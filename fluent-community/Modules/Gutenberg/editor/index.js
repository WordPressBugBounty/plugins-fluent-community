(()=>{"use strict";var e,t,n,a,o,r={87(e){e.exports=window.wp.element},143(e){e.exports=window.wp.data},279(e){e.exports=window.wp.plugins},314(e,t,n){n.d(t,{A:()=>m});var a=n(609),o=n(427),r=n(87);const i=window.wp.apiFetch;var l=n.n(i),s=n(881);const c={type:"oembed",url:"",inner_html:"",content_type:"video",html:"",provider:"",title:"",author_name:"",image:""},m=({media:e,videoLength:t,onUpdate:n})=>{const i=e&&"object"==typeof e?e:c,[m,d]=(0,r.useState)(i.type||"oembed"),[u,p]=(0,r.useState)(i.url||""),[f,w]=(0,r.useState)(i.html||""),[E,g]=(0,r.useState)(!1),[_,h]=(0,r.useState)(""),[v,b]=(0,r.useState)(!i.html),[y,A]=(0,r.useState)(i.html?{...i}:null),M=parseInt(t)||0,[x,S]=(0,r.useState)(Math.floor(M/60)),[k,N]=(0,r.useState)(M%60),P=(e,t)=>{const a=Math.max(0,parseInt(e)||0),o=Math.min(59,Math.max(0,parseInt(t)||0));S(a),N(o),n("video_length",60*a+o)},C=e=>{n("media",{...e})},D=()=>{u&&(g(!0),h(""),l()({path:`/fluent-community/v2/feeds/oembed?url=${encodeURIComponent(u)}`}).then(e=>{const t=e.oembed,n={type:t.type||"oembed",url:u,inner_html:"",content_type:"video",html:t.html,provider:t.provider||"",title:t.title||"",author_name:t.author_name||"",image:t.image||""};A(n),b(!1),C(n)}).catch(()=>{h((0,s.A)("Failed to fetch embed. Please check the URL."))}).finally(()=>{g(!1)}))},T=e=>{d(e),p(""),w(""),h(""),A(null),b(!0)},L=y&&y.html&&!v;return(0,a.createElement)("div",{className:"fcom-media-embedder"},L?(0,a.createElement)("div",{className:"fcom-media-preview"},y.image&&(0,a.createElement)("img",{src:y.image,alt:y.title||(0,s.A)("Video thumbnail"),style:{width:"100%",borderRadius:"4px",display:"block"}}),y.title&&(0,a.createElement)("p",{style:{margin:"8px 0 2px",fontWeight:600,fontSize:"13px"}},y.title),y.provider&&(0,a.createElement)("p",{style:{margin:0,fontSize:"12px",color:"#757575"}},y.provider,y.author_name?` â€” ${y.author_name}`:""),!y.image&&!y.title&&(0,a.createElement)("p",{style:{margin:0,fontSize:"12px",color:"#757575"}},(0,s.A)("Media embedded successfully")),(0,a.createElement)(o.Button,{variant:"link",isDestructive:!0,onClick:()=>b(!0),style:{marginTop:"8px",padding:0}},(0,s.A)("Edit media"))):(0,a.createElement)("div",{className:"fcom-media-input"},(0,a.createElement)(o.ButtonGroup,{className:"fcom-media-mode-toggle"},(0,a.createElement)(o.Button,{variant:"oembed"===m?"primary":"secondary",onClick:()=>T("oembed"),size:"compact"},(0,s.A)("Oembed")),(0,a.createElement)(o.Button,{variant:"iframe_html"===m?"primary":"secondary",onClick:()=>T("iframe_html"),size:"compact"},(0,s.A)("Custom HTML"))),"iframe_html"===m?(0,a.createElement)("div",{className:"fcom-media-field"},(0,a.createElement)(o.TextareaControl,{__nextHasNoMarginBottom:!0,label:(0,s.A)("Custom HTML Code"),value:f,onChange:w,placeholder:(0,s.A)("Paste an iframe code"),rows:4}),(0,a.createElement)(o.Button,{variant:"secondary",onClick:()=>{const e={...c,type:"iframe_html",html:f,content_type:"video"};A(e),b(!1),C(e)},disabled:!f,size:"compact",style:{marginTop:"8px"}},(0,s.A)("Embed"))):(0,a.createElement)("div",{className:"fcom-media-field"},(0,a.createElement)("div",{className:"fcom-url-input-row"},(0,a.createElement)("input",{type:"url",className:"components-text-control__input",value:u,onChange:e=>p(e.target.value),placeholder:(0,s.A)("Paste a URL to embed"),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),D())}}),(0,a.createElement)(o.Button,{variant:"secondary",onClick:D,disabled:!u||E,size:"compact"},E?(0,a.createElement)(o.Spinner,null):(0,s.A)("Embed"))),(0,a.createElement)("p",{className:"fcom-media-help"},(0,s.A)("Embed from Vimeo, YouTube, Wistia and more"))),_&&(0,a.createElement)("p",{className:"fcom-media-error"},_)),(0,a.createElement)("div",{className:"fcom-duration-section"},(0,a.createElement)("p",{className:"fcom-duration-label"},(0,s.A)("Lesson Duration")),(0,a.createElement)("div",{className:"fcom-duration-row"},(0,a.createElement)("div",{className:"fcom-duration-field"},(0,a.createElement)("input",{type:"number",className:"components-text-control__input",value:x,onChange:e=>P(e.target.value,k),min:0,max:1444}),(0,a.createElement)("span",{className:"fcom-duration-unit"},(0,s.A)("Minutes"))),(0,a.createElement)("span",{className:"fcom-duration-separator"},":"),(0,a.createElement)("div",{className:"fcom-duration-field"},(0,a.createElement)("input",{type:"number",className:"components-text-control__input",value:k,onChange:e=>P(x,e.target.value),min:0,max:59}),(0,a.createElement)("span",{className:"fcom-duration-unit"},(0,s.A)("Seconds"))))))}},388(e,t,n){n.d(t,{A:()=>r});var a=n(609),o=n(881);const r={name:"fcom_prefixed",className:"editor-autocompleters__fcom",triggerPrefix:"@",options:e=>[{code:"{{user.display_name|fallback}}",title:(0,o.A)("User's Name"),prefix:"user"},{code:"{{user.user_email|fallback}}",title:(0,o.A)("User's Email"),prefix:"user"},{code:"{{user.photo_html.50px}}",title:(0,o.A)("User's photo HTML"),prefix:"user"},{code:"##user.profile_link##",title:(0,o.A)("Profile Link"),prefix:"user"}],isDebounced:!0,getOptionKeywords:e=>[e.title,e.code],getOptionLabel:e=>[(0,a.createElement)("span",{key:"name",className:"editor-autocompleters__user-name"},e.title)],getOptionCompletion:e=>e.code}},427(e){e.exports=window.wp.components},609(e){e.exports=window.React},619(e){e.exports=window.wp.hooks},656(e){e.exports=window.wp.editor},766(e,t,n){n.d(t,{A:()=>l});var a=n(609),o=n(427),r=n(87),i=n(881);const l=()=>{const[e,t]=(0,r.useState)(window.fcomMetaSettings&&Array.isArray(window.fcomMetaSettings.document_lists)?window.fcomMetaSettings.document_lists:[]);return(0,r.useEffect)(()=>{const e=e=>{e.detail&&Array.isArray(e.detail.document_lists)&&t([...e.detail.document_lists])};window.addEventListener("fcomMetaSettingsReady",e);const n=()=>{window.fcomMetaSettings&&Array.isArray(window.fcomMetaSettings.document_lists)&&t([...window.fcomMetaSettings.document_lists])};return window.addEventListener("fcomDocumentsUpdated",n),()=>{window.removeEventListener("fcomMetaSettingsReady",e),window.removeEventListener("fcomDocumentsUpdated",n)}},[]),(0,a.createElement)("div",{className:"fcom-documents-panel"},e.length>0?(0,a.createElement)("ul",{className:"fcom-documents-list"},e.map(e=>{return(0,a.createElement)("li",{key:e.id,className:"fcom-document-item"},(0,a.createElement)("span",{className:"fcom-document-icon"},(t=e.type)?t.includes("pdf")?"ðŸ“„":t.includes("image")?"ðŸ–¼ï¸":t.includes("video")?"ðŸŽ¥":t.includes("audio")?"ðŸŽµ":t.includes("zip")||t.includes("rar")||t.includes("archive")?"ðŸ—œï¸":"ðŸ“„":"ðŸ“„"),(0,a.createElement)("span",{className:"fcom-document-title"},e.title),e.url&&(0,a.createElement)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"fcom-document-view",title:(0,i.A)("View")},(0,a.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor"},(0,a.createElement)("path",{d:"M19.5 14.5v3c0 .8-.7 1.5-1.5 1.5H6c-.8 0-1.5-.7-1.5-1.5v-3H6v3h12v-3h1.5zM12 4.5C7.3 4.5 3.4 7.6 2 12c1.4 4.4 5.3 7.5 10 7.5s8.6-3.1 10-7.5c-1.4-4.4-5.3-7.5-10-7.5zm0 12.5c-2.8 0-5-2.2-5-5s2.2-5 5-5 5 2.2 5 5-2.2 5-5 5zm0-8c-1.7 0-3 1.3-3 3s1.3 3 3 3 3-1.3 3-3-1.3-3-3-3z"}))));var t})):(0,a.createElement)("p",{className:"fcom-documents-empty"},(0,i.A)("No documents attached yet.")),(0,a.createElement)(o.Button,{variant:"secondary",onClick:()=>{window.parent.postMessage({action:"MANAGE_DOCUMENTS",content:null},"*")},size:"compact",className:"fcom-documents-manage-btn"},(0,i.A)("Manage Documents & Files")))}},881(e,t,n){n.d(t,{A:()=>o});const a=window.fcomEditorI18n||{};function o(e){return a[e]||e}},981(e,t,n){n.a(e,async(e,t)=>{try{var a=n(609),o=n(279),r=n(656),i=n(427),l=n(87),s=n(143),c=n(619),m=n(997),d=n(881),u=n(388),p=n(314),f=n(766);const w=()=>{const[e,t]=(0,l.useState)(window.fcomMetaSettings||null);(0,l.useEffect)(()=>{const e=e=>{e.detail&&t({...e.detail})};return window.addEventListener("fcomMetaSettingsReady",e),()=>window.removeEventListener("fcomMetaSettingsReady",e)},[]);const[n,o]=(0,l.useState)(!!e&&"yes"===e.enable_media),s=(0,l.useRef)(e?e.enable_media:"no");(0,l.useEffect)(()=>{e&&e.enable_media!==s.current&&(s.current=e.enable_media,"yes"===e.enable_media&&o(!0))},[e]);const c=(e,n)=>{const a={...window.fcomMetaSettings,[e]:n};window.fcomMetaSettings=a,t({...a}),window.parent.postMessage({action:"META_UPDATED",content:a},"*")};return(0,a.createElement)(a.Fragment,null,(0,a.createElement)(r.PluginPostStatusInfo,null,e&&(0,a.createElement)("div",{className:"fcom_feature_checkboxes",style:{width:"100%"}},(0,a.createElement)(i.CheckboxControl,{__nextHasNoMarginBottom:!0,label:(0,d.A)("Enable Video Embed"),checked:"yes"===e.enable_media,onChange:e=>c("enable_media",e?"yes":"no")}),(0,a.createElement)(i.CheckboxControl,{__nextHasNoMarginBottom:!0,label:(0,d.A)("Enable Comments"),checked:"yes"===e.enable_comments,onChange:e=>c("enable_comments",e?"yes":"no")}),(0,a.createElement)(i.CheckboxControl,{__nextHasNoMarginBottom:!0,label:(0,d.A)("Free Preview Lesson"),help:(0,d.A)("If enabled, public users can view this lesson without enrolling the course."),checked:"yes"===e.free_preview_lesson,onChange:e=>c("free_preview_lesson",e?"yes":"no")}))),(0,a.createElement)(r.PluginDocumentSettingPanel,{name:"fcom-media-embed",title:(0,d.A)("Media Embed"),className:e&&"yes"===e.enable_media?"":"fcom-panel-hidden",isOpen:n,onToggle:()=>o(!n)},e&&"yes"===e.enable_media&&(0,a.createElement)(p.A,{media:e.media,videoLength:e.video_length,onUpdate:(e,t)=>c(e,t)})),(0,a.createElement)(r.PluginDocumentSettingPanel,{name:"fcom-documents",title:(0,d.A)("Documents & Files"),className:e?"":"fcom-panel-hidden",initialOpen:!1},e&&(0,a.createElement)(f.A,null)),(0,a.createElement)(r.PluginDocumentSettingPanel,{name:"fcom-smartcodes",title:(0,d.A)("Smartcodes"),initialOpen:!1},(0,a.createElement)("div",{className:"fcom_lesson_info_codes"},(0,a.createElement)("p",null,(0,d.A)("You may use following smartcode in your lesson:")),(0,a.createElement)("ul",null,(0,a.createElement)("li",null,(0,a.createElement)("b",null,(0,d.A)("User's Name:"))," ",(0,a.createElement)("span",null,"{{user.display_name|fallback}}")),(0,a.createElement)("li",null,(0,a.createElement)("b",null,(0,d.A)("User's Email:"))," ",(0,a.createElement)("span",null,"{{user.user_email|fallback}}")),(0,a.createElement)("li",null,(0,a.createElement)("b",null,(0,d.A)("User's photo HTML:"))," ",(0,a.createElement)("span",null,"{{user.photo_html.50px}}")),(0,a.createElement)("li",null,(0,a.createElement)("b",null,(0,d.A)("User's Profile Link:"))," ",(0,a.createElement)("span",null,"##user.profile_link##"))))))};(0,o.registerPlugin)("fcom-document-settings",{render:w});let E=!1;const g=()=>(E||((0,s.select)("core/edit-post").isFeatureActive("welcomeGuide")&&(0,s.dispatch)("core/edit-post").toggleFeature("welcomeGuide"),(0,s.select)("core/edit-post").isFeatureActive("fullscreenMode")||(0,s.dispatch)("core/edit-post").toggleFeature("fullscreenMode"),"text"===(0,s.select)("core/edit-post").getEditorMode()&&(0,s.dispatch)("core/edit-post").switchEditorMode("visual"),(0,s.dispatch)("core/editor").lockPostSaving(),(0,s.dispatch)("core/editor").lockPostAutosaving(),E=!0),null);async function _(){await new Promise(e=>{const t=(0,s.subscribe)(()=>{((0,s.select)("core/editor").isCleanNewPost()||(0,s.select)("core/block-editor").getBlockCount()>0)&&(t(),e())})});const e=document.querySelector('[name="editor-canvas"]');return new Promise(t=>{e?e.loading?e.onload=()=>{t(e)}:t(e):t(null)})}(0,o.registerPlugin)("fluent-com-disable-gutenberg-features",{render:g}),(0,c.addFilter)("editor.DocumentBar","fluentcom-custom-document-bar",()=>null),(0,c.addFilter)("editor.Autocomplete.completers","fluent_com/add_autocmplete",function(e,t){return e=e.filter(e=>"users"!==e.name),[...e,u.A]}),window.addEventListener("beforeunload",function(e){e.stopImmediatePropagation()}),await _(),console.log("editor iframe is now ready");let h=!1;window.addEventListener("message",e=>{if("SYNC_META"===e.data?.type)return window.fcomMetaSettings=e.data.data,window.dispatchEvent(new CustomEvent("fcomMetaSettingsReady",{detail:e.data.data})),void window.dispatchEvent(new CustomEvent("fcomDocumentsUpdated"));if("UPDATE_EDITOR"!==e.data?.type)return;const{content:t,title:n,featured_image_id:a,metaSettings:o}=e.data.data;console.log("UPDATE_EDITOR",o,e.data.data),o?(window.fcomMetaSettings=o,window.dispatchEvent(new CustomEvent("fcomMetaSettingsReady",{detail:o}))):window.fcomMetaSettings=null,t&&(0,s.dispatch)("core/block-editor").resetBlocks((0,m.parse)(t));let r=null;n&&(r={title:n}),a&&(r?r.featured_media=a:r={featured_media:a}),r&&(0,s.dispatch)("core/editor").editPost(r),setTimeout(()=>{h=!0},1e3)}),window._wpLoadBlockEditor.then(()=>{window.parent.postMessage({content:"ping",action:"EDITOR_READY"},"*");let e="",t="",n=null;(0,s.subscribe)(()=>{if(!h)return;const a=(0,s.select)("core/editor").getEditedPostAttribute("title");a!=t&&(t=a,window.parent.postMessage({content:a,action:"TITLE_UPDATED"},"*"));const o=(0,s.select)("core/editor").getEditedPostAttribute("featured_media");n!=o&&(n=o,window.parent.postMessage({content:o,action:"FEATURED_MEDIA_UPDATED"},"*"));const r=(0,s.select)("core/block-editor").getBlocks(),i=(0,m.serialize)(r);e!=i&&(e=i,window.parent.postMessage({content:i,action:"EDITOR_UPDATED"},"*"))})}),t()}catch(v){t(v)}},1)},997(e){e.exports=window.wp.blocks}},i={};function l(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={exports:{}};return r[e](n,n.exports,l),n.exports}e="function"==typeof Symbol,t=e?Symbol("webpack queues"):"__webpack_queues__",n=e?Symbol("webpack exports"):"__webpack_exports__",a=e?Symbol("webpack error"):"__webpack_error__",o=e=>{e&&e.d<1&&(e.d=1,e.forEach(e=>e.r--),e.forEach(e=>e.r--?e.r++:e()))},l.a=(e,r,i)=>{var l;i&&((l=[]).d=-1);var s,c,m,d=new Set,u=e.exports,p=new Promise((e,t)=>{m=t,c=e});p[n]=u,p[t]=e=>(l&&e(l),d.forEach(e),p.catch(e=>{})),e.exports=p,r(e=>{var r;s=(e=>e.map(e=>{if(null!==e&&"object"==typeof e){if(e[t])return e;if(e.then){var r=[];r.d=0,e.then(e=>{i[n]=e,o(r)},e=>{i[a]=e,o(r)});var i={};return i[t]=e=>e(r),i}}var l={};return l[t]=e=>{},l[n]=e,l}))(e);var i=()=>s.map(e=>{if(e[a])throw e[a];return e[n]}),c=new Promise(e=>{(r=()=>e(i)).r=0;var n=e=>e!==l&&!d.has(e)&&(d.add(e),e&&!e.d&&(r.r++,e.push(r)));s.map(e=>e[t](n))});return r.r?c:i()},e=>(e?m(p[a]=e):c(u),o(l))),l&&l.d<0&&(l.d=0)},l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},l.d=(e,t)=>{for(var n in t)l.o(t,n)&&!l.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l(981)})();