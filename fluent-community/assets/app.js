import{A as i,B as c,V as l,ae as g,a7 as D,H as R,J as a,O as r,P as v,U as _,T as d,K as V,ak as K,Z as N,S,Y as Z,z,ad as pe,av as Ie,R as re,aw as ht,ax as ft,ab as be,Q as xt,ah as pt,a3 as Qe,W as ro,$ as co,_ as cs,al as uo,ap as _o}from"./vue.js?ver=2.2.0";import{c as os,a as mo,b as ho}from"./vue-router.js?ver=2.2.0";import{d as Ae,m as ds,c as fo,s as po}from"./pinia.js?ver=2.2.0";import{b6 as go,b7 as gt,ao as yo,U as yt,b8 as vo,b9 as Ve,ba as bo,m as us,bb as ko,bc as wo,k as Co,bd as $o,be as _s,L as ms,bf as So,bg as Vo,a as jt,bh as Lo,bi as Mo,bj as Po,bk as Fo,bl as To,bm as Io,bn as Uo,bo as Bo,bp as Eo,bq as Ao,br as Do,bs as Ro,bt as Ho,bu as xo,v as jo,h as Oo,bv as No,bw as zo,bx as qo,B as Go,by as Yo,s as Zo,x as Wo,q as Jo,n as Qo,bz as Ko,K as Xo,bA as ei,bB as ti,bC as si,bD as oi,e as ii,bE as ni,bF as li,Q as ai,bG as ri,bH as ci,bI as di,bJ as ui,V as _i,G as mi}from"./vendor.js?ver=2.2.0";import{E as O,a as hi,b as j,c as q,d as de,e as vt,f as ee,g as he,h as Xe,i as et,j as tt,k as Pe,l as st,m as ge,n as ye,o as hs,p as Oe,q as fe,r as ie,s as ne,t as bt,u as ue,v as fs,w as _e,x as ot,y as it,z as nt,A as ps,B as kt,C as wt,D as Ct,F as Ue,G as fi,H as gs,I as ys,J as pi,K as vs,L as gi,M as $t,N as bs,O as Ce,P as De,Q as Ne,R as Ot,S as yi,T as vi,U as ks,V as Nt,W as zt,X as bi,Y as ws,Z as ki,_ as wi,$ as At}from"./element-plus.js?ver=2.2.0";import{_ as F,P as Ci,E as $i}from"./emoji-picker.js?ver=2.2.0";import{o as Si,q as qt,u as Vi,r as Li,v as Ee,w as Mi}from"./lodash.js?ver=2.2.0";import{H as Pi,O as Fi,m as Ti,s as Ii,c as Ui,a as Bi,h as Ei,b as Ai,x as Di,P as Ri,W as Hi,U as xi,d as ji,_ as Oi,$ as Ni,w as zi,r as qi,L as Dt,e as Gi}from"./milkdown.js?ver=2.2.0";import"./dayjs.js?ver=2.2.0";const oe=Ae("cache",{state:()=>({cache:{},stats:{hits:0,misses:0,size:0,totalSaved:0},maxSize:500,maxMemorySize:50*1024*1024}),getters:{getCacheHitRate:e=>{const t=e.stats.hits+e.stats.misses;return t>0?(e.stats.hits/t*100).toFixed(2):0},getCacheSize:e=>Object.keys(e.cache).length,getMemoryUsage:e=>{try{return(new Blob([JSON.stringify(e.cache)]).size/1024/1024).toFixed(2)+" MB"}catch{return"Unknown"}},getCacheKeys:e=>Object.keys(e.cache),getCacheEntry:e=>t=>e.cache[t]||null},actions:{get(e,t=null){const o=this.cache[e];if(!o)return this.stats.misses++,null;const u=Date.now()-o.timestamp,s=o.ttl||t||5*60*1e3;return u>s?(delete this.cache[e],this.stats.misses++,this.stats.size=Object.keys(this.cache).length,null):(this.stats.hits++,o.hits=(o.hits||0)+1,o.lastAccessed=Date.now(),o.data)},set(e,t,o=5*60*1e3){Object.keys(this.cache).length>=this.maxSize&&this.pruneLRU(50),this.cache[e]={data:t,timestamp:Date.now(),lastAccessed:Date.now(),hits:0,ttl:o},this.stats.size=Object.keys(this.cache).length,this.stats.totalSaved++},invalidate(e){this.cache[e]&&(delete this.cache[e],this.stats.size=Object.keys(this.cache).length)},invalidatePattern(e){let t=0;return Object.keys(this.cache).forEach(o=>{o.includes(e)&&(delete this.cache[o],t++)}),this.stats.size=Object.keys(this.cache).length,t},pruneLRU(e){const t=Object.entries(this.cache).map(([o,u])=>({key:o,lastAccessed:u.lastAccessed||u.timestamp})).sort((o,u)=>o.lastAccessed-u.lastAccessed).slice(0,e);return t.forEach(({key:o})=>{delete this.cache[o]}),this.stats.size=Object.keys(this.cache).length,t.length},pruneExpired(e=15*60*1e3){let t=0;const o=Date.now();return Object.entries(this.cache).forEach(([u,s])=>{o-s.timestamp>e&&(delete this.cache[u],t++)}),this.stats.size=Object.keys(this.cache).length,t},clear(){this.cache={},this.stats.hits=0,this.stats.misses=0,this.stats.size=0},getStats(){return{...this.stats,hitRate:this.getCacheHitRate,memoryUsage:this.getMemoryUsage,cacheSize:this.getCacheSize}},has(e){return e in this.cache},getKeysMatching(e){return Object.keys(this.cache).filter(t=>t.includes(e))},warmCache(e){Object.entries(e).forEach(([t,o])=>{this.set(t,o)})}}}),xe=Ae("ui",{state:()=>({lastScrollPath:null,lastScrollPosition:0,lastViewedFeed:{},layoutStyle:null,sortBy:null,layoutStyleByContext:{},sortByContext:{},modals:{feedModal:!1,createPostModal:!1,editPostModal:!1,shareModal:!1},globalLoading:!1,sidebarCollapsed:!1,searchQuery:"",activeSpace:null,activeTopic:null}),getters:{getLastViewedFeed:e=>t=>e.lastViewedFeed[t]||null,getLayoutStyle:e=>t=>e.layoutStyleByContext[t]||e.layoutStyle||"list",getSortBy:e=>t=>e.sortByContext[t]||e.sortBy||"latest",isModalOpen:e=>t=>e.modals[t]||!1},actions:{saveScrollPosition(e,t){this.lastScrollPath=e,this.lastScrollPosition=t},restoreScrollPosition(e){return this.lastScrollPath===e&&this.lastScrollPosition>0?this.lastScrollPosition:0},saveLastViewedFeed(e,t,o){this.lastViewedFeed[e]={feedId:t,index:o,timestamp:Date.now()}},setLayoutStyle(e){this.layoutStyle=e;try{localStorage.setItem("fcom_feed_layout",e)}catch(t){console.error("Failed to save layout style:",t)}},setLayoutStyleForContext(e,t){this.layoutStyleByContext[e]=t;try{localStorage.setItem("fcom_layout_by_context",JSON.stringify(this.layoutStyleByContext))}catch(o){console.error("Failed to save layout style:",o)}},setSortBy(e){this.sortBy=e;try{localStorage.setItem("fcom_feed_sort",e)}catch(t){console.error("Failed to save sort preference:",t)}},setSortByForContext(e,t){this.sortByContext[e]=t;try{localStorage.setItem("fcom_sort_by_context",JSON.stringify(this.sortByContext))}catch(o){console.error("Failed to save sort preference:",o)}},openModal(e){this.modals[e]=!0},closeModal(e){this.modals[e]=!1},toggleModal(e){this.modals[e]=!this.modals[e]},setGlobalLoading(e){this.globalLoading=e},toggleSidebar(){this.sidebarCollapsed=!this.sidebarCollapsed},setSidebar(e){this.sidebarCollapsed=e},setSearchQuery(e){this.searchQuery=e},setActiveSpace(e){this.activeSpace=e},setActiveTopic(e){this.activeTopic=e},clearScrollPosition(){this.lastScrollPath=null,this.lastScrollPosition=0},clearLastViewedFeeds(){this.lastViewedFeed={}},initialize(){try{const e=localStorage.getItem("fcom_feed_layout");e&&(this.layoutStyle=e);const t=localStorage.getItem("fcom_layout_by_context");t&&(this.layoutStyleByContext=JSON.parse(t))}catch(e){console.error("Failed to restore layout style:",e)}try{const e=localStorage.getItem("fcom_feed_sort");e&&(this.sortBy=e);const t=localStorage.getItem("fcom_sort_by_context");t&&(this.sortByContext=JSON.parse(t))}catch(e){console.error("Failed to restore sort preference:",e)}},reset(){this.lastScrollPath=null,this.lastScrollPosition=0,this.lastViewedFeed={},this.modals={feedModal:!1,createPostModal:!1,editPostModal:!1,shareModal:!1},this.globalLoading=!1,this.sidebarCollapsed=!1,this.searchQuery="",this.activeSpace=null,this.activeTopic=null}}}),Te=Ae("user",{state:()=>({currentUser:null,profilesByUsername:{},follows:{},followers:[],loading:{},lastFetched:{}}),getters:{getProfile:e=>t=>e.profilesByUsername[t]||null,isFollowing:e=>t=>{const o=e.follows[String(t)];return o!==void 0&&["1","2"].includes(String(o))},isBlocked:e=>t=>{const o=e.follows[String(t)];return o!==void 0&&String(o)==="0"},getFollowLevel:e=>t=>e.follows[String(t)],getCurrentUser:e=>e.currentUser,isLoading:e=>t=>e.loading[t]||!1,followingCount:e=>Object.values(e.follows).filter(t=>["1","2"].includes(String(t))).length,followersCount:e=>e.followers.length},actions:{initializeCurrentUser(){var e;(e=window.fluentComAdmin)!=null&&e.auth&&(this.currentUser=window.fluentComAdmin.auth)},setFollows(e){if(!(!e||typeof e!="object"))for(const[t,o]of Object.entries(e)){const u=String(t);o==null?delete this.follows[u]:this.follows[u]=String(o)}},removeFollow(e){delete this.follows[String(e)]},async fetchProfile(e,t=!1){const o=oe(),u=`user-profile:${e}`;if(!t){const s=o.get(u);if(s)return this.profilesByUsername[e]=s,s.follow!==void 0&&s.user_id&&this.setFollows({[s.user_id]:s.follow}),s}this.loading[e]=!0;try{const s=await this.$api.get(`profile/${e}`),n=s.profile;return n.follow!==void 0&&n.user_id&&this.setFollows({[n.user_id]:n.follow}),s.current_user_follows&&this.setFollows(s.current_user_follows),this.profilesByUsername[e]=n,this.lastFetched[e]=Date.now(),o.set(u,n,5*60*1e3),this.loading[e]=!1,n}catch(s){throw this.loading[e]=!1,console.error("Failed to fetch user profile:",s),s}},async updateProfile(e,t=null,o=null){var s;const u=oe();try{const n=o?await this.$api.put(`profile/${o}`,{data:e}):await this.$api.put("profile",e),m=n.profile||n.user||n;return this.currentUser={...this.currentUser,...m},t&&t!==m.username&&(delete this.profilesByUsername[t],u.invalidate(`user-profile:${t}`)),m.username&&(this.profilesByUsername[m.username]=m,u.invalidate(`user-profile:${m.username}`)),(s=window.fluentComAdmin)!=null&&s.auth&&(window.fluentComAdmin.auth={...window.fluentComAdmin.auth,...m}),m}catch(n){throw console.error("Failed to update profile:",n),n}},async toggleFollow(e,t=null){var p,h,y;const o=oe(),u=String(e),s=this.follows[u],n=s!==void 0&&["1","2"].includes(String(s)),m=s;n?(delete this.follows[u],t&&this.profilesByUsername[t]&&(this.profilesByUsername[t].followers_count--,this.profilesByUsername[t].follow=void 0)):(this.follows[u]="1",t&&this.profilesByUsername[t]&&(this.profilesByUsername[t].followers_count++,this.profilesByUsername[t].follow="1"));try{const k=n?`profile/${t}/unfollow`:`profile/${t}/follow`,b=await this.$api.post(k);return n?delete this.follows[u]:((p=b.follow)==null?void 0:p.level)!==void 0&&this.setFollows({[u]:b.follow.level}),t&&this.profilesByUsername[t]&&(((h=b.xprofile)==null?void 0:h.followers_count)!==void 0&&(this.profilesByUsername[t].followers_count=b.xprofile.followers_count),o.invalidate(`user-profile:${t}`)),(y=window.fluentFrameworkApp)!=null&&y.$eventBus&&window.fluentFrameworkApp.$eventBus.emit("user_follow_toggled",{userId:e,isFollowing:!n}),b}catch(k){throw n?(this.follows[u]=m,t&&this.profilesByUsername[t]&&(this.profilesByUsername[t].followers_count++,this.profilesByUsername[t].follow=m)):(delete this.follows[u],t&&this.profilesByUsername[t]&&(this.profilesByUsername[t].followers_count--,this.profilesByUsername[t].follow=void 0)),console.error("Failed to toggle follow:",k),k}},async fetchFollowing(){const e=oe(),t="user-following",o=e.get(t);if(o)return o;try{const u=await this.$api.get("profile/following"),s=u.following||u;return u.current_user_follows&&this.setFollows(u.current_user_follows),e.set(t,s,5*60*1e3),s}catch(u){throw console.error("Failed to fetch following:",u),u}},invalidateProfile(e){oe().invalidate(`user-profile:${e}`),delete this.lastFetched[e]},clearAll(){this.currentUser=null,this.profilesByUsername={},this.follows={},this.followers=[],this.loading={},this.lastFetched={};const e=oe();e.invalidatePattern("user-profile:"),e.invalidate("user-following")}}}),Se=Ae("feed",{state:()=>({feedsByContext:{},feedsById:{},stickyFeeds:{},loading:{},pagination:{},filters:{},tickerIntervals:{},tickerEnabled:{},lastTickerCheck:{},tickerPending:{},newPostsCount:{},ticker:{count:0,lastFetched:0},executionTimes:{},_pendingRequests:{}}),getters:{getFeedsByContext:e=>t=>{const o=e.feedsByContext[t];return o?o.data||[]:[]},getFeedById:e=>t=>e.feedsById[t]||null,getStickyFeed:e=>t=>e.stickyFeeds[t]||null,getPagination:e=>t=>e.pagination[t]||{page:1,per_page:10,total:0,last_page:1,has_more:!1},isLoading:e=>t=>e.loading[t]||!1,getExecutionTime:e=>t=>e.executionTimes[t]||"",totalFeedsInMemory:e=>{let t=Object.keys(e.feedsById).length;return Object.values(e.feedsByContext).forEach(o=>{var u;t+=((u=o.data)==null?void 0:u.length)||0}),t},disableAutoLoad:e=>t=>{const o=e.loading[t]||!1,u=e.pagination[t];return u?o||u.has_more===!1:!0},getTickerCount:e=>e.ticker.count||0,getTickerLastFetched:e=>e.ticker.lastFetched||0,isTickerActive:e=>t=>e.tickerEnabled[t]&&e.tickerIntervals[t]!==null,getNewPostsCount:e=>t=>e.newPostsCount[t]||0,getMemoryStats:e=>{let t=0,o={};Object.keys(e.feedsByContext).forEach(n=>{var p,h;const m=((h=(p=e.feedsByContext[n])==null?void 0:p.data)==null?void 0:h.length)||0;o[n]=m,t+=m});const u=Object.keys(e.feedsById).length,s=(t*5/1024).toFixed(2);return{totalFeeds:t,feedsByContextCount:o,feedsByIdCount:u,estimatedMemoryMB:s,contexts:Object.keys(e.feedsByContext).length}}},actions:{async fetchFeeds(e,t={},o=!1){var h,y;if(console.log("[Feed Store] fetchFeeds called:",{context:e,loadMore:o,paramsPage:t.page,currentLoading:this.loading[e],currentPage:(h=this.pagination[e])==null?void 0:h.page}),this.loading[e]){console.log("[Feed Store] Already loading for context:",e,"- ignoring duplicate request");return}const u=o?(((y=this.pagination[e])==null?void 0:y.page)||0)+1:t.page||1,s={...t,page:u,per_page:t.per_page||10},n=`feeds:${e}:${JSON.stringify(s)}`,m=oe();if(!o&&u===1){const k=m.get(n,3e5);if(k)return this.feedsByContext[e]=k.feedsByContext,this.pagination[e]=k.pagination,this.stickyFeeds[e]=k.stickyFeed,this.executionTimes[e]=k.executionTime,k.feedsByContext.data.forEach(b=>{this.feedsById[b.id]=b}),this.loading[e]=!1,console.log("[Feed Store] Returning CACHED data, set loading to FALSE for context:",e),k}return this.loading[e]=!0,console.log("[Feed Store] Set loading to TRUE for context:",e,"page:",u),this.$api.get(t.feed_base_url||"feeds",s).then(k=>{var b,$,f,w;if(k.sticky){const C="viewed_sticky_posts_"+k.sticky.id;window[C]?k.feeds.data.unshift(k.sticky):this.stickyFeeds[e]=k.sticky}else u===1&&(this.stickyFeeds[e]=null);if(o){const C=((b=this.feedsByContext[e])==null?void 0:b.data)||[];this.feedsByContext[e]={data:[...C,...k.feeds.data],timestamp:Date.now()}}else this.feedsByContext[e]={data:k.feeds.data,timestamp:Date.now()};if(this.pagination[e]={page:u,per_page:s.per_page,total:k.feeds.total,last_page:k.feeds.last_page,has_more:k.feeds.has_more},console.log("[Feed Store] Updated pagination:",{context:e,page:u,has_more:k.feeds.has_more,total:k.feeds.total}),k.execution_time&&(this.executionTimes[e]=k.execution_time),k.feeds.data.forEach(C=>{this.feedsById[C.id]={...C,timestamp:Date.now()}}),o){const C=((f=($=this.feedsByContext[e])==null?void 0:$.data)==null?void 0:f.length)||0;C>500&&(console.log("[Feed Store] Pruning feeds, count:",C),this.pruneOldFeeds(e))}return k.last_fetched_timestamp&&(this.ticker.lastFetched=k.last_fetched_timestamp,(w=window.fluentFrameworkApp)!=null&&w.$eventBus&&window.fluentFrameworkApp.$eventBus.emit("newest_feed_fetched",{last_fetched_timestamp:k.last_fetched_timestamp})),k.current_user_follows&&Te().setFollows(k.current_user_follows),!o&&u===1&&m.set(n,{feedsByContext:this.feedsByContext[e],pagination:this.pagination[e],stickyFeed:this.stickyFeeds[e],executionTime:this.executionTimes[e]}),console.log("[Feed Store] Fetch SUCCESS, stored feeds for context:",e,{feedCount:this.feedsByContext[e].data.length,pagination:this.pagination[e],hasSticky:!!this.stickyFeeds[e]}),this.loading[e]=!1,console.log("[Feed Store] Set loading to FALSE after success for context:",e),{feeds:this.feedsByContext[e].data,pagination:this.pagination[e],sticky:this.stickyFeeds[e]}}).catch(k=>{throw console.error("[Feed Store] Failed to fetch feeds:",k),this.loading[e]=!1,console.log("[Feed Store] Set loading to FALSE after error for context:",e),k})},async fetchFeedBySlug(e){const t=`feed:slug:${e}`,o=oe(),u=o.get(t,10*60*1e3);if(u)return this.feedsById[u.id]=u,u;try{const n=(await this.$api.get(`feeds/${e}/by-slug`)).feed;return this.feedsById[n.id]={...n,timestamp:Date.now()},o.set(t,n),window.appVars&&(window.appVars.last_feed_id=n.id),n}catch(s){throw console.error("Failed to fetch feed:",s),s}},async createFeed(e,t){var o,u,s;try{const n=await this.$api.post("feeds",t),m=n.feed;if(this.feedsById[m.id]={...m,timestamp:Date.now()},!n.scheduled_at){const h=y=>{this.feedsByContext[y]||(this.feedsByContext[y]={data:[],timestamp:Date.now()}),this.stickyFeeds[y]&&(this.feedsByContext[y].data.unshift(this.stickyFeeds[y]),this.stickyFeeds[y]=null);const k=this.feedsByContext[y].data.findIndex(b=>b.id===m.id);k===-1&&this.feedsByContext[y].data.unshift(m),this.pagination[y]?k===-1&&this.pagination[y].total++:this.pagination[y]={page:1,per_page:10,total:1,last_page:1,has_more:!1}};h(e),m.space_id&&e!=="global"&&(h("global"),oe().invalidatePattern("feeds:global"))}return n.last_fetched_timestamp&&(this.ticker.lastFetched=n.last_fetched_timestamp,(o=window.FluentCommunityUtil)!=null&&o.eventBus&&((s=(u=window.fluentFrameworkApp)==null?void 0:u.$eventBus)==null||s.emit("newest_feed_fetched",{last_fetched_timestamp:n.last_fetched_timestamp}))),oe().invalidatePattern(`feeds:${e}`),n}catch(n){throw console.error("Failed to create feed:",n),n}},async updateFeed(e,t){const o=this.feedsById[e]?{...this.feedsById[e]}:null;this.feedsById[e]&&(this.feedsById[e]={...this.feedsById[e],...t,timestamp:Date.now()}),Object.keys(this.feedsByContext).forEach(u=>{const s=this.feedsByContext[u].data.findIndex(n=>n.id===e);s!==-1&&(this.feedsByContext[u].data[s]={...this.feedsByContext[u].data[s],...t})});try{const s=(await this.$api.patch(`feeds/${e}`,t)).feed;return this.feedsById[e]={...this.feedsById[e],...s,timestamp:Date.now()},Object.keys(this.feedsByContext).forEach(m=>{const p=this.feedsByContext[m].data.findIndex(h=>h.id===e);p!==-1&&(this.feedsByContext[m].data[p]={...this.feedsByContext[m].data[p],...s})}),oe().invalidatePattern("feed:"),s}catch(u){throw o&&(this.feedsById[e]=o,Object.keys(this.feedsByContext).forEach(s=>{const n=this.feedsByContext[s].data.findIndex(m=>m.id===e);n!==-1&&(this.feedsByContext[s].data[n]=o)})),console.error("Failed to update feed:",u),u}},async deleteFeed(e,t,o=null){try{return await this.$api.delete(`feeds/${t}`),delete this.feedsById[t],o!==null&&this.feedsByContext[e]?this.feedsByContext[e].data.splice(o,1):Object.keys(this.feedsByContext).forEach(s=>{var n;(n=this.feedsByContext[s])!=null&&n.data&&(this.feedsByContext[s].data=this.feedsByContext[s].data.filter(m=>m.id!==t))}),this.pagination[e]&&this.pagination[e].total--,oe().invalidatePattern("feed:"),!0}catch(u){throw console.error("Failed to delete feed:",u),u}},async toggleBookmark(e){const t=this.feedsById[e];if(!t)return;const o=t.is_bookmarked;t.is_bookmarked=!o,Object.keys(this.feedsByContext).forEach(u=>{var n;const s=(n=this.feedsByContext[u].data)==null?void 0:n.findIndex(m=>m.id===e);s!==-1&&(this.feedsByContext[u].data[s].is_bookmarked=!o)});try{const u=await this.$api.post(`feeds/${e}/toggle-bookmark`);return t.is_bookmarked=u.is_bookmarked,Object.keys(this.feedsByContext).forEach(s=>{var m;const n=(m=this.feedsByContext[s].data)==null?void 0:m.findIndex(p=>p.id===e);n!==-1&&(this.feedsByContext[s].data[n].is_bookmarked=u.is_bookmarked)}),u}catch(u){throw t.is_bookmarked=o,Object.keys(this.feedsByContext).forEach(s=>{var m;const n=(m=this.feedsByContext[s].data)==null?void 0:m.findIndex(p=>p.id===e);n!==-1&&(this.feedsByContext[s].data[n].is_bookmarked=o)}),u}},async fetchTicker(e){var t,o,u;try{const s=e||this.ticker.lastFetched;console.log("[Legacy Ticker] Fetching ticker with timestamp:",s);const n=await this.$api.get("feeds/ticker",{last_fetched_timestamp:s});if(console.log("[Legacy Ticker] Response:",{has_changes:n.has_changes,feeds:((t=n.feeds)==null?void 0:t.length)||0,new_items_count:n.new_items_count}),this.ticker={count:n.new_items_count||0,lastFetched:n.last_fetched_timestamp||Date.now()},console.log("[Legacy Ticker] Checking if we should process feeds:",{has_changes:n.has_changes,feeds_exists:!!n.feeds,feeds_length:((o=n.feeds)==null?void 0:o.length)||0,feeds_data:n.feeds}),n.has_changes&&n.feeds&&n.feeds.length>0){console.log(`[Legacy Ticker] ‚úÖ Processing ${n.feeds.length} feed updates`);const m={};n.feeds.forEach(p=>{console.log("[Legacy Ticker] Processing feed update:",p);const h=p.context||"global";m[h]||(m[h]=[]),m[h].push(p)}),console.log("[Legacy Ticker] Updates grouped by context:",m);for(const p in m){console.log(`[Legacy Ticker] üì• Processing context: ${p} (${m[p].length} updates)`);try{await this.processTickerUpdates(p,m[p]),console.log(`[Legacy Ticker] ‚úÖ Successfully processed context: ${p}`)}catch(h){console.error(`[Legacy Ticker] ‚ùå Failed to process context: ${p}`,h)}}}else console.log("[Legacy Ticker] ‚è≠Ô∏è  Skipping feed processing - no changes or no feeds in response");return(u=window.fluentFrameworkApp)!=null&&u.$eventBus&&window.fluentFrameworkApp.$eventBus.emit("ticker_updated",n),this.ticker}catch(s){throw console.error("[Legacy Ticker] Failed to fetch ticker:",s),s}},resetTicker(){this.ticker.count=0},markStickyAsViewed(e,t){const o=this.stickyFeeds[e];o&&o.id===t&&(window["viewed_sticky_posts_"+t]=!0,this.feedsByContext[e]&&this.feedsByContext[e].data.unshift(o),this.stickyFeeds[e]=null)},pruneOldFeeds(e=null){(e?[e]:Object.keys(this.feedsByContext)).forEach(u=>{var n;const s=((n=this.feedsByContext[u])==null?void 0:n.data)||[];if(s.length>500){const m=s.slice(0,s.length-500);this.feedsByContext[u].data=s.slice(s.length-500),console.log(`[Feed Store] Pruned ${m.length} old feeds from ${u}, kept ${this.feedsByContext[u].data.length}`),m.forEach(p=>{Object.values(this.feedsByContext).some(y=>{var k;return(k=y.data)==null?void 0:k.some(b=>b.id===p.id)})||delete this.feedsById[p.id]})}})},resetContext(e){this.feedsByContext[e]={data:[],timestamp:0},this.pagination[e]={page:1,per_page:10,total:0,last_page:1,has_more:!1},this.stickyFeeds[e]=null,this.loading[e]=!1,this.executionTimes[e]="",oe().invalidatePattern(`feeds:${e}`)},startTicker(e="global",t=3e4){this.lastTickerCheck[e]||(this.lastTickerCheck[e]=new Date().toISOString()),this.stopTicker(e),this.tickerEnabled[e]=!0,this.newPostsCount[e]=0,this.tickerIntervals[e]=setInterval(()=>{this.checkForUpdates(e)},t),console.log(`[Feed Store] Ticker started for ${e} (interval: ${t}ms)`),this.checkForUpdates(e)},stopTicker(e){this.tickerIntervals[e]&&(clearInterval(this.tickerIntervals[e]),this.tickerIntervals[e]=null,this.tickerEnabled[e]=!1,console.log(`[Feed Store] Ticker stopped for ${e}`))},stopAllTickers(){Object.keys(this.tickerIntervals).forEach(e=>{this.stopTicker(e)})},async checkForUpdates(e="global"){if(!this.tickerPending[e]){this.tickerPending[e]=!0;try{const t=await this.$api.get("feeds/ticker-updates",{context:e,since:this.lastTickerCheck[e]||new Date().toISOString()});this.lastTickerCheck[e]=t.timestamp,t.has_changes&&t.updates.length>0&&(console.log(`[Feed Store] Ticker found ${t.updates.length} changes for ${e}`),await this.processTickerUpdates(e,t.updates))}catch(t){t.xhr_status!==404&&console.error("[Feed Store] Ticker check failed:",t)}finally{this.tickerPending[e]=!1}}},async processTickerUpdates(e,t){var s;console.log(`[processTickerUpdates] Called for context: ${e} with ${t.length} updates`),console.log("[processTickerUpdates] Updates:",t);const o=[],u=[];if(t.forEach(n=>{console.log("[processTickerUpdates] Processing update:",{id:n.id,action:n.action,updated_at:n.updated_at});const m=this.feedsById[n.id];console.log("[processTickerUpdates] Existing feed in store:",m?{id:m.id,updated_at:m.updated_at}:"NOT IN STORE"),n.action==="deleted"?(console.log(`[processTickerUpdates] ‚û°Ô∏è Marking feed ${n.id} for DELETION`),u.push(n.id)):n.action==="created"?(console.log(`[processTickerUpdates] ‚û°Ô∏è Marking feed ${n.id} for FETCH (CREATED)`),o.push(n.id)):n.action==="updated"&&(!m||new Date(m.updated_at)<new Date(n.updated_at)?(console.log(`[processTickerUpdates] ‚û°Ô∏è Marking feed ${n.id} for FETCH (UPDATED - ${m?"outdated":"not in store"})`),o.push(n.id)):console.log(`[processTickerUpdates] ‚è≠Ô∏è  Skipping feed ${n.id} - already have latest version`))}),console.log("[processTickerUpdates] Summary:",{toFetch:o.length,toDelete:u.length,fetchIds:o,deleteIds:u}),u.length>0&&(console.log(`[processTickerUpdates] üóëÔ∏è  Deleting ${u.length} feeds from ${e}`),this.deleteFeedsFromStore(e,u)),o.length>0){console.log(`[processTickerUpdates] üì• Fetching ${o.length} feeds for ${e}`),await this.fetchFeedsByIds(e,o);const n=t.filter(m=>m.action==="created").length;n>0&&(this.newPostsCount[e]=(this.newPostsCount[e]||0)+n)}(s=window.fluentFrameworkApp)!=null&&s.$eventBus&&window.fluentFrameworkApp.$eventBus.emit("feeds_updated",{context:e,added:o.filter(n=>!this.feedsById[n]).length,updated:o.filter(n=>this.feedsById[n]).length,removed:u.length})},async fetchFeedsByIds(e,t){if(t.length===0)return;console.log("[Feed Store] fetchFeedsByIds called:",{context:e,count:t.length,ids:t});const o=20;try{if(t.length>o){console.log(`[Feed Store] Batching ${t.length} feeds into chunks of ${o}`);for(let u=0;u<t.length;u+=o){const s=t.slice(u,u+o);await this.fetchFeedBatch(e,s)}}else await this.fetchFeedBatch(e,t);console.log(`[Feed Store] Successfully fetched ${t.length} feeds for ${e}`)}catch(u){console.error("[Feed Store] Failed to fetch feeds by IDs:",{context:e,feedIds:t,error:u})}},async fetchFeedBatch(e,t){try{console.log("[Feed Store] Fetching feeds:",{context:e,feedIds:t});const o=await this.$api.post("feeds/batch",{feed_ids:t,context:e});if(console.log("[Feed Store] API response:",o),!o||!Array.isArray(o.feeds)){console.error("[Feed Store] Invalid response from /feeds/batch:",o);return}console.log(`[Feed Store] Received ${o.feeds.length} feeds for context: ${e}`),o.feeds.forEach(u=>{this.feedsById[u.id]=u,this.feedsByContext[e]||(this.feedsByContext[e]={data:[],timestamp:Date.now()});const s=this.feedsByContext[e].data,n=s.findIndex(m=>m.id===u.id);n===-1?s.unshift(u):s[n]=u})}catch(o){throw console.error("[Feed Store] Failed to fetch batch for context:",e,o),o}},deleteFeedsFromStore(e,t){t.forEach(o=>{var s;delete this.feedsById[o],(s=this.feedsByContext[e])!=null&&s.data&&(this.feedsByContext[e].data=this.feedsByContext[e].data.filter(n=>n.id!==o)),oe().invalidate(`feed:${o}`)}),console.log(`[Feed Store] Deleted ${t.length} feeds from ${e}`)},clearNewPostsCount(e){this.newPostsCount[e]=0},clearAll(){this.stopAllTickers(),this.feedsByContext={},this.feedsById={},this.stickyFeeds={},this.loading={},this.pagination={},this.filters={},this.ticker={count:0,lastFetched:0},this.executionTimes={},this._pendingRequests={},this.tickerIntervals={},this.tickerEnabled={},this.lastTickerCheck={},this.tickerPending={},this.newPostsCount={}}}}),je=Ae("space",{state:()=>({spacesBySlug:{},currentSpace:null,mySpaces:[],topicsBySpace:{},loading:{},mySpacesLoading:!1,lastFetched:{}}),getters:{getSpaceBySlug:e=>t=>e.spacesBySlug[t]||null,getCurrentSpace:e=>e.currentSpace,getSpaceTopics:e=>t=>e.topicsBySpace[t]||[],isJoinedSpace:e=>t=>e.mySpaces.some(o=>o.slug===t),getMySpaces:e=>[...e.mySpaces].sort((t,o)=>t.title.localeCompare(o.title)),isLoading:e=>t=>e.loading[t]||!1,joinedSpacesCount:e=>e.mySpaces.length},actions:{async fetchSpace(e,t=!1){const o=oe(),u=`space:${e}`;if(!t){const s=o.get(u);if(s)return this.spacesBySlug[e]=s,this.currentSpace=s,s}this.loading[e]=!0;try{const s=await this.$api.get(`spaces/${e}/by-slug`),n=s.space||s;return this.spacesBySlug[e]=n,this.currentSpace=n,this.lastFetched[e]=Date.now(),s.topics&&(this.topicsBySpace[e]=s.topics),s.pending_count!==void 0&&(n.pending_count=s.pending_count),o.set(u,n,15*60*1e3),typeof window<"u"&&(window.fcom_current_community=n),this.loading[e]=!1,n}catch(s){throw this.loading[e]=!1,console.error("Failed to fetch space:",s),s}},async fetchMySpaces(e=!1){const t=oe(),o="my-spaces";if(!e){const u=t.get(o);if(u)return this.mySpaces=u,u}this.mySpacesLoading=!0;try{const u=await this.$api.get("spaces/my-spaces"),s=u.spaces||u;return this.mySpaces=s,s.forEach(n=>{this.spacesBySlug[n.slug]=n}),t.set(o,s,10*60*1e3),this.mySpacesLoading=!1,s}catch(u){throw this.mySpacesLoading=!1,console.error("Failed to fetch my spaces:",u),u}},async joinSpace(e,t=null){var n,m,p;const o=oe(),u=t||this.spacesBySlug[e];if(!u)throw new Error("Space not found");const s=((n=u.user_status)==null?void 0:n.status)==="active";s||(u.user_status||(u.user_status={}),u.user_status.status="active",u.members_count=(u.members_count||0)+1,this.mySpaces.find(h=>h.slug===e)||this.mySpaces.push(u));try{const h=await this.$api.post(`spaces/${e}/join`),y=h.space||h;this.spacesBySlug[e]=y,((m=this.currentSpace)==null?void 0:m.slug)===e&&(this.currentSpace=y);const k=this.mySpaces.findIndex(b=>b.slug===e);return k!==-1?this.mySpaces[k]=y:this.mySpaces.push(y),o.invalidate(`space:${e}`),o.invalidate("my-spaces"),(p=window.fluentFrameworkApp)!=null&&p.$eventBus&&window.fluentFrameworkApp.$eventBus.emit("space_joined",y),y}catch(h){if(!s){u.user_status.status=null,u.members_count=Math.max(0,(u.members_count||1)-1);const y=this.mySpaces.findIndex(k=>k.slug===e);y!==-1&&this.mySpaces.splice(y,1)}throw console.error("Failed to join space:",h),h}},async leaveSpace(e){var m,p,h,y;const t=oe(),o=this.spacesBySlug[e];if(!o)throw new Error("Space not found");const u=((m=o.user_status)==null?void 0:m.status)==="active",s=(p=o.user_status)==null?void 0:p.status,n=o.members_count;if(u){o.user_status.status=null,o.members_count=Math.max(0,(o.members_count||1)-1);const k=this.mySpaces.findIndex(b=>b.slug===e);k!==-1&&this.mySpaces.splice(k,1)}try{const k=await this.$api.post(`spaces/${e}/leave`),b=k.space||k;return this.spacesBySlug[e]=b,((h=this.currentSpace)==null?void 0:h.slug)===e&&(this.currentSpace=b),t.invalidate(`space:${e}`),t.invalidate("my-spaces"),(y=window.fluentFrameworkApp)!=null&&y.$eventBus&&window.fluentFrameworkApp.$eventBus.emit("space_left",b),b}catch(k){throw u&&(o.user_status.status=s,o.members_count=n,this.mySpaces.push(o)),console.error("Failed to leave space:",k),k}},async fetchSpaceTopics(e,t=!1){const o=oe(),u=`space-topics:${e}`;if(!t){const s=o.get(u);if(s)return this.topicsBySpace[e]=s,s}try{const s=await this.$api.get(`spaces/${e}/topics`),n=s.topics||s;return this.topicsBySpace[e]=n,o.set(u,n,30*60*1e3),n}catch(s){throw console.error("Failed to fetch space topics:",s),s}},setCurrentSpace(e){const t=this.spacesBySlug[e];t&&(this.currentSpace=t,typeof window<"u"&&(window.fcom_current_community=t))},clearCurrentSpace(){this.currentSpace=null,typeof window<"u"&&(window.fcom_current_community=null)},invalidateSpace(e){const t=oe();t.invalidate(`space:${e}`),t.invalidate(`space-topics:${e}`),delete this.lastFetched[e]},clearAll(){this.spacesBySlug={},this.currentSpace=null,this.mySpaces=[],this.topicsBySpace={},this.loading={},this.mySpacesLoading=!1,this.lastFetched={};const e=oe();e.invalidatePattern("space:"),e.invalidatePattern("space-topics:"),e.invalidate("my-spaces")}}}),Gt=Ae("notification",{state:()=>({notifications:[],unreadCount:0,loading:!1,pagination:{page:1,per_page:20,total:0,has_more:!1},pollingInterval:null,pollingEnabled:!1,lastFetched:0}),getters:{getUnreadCount:e=>e.unreadCount,getNotifications:e=>e.notifications,getUnreadNotifications:e=>e.notifications.filter(t=>!t.is_read),isLoading:e=>e.loading,isPollingActive:e=>e.pollingEnabled&&e.pollingInterval!==null},actions:{async fetchNotifications(e=!1){this.loading=!0;const t=e?this.pagination.page+1:1;try{const o=await this.$api.get("notifications",{page:t,per_page:this.pagination.per_page});return e?this.notifications=[...this.notifications,...o.notifications.data]:this.notifications=o.notifications.data,this.pagination={page:t,per_page:this.pagination.per_page,total:o.notifications.total,has_more:o.notifications.has_more},this.unreadCount=o.unread_count||0,this.lastFetched=Date.now(),this.loading=!1,o}catch(o){throw this.loading=!1,console.error("Failed to fetch notifications:",o),o}},async fetchUnreadCount(){try{const e=await this.$api.get("notifications/unread-count");return this.unreadCount=e.count||e.unread_count||0,this.unreadCount}catch(e){return e.xhr_status!==404&&console.error("Failed to fetch unread count:",e),this.unreadCount}},async markAsRead(e){var o;const t=this.notifications.find(u=>u.id===e);t&&!t.is_read&&(t.is_read=!0,this.unreadCount=Math.max(0,this.unreadCount-1));try{await this.$api.post(`notifications/${e}/mark-read`),(o=window.fluentFrameworkApp)!=null&&o.$eventBus&&window.fluentFrameworkApp.$eventBus.emit("notification_read",e)}catch(u){throw t&&(t.is_read=!1,this.unreadCount++),console.error("Failed to mark notification as read:",u),u}},async markFeedNotificationsAsRead(e){var u;const t=this.notifications.filter(s=>s.object_id===e&&!s.is_read),o=this.unreadCount;t.forEach(s=>{s.is_read=!0}),this.unreadCount=Math.max(0,this.unreadCount-t.length);try{await this.$api.post(`notifications/mark-read-by-feed/${e}`),(u=window.fluentFrameworkApp)!=null&&u.$eventBus&&window.fluentFrameworkApp.$eventBus.emit("feed_notifications_read",e)}catch(s){throw t.forEach(n=>{n.is_read=!1}),this.unreadCount=o,console.error("Failed to mark feed notifications as read:",s),s}},async markAllAsRead(){var o;const e=this.unreadCount,t=this.notifications.map(u=>({...u,is_read:u.is_read}));this.notifications.forEach(u=>{u.is_read=!0}),this.unreadCount=0;try{await this.$api.post("notifications/mark-all-read"),(o=window.fluentFrameworkApp)!=null&&o.$eventBus&&window.fluentFrameworkApp.$eventBus.emit("all_notifications_read")}catch(u){throw this.notifications=t,this.unreadCount=e,console.error("Failed to mark all notifications as read:",u),u}},startPolling(e=6e4){this.pollingInterval&&this.stopPolling(),this.pollingEnabled=!0,this.fetchUnreadCount(),this.pollingInterval=setInterval(()=>{this.fetchUnreadCount()},e),console.log(`[Notification Store] Polling started (interval: ${e}ms)`)},stopPolling(){this.pollingInterval&&(clearInterval(this.pollingInterval),this.pollingInterval=null,this.pollingEnabled=!1,console.log("[Notification Store] Polling stopped"))},async deleteNotification(e){const t=this.notifications.findIndex(u=>u.id===e);let o=null;t!==-1&&(o=this.notifications[t],this.notifications.splice(t,1),o.is_read||(this.unreadCount=Math.max(0,this.unreadCount-1)));try{await this.$api.delete(`notifications/${e}`)}catch(u){throw o&&t!==-1&&(this.notifications.splice(t,0,o),o.is_read||this.unreadCount++),console.error("Failed to delete notification:",u),u}},clearAll(){this.notifications=[],this.unreadCount=0,this.loading=!1,this.pagination={page:1,per_page:20,total:0,has_more:!1},this.lastFetched=0,this.stopPolling()}}}),Cs=Ae("ticker",{state:()=>({tickerInterval:null,enabled:!1,lastCheck:null,pending:!1,errorCount:0,minInterval:45e3,maxInterval:75e3,paused:!1,visibilityHandler:null}),getters:{isActive:e=>e.enabled&&e.tickerInterval!==null,isPaused:e=>e.paused},actions:{start(e=45e3,t=75e3,o=5e4){this.tickerInterval&&this.stop(),this.minInterval=e,this.maxInterval=t,this.enabled=!0,this.errorCount=0,this.lastCheck=null,console.log(`[Global Ticker] Started (random interval: ${e}ms - ${t}ms, initial delay: ${o}ms)`),this.setupVisibilityHandler(),console.log(`[Global Ticker] First check scheduled in ${(o/1e3).toFixed(1)} seconds`),setTimeout(()=>{this.enabled&&(this.check(),this.scheduleNextCheck())},o)},scheduleNextCheck(){const e=Math.floor(Math.random()*(this.maxInterval-this.minInterval+1))+this.minInterval;console.log(`[Global Ticker] Next check in ${(e/1e3).toFixed(1)} seconds`),this.tickerInterval=setTimeout(()=>{this.paused||this.check(),this.enabled&&this.scheduleNextCheck()},e)},stop(){this.tickerInterval&&(clearTimeout(this.tickerInterval),this.tickerInterval=null,this.enabled=!1,this.visibilityHandler&&(document.removeEventListener("visibilitychange",this.visibilityHandler),this.visibilityHandler=null),console.log("[Global Ticker] Stopped"))},pause(){this.paused=!0,console.log("[Global Ticker] Paused (tab hidden)")},resume(){this.paused=!1,console.log("[Global Ticker] Resumed (tab visible)"),this.check()},async check(){if(!this.pending){this.pending=!0;try{const e={};this.lastCheck&&(e.since=this.lastCheck),console.log("[Global Ticker] Check params:",e);const t=await this.$api.get("feeds/ticker",e);t&&t.timestamp&&(this.lastCheck=t.timestamp,console.log("[Global Ticker] Updated lastCheck to:",this.lastCheck)),this.errorCount=0,await this.processUpdates(t)}catch(e){this.handleError(e)}finally{this.pending=!1}}},async processUpdates(e){var n;const{feeds:t=[],notifications:o={},spaces:u=[],has_changes:s=!1}=e;if(o&&o.unread_count!==void 0&&this.processNotificationUpdates(o),!!s&&(console.log("[Global Ticker] Processing updates:",{feeds:t.length,notifications:o.unread_count||0,spaces:u.length}),t.length>0&&await this.processFeedUpdates(t),u.length>0&&this.processSpaceUpdates(u),(n=window.fluentFrameworkApp)!=null&&n.$eventBus)){const m={...e,unread_notification_count:o.unread_count||0};window.fluentFrameworkApp.$eventBus.emit("ticker_updated",m)}},async processFeedUpdates(e){console.log("[Ticker Debug] processFeedUpdates called with:",e);const t=Se();e.forEach(o=>{var m;const u=o.context||"global",s=o.id,n=[u];if(o.action!=="deleted"&&(u.startsWith("space-")&&n.push("global"),o.user_id&&n.push(`user-${o.user_id}`)),o.action==="deleted")console.log(`[Global Ticker] Deleting feed ${s} from contexts:`,n),n.forEach(p=>{t.deleteFeedsFromStore(p,[s])});else if(o.feed_data){const p=o.feed_data;console.log(`[Global Ticker] Updating feed ${s} in contexts:`,n),n.forEach(h=>{t.feedsById[p.id]=p,t.feedsByContext[h]||(t.feedsByContext[h]={data:[],timestamp:Date.now()});const y=t.feedsByContext[h].data,k=y.findIndex(b=>b.id===p.id);k===-1?(y.unshift(p),console.log(`[Global Ticker] Added feed ${p.id} to ${h}`),o.action==="created"&&(t.newPostsCount[h]=(t.newPostsCount[h]||0)+1)):(y[k]=p,console.log(`[Global Ticker] Updated feed ${p.id} in ${h}`))}),(m=window.fluentFrameworkApp)!=null&&m.$eventBus&&n.forEach(h=>{window.fluentFrameworkApp.$eventBus.emit("feeds_updated",{context:h,added:o.action==="created"?1:0,updated:o.action==="updated"?1:0,removed:0})})}else console.warn(`[Global Ticker] Feed ${s} has no feed_data, skipping update`)})},processNotificationUpdates(e){const t=Gt();e.unread_count!==void 0&&(t.unreadCount=e.unread_count),e.new_count>0&&console.log("[Global Ticker] New notifications:",e.new_count)},processSpaceUpdates(e){console.log("[Global Ticker] Space updates:",e.length)},handleError(e){e.xhr_status!==404&&console.error("[Global Ticker] Check failed:",e),this.errorCount++;const t=Math.min(6e4,1e3*Math.pow(2,this.errorCount));console.warn(`[Global Ticker] Backing off for ${t}ms`),setTimeout(()=>{this.enabled&&!this.paused&&this.check()},t)},setupVisibilityHandler(){typeof document.hidden<"u"&&(this.visibilityHandler&&document.removeEventListener("visibilitychange",this.visibilityHandler),this.visibilityHandler=()=>{document.hidden?this.pause():this.resume()},document.addEventListener("visibilitychange",this.visibilityHandler))}}}),Yi={name:"ChatIcon"},Zi={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Wi=l("path",{d:"M6.66732 11.25H13.334M6.66732 7.08333H10.0007",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Ji=l("path",{d:"M5.08267 15.833C3.99924 15.7264 3.18762 15.401 2.6433 14.8567C1.66699 13.8804 1.66699 12.309 1.66699 9.16634V8.74967C1.66699 5.60698 1.66699 4.03563 2.6433 3.05932C3.61961 2.08301 5.19096 2.08301 8.33366 2.08301H11.667C14.8097 2.08301 16.381 2.08301 17.3573 3.05932C18.3337 4.03563 18.3337 5.60698 18.3337 8.74967V9.16634C18.3337 12.309 18.3337 13.8804 17.3573 14.8567C16.381 15.833 14.8097 15.833 11.667 15.833C11.1999 15.8434 10.8279 15.879 10.4625 15.9622C9.46385 16.1921 8.5391 16.7031 7.62522 17.1487C6.32307 17.7837 5.67199 18.1012 5.2634 17.8039C4.48174 17.2218 5.24577 15.4179 5.41699 14.583",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round"},null,-1),Qi=[Wi,Ji];function Ki(e,t,o,u,s,n){return i(),c("svg",Zi,Qi)}const ze=F(Yi,[["render",Ki]]),Xi={name:"HeartIcon",props:{filled:{default:!1}}},en={key:0,viewBox:"0 0 24 24","aria-hidden":"true"},tn=l("g",null,[l("path",{d:"M20.884 13.19c-1.351 2.48-4.001 5.12-8.379 7.67l-.503.3-.504-.3c-4.379-2.55-7.029-5.19-8.382-7.67-1.36-2.5-1.41-4.86-.514-6.67.887-1.79 2.647-2.91 4.601-3.01 1.651-.09 3.368.56 4.798 2.01 1.429-1.45 3.146-2.1 4.796-2.01 1.954.1 3.714 1.22 4.601 3.01.896 1.81.846 4.17-.514 6.67z"})],-1),sn=[tn],on={key:1,viewBox:"0 0 24 24","aria-hidden":"true"},nn=l("g",null,[l("path",{d:"M16.697 5.5c-1.222-.06-2.679.51-3.89 2.16l-.805 1.09-.806-1.09C9.984 6.01 8.526 5.44 7.304 5.5c-1.243.07-2.349.78-2.91 1.91-.552 1.12-.633 2.78.479 4.82 1.074 1.97 3.257 4.27 7.129 6.61 3.87-2.34 6.052-4.64 7.126-6.61 1.111-2.04 1.03-3.7.477-4.82-.561-1.13-1.666-1.84-2.908-1.91zm4.187 7.69c-1.351 2.48-4.001 5.12-8.379 7.67l-.503.3-.504-.3c-4.379-2.55-7.029-5.19-8.382-7.67-1.36-2.5-1.41-4.86-.514-6.67.887-1.79 2.647-2.91 4.601-3.01 1.651-.09 3.368.56 4.798 2.01 1.429-1.45 3.146-2.1 4.796-2.01 1.954.1 3.714 1.22 4.601 3.01.896 1.81.846 4.17-.514 6.67z"})],-1),ln=[nn];function an(e,t,o,u,s,n){return o.filled?(i(),c("svg",en,sn)):(i(),c("svg",on,ln))}const qe=F(Xi,[["render",an]]),rn={name:"NotificationsBlock",emits:["close"],components:{ChatIcon:ze,HeartIcon:qe},props:["notifications"],methods:{markRead(e,t){e.subscriber&&!e.subscriber.is_read||(this.notifications.splice(t,1),this.$post("notifications/mark-read/"+e.id).then(o=>{this.$eventBus.emit("notification-read",o.unread_count)}))},getNotificationRoute(e){const{route:t,action:o,object_id:u,feed_id:s}=e;return{...t,query:{comment_added:{comment_id:u},comment_report_added:{comment_id:s}}[o]||{}}}}},cn={class:"notification_avatar"},dn={class:"fcom_notification_type"},un=l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"20",height:"20",color:"currentColor",fill:"none"},[l("path",{d:"M12.9915 20.5C13.7121 20.5 13.9925 20.4956 13.9925 20.4956C17.4088 20.471 19.2922 20.3099 20.5342 19.2552C22 18.0104 22 16.0069 22 12C22 7.99306 22 5.98959 20.5342 4.7448C19.0683 3.5 16.7091 3.5 11.9906 3.5C7.27213 3.5 4.91289 3.5 3.44705 4.7448C2.32426 5.69827 2.0615 7.09687 2 9.5",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),l("path",{d:"M2.98242 19.5H2.9914",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),l("path",{d:"M2 15.7349C4.49328 15.7349 6.77053 18 6.77053 20.4996M10 20.4996C10 16 5.99511 12.5 2.04522 12.5",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round"})],-1),_n={class:"notification_content"},mn=["innerHTML"],hn=["title"];function fn(e,t,o,u,s,n){const m=g("UserAvatar"),p=g("ChatIcon"),h=O,y=g("HeartIcon"),k=g("router-link");return i(!0),c(V,null,D(o.notifications,(b,$)=>{var f;return i(),c("div",{class:R(["notification_wrap",{notification_wrap_unread:((f=b==null?void 0:b.subscriber)==null?void 0:f.is_read)=="0"}])},[a(k,{onClick:w=>n.markRead(b,$),to:n.getNotificationRoute(b),class:"notification_item"},{default:r(()=>[l("div",cn,[a(m,{with_level:!1,xprofile:b.xprofile},null,8,["xprofile"]),l("div",dn,[b.action=="comment_added"||b.action=="child_comment_added"?(i(),v(h,{key:0,class:"fcom_nt_comment"},{default:r(()=>[a(p)]),_:1})):b.action=="feed/react_added"?(i(),v(h,{key:1,class:"fcom_nt_heart"},{default:r(()=>[a(y,{filled:!0})]),_:1})):b.action=="feed/mentioned"||b.action=="mention_added"?(i(),v(h,{key:2,class:"fcom_nt_mention"},{default:r(()=>[a(p)]),_:1})):b.action=="space_feed/created"?(i(),v(h,{key:3,class:"fcom_new_post"},{default:r(()=>[un]),_:1})):_("",!0)])]),l("div",_n,[l("div",{innerHTML:b.content},null,8,mn),l("span",{title:b.updated_at,class:"notification_time_stamp"},d(e.humanDateDiff(b.updated_at)),9,hn)])]),_:2},1032,["onClick","to"])],2)}),256)}const $s=F(rn,[["render",fn]]),pn={name:"NotificationIcon"},gn={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},yn=l("path",{d:"M2.10794 11.9954C1.93073 13.1229 2.72301 13.9055 3.69305 14.2955C7.41201 15.7908 12.5873 15.7908 16.3063 14.2955C17.2763 13.9055 18.0686 13.1229 17.8914 11.9954C17.7825 11.3024 17.244 10.7254 16.845 10.162C16.3224 9.41493 16.2705 8.60009 16.2704 7.73317C16.2704 4.38291 13.4629 1.66699 9.99968 1.66699C6.53645 1.66699 3.72895 4.38291 3.72895 7.73317C3.72887 8.60009 3.67694 9.41493 3.15435 10.162C2.75537 10.7254 2.21685 11.3024 2.10794 11.9954Z",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),vn=l("path",{d:"M7.5 17.5C8.16345 18.0182 9.03956 18.3333 10 18.3333C10.9604 18.3333 11.8366 18.0182 12.5 17.5",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),bn=[yn,vn];function kn(e,t,o,u,s,n){return i(),c("svg",gn,bn)}const wn=F(pn,[["render",kn]]),Cn={name:"Notifications",components:{NotificationsBlock:$s,NotificationIcon:wn},data(){return{unread_notifications:[],unread_count:parseInt(this.appVars.unread_notification_count),loading:!1,working:!1,visible:!1,notification_type:"all"}},methods:{switchType(e){this.notification_type=e,this.fetchUnread()},toggleNotifications(){this.loading=!0,this.visible=!this.visible,this.visible?this.fetchUnread():this.loading=!1},handleClose(){this.$refs.notification_pop.hide(),this.visible=!1},fetchUnread(){this.loading=!0,this.$get("notifications/unread",{notification_type:this.notification_type}).then(e=>{this.unread_notifications=e.notifications,this.appVars.unread_notification_count=e.unread_count,this.unread_count=e.unread_count}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})},markAllRead(){this.working=!0,this.$post("notifications/mark-all-read").then(e=>{this.$notify.success(e.message),this.fetchUnread()}).catch(e=>{this.$handleError(e)}).finally(()=>{this.working=!1})},keyBind(e){e.code==="KeyN"&&e.altKey&&this.$refs.notification_icon.click()}},mounted(){document.addEventListener("keydown",this.keyBind),this.$eventBus.on("ticker_updated",e=>{this.appVars.unread_notification_count=e.unread_notification_count,this.unread_count=e.unread_notification_count}),this.$eventBus.on("notification_count_updated",e=>{this.appVars.unread_notification_count=e,this.unread_count=e}),this.$eventBus.on("feed_interaction",e=>{e=e+"",this.appVars.unread_feed_ids&&this.appVars.unread_feed_ids.indexOf(e)!==-1&&this.$post("notifications/mark-read/"+e+"/by-feed-id").then(t=>{this.unread_count=t.unread_notification_count,this.appVars.unread_feed_ids=t.unread_feed_ids})})},beforeUnmount(){document.removeEventListener("keydown",this.keyBind)}},$n={class:"fcom_menu_button",ref:"notification_icon"},Sn={class:"notifications_wrap unread_notifications"},Vn={class:"norification_pop_header"},Ln={class:"fcom_filter_menu"},Mn={class:"fcom_filter_menu_ul"},Pn={key:2,class:"fcom_no_unread_notifications"};function Fn(e,t,o,u,s,n){const m=g("NotificationIcon"),p=O,h=hi,y=j,k=q,b=g("notifications-block"),$=g("router-link"),f=de,w=K("loading");return i(),v(f,{popperClass:"notification_pop",onBeforeEnter:t[6]||(t[6]=C=>n.toggleNotifications()),ref:"notification_pop",trigger:"click",placement:"bottom",width:500},{reference:r(()=>[a(h,{max:20,hidden:!s.unread_count,value:s.unread_count,class:"item"},{default:r(()=>[l("button",$n,[a(p,null,{default:r(()=>[a(m)]),_:1})],512)]),_:1},8,["hidden","value"])]),default:r(()=>[l("div",Sn,[l("div",Vn,[l("h3",null,d(e.$t("Unread Notifications")),1),l("div",null,[N((i(),v(y,{disabled:s.working,size:"small",onClick:t[0]||(t[0]=C=>n.markAllRead())},{default:r(()=>[S(d(e.$t("Mark all as read")),1)]),_:1},8,["disabled"])),[[w,s.working]])])]),l("div",Ln,[l("ul",Mn,[l("li",null,[l("a",{onClick:t[1]||(t[1]=Z(C=>n.switchType("all"),["prevent"])),class:R({"router-link-exact-active":s.notification_type=="all"}),href:"#"},d(e.$t("All")),3)]),l("li",null,[l("a",{onClick:t[2]||(t[2]=Z(C=>n.switchType("mentioned"),["prevent"])),class:R({"router-link-exact-active":s.notification_type=="mentioned"}),href:"#"},d(e.$t("Mentions")),3)]),l("li",null,[l("a",{onClick:t[3]||(t[3]=Z(C=>n.switchType("following"),["prevent"])),class:R({"router-link-exact-active":s.notification_type=="following"}),href:"#"},d(e.$t("Following")),3)])])]),s.loading?(i(),v(k,{key:0,style:{"margin-top":"15px"},animated:!0,rows:2})):s.unread_notifications.length?(i(),c("div",{key:1,onClick:t[5]||(t[5]=C=>e.$refs.notification_pop.hide()),class:"notifications"},[a(b,{onClose:t[4]||(t[4]=C=>n.handleClose()),notifications:s.unread_notifications},null,8,["notifications"])])):(i(),c("div",Pn,[l("p",null,d(e.$t("No unread notifications found")),1)])),a($,{class:"fcom_view_all_notifications",to:{name:"notifications"},onClick:n.handleClose},{default:r(()=>[a(y,{class:"fcom_secondary_button"},{default:r(()=>[S(d(e.$t("View All")),1)]),_:1})]),_:1},8,["onClick"])])]),_:1},512)}const Tn=F(Cn,[["render",Fn]]),In={name:"ImageUploader",emits:["uploaded","completed","uploading"],data(){return{loading:!1}},props:{button_text:{type:String,default:""},additionalData:{type:Object,default:()=>({})},isMultiple:{type:Boolean,default:!1},can_remove:{type:Boolean,default:!1},isTextBtn:{type:Boolean,default:!0},removeIcon:{type:Boolean,default:!0},className:{type:String,default:"image-uploader"}},methods:{handleSuccess(e){this.$emit("uploaded",e.media.url),this.$emit("completed",e),this.loading=!1},handleError(e){this.$handleError(JSON.parse(e.message)),this.$emit("completed",e),this.loading=!1},inProgress(e){this.$emit("uploading"),this.loading=!0}},computed:{action_url(){return this.appVars.rest.url+"/feeds/media-upload"},headers(){return{"X-WP-Nonce":this.appVars.rest.nonce}}}};function Un(e,t,o,u,s,n){const m=j,p=vt,h=g("CloseBold"),y=O,k=K("loading");return i(),c(V,null,[a(p,{class:R(o.className),multiple:o.isMultiple,action:n.action_url,headers:n.headers,accept:"image/*",data:o.additionalData,"on-success":n.handleSuccess,"on-progress":n.inProgress,"on-error":n.handleError,"show-file-list":!1},{default:r(()=>[z(e.$slots,"trigger",{},()=>[z(e.$slots,"default",{},()=>[N((i(),v(m,{disabled:s.loading,text:o.isTextBtn,class:"fcom_plain_button"},{default:r(()=>[S(d(o.button_text||e.$t("Upload Photo")),1)]),_:1},8,["disabled","text"])),[[k,s.loading]])])])]),_:3},8,["class","multiple","action","headers","data","on-success","on-progress","on-error"]),o.can_remove?(i(),v(m,{key:0,class:"remove_img",size:"small",type:"danger",plain:"",onClick:t[0]||(t[0]=b=>e.$emit("uploaded","")),text:o.isTextBtn},{default:r(()=>[z(e.$slots,"remove",{},()=>[o.removeIcon?(i(),v(y,{key:0},{default:r(()=>[a(h)]),_:1})):_("",!0),l("span",null,d(e.$t("Remove")),1)])]),_:3},8,["text"])):_("",!0)],64)}const Re=F(In,[["render",Un]]),Bn={name:"ImageIcon"},En={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},An=l("path",{d:"M7.49996 18.3327H12.5C16.6666 18.3327 18.3333 16.666 18.3333 12.4993V7.49935C18.3333 3.33268 16.6666 1.66602 12.5 1.66602H7.49996C3.33329 1.66602 1.66663 3.33268 1.66663 7.49935V12.4993C1.66663 16.666 3.33329 18.3327 7.49996 18.3327Z",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Dn=l("path",{d:"M7.50004 8.33333C8.42052 8.33333 9.16671 7.58714 9.16671 6.66667C9.16671 5.74619 8.42052 5 7.50004 5C6.57957 5 5.83337 5.74619 5.83337 6.66667C5.83337 7.58714 6.57957 8.33333 7.50004 8.33333Z",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Rn=l("path",{d:"M2.22498 15.7918L6.33331 13.0335C6.99164 12.5918 7.94164 12.6418 8.53331 13.1501L8.80831 13.3918C9.45831 13.9501 10.5083 13.9501 11.1583 13.3918L14.625 10.4168C15.275 9.85846 16.325 9.85846 16.975 10.4168L18.3333 11.5835",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Hn=[An,Dn,Rn];function xn(e,t,o,u,s,n){return i(),c("svg",En,Hn)}const Yt=F(Bn,[["render",xn]]),jn={name:"PollIcon"},On={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},Nn=l("path",{d:"M1.66663 18.334H18.3333",stroke:"currentColor","stroke-width":"1.5","stroke-miterlimit":"10","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),zn=l("path",{d:"M8.125 3.33268V18.3327H11.875V3.33268C11.875 2.41602 11.5 1.66602 10.375 1.66602H9.625C8.5 1.66602 8.125 2.41602 8.125 3.33268Z",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),qn=l("path",{d:"M2.5 8.33268V18.3327H5.83333V8.33268C5.83333 7.41602 5.5 6.66602 4.5 6.66602H3.83333C2.83333 6.66602 2.5 7.41602 2.5 8.33268Z",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Gn=l("path",{d:"M14.1666 12.5007V18.334H17.5V12.5007C17.5 11.584 17.1666 10.834 16.1666 10.834H15.5C14.5 10.834 14.1666 11.584 14.1666 12.5007Z",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Yn=[Nn,zn,qn,Gn];function Zn(e,t,o,u,s,n){return i(),c("svg",On,Yn)}const Wn=F(jn,[["render",Zn]]),Jn={name:"SurveyEditForm",props:{form:{type:Object,required:!0},is_editing:{type:Boolean,default:!1}},emits:["cancel"],data(){return{}},methods:{addOption(){this.form.options.push({label:"",slug:""})},removeOption(e){this.form.options.splice(e,1)}}},Qn={class:"fcom_compose_app_form"},Kn={class:"fcom_app_header"},Xn={class:"fcom_app_options"},el={class:"fcom_app_pref"},tl={class:"fcom_app_footer"},sl=l("br",null,null,-1),ol={style:{"font-weight":"500",color:"var(--el-text-color-regular)","font-size":"14px"}};function il(e,t,o,u,s,n){const m=j,p=ee,h=g("Plus"),y=O,k=he,b=Xe;return i(),c("div",Qn,[l("div",Kn,[l("h5",null,d(e.$t("Poll Options")),1),l("div",null,[a(m,{onClick:t[0]||(t[0]=$=>e.$emit("cancel")),size:"small",text:""},{default:r(()=>[S(d(e.$t("cancel")),1)]),_:1})])]),l("div",Xn,[(i(!0),c(V,null,D(o.form.options,($,f)=>(i(),c("div",{class:"fcom_app_option",key:"option_"+f},[a(p,{modelValue:$.label,"onUpdate:modelValue":w=>$.label=w,type:"text",placeholder:e.$t("Your option text")},pe({_:2},[!$.slug&&f!==0?{name:"suffix",fn:r(()=>[a(m,{onClick:w=>n.removeOption(f),text:"",size:"small"},{default:r(()=>[S("x")]),_:2},1032,["onClick"])]),key:"0"}:void 0]),1032,["modelValue","onUpdate:modelValue","placeholder"])]))),128)),l("div",el,[a(m,{onClick:n.addOption,text:"",size:"small"},{default:r(()=>[a(y,null,{default:r(()=>[a(h)]),_:1}),l("span",null,d(e.$t("Add More")),1)]),_:1},8,["onClick"])])]),l("div",tl,[l("h5",null,d(e.$t("Poll Settings")),1),o.is_editing?_("",!0):(i(),v(k,{key:0,modelValue:o.form.type,"onUpdate:modelValue":t[1]||(t[1]=$=>o.form.type=$),"true-value":"multi_choice","false-value":"single_choice",class:"fcom_checkbox"},{default:r(()=>[S(d(e.$t("Users can choose multiple options")),1)]),_:1},8,["modelValue"])),sl,l("label",ol,d(e.$t("End Date:")),1),l("div",null,[a(b,{style:{"min-width":"50%"},placeholder:e.$t("Leave blank for not end"),clearable:!0,type:"datetime",modelValue:o.form.end_date,"onUpdate:modelValue":t[2]||(t[2]=$=>o.form.end_date=$),"value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["placeholder","modelValue"])])])])}const nl=F(Jn,[["render",il]]),ll={name:"GiphyIcon"},al={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},rl=Ie('<path d="M12.9287 10.09H14.7095" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"></path><path d="M15.0781 8.20333H12.9277V11.98" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"></path><path d="M10.3458 8.19998V11.98" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"></path><path d="M7.74961 8.2H6.48961C5.44549 8.2 4.59961 9.04588 4.59961 10.09V10.09C4.59961 11.1341 5.44549 11.98 6.48961 11.98H7.74961V10.09H6.69961" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"></path><path d="M4.5 19C2.567 19 1 17.433 1 15.5L1 4.49999C1 2.567 2.567 0.999992 4.5 0.999992H15.5C17.433 0.999992 19 2.567 19 4.49999V15.5C19 17.433 17.433 19 15.5 19H4.5Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>',5),cl=[rl];function dl(e,t,o,u,s,n){return i(),c("svg",al,cl)}const ul=F(ll,[["render",dl]]),_l={name:"Giphy",components:{GiphyIcon:ul},data(){return{gifs:[],searchQuery:"",offset:0,limit:20,loading:!1}},methods:{loadGifs(){var t,o;if(((o=(t=this.$gloablStorage)==null?void 0:t.gifs)==null?void 0:o.length)>0&&!this.searchQuery){this.gifs=this.$gloablStorage.gifs;return}this.loading=!0;const e={limit:this.limit,offset:this.offset,q:this.searchQuery.trim()};this.$get("giphy",e).then(u=>{this.gifs=this.offset===0?u.gifs:this.gifs.concat(u.gifs),!this.searchQuery&&this.offset===0&&(this.$gloablStorage.gifs=this.gifs),this.offset+=this.limit}).catch(u=>{this.$handleError(u)}).finally(()=>{this.loading=!1})},handleGiphyClick(){this.offset=0,this.searchQuery="",this.loadGifs()},handleSearch:Si(function(){this.offset=0,this.loadGifs()},300),handleScroll(e){e.target.scrollHeight-e.target.scrollTop===e.target.clientHeight&&!this.loading&&this.loadGifs()},selectGiphy(e){this.$emit("selected-giphy",e),this.$refs.popover.hide()}}},ml={class:"fcom_giphy_composer"},hl={class:"search-container"},fl=["onLoad","src","alt","onClick"],pl={key:0,class:"img_loading"},gl={key:1,class:"no_result"},yl=l("div",{class:"fcom_giphy_powered_by"},[l("span",{class:"powered_by"},"POWERED BY "),l("span",null,"GIPHY")],-1);function vl(e,t,o,u,s,n){const m=ee,p=et,h=tt,y=g("GiphyIcon"),k=O,b=j,$=de,f=K("loading");return i(),c("div",ml,[a($,{placement:"bottom-end",width:300,persistent:!1,trigger:"click","popper-class":"fcom_giphy_popover",ref:"popover"},{reference:r(()=>[a(b,{"aria-label":"Pick GIF",text:"",onClick:n.handleGiphyClick},{default:r(()=>[a(k,{class:R(["fcom_apps_icon"])},{default:r(()=>[a(y)]),_:1})]),_:1},8,["onClick"])]),default:r(()=>[N((i(),c("div",hl,[a(m,{modelValue:s.searchQuery,"onUpdate:modelValue":t[0]||(t[0]=w=>s.searchQuery=w),placeholder:e.$t("Search Gifs"),onInput:n.handleSearch},null,8,["modelValue","placeholder","onInput"]),l("div",{class:"gif_container",onScroll:t[1]||(t[1]=(...w)=>n.handleScroll&&n.handleScroll(...w))},[s.gifs.length>0?(i(),v(h,{key:0,gutter:5},{default:r(()=>[(i(!0),c(V,null,D(s.gifs,w=>(i(),v(p,{span:12,key:w.id,class:"gif_item"},{default:r(()=>[l("img",{alt:"",onLoad:C=>w.loaded=!0,src:w.images.preview_gif.url,onClick:C=>n.selectGiphy(w)},null,40,fl),w.loaded?_("",!0):(i(),c("p",pl))]),_:2},1024))),128))]),_:1})):(i(),c("p",gl,d(e.$t("No results")),1))],32),yl])),[[f,s.loading]])]),_:1},512)])}const bl=F(_l,[["render",vl]]),kl={name:"VideoIcon"},wl={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},Cl=l("rect",{x:"1",y:"1",width:"18",height:"18",rx:"3.5",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),$l=l("path",{d:"M8.90484 7.14604L12.663 9.3589C13.1383 9.6384 13.1383 10.3237 12.663 10.6032L8.90484 12.816C8.4208 13.1013 7.80896 12.7534 7.80896 12.1934V7.76865C7.80896 7.20869 8.4208 6.86076 8.90484 7.14604Z",fill:"currentColor"},null,-1),Sl=[Cl,$l];function Vl(e,t,o,u,s,n){return i(),c("svg",wl,Sl)}const Ll=F(kl,[["render",Vl]]);const Ml={name:"FluentPlayerPreview",props:{media:{type:Object,required:!0}},data(){return{html:"",loading:!1}},watch:{"media.url"(){this.loadFluentPlayerContent()}},async mounted(){await this.loadFluentPlayerContent()},methods:{async loadFluentPlayerContent(){this.loading=!0;try{if(!this.appVars.features.has_fluent_player||this.appVars.features.enable_fluent_player!=="yes")return;let e=this.media.media_id;e||(e=new Date().getTime());const t=await this.$get("fluent-player/video-content/"+e,{...this.media,media_id:e});t.html&&(this.html=t.html,this.$nextTick(()=>{const o=this.$el.querySelector(".fluent-player");document.dispatchEvent(new CustomEvent("InitSingleFluentPlayer",{detail:{container:o,playerData:{media:t.media}}}))}))}catch(e){console.warn("Failed to load fluent-player assets:",e)}finally{this.loading=!1}}}},Pl={class:"fluent-player-preview"},Fl={key:0,class:"player-container"},Tl=["innerHTML"];function Il(e,t,o,u,s,n){const m=q;return i(),c("div",Pl,[s.html?(i(),c("div",Fl,[l("div",{innerHTML:s.html},null,8,Tl)])):_("",!0),s.loading?(i(),v(m,{key:1,animated:"",rows:5})):_("",!0)])}const Ul=F(Ml,[["render",Il],["__scopeId","data-v-1e10ea88"]]);const Bl={name:"MediaPreview",components:{Postcard:go,FluentPlayerPreview:Ul},props:["feed","media_item","is_single"],data(){return{is_error:!1,isPlaying:!1}},computed:{media(){var e;return this.feed?(e=this.feed.meta)==null?void 0:e.media_preview:this.media_item},isVideoMedia(){return["oembed","iframe_html","video"].includes(this.media.type)},hasFluentPlayer(){var e;return this.appVars.features.has_fluent_player&&((e=this.appVars.features.fluent_player)==null?void 0:e.enable)},playEmbeddedVideos(){var e;return(e=this.appVars.features.fluent_player)==null?void 0:e.play_embedded_videos}},methods:{getDomainName(e){return e?e.split("/")[2].replace("www.",""):""},isSupportedByFluentPlayer(){const e=this.media.url;return!e||!this.playEmbeddedVideos&&this.media.provider!=="upload"?!1:[{name:"youtube",regex:/^(https?:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/.+$/},{name:"vimeo",regex:/^(https?:\/\/)?(www\.)?vimeo\.com\/\d+$/},{name:"file",regex:/\.(mp4|m3u8|mpd|webm|mov)(\?.*)?$/i}].some(o=>o.regex.test(e))},getAspectRatio(e,t){if(e&&t){let o=e/t;return o<1?16/9:o}return 16/9},handleImageError(){this.is_error=!0},getVideoType(e){const t={mp4:"video/mp4",webm:"video/webm",ogg:"video/ogg",ogv:"video/ogg"},o=e.split(".").pop().toLowerCase();return t[o]||"video/mp4"},playVideo(){this.$refs.nativeVideo&&this.$refs.nativeVideo.play()},onVideoPause(){this.$refs.nativeVideo&&this.$refs.nativeVideo.currentTime>0&&(this.isPlaying=!0)}}},Ss=e=>(ht("data-v-359b1e49"),e=e(),ft(),e),El={key:0},Al={key:1},Dl=["innerHTML"],Rl=["controls","preload","poster"],Hl=["src","type"],xl=Ss(()=>l("div",{class:"native_play_button"},[l("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M8 5v14l11-7z"})])],-1)),jl=[xl],Ol=["href"],Nl={key:0,class:"feed_media_image"},zl=Ss(()=>l("span",null,null,-1)),ql={key:1,class:"feed_media_content"},Gl={class:"media_domain"},Yl={class:"feed_media_title"},Zl={key:0,class:"feed_media_description"},Wl={class:"feed_meta_desc"};function Jl(e,t,o,u,s,n){const m=g("fluent-player-preview"),p=q,h=Pe;return i(),c("div",{class:R(["feed_media","feed_media_"+n.media.type])},[n.isVideoMedia?(i(),c(V,{key:0},[n.hasFluentPlayer&&n.isSupportedByFluentPlayer()?(i(),c("div",El,[a(m,{media:n.media},null,8,["media"])])):n.media.html?(i(),c("div",Al,[l("div",{class:"feed_media_ext_video",innerHTML:n.media.html},null,8,Dl)])):n.media.url?(i(),c("div",{key:2,class:R(["native_video_wrapper",{video_playing:s.isPlaying}])},[l("video",{ref:"nativeVideo",class:"native_video_player",controls:s.isPlaying,preload:o.is_single?"metadata":"none",poster:n.media.thumbnail,onPlay:t[0]||(t[0]=y=>s.isPlaying=!0),onPause:t[1]||(t[1]=(...y)=>n.onVideoPause&&n.onVideoPause(...y)),onEnded:t[2]||(t[2]=y=>s.isPlaying=!1)},[l("source",{src:n.media.url,type:n.getVideoType(n.media.url)},null,8,Hl)],40,Rl),s.isPlaying?_("",!0):(i(),c("div",{key:0,class:"native_video_overlay",onClick:t[3]||(t[3]=(...y)=>n.playVideo&&n.playVideo(...y))},jl))],2)):_("",!0)],64)):n.media.type=="image"||n.media.is_uploaded?(i(),c("div",{key:1,class:R(["feed_media_provider_"+n.media.provider,"feed_media_image feed_custom_uploaded"])},[n.media.image&&!s.is_error?(i(),v(h,{key:0,alt:"",style:re({width:"100%",aspectRatio:n.getAspectRatio(n.media.width,n.media.height)}),src:n.media.image,lazy:!0,previewSrcList:[n.media.image],loading:"lazy",onError:n.handleImageError,"zoom-rate":1.2,"max-scale":7,"hide-on-click-modal":!0,"preview-teleported":!0,"min-scale":.2,"initial-index":1,class:R("fcom_media_provider_"+n.media.provider),fit:"scale-down"},{placeholder:r(()=>[a(p,{animated:!0})]),_:1},8,["style","src","previewSrcList","onError","class"])):_("",!0)],2)):(i(),c("a",{key:2,href:n.media.url,target:"_blank",rel:"noopener",class:"feed_media_link"},[n.media.image&&!s.is_error?(i(),c("div",Nl,[a(h,{onError:t[4]||(t[4]=y=>n.handleImageError()),style:{width:"100%"},src:n.media.image},{error:r(()=>[zl]),_:1},8,["src"])])):_("",!0),n.media.title?(i(),c("div",ql,[l("div",Gl,d(n.getDomainName(n.media.url)),1),l("div",Yl,d(e.getExcerpt(n.media.title,88)),1),n.media.description?(i(),c("div",Zl,[l("div",Wl,d(e.getExcerpt(n.media.description,160)),1)])):_("",!0)])):_("",!0)],8,Ol))],2)}const Be=F(Bl,[["render",Jl],["__scopeId","data-v-359b1e49"]]);const Ql=[{name:"youtube",regex:/^(https?:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/.+$/},{name:"vimeo",regex:/^(https?:\/\/)?(www\.)?vimeo\.com\/\d+$/},{name:"file",regex:/\.(mp4|m3u8|mpd|webm|mov)(\?.*)?$/i}],Kl={name:"FluentPlayerUploader",components:{UploadFilled:gt},emits:["video-added","completed","uploading"],props:{className:{type:String,default:"video-uploader"},type:{type:String,default:"url"}},data(){return{videoUrl:"",processing:!1}},computed:{uploadData(){return{context:"fluent_player"}},action_url(){return this.appVars.rest.url+"/fluent-player/video-upload"},headers(){return{"X-WP-Nonce":this.appVars.rest.nonce}}},methods:{async handleUrlSubmit(){if(!this.videoUrl)return;const e=Ql.some(o=>o.regex.test(this.videoUrl));let t={};e?t={type:"oembed",url:this.videoUrl,html:"",content_type:"video",player:"fluent_player",media_id:new Date().getTime()}:t={type:"oembed",url:this.videoUrl,html:"",content_type:"video"},this.$emit("video-added",t)},handleVideoUploadSuccess(e){var t;try{if(!e||!e.media||!e.media.url)throw new Error("Invalid response: missing media.url");const{media:o}=e,u={type:"upload",url:o.url,player:"fluent_player",provider:"upload",content_type:"video",html:"",title:((t=o.settings)==null?void 0:t.title)||"",media_id:o.media_id};this.$emit("video-added",u)}catch(o){console.error("[FluentPlayerUploader] handleVideoUploadSuccess error:",o,e)}finally{this.$emit("completed",e),this.processing=!1}},handleError(e){try{const t=(e==null?void 0:e.message)||e;this.$handleError(t)}catch(t){console.error("[FluentPlayerUploader] handleError failed:",t,e)}finally{this.$emit("completed",e),this.processing=!1}},inProgress(e){this.$emit("uploading"),this.processing=!0}}},Xl=["element-loading-text"],ea={key:0,class:"upload-options"},ta={class:"uploader-content"},sa=l("div",{class:"el-upload__text"},[S(" Drop file here or "),l("em",null,"upload by clicking")],-1),oa={key:1,class:"url-input-section"};function ia(e,t,o,u,s,n){const m=g("upload-filled"),p=O,h=j,y=vt,k=ee,b=K("loading");return N((i(),c("div",{class:"fluent-player-uploader","element-loading-text":e.$t("Uploading video..."),"element-loading-background":"rgba(255, 255, 255, 0.85)"},[o.type==="upload"?(i(),c("div",ea,[a(y,{drag:"",class:R([o.className,"video-drag-uploader"]),multiple:!1,action:n.action_url,headers:n.headers,accept:"video/*",data:n.uploadData,"on-success":n.handleVideoUploadSuccess,"on-progress":n.inProgress,"on-error":n.handleError,"show-file-list":!1,disabled:s.processing},{default:r(()=>[l("div",ta,[a(p,{class:"el-icon--upload"},{default:r(()=>[a(m)]),_:1}),sa,a(h,{type:"primary",class:"upload-button",loading:s.processing,disabled:s.processing},{default:r(()=>[z(e.$slots,"trigger",{},()=>[z(e.$slots,"default",{},()=>[S(d(s.processing?e.$t("Uploading..."):e.$t("Upload Video")),1)])])]),_:3},8,["loading","disabled"])])]),_:3},8,["class","action","headers","data","on-success","on-progress","on-error","disabled"])])):(i(),c("div",oa,[a(k,{modelValue:s.videoUrl,"onUpdate:modelValue":t[0]||(t[0]=$=>s.videoUrl=$),type:"url",placeholder:e.$t("Enter video URL"),size:"large"},{append:r(()=>[a(h,{onClick:n.handleUrlSubmit,loading:s.processing},{default:r(()=>[S(d(e.$t("Embed")),1)]),_:1},8,["onClick","loading"])]),_:1},8,["modelValue","placeholder"])]))],8,Xl)),[[b,s.processing]])}const na=F(Kl,[["render",ia]]),la={name:"MediaEmbeder",emits:["embeded"],props:{media:{type:Object,default:()=>({type:"oembed",url:"",inner_html:"",content_type:"video",html:"",provider:"",title:"",author_name:"",image:""})},box_title:{type:String,default:""},box_description:{type:String,default:""},has_iframe:{type:Boolean,default:!0},space:{type:String,default:""},is_feed:{type:Boolean,default:!1}},components:{MediaPreview:Be,FluentPlayerUploader:na},computed:{showPreview(){return this.media.html&&!this.showInput},hasFluentPlayer(){var e;return this.hasFluentPlayerInstalled&&((e=this.appVars.features.fluent_player)==null?void 0:e.enable)},hasFluentPlayerInstalled(){return this.appVars.features.has_fluent_player},hasUploadEnabled(){var e;return this.is_feed&&this.hasFluentPlayer&&((e=this.appVars.features.fluent_player)==null?void 0:e.has_video_upload)},uploadRole(){var e;return((e=this.appVars.features.fluent_player)==null?void 0:e.video_upload_role)||"admin"},getSpace(){return this.space||""},playEmbeddedVideos(){var e;return(e=this.appVars.features.fluent_player)==null?void 0:e.play_embedded_videos},hasUpload(){return this.hasUploadEnabled&&(this.uploadRole==="everyone"||this.uploadRole==="admin_moderator"&&(this.isModerator(this.getSpace)||this.isAdmin())||this.uploadRole==="admin"&&this.isAdmin())}},data(){return{appReady:!1,showInput:!1,fetching:!1}},methods:{fetchData(){this.media.url&&(this.fetching=!0,this.$get("feeds/oembed",{url:this.media.url}).then(e=>{this.media.html=e.oembed.html,this.media.provider=e.oembed.provider,this.media.title=e.oembed.title,this.media.author_name=e.oembed.author_name,this.media.type=e.oembed.type,this.media.image=e.oembed.image,this.media.content_type="video",this.$emit("embeded",this.media),this.showInput=!1}).catch(e=>{this.$handleError(e)}).finally(()=>{this.fetching=!1}))},handleAddCustomHtml(){this.media.content_type="video",this.$emit("embeded",this.media),this.showInput=!1},handleFluentPlayerVideo(e){if(Object.assign(this.media,e),this.media.player==="fluent_player"&&this.media.type==="upload"){this.media.type="oembed",this.$emit("embeded",this.media);return}this.fetchData()}},mounted(){typeof this.media!="object"&&(this.media={type:"oembed",url:"",inner_html:"",content_type:"video"}),this.appReady=!0,this.media.html||this.fetchData()}},aa={key:0},ra={key:0,class:"fcom_media_editor_actions"},ca={key:1,class:"fcom_media_editor fcom_media_embeder"},da={key:0},ua={key:1},_a={key:2,class:"fcom_course_media"};function ma(e,t,o,u,s,n){var f;const m=j,p=st,h=ge,y=ee,k=g("fluent-player-uploader"),b=g("media-preview"),$=K("loading");return s.appReady?N((i(),c("div",aa,[o.has_iframe||n.hasUpload?(i(),c("div",ra,[n.showPreview?(i(),v(m,{key:0,onClick:t[0]||(t[0]=w=>s.showInput=!0),type:"danger",size:"small",text:""},{default:r(()=>[S(d(e.$t("Edit media")),1)]),_:1})):(i(),v(h,{key:1,onChange:t[1]||(t[1]=w=>{o.media.html="",o.media.url="",s.showInput=!0}),size:"small",modelValue:o.media.type,"onUpdate:modelValue":t[2]||(t[2]=w=>o.media.type=w)},{default:r(()=>[a(p,{label:e.$t("Oembed"),value:"oembed"},null,8,["label"]),o.has_iframe?(i(),v(p,{key:0,label:e.$t("HTML Code"),value:"iframe_html"},null,8,["label"])):_("",!0),n.hasUpload?(i(),v(p,{key:1,label:e.$t("Upload Video"),value:"upload"},null,8,["label"])):_("",!0)]),_:1},8,["modelValue"]))])):_("",!0),n.showPreview?(i(),c("div",_a,[a(b,{media_item:o.media},null,8,["media_item"])])):(i(),c("div",ca,[o.media.type=="iframe_html"&&o.has_iframe?(i(),c(V,{key:0},[l("h3",null,d(e.$t("Add Video from custom HTML Code")),1),a(y,{rows:5,modelValue:o.media.html,"onUpdate:modelValue":t[3]||(t[3]=w=>o.media.html=w),type:"textarea",placeholder:e.$t("Paste an iframe code")},null,8,["modelValue","placeholder"]),a(m,{style:{"margin-top":"20px"},onClick:t[4]||(t[4]=w=>n.handleAddCustomHtml()),class:"fcom_secondary_button"},{default:r(()=>[S(d(e.$t("Embed")),1)]),_:1})],64)):(i(),c(V,{key:1},[l("h3",null,d(o.box_title||e.$t("Featured media")),1),n.hasFluentPlayerInstalled&&o.media.type==="upload"?(i(),c("p",da,d(e.$t("The file must be a valid video type (MP4, M3U8, MPD, WebM, MOV)")),1)):(i(),c("p",ua,d(o.box_description||e.$t("Embed from Vimeo, YouTube, Wistia and more")),1)),n.hasFluentPlayer&&(o.media.type==="upload"||n.playEmbeddedVideos)?(i(),v(k,{key:2,type:((f=o.media)==null?void 0:f.type)==="upload"?"upload":"url",onVideoAdded:n.handleFluentPlayerVideo},null,8,["type","onVideoAdded"])):(i(),v(y,{key:3,onKeydown:be(n.fetchData,["enter"]),size:"large",modelValue:o.media.url,"onUpdate:modelValue":t[5]||(t[5]=w=>o.media.url=w),type:"url",placeholder:e.$t("Paste a URL to embed")},{append:r(()=>[a(m,{onClick:n.fetchData,class:"fcom_primary_button"},{default:r(()=>[S(d(e.$t("Embed")),1)]),_:1},8,["onClick"])]),_:1},8,["onKeydown","modelValue","placeholder"]))],64))]))])),[[$,s.fetching]]):_("",!0)}const Zt=F(la,[["render",ma]]),ha={name:"VideoEmbeder",emits:["embeded"],props:["is_admin","space"],components:{MediaEmbeder:Zt,VideoIcon:Ll},data(){return{videoUrl:"",showVideoPop:!1,media:{type:"oembed",url:"",inner_html:"",content_type:"video"}}},methods:{show(){this.showVideoPop=!0},embeded(e){this.$emit("embeded",e),this.showVideoPop=!1,this.media={type:"oembed",url:"",inner_html:"",content_type:"video"}}}},fa={class:"fcom_video_embeder"};function pa(e,t,o,u,s,n){const m=g("VideoIcon"),p=O,h=j,y=g("media-embeder"),k=ye;return i(),c("div",fa,[a(h,{"aria-label":"Add Video",text:"",onClick:n.show},{default:r(()=>[a(p,{class:R(["fcom_apps_icon"])},{default:r(()=>[a(m)]),_:1})]),_:1},8,["onClick"]),s.showVideoPop?(i(),v(k,{key:0,title:e.$t("Attach Video"),modelValue:s.showVideoPop,"onUpdate:modelValue":t[0]||(t[0]=b=>s.showVideoPop=b),width:e.dialogWidth,style:{"max-width":"600px"},"append-to-body":!0},{default:r(()=>[a(y,{box_title:e.$t("Add Featured Video for this post"),has_iframe:o.is_admin,is_feed:!0,onEmbeded:n.embeded,space:o.space,media:s.media},null,8,["box_title","has_iframe","onEmbeded","space","media"])]),_:1},8,["title","modelValue","width"])):_("",!0)])}const ga=F(ha,[["render",pa]]),ya="modulepreload",va=function(e){return"/"+e},is={},We=function(t,o,u){if(!o||o.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(o.map(n=>{if(n=va(n),n in is)return;is[n]=!0;const m=n.endsWith(".css"),p=m?'[rel="stylesheet"]':"";if(!!u)for(let k=s.length-1;k>=0;k--){const b=s[k];if(b.href===n&&(!m||b.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${n}"]${p}`))return;const y=document.createElement("link");if(y.rel=m?"stylesheet":ya,m||(y.as="script",y.crossOrigin=""),y.href=n,document.head.appendChild(y),m)return new Promise((k,b)=>{y.addEventListener("load",k),y.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>t()).catch(n=>{const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=n,window.dispatchEvent(m),!m.defaultPrevented)throw n})};var Vs=(e=>(e.CodeMirror="code-mirror",e.LinkTooltip="link-tooltip",e.Cursor="cursor",e.BlockEdit="block-edit",e.Toolbar="toolbar",e.Placeholder="placeholder",e.ImageBlock="image-block",e))(Vs||{});const ba={cursor:!0,"link-tooltip":!0,"block-edit":!0,placeholder:!0,toolbar:!0,"code-mirror":!0,"image-block":!0};async function ka(e,t,o){switch(e){case"link-tooltip":{const{defineFeature:u}=await We(()=>import("./index.js?ver=2.2.0"),[]);return u(t,o)}case"block-edit":{const{defineFeature:u}=await We(()=>import("./index2.js?ver=2.2.0"),[]);return u(t,o)}case"placeholder":{const{defineFeature:u}=await We(()=>import("./index3.js?ver=2.2.0"),[]);return u(t,o)}case"toolbar":{const{defineFeature:u}=await We(()=>import("./index4.js?ver=2.2.0"),[]);return u(t,o)}case"image-block":{const{defineFeature:u}=await We(()=>import("./index5.js?ver=2.2.0"),[]);return u(t,o)}}}const wa=Pi([],"FeaturesCtx");function Ca(e){return t=>{t.inject(wa,e)}}var Ls=(e,t,o)=>{if(!t.has(e))throw TypeError("Cannot "+o)},$e=(e,t,o)=>(Ls(e,t,"read from private field"),o?o.call(e):t.get(e)),dt=(e,t,o)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,o)},ut=(e,t,o,u)=>(Ls(e,t,"write to private field"),u?u.call(e,o):t.set(e,o),o),Me,Je,_t,mt;class Ms{constructor({root:t,features:o={},featureConfigs:u={},defaultValue:s="",onUpdate:n=p=>{},handleCommonActions:m=(p,h)=>{}}){dt(this,Me,void 0),dt(this,Je,void 0),dt(this,_t,void 0),dt(this,mt,!0);const p=Object.entries({...ba,...o}).filter(([,y])=>y).map(([y])=>y);ut(this,_t,(typeof t=="string"?document.querySelector(t):t)??document.body),ut(this,Me,Fi.make().config(Ca(p)).config(y=>{y.set(Ti,$e(this,_t)),y.set(Ii,s),y.set(Ui,{editable:()=>$e(this,mt)})}).config(y=>{const k=async(b,$)=>await m("handleFileUpload",{ctx:y,files:b,schema:$});y.update(Bi.key,b=>({...b,uploader:k}))}).config(y=>{const k=y.get(Ei);k.markdownUpdated((b,$,f)=>{$!==f&&n($)}),k.updated((b,$,f)=>{m("editor_updated",b)})}).use(Ai).use(Di).use(Ri).use(Hi).use(xi).use(ji).use(Oi));const h=[];p.forEach(y=>{const k=u[y];h.push(ka(y,$e(this,Me),k))}),ut(this,Je,Promise.all(h))}async create(){return await $e(this,Je),$e(this,Me).create()}async destroy(){return await $e(this,Je),$e(this,Me).destroy()}get editor(){return $e(this,Me)}setReadonly(t){return ut(this,mt,!t),this}getMarkdown(){return $e(this,Me).action(Ni())}getEditor(){return $e(this,Me)}destroyEditor(){this.destroy()}}Me=new WeakMap;Je=new WeakMap;_t=new WeakMap;mt=new WeakMap;Ms.Feature=Vs;const $a={name:"CrepeEditor",emits:["update:modelValue","handleMediaUpload","editorCreated"],props:{modelValue:{type:String,default:""},placeholder:{type:String,default:""},autofocus:{type:Boolean,default:!1},mentionQuery:{type:Object,default:()=>({})},autofocus_changed:{type:Boolean,default:!1},disable_mention:{type:Boolean,default:!1},disable_media:{type:Boolean,default:!1},defaultMentions:{type:Array,default:()=>[]},context:{type:String,default:""},is_modal:{type:Boolean,default:!1},onInlineUpload:{type:Function,default:null},canAddImage:{type:Function,default:null}},components:{MilkdownProvider:zi,ProsemirrorAdapterProvider:qi},data(){return{editor:null,currentContent:"",showMentionPop:!1,currentMentionSearch:"",mentionResults:[],justReplaced:!1,searchingMention:!1,hasUnsavedChanges:!1,pendingNavigation:null,activeUploadBlock:null}},watch:{autofocus_changed(e){e&&this.focusOnEditor()},currentContent(){var t;const e=this.context==="feed"||this.context==="comment";this.hasUnsavedChanges=e&&!!((t=this.currentContent)!=null&&t.replace(/&#x20;|\u00A0/gi,"").trim()),this.context==="comment"&&this.is_modal&&(window.fcom_modal_comment_unsaved=this.hasUnsavedChanges)}},methods:{updateContent(e){this.editor.action(t=>{const o=t.get(Dt),{state:u}=o,{from:s}=u.selection,n=e,m=u.tr.insertText(n,s),p=s+n.length,h=m.setSelection(yo.create(m.doc,p));o.dispatch(h),o.focus()})},initEditor(){const e=this,t=new Ms({root:this.$refs.crepe_editor_vue,defaultValue:this.modelValue,featureConfigs:{placeholder:{text:this.placeholder||this.$t("Type your message here!"),mode:"doc"},"block-edit":{hasImageBlock:!this.disable_media&&!!this.onInlineUpload,canAddImage:this.canAddImage},"image-block":{onUpload:async o=>{if(!this.onInlineUpload)return null;this.activeUploadBlock&&this.activeUploadBlock.classList.add("uploading");try{return await this.onInlineUpload(o)}finally{this.activeUploadBlock&&(this.activeUploadBlock.classList.remove("uploading"),this.activeUploadBlock=null)}},blockUploadButton:()=>this.$t("Upload image"),blockConfirmButton:()=>this.$t("Confirm"),blockUploadPlaceholderText:this.$t("or paste link")}},onUpdate(o){o=o.replace(/!\[[^\]]*\]\(\s*\)/g,""),e.$emit("update:modelValue",o),e.currentContent=o},async handleCommonActions(o,u){if(o==="editor_updated"){if(e.disable_mention)return!1;e.checkforMention(u)}else if(o==="handleFileUpload")return e.disable_media?[]:await e.handleFileUpload(u)}});t.create().then(()=>{this.focusOnEditor(),this.$emit("editorCreated"),this.editor=t.getEditor()})},focusOnEditor(){if(!this.autofocus)return;const e=this.$refs.crepe_editor_vue;if(e.querySelector(".ProseMirror")){let t=e.querySelector(".ProseMirror");if(t.focus(),t.hasChildNodes()){let o=window.getSelection(),u=document.createRange(),s=t.childElementCount>0?t.lastChild:t;u.setStart(s,1),u.setEnd(s,1),o.removeAllRanges(),o.addRange(u)}}},checkforMention(e){if(!this.currentContent.includes("@")||this.justReplaced){this.showMentionPop=!1,this.currentMentionSearch="";return}const o=e.get(Dt),{state:u}=o,{selection:s}=u;if(!s)return;const m=u.doc.textBetween(0,s.to," ").match(/@([\p{L}\p{M}\p{N}_-]+(?:\s[\p{L}\p{M}\p{N}_-]+)*)$/u);if(!m){this.showMentionPop=!1,this.currentMentionSearch="";return}let p=m[1];if(!p||p.length<3){if(this.defaultMentions&&this.defaultMentions.length){let h=p.toLowerCase(),y=this.defaultMentions.filter(k=>k.username.toLowerCase().includes(h)||k.display_name.toLowerCase().includes(h));y.length&&(this.currentMentionSearch=p,this.mentionResults=y,this.showMentionPop=!0)}return}if(this.currentMentionSearch&&(this.currentMentionSearch=p,this.searchingMention))return!1;this.searchingMention=!0,this.currentMentionSearch=p,this.$get("members",{mention:this.currentMentionSearch,...this.mentionQuery}).then(h=>{this.mentionResults=h.members.data,this.showMentionPop=!0}).finally(()=>{this.searchingMention=!1})},addMention(e){if(this.disable_mention)return;const t=new RegExp(`@${this.currentMentionSearch}(?!.*@${this.currentMentionSearch})`);this.currentContent=this.currentContent.replace(t,e+"¬†"),this.editor.action(Gi(this.currentContent)),this.focusOnEditor(),this.showMentionPop=!1,this.currentMentionSearch="",this.justReplaced=!0,setTimeout(()=>{this.justReplaced=!1},2e3)},async handleFileUpload(e){const t=e.files;for(let o=0;o<t.length;o++){const u=t.item(o);if(u&&u.type.includes("image"))if(this.onInlineUpload){if(this.canAddImage&&!this.canAddImage())continue;await this.insertInlineImage(u)}else this.$emit("handleMediaUpload",u)}return[]},async insertInlineImage(e){try{const t=await this.onInlineUpload(e);if(!t)return;this.editor.action(o=>{const u=o.get(Dt),{state:s}=u,n=s.schema.nodes["image-block"];if(!n)return;const m=n.create({src:t,caption:"",ratio:1}),{$from:p}=s.selection,h=p.after(1),y=s.tr.insert(h,m);u.dispatch(y),u.focus()})}catch{}},handleBeforeUnload(e){this.hasUnsavedChanges&&(e.preventDefault(),e.returnValue="")},handleLinkClick(e){const t=e.target.closest("a");if(!t||!this.hasUnsavedChanges)return;const o=t.getAttribute("href"),u=this.appVars.portal_url;if(!o)return;const s=o.startsWith(u)||o.startsWith("/"),n=o===window.location.href;s&&!n&&(e.preventDefault(),e.stopPropagation(),this.pendingNavigation=t,this.$eventBus.emit("showUnsavedChangesModal",this.context))},handleImageBlockClick(e){const t=e.target.closest("milkdown-image-block");t&&(this.activeUploadBlock=t),e.target.closest(".confirm")&&!this.canAddImage()&&(e.preventDefault(),e.stopPropagation())}},mounted(){this.initEditor(),window.addEventListener("beforeunload",this.handleBeforeUnload),document.addEventListener("click",this.handleLinkClick,!0),this.onInlineUpload&&this.$refs.crepe_editor_vue.addEventListener("click",this.handleImageBlockClick,!0),this.$eventBus.on("unsavedChangesProceeded",()=>{if(this.pendingNavigation){this.hasUnsavedChanges=!1,this.context==="comment"&&this.is_modal&&(window.fcom_modal_comment_unsaved=!1);const e=this.pendingNavigation;this.pendingNavigation=null,setTimeout(()=>e.click(),0)}})},beforeUnmount(){var e;this.editor&&this.editor.destroy(),this.context==="comment"&&this.is_modal&&this.hasUnsavedChanges&&(window.fcom_modal_comment_unsaved=!1),window.removeEventListener("beforeunload",this.handleBeforeUnload),document.removeEventListener("click",this.handleLinkClick,!0),this.onInlineUpload&&((e=this.$refs.crepe_editor_vue)==null||e.removeEventListener("click",this.handleImageBlockClick,!0))}},Sa={style:{position:"relative"},class:"fcom_md_editor"},Va={ref:"crepe_editor_vue",class:"crepe-editor feed_md_content fcom_md_seditor_wrapper"},La={class:"fcom_mention_pop_wrap"},Ma=l("span",{style:{}},null,-1),Pa={key:0},Fa={key:0},Ta=["onClick"],Ia=["src"],Ua={key:1};function Ba(e,t,o,u,s,n){const m=g("ProsemirrorAdapterProvider"),p=g("MilkdownProvider"),h=de;return i(),c(V,null,[a(p,null,{default:r(()=>[a(m,null,{default:r(()=>[l("div",Sa,[l("div",Va,null,512)])]),_:1})]),_:1}),l("div",La,[a(h,{"popper-class":"fcom_mention_pop",ref:"mentionPopoverRef",placement:"bottom",visible:s.showMentionPop,width:300,persistent:!1},{reference:r(()=>[Ma]),default:r(()=>[s.justReplaced?_("",!0):(i(),c("div",Pa,[s.mentionResults.length?(i(),c("ul",Fa,[(i(!0),c(V,null,D(s.mentionResults,y=>(i(),c("li",{key:y.user_id,onClick:k=>n.addMention("@"+y.username)},[y.avatar?(i(),c("img",{key:0,alt:"",src:y.avatar},null,8,Ia)):_("",!0),l("span",null,d(y.display_name)+" (@"+d(y.username)+")",1)],8,Ta))),128))])):s.searchingMention?_("",!0):(i(),c("div",Ua,[l("p",null,d(e.$t("No results found. Please search by username")),1)]))]))]),_:1},8,["visible"])])],64)}const St=F($a,[["render",Ba]]);const Ea={name:"EmojiPicker",components:{Picker:Ci},emits:["emoji-selected"],props:{close_on_select:{type:Boolean,default:!1}},data(){return{isEmojiPickerVisible:!1,emojiIndex:null,imojiLoading:!1,errorMessage:"",isLoading:!1}},methods:{onEmojiSelect(e){this.$emit("emoji-selected",e.native),this.close_on_select&&this.$refs.fcom_emoji_popover.hide()},handleClickOutside(e){if(this.isEmojiPickerVisible){const t=this.$refs.container;t&&!t.contains(e.target)&&(this.isEmojiPickerVisible=!1)}},loadEmojiAssets(){if(this.isLoading)return;this.isLoading=!0,window.fcomEmojiIndex&&(this.emojiIndex=window.fcomEmojiIndex);let e=this.appVars.assets_url+"libs/static/tw_emojis.json";this.imojiLoading=!0,fetch(e).then(t=>t.json()).then(t=>{t?(window.fcomEmojiIndex=new $i(t),this.emojiIndex=window.fcomEmojiIndex,this.imojiLoading=!1):this.errorMessage="Emoji loading failed"}).catch(t=>{this.errorMessage="Emoji loading failed"}).finally(()=>{this.isLoading=!1})}}},Aa={style:{position:"relative"},ref:"container"},Da=l("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[l("g",null,[l("circle",{cx:"9.99996",cy:"10.0013",r:"8.33333",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),l("path",{d:"M6.66663 12.5C7.42673 13.512 8.6369 14.1667 9.99996 14.1667C11.363 14.1667 12.5732 13.512 13.3333 12.5",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),l("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.6741 7.5L6.66663 7.5Z",fill:"currentColor"}),l("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M13.3333 7.5L13.3258 7.5Z",fill:"currentColor"}),l("path",{d:"M6.6741 7.5L6.66663 7.5M13.3333 7.5L13.3258 7.5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})])],-1),Ra={key:0,class:"emoji-mart emoji-mart-static",style:{width:"320px",padding:"10px 20px"}},Ha={key:0},xa={style:{"text-align":"center","margin-bottom":"20px"}},ja={key:1,class:"fcom_emoji_holder"};function Oa(e,t,o,u,s,n){const m=O,p=j,h=q,y=g("Picker"),k=de;return i(),c("div",Aa,[a(k,{placement:"top-end",width:320,trigger:"click",persistent:!1,ref:"fcom_emoji_popover",onShow:n.loadEmojiAssets,"popper-class":"fcom_emoji_popover ffcom_emoji"},{reference:r(()=>[a(p,{"aria-label":"Pick Imoji",text:""},{default:r(()=>[a(m,null,{default:r(()=>[Da]),_:1})]),_:1})]),default:r(()=>[s.imojiLoading?(i(),c("div",Ra,[s.errorMessage?(i(),c("div",Ha,d(s.errorMessage),1)):(i(),c(V,{key:1},[l("div",xa,d(e.$t("Loading.....")),1),a(h,{animated:!0,rows:3})],64))])):s.emojiIndex?(i(),c("div",ja,[a(y,{title:e.$t("Pick Emoji"),i18n:{search:e.$t("Search"),notfound:e.$t("No Emoji Found"),categories:{search:e.$t("Search Results"),recent:e.$t("Frequently Used"),smileys:e.$t("Smileys & Emotion"),people:e.$t("People & Body"),nature:e.$t("Animals & Nature"),foods:e.$t("Food & Drink"),activity:e.$t("Activity"),places:e.$t("Travel & Places"),objects:e.$t("Objects"),symbols:e.$t("Symbols"),flags:e.$t("Flags"),custom:e.$t("Custom")}},color:"#66b1ff",showPreview:!1,ref:"picker",data:s.emojiIndex,set:"twitter",onSelect:n.onEmojiSelect,emojiSize:22,sheetSize:32,emojiTooltip:!1},null,8,["title","i18n","data","onSelect"])])):_("",!0)]),_:1},8,["onShow"])],512)}const Ps=F(Ea,[["render",Oa]]),Na={name:"DocumentsUploader",components:{UploadFilled:gt,Document:yt},emits:["filesChanged","fileAdded"],props:{is_multiple:{type:Boolean,default:!1},additional_data:{type:Object,default:()=>({})},showLists:{type:Boolean,default:!0},prevFiles:{type:Array,default:()=>[]}},computed:{action_url(){return this.appVars.rest.url+"/documents/upload"},headers(){return{"X-WP-Nonce":this.appVars.rest.nonce}},uploadingFiles(){return this.fileList.filter(e=>e.status==="uploading")}},data(){return{fileList:[]}},methods:{handleSuccess(e){var t;console.log(e),(t=e==null?void 0:e.file)!=null&&t.media_key&&this.$emit("fileAdded",e==null?void 0:e.file)},handleChange(){let e=[];this.fileList.forEach(t=>{var o,u;(u=(o=t==null?void 0:t.response)==null?void 0:o.file)!=null&&u.media_key&&e.push({id:t.response.file.id,media_key:t.response.file.media_key,title:t.response.file.title,type:t.response.file.type})}),this.$emit("filesChanged",e)},handleError(e){this.$handleError(JSON.parse(e.message))}}},za={class:"fcom_documents_uploader"},qa={class:"el-upload__text"},Ga={key:0},Ya={class:"fcom_document_lists"},Za={class:"fcom_each_document"},Wa={class:"fcom_document_info"},Ja={class:"fcom_document_icon"},Qa={class:"fcom_document_title"},Ka={class:"fcom_document_actions"};function Xa(e,t,o,u,s,n){const m=g("UploadFilled"),p=O,h=vt,y=g("Document"),k=j;return i(),c("div",za,[a(h,{action:n.action_url,headers:n.headers,"file-list":s.fileList,"onUpdate:fileList":t[0]||(t[0]=b=>s.fileList=b),accept:"*/*",drag:"",class:"fcom_document_upload",multiple:o.is_multiple,data:o.additional_data,"show-file-list":o.showLists,"on-change":n.handleChange,"on-success":n.handleSuccess,"on-error":n.handleError,"on-remove":n.handleChange},{default:r(()=>[a(p,{class:"el-icon--upload"},{default:r(()=>[a(m)]),_:1}),l("div",qa,d(e.$t("Drop file here or click to upload")),1)]),_:1},8,["action","headers","file-list","multiple","data","show-file-list","on-change","on-success","on-error","on-remove"]),!o.showLists&&n.uploadingFiles.length?(i(),c("div",Ga,[l("div",Ya,[(i(!0),c(V,null,D(n.uploadingFiles,b=>(i(),c("div",Za,[l("div",Wa,[l("div",Ja,[a(p,null,{default:r(()=>[a(y)]),_:1})]),l("span",Qa,d(b.name),1)]),l("div",Ka,[a(k,{text:"",size:"small",loading:!0},{default:r(()=>[S(d(e.$t("Uploading...")),1)]),_:1})])]))),256))])])):_("",!0)])}const er=F(Na,[["render",Xa]]),tr={name:"PdfIcon"},sr={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"20",height:"20",color:"currentColor",fill:"none"},or=l("path",{opacity:"0.4",d:"M19 11C19 10.1825 19 9.4306 18.8478 9.06306C18.6955 8.69552 18.4065 8.40649 17.8284 7.82843L13.0919 3.09188C12.593 2.593 12.3436 2.34355 12.0345 2.19575C11.9702 2.165 11.9044 2.13772 11.8372 2.11401C11.5141 2 11.1614 2 10.4558 2C7.21082 2 5.58831 2 4.48933 2.88607C4.26731 3.06508 4.06508 3.26731 3.88607 3.48933C3 4.58831 3 6.21082 3 9.45584V14C3 17.7712 3 19.6569 4.17157 20.8284C5.34315 22 7.22876 22 11 22H19M12 2.5V3C12 5.82843 12 7.24264 12.8787 8.12132C13.7574 9 15.1716 9 18 9H18.5",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),ir=l("path",{d:"M21 14H19C18.4477 14 18 14.4477 18 15V16.5M18 16.5V19M18 16.5H20.5M7 19V17M7 17V14H8.5C9.32843 14 10 14.6716 10 15.5C10 16.3284 9.32843 17 8.5 17H7ZM12.5 14H13.7857C14.7325 14 15.5 14.7462 15.5 15.6667V17.3333C15.5 18.2538 14.7325 19 13.7857 19H12.5V14Z",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),nr=[or,ir];function lr(e,t,o,u,s,n){return i(),c("svg",sr,nr)}const ar=F(tr,[["render",lr]]),rr={name:"ZipIcon"},cr={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"20",height:"20",color:"currentColor",fill:"none"},dr=l("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M9.24643 13.7697C8.9545 13.7507 8.55839 13.75 8.00407 13.75H7.00391C6.58969 13.75 6.25391 13.4142 6.25391 13C6.25391 12.5858 6.58969 12.25 7.00391 12.25H8.00407C8.01907 12.25 8.03402 12.25 8.04892 12.25C8.66199 12.25 9.18423 12.25 9.57881 12.2929C9.93962 12.3322 10.469 12.4271 10.7888 12.8672C10.9627 13.1066 11.0272 13.3876 10.9857 13.67C10.9495 13.9166 10.8383 14.1258 10.7382 14.2819C10.5513 14.5734 10.2447 14.912 9.91903 15.2718C9.90537 15.2868 9.89169 15.3019 9.87798 15.3171L8.63592 16.6895C8.43153 16.9153 8.27429 17.0901 8.15532 17.2303C8.44726 17.2493 8.84336 17.25 9.39768 17.25H10.3978C10.8121 17.25 11.1478 17.5858 11.1478 18C11.1478 18.4142 10.8121 18.75 10.3978 18.75L9.35284 18.75C8.73977 18.75 8.21752 18.7501 7.82294 18.7071C7.46213 18.6678 6.93277 18.5729 6.61299 18.1328C6.43908 17.8934 6.37458 17.6124 6.41604 17.33C6.45224 17.0835 6.5634 16.8742 6.66351 16.7181C6.85041 16.4266 7.15703 16.088 7.48273 15.7283C7.49638 15.7132 7.51006 15.6981 7.52377 15.6829L8.76583 14.3105C8.97022 14.0847 9.12746 13.9099 9.24643 13.7697Z",fill:"currentColor"},null,-1),ur=l("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12.1914 13C12.1914 12.5858 12.5272 12.25 12.9414 12.25H15.4869C15.9011 12.25 16.2369 12.5858 16.2369 13C16.2369 13.4142 15.9011 13.75 15.4869 13.75H14.9641V17.25H15.4869C15.9011 17.25 16.2369 17.5858 16.2369 18C16.2369 18.4142 15.9011 18.75 15.4869 18.75H12.9414C12.5272 18.75 12.1914 18.4142 12.1914 18C12.1914 17.5858 12.5272 17.25 12.9414 17.25H13.4641V13.75H12.9414C12.5272 13.75 12.1914 13.4142 12.1914 13Z",fill:"currentColor"},null,-1),_r=l("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M19.0189 12.25C19.0305 12.25 19.0419 12.25 19.0534 12.25H19.7321C20.8365 12.25 21.7549 13.1328 21.7549 14.25C21.7549 15.3673 20.8365 16.25 19.7321 16.25H18.7852V18C18.7852 18.4142 18.4494 18.75 18.0352 18.75C17.621 18.75 17.2852 18.4142 17.2852 18V14C17.2852 13.9885 17.2852 13.9769 17.2852 13.9653C17.2851 13.7605 17.285 13.5378 17.3107 13.3497C17.3411 13.1278 17.4193 12.8466 17.6588 12.6114C17.8964 12.378 18.1772 12.3037 18.3966 12.2748C18.5853 12.2499 18.8094 12.2499 19.0189 12.25ZM18.7852 14.75H19.7321C20.0336 14.75 20.2549 14.5135 20.2549 14.25C20.2549 13.9866 20.0336 13.75 19.7321 13.75H19.0534C18.9463 13.75 18.8604 13.7501 18.7863 13.7514C18.7852 13.8207 18.7852 13.9009 18.7852 14V14.75Z",fill:"currentColor"},null,-1),mr=l("path",{opacity:"0.4",d:"M7.13841 20.7033C8.00786 20.7942 9.13899 20.7955 10.7476 20.7955H14.9079C15.4456 20.7955 15.8816 21.233 15.8816 21.7727C15.8816 22.3125 15.4456 22.75 14.9079 22.75H10.6927C9.15159 22.75 7.91879 22.75 6.93654 22.6473C5.92712 22.5417 5.0659 22.3186 4.32113 21.7919C3.93077 21.5159 3.58222 21.1871 3.28704 20.8146C2.71721 20.0956 2.47396 19.2577 2.35985 18.2843C2.24996 17.3469 2.24998 16.1743 2.25 14.7262V12.1428V12.1427C2.25 10.7244 2.24999 9.61179 2.30919 8.71107C2.36944 7.79422 2.49398 7.02952 2.77509 6.31755C3.61848 4.1815 5.39221 2.51875 7.61221 1.73658C8.99465 1.2495 10.6813 1.24971 13.5209 1.25007L13.7572 1.25009L13.9605 1.25004L13.9606 1.25004C15.5156 1.2495 16.548 1.24914 17.4068 1.55172C18.7834 2.03673 19.8918 3.071 20.4206 4.41031C20.6039 4.87447 20.6795 5.36014 20.7153 5.90477C20.75 6.43335 20.75 7.08083 20.75 7.87999V7.88006V10.0455C20.75 10.5852 20.3141 11.0228 19.7763 11.0228C19.2386 11.0228 18.8026 10.5852 18.8026 10.0455V7.91329C18.8026 7.07303 18.8021 6.49008 18.7721 6.03341C18.7427 5.58546 18.6879 5.32704 18.6102 5.1304C18.3001 4.34503 17.6344 3.70339 16.7618 3.39593C16.2584 3.21858 15.5913 3.20463 13.7572 3.20463C13.4591 3.20463 13.1023 3.2058 12.7641 3.20732C12.426 3.20885 11.8726 3.21134 11.4104 3.48025C11.1057 3.65756 10.8849 3.85945 10.7582 4.08004C10.5409 4.45845 10.4166 4.89711 10.4166 5.3648C10.4166 5.51193 10.4262 5.70446 10.4344 5.88206L10.4344 5.88212C10.4417 6.03696 10.4496 6.20566 10.4531 6.3737C10.461 6.75379 10.449 7.19733 10.3343 7.62548C10.1108 8.45945 9.4594 9.11086 8.62543 9.33432C8.19728 9.44904 7.75374 9.46105 7.37365 9.45315C7.20551 9.44966 7.03693 9.44174 6.88201 9.43446C6.70441 9.42622 6.48041 9.41667 6.33328 9.41667C5.88661 9.41667 5.46642 9.53003 5.09991 9.72955C4.87246 9.85337 4.65104 10.0965 4.47811 10.3875C4.19749 10.8596 4.19732 11.4982 4.19734 11.7652L4.19737 14.6653C4.19737 16.1888 4.19894 17.2461 4.29387 18.0559C4.38611 18.8427 4.55555 19.2754 4.81111 19.5979C4.9889 19.8223 5.20128 20.0234 5.44274 20.1941C5.80057 20.4472 6.28449 20.6139 7.13841 20.7033Z",fill:"currentColor"},null,-1),hr=[dr,ur,_r,mr];function fr(e,t,o,u,s,n){return i(),c("svg",cr,hr)}const pr=F(rr,[["render",fr]]),gr={name:"AudioIcon"},yr={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"20",height:"20",color:"currentColor",fill:"none"},vr=l("path",{d:"M5.5 21.5H18.5C20.1569 21.5 21.5 20.1569 21.5 18.5V5.5C21.5 3.84315 20.1569 2.5 18.5 2.5H5.5C3.84315 2.5 2.5 3.84315 2.5 5.5V18.5C2.5 20.1569 3.84315 21.5 5.5 21.5Z",stroke:"currentColor","stroke-width":"1.5","stroke-linejoin":"round"},null,-1),br=l("path",{d:"M10 15.5C10 16.3284 9.32843 17 8.5 17C7.67157 17 7 16.3284 7 15.5C7 14.6716 7.67157 14 8.5 14C9.32843 14 10 14.6716 10 15.5ZM10 15.5V8.5L16 7V13.5M16 13.5C16 14.3284 15.3284 15 14.5 15C13.6716 15 13 14.3284 13 13.5C13 12.6716 13.6716 12 14.5 12C15.3284 12 16 12.6716 16 13.5Z",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),kr=[vr,br];function wr(e,t,o,u,s,n){return i(),c("svg",yr,kr)}const Cr=F(gr,[["render",wr]]),$r={name:"DocIcon"},Sr={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"20",height:"20",color:"currentColor",fill:"none"},Vr=l("path",{d:"M21 15C21 14.4477 20.5523 14 20 14H19C18.4477 14 18 14.4477 18 15V18C18 18.5523 18.4477 19 19 19H20C20.5523 19 21 18.5523 21 18M7 14H8C9.10457 14 10 14.8954 10 16V17C10 18.1046 9.10457 19 8 19H7V14ZM13.5 14H14.5C15.0523 14 15.5 14.4477 15.5 15V18C15.5 18.5523 15.0523 19 14.5 19H13.5C12.9477 19 12.5 18.5523 12.5 18V15C12.5 14.4477 12.9477 14 13.5 14Z",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Lr=l("path",{d:"M19 22H5C3.89543 22 3 21.1046 3 20L3 4C3 2.89543 3.89543 2 5 2H12L19 9V11M18.5 9H13.998C12.8935 9 11.998 8.10457 11.998 7V2.5",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Mr=[Vr,Lr];function Pr(e,t,o,u,s,n){return i(),c("svg",Sr,Mr)}const Fr=F($r,[["render",Pr]]),Tr={name:"VideoFileIcon"},Ir={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"20",height:"20",color:"currentColor",fill:"none"},Ur=l("path",{d:"M19 13V9L12 2H5C3.89543 2 3 2.89543 3 4V20C3 21.1046 3.89543 22 5 22H9",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Br=l("path",{d:"M12 2V7C12 8.10457 12.8954 9 14 9H19",stroke:"currentColor","stroke-width":"1.5","stroke-linejoin":"round"},null,-1),Er=l("path",{d:"M18 19.5L21 21V17L18 18.5M18 19.5V18.5M18 19.5V21C18 21.5523 17.5523 22 17 22H13C12.4477 22 12 21.5523 12 21V17C12 16.4477 12.4477 16 13 16H17C17.5523 16 18 16.4477 18 17V18.5",stroke:"currentColor","stroke-width":"1.5","stroke-linejoin":"round"},null,-1),Ar=[Ur,Br,Er];function Dr(e,t,o,u,s,n){return i(),c("svg",Ir,Ar)}const Rr=F(Tr,[["render",Dr]]);const Hr={name:"DocumentLists",components:{Document:yt,Download:vo,PdfIcon:ar,ImageIcon:Yt,ZipIcon:pr,AudioIcon:Cr,DocIcon:Fr,VideoFileIcon:Rr},props:["document_lists","additional_data","is_editable"],emits:["fileRemoved","documentsUpdated"],data(){return{editingIndex:null,isSaving:!1}},methods:{removeDocument(e,t){if(!this.is_editable){this.$emit("fileRemoved",e);return}this.$confirm(this.$t("Are you sure you want to delete this document?"),this.$t("Warning"),{confirmButtonText:this.$t("OK"),cancelButtonText:this.$t("Cancel"),confirmButtonClass:"fcom_primary_button",cancelButtonClass:"fcom_secondary_button",type:"warning"}).then(()=>{this.deleteDocument(e,t)})},deleteDocument(e,t){this.isSaving=!0,this.$post("documents/delete",{id:t.id}).then(o=>{this.$notify.success(o.message),this.document_lists.splice(e,1),this.$emit("documentsUpdated",this.document_lists)}).catch(o=>{this.$handleError(o)}).finally(()=>{this.isSaving=!1})},getIcon(e){return e=="application/pdf"?"pdf-icon":e.includes("image")?"image-icon":e=="application/zip"?"zip-icon":e.includes("audio")?"audio-icon":e.includes("video")?"video-file-icon":e.includes("openxmlformats")?"doc-icon":"document"},saveDoc(e){this.isSaving=!0,this.$post("documents/update",{id:e.id,title:e.title,...this.additional_data}).then(t=>{this.$notify.success(t.message),this.isSaving=!1,this.editingIndex=null,this.$emit("documentsUpdated",this.document_lists)}).catch(t=>{this.$handleError(t)}).finally(()=>{this.isSaving=!1})}}},xr={class:"fcom_document_lists"},jr={class:"fcom_each_document"},Or={class:"fcom_document_info"},Nr={class:"fcom_document_icon"},zr=["href"],qr=["onClick"],Gr={class:"fcom_document_actions"},Yr=["href"];function Zr(e,t,o,u,s,n){const m=O,p=g("EditPen"),h=j,y=ee,k=g("Download"),b=g("DeleteFilled"),$=K("loading");return i(),c("div",xr,[(i(!0),c(V,null,D(o.document_lists,(f,w)=>(i(),c("div",jr,[l("div",Or,[l("div",Nr,[a(m,null,{default:r(()=>[(i(),v(xt(n.getIcon(f.type))))]),_:2},1024)]),o.is_editable?(i(),c(V,{key:1},[s.editingIndex!=w?(i(),c("span",{key:0,style:{cursor:"pointer"},onClick:C=>s.editingIndex=w,class:"fcom_document_title"},[l("span",null,d(f.title),1),a(m,{style:{"margin-left":"10px","font-size":"80%"}},{default:r(()=>[a(p)]),_:1})],8,qr)):(i(),v(y,{key:1,readonly:s.isSaving,size:"small",style:{width:"80%"},modelValue:f.title,"onUpdate:modelValue":C=>f.title=C},{append:r(()=>[a(h,{disabled:s.isSaving,loading:s.isSaving,onClick:C=>n.saveDoc(f)},{default:r(()=>[l("span",null,d(e.$t("Update")),1)]),_:2},1032,["disabled","loading","onClick"])]),_:2},1032,["readonly","modelValue","onUpdate:modelValue"]))],64)):(i(),c("a",{key:0,href:f.url,target:"_blank",rel:"noopener",class:"fcom_document_title"},d(f.title),9,zr))]),N((i(),c("div",Gr,[!o.is_editable&&f.url?(i(),c("a",{key:0,href:f.url+"&force_download=1",target:"_blank",class:"el-button el-button--text"},[a(m,null,{default:r(()=>[a(k)]),_:1})],8,Yr)):_("",!0),o.is_editable?(i(),v(h,{key:1,onClick:C=>n.removeDocument(w,f),plain:"",text:"",size:"small"},{default:r(()=>[a(m,null,{default:r(()=>[a(b)]),_:1})]),_:2},1032,["onClick"])):_("",!0)])),[[$,s.isSaving]])]))),256))])}const Ge=F(Hr,[["render",Zr]]);const Wr={name:"DocumentUploaderPop",components:{DocumentLists:Ge,DocumentsUploader:er,Document:yt},props:["feed","space_id","is_inline"],methods:{reset(){delete this.feed.document_ids,this.feed.content_type=""},fileAdded(e){this.feed.document_ids||(this.feed.document_ids=[]),this.feed.document_ids.push(e),this.feed.content_type="document"},removeDocument(e){this.feed.document_ids.splice(e,1),(!this.feed.document_ids||this.feed.document_ids.length===0)&&(this.feed.content_type="")}}},Jr={class:"fcom_inline_docs_form"},Qr={class:"fcom_doc_upload_modal"};function Kr(e,t,o,u,s,n){var y;const m=j,p=g("documents-uploader"),h=g("document-lists");return i(),c("div",Jr,[l("div",Qr,[a(m,{onClick:t[0]||(t[0]=k=>n.reset()),class:"fcom_file_cancel_btn",text:"",size:"small"},{default:r(()=>[S(d(e.$t("Cancel")),1)]),_:1}),a(p,{style:{"margin-bottom":"20px"},showLists:!1,additional_data:{space_id:o.space_id},is_multiple:!0,onFileAdded:n.fileAdded},null,8,["additional_data","onFileAdded"]),a(h,{class:"fcom_boxed_documents",additional_data:{space_id:o.space_id,feed_id:o.feed.id},is_editable:!0,document_lists:(y=o.feed)==null?void 0:y.document_ids,onFileRemoved:n.removeDocument},null,8,["additional_data","document_lists","onFileRemoved"])])])}const Xr=F(Wr,[["render",Kr]]),ec={name:"PaperClipIcon"},tc={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},sc=l("path",{d:"M18.1188 9.2622L11.431 16.6897C9.50497 18.8288 6.13081 18.9109 3.86828 16.8737C1.60575 14.8365 1.33471 11.4723 3.26079 9.33317L9.14601 2.79697C10.4836 1.31147 12.8106 1.25484 14.3818 2.66956C15.953 4.08428 16.1399 6.40445 14.8023 7.88995L9.45214 13.832C8.70311 14.6638 7.42326 14.695 6.54338 13.9027C5.66351 13.1105 5.5607 11.8344 6.30973 11.0025L10.8574 5.95182",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),oc=[sc];function ic(e,t,o,u,s,n){return i(),c("svg",tc,oc)}const Fs=F(ec,[["render",ic]]),nc=window.fluentComAdmin.auth,lc={name:"FeedTextComposer",components:{PaperClipIcon:Fs,DocumentLists:Ge,DocumentUploaderPop:Xr,Document:yt,MediaPreview:Be,Giphy:bl,ImageUploader:Re,SurveyEditForm:nl,MarkdownEditor:St,EmojiPicker:Ps,VideoEmbeder:ga,ImageIcon:Yt,PollIcon:Wn},emits:["editorCreated"],props:{placeholder:{type:String,default(){return"What's happening, "+nc.first_name}},config:{type:Object,default(){return{multipleMedia:!1,surveyApp:!1,videoApp:!1,disableUpload:!1,documentsApp:!1,space_id:null,spaceSlug:null,isAdmin:!1}}},disabled:{type:Boolean,default(){return!1}},autofocus:{type:Boolean,default(){return!0}},content:{type:Object,default(){return{message:"",media_images:[]}}},mentionQuery:{type:Object,default(){return{}}},autofocus_changed:{type:Boolean,default(){return!1}},defaultMentions:{type:Array,default(){return[]}},context:{type:String,default(){return""}},is_editing:{type:Boolean,default(){return!1}},is_modal:{type:Boolean,default(){return!1}}},computed:{hasActiveApp(){return this.content.content_type=="document"},hasInlineImageUpload(){return this.appVars.features.has_inline_image_upload==="yes"}},data(){return{mentionResults:[],mentionSearch:"",uploading:!1,isEmojiPickerVisible:!1,maxMediaPerPost:this.appVars.features.max_media_per_post}},methods:{cencelSurvey(){this.content.survey=null},insertEmoji(e){this.$refs.markdownEditor&&this.$refs.markdownEditor.updateContent(e)},checkHasImageForCommentsEdit(e){return e.media&&e.media.media_url},removeImageFromComments(){this.content.media=null},checkForImage(e){for(let t=0;t<e.clipboardData.items.length;++t){let o=e.clipboardData.items[t];if(o.kind=="file"&&o.type.startsWith("image/")){const u=o.getAsFile(),s=e.clipboardData.getData("text")||"clipboard-image.png";this.uploadImage(new File([u],s,{type:u.type}))}}},uploadImage(e,t=!0){if(this.config.disableUpload)return this.$notify.error(this.$t("You are not allowed to upload media here.")),!1;if(!this.canAddImage())return!1;t&&(this.uploading=!0);const o=new FormData;return o.append("file",e),o.append("max_width",1400),o.append("context",this.context),o.append("resize",!0),this.$uploadFile("feeds/media-upload",o).then(u=>(t&&this.handleMediaUpload(u.media.url),u.media.url)).catch(u=>{this.$handleError(u)}).finally(()=>{this.uploading=!1})},handleMediaUpload(e,t="uploader"){var o,u;if(this.content.media_images||(this.content.media_images=[]),(u=(o=this.content)==null?void 0:o.meta)!=null&&u.media_preview&&(this.content.meta.media_preview=null),this.config.multipleMedia||(this.content.media_images=[]),!this.canAddImage())return!1;this.content.media=null,this.content.meta=null,this.content.media_images.push({url:e,provider:t,type:"image",height:0,width:0})},initSurveyForm(){this.content.survey||(this.content.survey={type:"single_choice",options:[{slug:"",label:this.$t("First choice")},{slug:"",label:""}]})},selectedGiphy(e){var o,u;this.content.meta||(this.content.meta=[]),(o=this.content)!=null&&o.media_images&&(this.content.media_images=[]),(u=this.content)!=null&&u.media&&(this.content.media=null);const t={image:e.images.downsized_medium.url,height:e.images.downsized_medium.height,width:e.images.downsized_medium.width,type:"image",provider:"giphy"};this.content.meta={media_preview:t}},handleVideoAttachment(e){this.content.media_images=[],this.content.meta=[],this.content.media=e},getInlineImageCount(){var t,o;const e=(o=(t=this.$refs.markdownEditor)==null?void 0:t.$refs)==null?void 0:o.crepe_editor_vue;return e?e.querySelectorAll('img[data-type="image-block"][src^="http"]').length:0},canAddImage(){var o;return(((o=this.content.media_images)==null?void 0:o.length)||0)+this.getInlineImageCount()>=this.maxMediaPerPost?(this.$notify.error(this.$t("You can upload a maximum of %s images per post.",this.maxMediaPerPost)),!1):!0}},mounted(){this.autofocus&&this.$nextTick(()=>{this.$refs.create_status&&this.$refs.create_status.focus()})}},ac={class:"fcom_text_composer"},rc={class:"fcom_editor status_text_input"},cc={key:1,style:{position:"relative","text-align":"center"}},dc={key:2,class:"fcom_media_items"},uc={key:0,class:"fcom_media_images"},_c=["src","alt"],mc={key:1,class:"fcrom_media_images"},hc={class:"fcrom_media_image"},fc=["src","alt"],pc={key:3,class:"fcrom_media_images"},gc=["src","alt"],yc={key:4,class:"fcrom_media_images"},vc={class:"fcrom_media_image"},bc=["src","alt"],kc={class:"fcom_composer_footer"},wc={class:"fcom_composer_apps"},Cc={key:0},$c={class:"fcom_composer_actions"};function Sc(e,t,o,u,s,n){var B,A,L,E,G,se,H,X,x;const m=g("MarkdownEditor"),p=g("DocumentUploaderPop"),h=g("SurveyEditForm"),y=j,k=g("media-preview"),b=g("CloseBold"),$=O,f=g("ImageIcon"),w=g("image-uploader"),C=g("video-embeder"),M=g("PaperClipIcon"),P=g("PollIcon"),T=g("EmojiPicker"),I=g("Giphy"),U=K("loading");return i(),c(V,null,[l("div",ac,[l("div",rc,[z(e.$slots,"before_input"),a(m,{ref:"markdownEditor",modelValue:o.content.message,"onUpdate:modelValue":t[0]||(t[0]=Q=>o.content.message=Q),context:o.context,is_modal:o.is_modal,autofocus:o.autofocus,placeholder:o.placeholder,mentionQuery:o.mentionQuery,defaultMentions:o.defaultMentions,autofocus_changed:o.autofocus_changed,onInlineUpload:n.hasInlineImageUpload?Q=>n.uploadImage(Q,!1):null,canAddImage:n.canAddImage,onHandleMediaUpload:n.uploadImage,onEditorCreated:t[1]||(t[1]=()=>{e.$emit("editorCreated")})},null,8,["modelValue","context","is_modal","autofocus","placeholder","mentionQuery","defaultMentions","autofocus_changed","onInlineUpload","canAddImage","onHandleMediaUpload"]),z(e.$slots,"after_input")]),o.content.content_type=="document"?(i(),c(V,{key:0},[o.config.documentsApp&&o.config.space_id?(i(),v(p,{key:0,is_inline:!0,feed:o.content,space_id:o.config.space_id},null,8,["feed","space_id"])):_("",!0)],64)):(i(),c(V,{key:1},[o.content.survey?(i(),v(h,{key:0,onCancel:n.cencelSurvey,form:o.content.survey,is_editing:o.is_editing},null,8,["onCancel","form","is_editing"])):_("",!0),(A=(B=o.content)==null?void 0:B.media)!=null&&A.type?(i(),c("div",cc,[a(y,{onClick:t[2]||(t[2]=Q=>{o.content.media=null}),text:"",type:"danger"},{default:r(()=>[S(d(e.$t("Remove Media")),1)]),_:1}),a(k,{media_item:o.content.media},null,8,["media_item"])])):(L=o.content)!=null&&L.meta?(i(),c("div",dc,[(G=(E=o.content.meta)==null?void 0:E.media_items)!=null&&G.length?(i(!0),c(V,{key:0},D(o.content.meta.media_items,(Q,ce)=>(i(),c("div",{key:ce},[Q.type=="image"?(i(),c("div",uc,[l("img",{class:"fcom_media_image",src:Q.url,alt:e.$t("Media image")},null,8,_c),a(y,{class:"fcom_media_images_cross_button",link:"",onClick:J=>o.content.meta.media_items.splice(ce,1)},{default:r(()=>[a($,null,{default:r(()=>[a(b)]),_:1})]),_:2},1032,["onClick"])])):_("",!0)]))),128)):((H=(se=o.content.meta)==null?void 0:se.media_preview)==null?void 0:H.type)=="image"||(x=(X=o.content.meta)==null?void 0:X.media_preview)!=null&&x.image?(i(),c("div",mc,[l("div",hc,[l("img",{src:o.content.meta.media_preview.image,alt:e.$t("Media Preview image")},null,8,fc),a(y,{link:"",onClick:t[3]||(t[3]=Q=>o.content.meta.media_preview=null)},{default:r(()=>[a($,null,{default:r(()=>[a(b)]),_:1})]),_:1})])])):_("",!0)])):o.content.media_images&&o.content.media_images.length?(i(),c("div",pc,[(i(!0),c(V,null,D(o.content.media_images,(Q,ce)=>(i(),c("div",{class:"fcrom_media_image",key:ce},[l("img",{src:Q.url,alt:e.$t("Media image")},null,8,gc),a(y,{link:"",onClick:J=>o.content.media_images.splice(ce,1)},{default:r(()=>[a($,null,{default:r(()=>[a(b)]),_:1})]),_:2},1032,["onClick"])]))),128))])):n.checkHasImageForCommentsEdit(o.content)?(i(),c("div",yc,[l("div",vc,[l("img",{src:o.content.media.media_url,alt:e.$t("Media image")},null,8,bc),a(y,{link:"",onClick:t[4]||(t[4]=Q=>n.removeImageFromComments())},{default:r(()=>[a($,null,{default:r(()=>[a(b)]),_:1})]),_:1})])])):_("",!0)],64))]),z(e.$slots,"before_composer_footer"),N((i(),c("div",kc,[l("div",wc,[n.hasActiveApp?_("",!0):(i(),c(V,{key:0},[s.maxMediaPerPost?(i(),v(w,{key:0,additionalData:{resize:!0,context:o.context,max_width:1400},isMultiple:o.config.multipleMedia,onUploading:t[5]||(t[5]=()=>{s.uploading=!0}),onCompleted:t[6]||(t[6]=()=>{s.uploading=!1}),onUploaded:n.handleMediaUpload},{default:r(()=>[a(y,{"aria-label":"Upload Media",loading:s.uploading,text:""},{default:r(()=>[a($,{class:"fcom_status_img_icon"},{default:r(()=>[a(f)]),_:1}),s.uploading?(i(),c("span",Cc,d(e.$t("Uploading...")),1)):_("",!0)]),_:1},8,["loading"])]),_:1},8,["additionalData","isMultiple","onUploaded"])):_("",!0),o.config.videoApp&&e.hasFeature("video_embeder")?(i(),v(C,{key:1,space:o.config.spaceSlug,is_admin:o.config.is_admin,onEmbeded:n.handleVideoAttachment},null,8,["space","is_admin","onEmbeded"])):_("",!0),o.config.documentsApp&&o.config.space_id?(i(),v(y,{key:2,"aria-label":e.$t("Add Documents"),title:e.$t("Upload Documents"),text:"",onClick:t[7]||(t[7]=Q=>o.content.content_type="document")},{default:r(()=>[a($,{class:R(["fcom_apps_icon"])},{default:r(()=>[a(M)]),_:1})]),_:1},8,["aria-label","title"])):_("",!0),o.config.surveyApp&&e.hasFeature("has_survey_poll")?(i(),v(y,{key:3,"aria-label":"Create Poll",onClick:n.initSurveyForm,text:""},{default:r(()=>[a($,{class:"fcom_apps_icon"},{default:r(()=>[a(P)]),_:1})]),_:1},8,["onClick"])):_("",!0),e.hasFeature("emoji_app")?(i(),v(T,{key:4,onEmojiSelected:n.insertEmoji},null,8,["onEmojiSelected"])):_("",!0),e.hasFeature("giphy_app")?(i(),v(I,{key:5,onSelectedGiphy:n.selectedGiphy},null,8,["onSelectedGiphy"])):_("",!0)],64))]),l("div",$c,[z(e.$slots,"default")])])),[[U,s.uploading]]),z(e.$slots,"after_composer_footer")],64)}const lt=F(lc,[["render",Sc]]),Vc={name:"ImageCarousel",props:["feed","is_single"],computed:{srcList(){return this.feed.meta.media_items.map(e=>e.url)},visibleMedia(){return this.feed.meta.media_items.map((e,t)=>({url:e.url,type:e.type,index:t})).slice(0,4)},overflowCount(){return this.srcList.length>4?this.srcList.length-4:0},carouselClass(){const e=this.srcList.length;return e===1?"fcom_image_carousel_num_1":e===3?"fcom_image_carousel_num_3":e===2||e===4||e>4?"fcom_image_carousel_num_2_or_4":""}},methods:{getVideoType(e){switch(e.split(".").pop().toLowerCase()){case"mp4":return"video/mp4";case"webm":return"video/webm";case"ogg":case"ogv":return"video/ogg";default:return"video/mp4"}},isOverflowSlot(e){return e===3&&this.feed.meta.media_items.length>4}}},Lc={class:"fcom_image_carousel"},Mc={key:0},Pc=["preload","poster"],Fc=["src","type"],Tc={key:1,class:"fcom_image_wrap"},Ic={key:0,class:"fcom_image_overlay"};function Uc(e,t,o,u,s,n){const m=Pe;return i(),c("div",Lc,[l("div",{class:R([n.carouselClass+" "+o.feed.type,"fcom_image_carousel__container"])},[(i(!0),c(V,null,D(n.visibleMedia,(p,h)=>(i(),c("div",{class:R(["fcom_carousel__image","fcom_media_type_"+p.type])},[p.type==="video"?(i(),c("div",Mc,[l("video",{style:{width:"100%","aspect-ratio":"16/9"},controls:"",preload:o.is_single?"":"none",poster:p.thumbnail},[l("source",{src:p.url,type:n.getVideoType(p.url)},null,8,Fc)],8,Pc)])):(i(),c("div",Tc,[a(m,{lazy:"",alt:"",src:p.url,"zoom-rate":1.2,"max-scale":7,"min-scale":.5,"hide-on-click-modal":!0,"preview-teleported":!0,"initial-index":p.index,"preview-src-list":n.srcList,fit:"cover"},null,8,["src","initial-index","preview-src-list"]),n.isOverflowSlot(h)?(i(),c("div",Ic,"+"+d(n.overflowCount),1)):_("",!0)]))],2))),256))],2)])}const Vt=F(Vc,[["render",Uc]]),Bc={name:"ErrorIcon"},Ec={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"rgb(245 166 7)","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"h-3 w-3 ltr:mr-2 rtl:ml-2"},Ac=l("circle",{cx:"12",cy:"12",r:"10"},null,-1),Dc=l("line",{x1:"12",x2:"12",y1:"16",y2:"12"},null,-1),Rc=l("line",{x1:"12",x2:"12.01",y1:"8",y2:"8"},null,-1),Hc=[Ac,Dc,Rc];function xc(e,t,o,u,s,n){return i(),c("svg",Ec,Hc)}const Ts=F(Bc,[["render",xc]]),jc={name:"ReportReview",components:{ErrorIcon:Ts},props:{feed:{type:Object,required:!0},type:{type:String,default:"post"}},methods:{openReportDetails(){this.$eventBus.emit("showReportReviewModal",{content:this.feed,type:this.type})}}},Oc={class:"fcom_feed_report_wrap"},Nc={class:"fcom_feed_report_content"},zc={key:0},qc={key:1},Gc={key:2},Yc={class:"fcom_feed_report_action"};function Zc(e,t,o,u,s,n){const m=g("ErrorIcon"),p=j;return i(),c("div",Oc,[l("div",Nc,[a(m),o.feed.meta.auto_flagged=="yes"?(i(),c("span",zc,d(e.$t("This %s has been flagged automatically by the site rule.",o.type)),1)):o.feed.meta.reports_count>1?(i(),c("span",qc,d(e.$t("This %1$s has been flagged with %2$s reports",o.type,o.feed.meta.reports_count)),1)):(i(),c("span",Gc,d(e.$t("This %1$s has been flagged with %2$s report",o.type,o.feed.meta.reports_count)),1))]),l("div",Yc,[a(p,{onClick:t[0]||(t[0]=h=>n.openReportDetails())},{default:r(()=>[S(d(e.$t("Review")),1)]),_:1})])])}const Is=F(jc,[["render",Zc]]),Wc={name:"StickyIcon"},Jc={viewBox:"0 0 24 24","aria-hidden":"true",class:"r-4qtqp9 r-yyyyoo r-dnmrzs r-bnwqim r-lrvibr r-m6rgpd r-14j79pv r-10ptun7 r-1janqcz"},Qc=l("g",null,[l("path",{d:"M7 4.5C7 3.12 8.12 2 9.5 2h5C15.88 2 17 3.12 17 4.5v5.26L20.12 16H13v5l-1 2-1-2v-5H3.88L7 9.76V4.5z"})],-1),Kc=[Qc];function Xc(e,t,o,u,s,n){return i(),c("svg",Jc,Kc)}const Lt=F(Wc,[["render",Xc]]),ed={name:"FeedMdContent",props:["content","class_name"],data(){return{hoverTimeout:null,lightboxImages:[],lightboxIndex:0}},watch:{content(){this.$nextTick(()=>{this.cleanupListeners(),this.setupListeners()})}},methods:{setupListeners(){const e=this.$refs.content;if(!e)return;const t=/\/u\/([^\/]+)\/?$/;e.querySelectorAll("a").forEach(o=>{const u=o.getAttribute("href"),s=(u==null?void 0:u.startsWith(this.appVars.portal_url))&&u.match(t);if(!s)return;const n=s[1];o._mentionEnter=()=>{clearTimeout(this.hoverTimeout),this.hoverTimeout=setTimeout(()=>{this.$eventBus.emit("show_mention_popover",{username:n,triggerElement:o})},500)},o._mentionLeave=()=>{clearTimeout(this.hoverTimeout),this.$eventBus.emit("hide_mention_popover")},o.addEventListener("mouseenter",o._mentionEnter),o.addEventListener("mouseleave",o._mentionLeave)}),this._lightboxHandler=o=>{const u=o.target.closest('img[src^="http"]');if(!u)return;o.preventDefault();const s=Array.from(e.querySelectorAll('img[src^="http"]')).map(n=>n.src);this.lightboxImages=s,this.lightboxIndex=Math.max(0,s.indexOf(u.src))},e.addEventListener("click",this._lightboxHandler)},cleanupListeners(){const e=this.$refs.content;e&&(e.querySelectorAll("a").forEach(t=>{t._mentionEnter&&(t.removeEventListener("mouseenter",t._mentionEnter),t.removeEventListener("mouseleave",t._mentionLeave))}),clearTimeout(this.hoverTimeout),this._lightboxHandler&&(e.removeEventListener("click",this._lightboxHandler),this._lightboxHandler=null))}},mounted(){this.$nextTick(()=>this.setupListeners())},beforeUnmount(){this.cleanupListeners()}},td=["innerHTML"];function sd(e,t,o,u,s,n){const m=hs;return i(),c(V,null,[l("div",{ref:"content",class:R(["feed_md_content",o.class_name]),innerHTML:o.content},null,10,td),s.lightboxImages.length?(i(),v(m,{key:0,"url-list":s.lightboxImages,"initial-index":s.lightboxIndex,"hide-on-click-modal":!0,onClose:t[0]||(t[0]=p=>s.lightboxImages=[])},null,8,["url-list","initial-index"])):_("",!0)],64)}const Mt=F(ed,[["render",sd]]),od={name:"SingleComment",components:{ImageCarousel:Vt,FeedTextComposer:lt,MediaPreview:Be,ReportReview:Is,StickyIcon:Lt,FeedMdContent:Mt},props:{comment:{type:Object,required:!0},show_header:{type:Boolean,default:!0},show_report:{type:Boolean,default:!1},space_id:{type:String,default:null}},emits:["deleted","updated","reload","copyLink"],data(){return{working:!1,isEdit:!1,editingComment:null,focusTrigger:0}},computed:{isReportEnabled(){return this.has_pro&&this.appVars.moderationConfig.is_enabled},showReport(){var e;return this.hasSpaceModeratorAccess()&&this.isReportEnabled&&this.show_report&&((e=this.comment.meta)==null?void 0:e.reports_count)},showReportOption(){return!(this.comment.user_id==this.auth.user_id)&&this.auth.user_id&&this.isReportEnabled},showStickyOption(){return!this.comment.parent_id&&this.hasSpaceModeratorAccess()},getReportComment(){return{...this.comment,space_id:this.space_id}}},methods:{maybeSave(e){(e.metaKey||e.ctrlKey)&&e.keyCode===13&&this.updateComment()},deleteComment(){this.$confirm(this.$t("Are you sure you want to delete this comment and associated data?"),this.$t("Warning"),{confirmButtonText:this.$t("Delete"),cancelButtonText:this.$t("Cancel"),confirmButtonClass:"fcom_primary_button",cancelButtonClass:"fcom_secondary_button",type:"warning"}).then(()=>{this.working=!0,this.$del("feeds/"+this.comment.post_id+"/comments/"+this.comment.id).then(e=>{this.$emit("deleted"),this.$notify.success(e.message)}).catch(e=>{this.$handleError(e)}).finally(()=>{this.working=!1})})},editComment(){this.working=!0,this.$get(`comments/${this.comment.id}`,{context:"edit"}).then(e=>{this.editingComment=e.comment,this.isEdit=!0}).catch(e=>{this.$handleError(e)}).finally(()=>{this.working=!1,this.$refs.comment_actions.hide()})},updateComment(){var e;if(!((e=this.editingComment.message)!=null&&e.replace(/&#x20;|\u00A0/gi,"").trim())){this.$notify.error(this.$t("Comment cannot be empty")),this.focusTrigger++;return}this.working=!0,this.isEdit=!0,this.$post(`feeds/${this.comment.post_id}/comments/${this.comment.id}`,{comment:this.editingComment.message,media_images:this.editingComment.media_images,meta:this.editingComment.meta}).then(t=>{this.$notify.success((t==null?void 0:t.message)||this.$t("Comment updated successfully")),Object.assign(this.comment,t.comment),this.comment.is_sticky=parseInt(this.comment.is_sticky),this.comment.media_images=[]}).catch(t=>{this.$handleError(t),this.focusTrigger++}).finally(()=>{this.isEdit=!1,this.working=!1})},toggleSticky(){this.working=!0,this.comment.is_sticky=!this.comment.is_sticky,this.$patch("feeds/"+this.comment.post_id+"/comments/"+this.comment.id,{is_sticky:this.comment.is_sticky?1:0}).then(e=>{this.$notify.success(e.message),this.$emit("reload")}).catch(e=>{this.$handleError(e)}).finally(()=>{this.working=!1})},renderedComment(e){const o=/(?:https?:\/\/)?(?:www\.)?youtube\.com\/watch\?v=([a-zA-Z0-9_-]+)/.exec(e);if(o&&o[1]){let n=o[1];if(n){let m=`<div class="feed_media_ext_video"><iframe src="https://www.youtube.com/embed/${n}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>`;e+=m}}let u=window.location.origin,s=new RegExp(u,"g");return e=e.replace(/<a(.*?)href="(.*?)"(.*?)>/g,(n,m,p,h)=>p.match(s)?`<a${m}href="${p}"${h}>`:`<a${m}href="${p}" target="_blank"${h}>`),e},copyCommentLink(e){this.$emit("copyLink",e),this.$refs.comment_actions.hide()},reportComment(e){this.$refs.comment_actions.hide(),this.$eventBus.emit("showReportContentModal",{reportConfig:e,type:"comment"})},reportUpdated(e){e.status=="unpublished"?this.$emit("deleted"):this.$emit("updated")}},mounted(){this.comment.is_sticky=parseInt(this.comment.is_sticky)}},id={key:1,class:"person_avatar"},nd={class:"comment_wrap"},ld={key:0,class:"comment_text"},ad={key:0,class:"comment_text_head"},rd={class:"comment_text_head_name"},cd=["title"],dd={key:0,class:"comment_text_head_status"},ud={class:"comment_actions"},_d={class:"actions_items"},md={key:1,class:"comment_text_media"},hd={key:2,class:"comment_text_media"};function fd(e,t,o,u,s,n){const m=g("ReportReview"),p=g("UserAvatar"),h=g("UserRouteLink"),y=Oe,k=g("StickyIcon"),b=O,$=j,f=g("MoreFilled"),w=de,C=g("FeedMdContent"),M=g("MediaPreview"),P=g("ImageCarousel"),T=g("feed-text-composer"),I=K("loading");return i(),c(V,null,[n.showReport?(i(),v(m,{key:0,feed:n.getReportComment,type:"comment",onUpdated:n.reportUpdated},null,8,["feed","onUpdated"])):_("",!0),o.show_header&&o.comment.xprofile?(i(),c("div",id,[a(p,{with_level:!1,xprofile:o.comment.xprofile,is_rounded:!0},null,8,["xprofile"])])):_("",!0),N((i(),c("div",nd,[s.isEdit?(i(),c("div",{key:1,onKeydown:t[10]||(t[10]=be((...U)=>n.maybeSave&&n.maybeSave(...U),["enter"])),class:"comment_text"},[a(T,{context:"comment",config:{multipleMedia:!0},placeholder:e.$t("Write a comment"),content:s.editingComment,autofocus:!0,autofocus_changed:s.focusTrigger,onUpdated:t[9]||(t[9]=U=>s.isEdit=!1)},{default:r(()=>[l("div",null,[a($,{onClick:t[7]||(t[7]=U=>s.isEdit=!1),class:"fcom_secondary_button"},{default:r(()=>[S(d(e.$t("Cancel")),1)]),_:1}),a($,{class:"fcom_primary_button",onClick:t[8]||(t[8]=U=>n.updateComment(s.editingComment))},{default:r(()=>[S(d(e.$t("Update")),1)]),_:1})])]),_:1},8,["placeholder","content","autofocus_changed"])],32)):(i(),c("div",ld,[o.show_header?(i(),c("div",ad,[l("div",rd,[a(h,{show_badge:!0,xprofile:o.comment.xprofile,show_follow:!0},null,8,["xprofile"])]),l("div",{title:o.comment.created_at,class:"comment_text_head_time"},d(e.humanDateDiff(o.comment.created_at)),9,cd),o.comment.status=="pending"?(i(),c("div",dd,[a(y,{type:"warning"},{default:r(()=>[S(d(e.$t("In Review")),1)]),_:1})])):_("",!0),l("div",ud,[o.comment.is_sticky?(i(),v($,{key:0,onClick:t[0]||(t[0]=U=>n.toggleSticky()),"aria-label":e.$t("Toggle Sticky"),class:"no_pad_btn",text:"",size:"small"},{default:r(()=>[a(b,{title:e.$t("Unpin from Top"),class:"fcom_sticky"},{default:r(()=>[a(k)]),_:1},8,["title"])]),_:1},8,["aria-label"])):_("",!0),a(w,{persistent:!1,placement:"bottom",ref:"comment_actions",width:200,trigger:"click"},{reference:r(()=>[a($,{"aria-label":e.$t("View comment actions"),class:"fcom_dot_menu",size:"small",text:""},{default:r(()=>[a(b,null,{default:r(()=>[a(f)]),_:1})]),_:1},8,["aria-label"])]),default:r(()=>[l("ul",_d,[l("li",{onClick:t[1]||(t[1]=U=>n.copyCommentLink(o.comment))},d(e.$t("Copy Link")),1),n.showStickyOption?(i(),c(V,{key:0},[o.comment.is_sticky?(i(),c("li",{key:0,onClick:t[2]||(t[2]=U=>n.toggleSticky())},d(e.$t("Unpin from Top")),1)):(i(),c("li",{key:1,onClick:t[3]||(t[3]=U=>n.toggleSticky())},d(e.$t("Pin to Top")),1))],64)):_("",!0),n.showReportOption?(i(),c("li",{key:1,onClick:t[4]||(t[4]=U=>n.reportComment(o.comment))},d(e.$t("Report Comment")),1)):_("",!0),e.canEditComment(o.comment)?(i(),c("li",{key:2,onClick:t[5]||(t[5]=U=>n.editComment())},d(e.$t("Edit")),1)):_("",!0),e.canDeleteComment(o.comment)?(i(),c("li",{key:3,onClick:t[6]||(t[6]=U=>n.deleteComment())},d(e.$t("Delete")),1)):_("",!0)])]),_:1},512)])])):_("",!0),a(C,{class_name:"comment_text_body",content:n.renderedComment(o.comment.message_rendered)},null,8,["content"]),o.comment.meta.media_preview?(i(),c("div",md,[a(M,{media_item:o.comment.meta.media_preview},null,8,["media_item"])])):o.comment.meta.media_items?(i(),c("div",hd,[o.comment.meta.media_items?(i(),v(P,{key:0,feed:o.comment},null,8,["feed"])):_("",!0)])):_("",!0)])),z(e.$slots,"after_comment_text")])),[[I,s.working]])],64)}const Us=F(od,[["render",fd]]);function Y(e){return window.fluentComAdmin.i18n[e]||e}const Bs={public:{label:Y("Public"),description:Y("__PUBLIC_SPACE_DESC"),space_description:Y("__PIBLIC_SPACE_DESC_2")},private:{label:Y("Private"),description:Y("__PRIVATE_SPACE_DESC"),space_description:Y("__PRIVATE_SPACE_DESC_2")},secret:{label:Y("Secret"),description:Y("Only invited members can view and post."),space_description:Y("__SECRET_SPACE_DESC_2")}},pd={public:{label:Y("Public"),description:Y("Anyone can view and enroll the course for free")},private:{label:Y("Private"),description:Y("__PRIVATE_COURSE_DESC")},secret:{label:Y("Secret"),description:Y("Only invited students can view and enroll the course content.")}},gd={self_paced:{label:Y("Self Paced"),description:Y("__SELF_PAED_COURSE_DESC")},structured:{label:Y("Structured"),description:Y("__STRUCTURED_COURSE_DESC")},scheduled:{label:Y("Scheduled"),description:Y("Course starts on a specific date. Sections are dripped relative to that date.")}};Y("Leaderboard Settings"),Y("Settings for Leaderboard & Gamification features"),Y("Get Leaderboard & Gamification Module"),Y("Unlock potential by creating new feeds and earning points for likes. Advance in rank based on your total points using this module"),Y("Emoji Module"),Y("Settings for Emoji & Reaction features"),Y("Get Emoji & Reaction Module"),Y("Use emojis to add a personal touch and make your new article, post, or comment more expressive"),Y("Giphy Module"),Y("Customize Your Giphy Module Settings"),Y("Get Giphy Module"),Y("Want to use awesome GIFs? Upgrade to Pro plan now and enjoy surfing on FluentCommunity"),Y("User Badge Module"),Y("Add a badge next to user profile name to highlight valued users"),Y("Get User Badge Module"),Y("Show a customized badge on user profiles beside their names to easily recognize your admins or moderators, or to give appreciation to your power users."),Y("Media Module"),Y("Add a badge next to user profile name to highlight valued users"),Y("Get Media Module"),Y("Choose where to store your media files. Options include Local File System, Amazon S3, or Cloudflare R2 for storing and serving your media assets");const Fe=e=>{e=parseInt(e);const t=Object.values(window.fluentComAdmin.leaderboard_levels);if(!e)return t[0];for(let o=0;o<t.length;o++)if(e>=t[o].min_points&&e<=t[o].max_points)return t[o];return t[t-1]},yd={name:"SocialLinks",props:["xprofile","isOwn"],computed:{hasSocialLinks(){return this.socialLinks.length>0},socialLinks(){var u;if(!this.xprofile)return[];const e=[];this.xprofile.website&&e.push({title:this.$t("Website"),icon:'<svg viewBox="0 0 40 20" fill="currentColor"><path d="M3.8 10C3.8 6.58 6.58 3.8 10 3.8H18V0H10C4.48 0 0 4.48 0 10C0 15.52 4.48 20 10 20H18V16.2H10C6.58 16.2 3.8 13.42 3.8 10ZM12 12H28V8H12V12ZM30 0H22V3.8H30C33.42 3.8 36.2 6.58 36.2 10C36.2 13.42 33.42 16.2 30 16.2H22V20H30C35.52 20 40 15.52 40 10C40 4.48 35.52 0 30 0Z"></path></svg>',url:this.xprofile.website});let t=this.xprofile.social_links;if(t||(t=(u=this.xprofile.meta)==null?void 0:u.social_links),qt(t))return e;const o=this.appVars.socialLinkProviders;return o&&this.each(o,(s,n)=>{t[n]&&e.push({title:s.title,icon:s.icon_svg,url:s.domain+t[n]})}),e}}},vd={key:0,class:"fcom_social_links"},bd=["href","title"];function kd(e,t,o,u,s,n){const m=O,p=g("router-link");return n.hasSocialLinks?(i(),c("div",vd,[(i(!0),c(V,null,D(n.socialLinks,h=>(i(),c("a",{rel:"noopener nofollow",target:"_blank",href:h.url,key:h.title,title:h.title},[a(m,{innerHTML:h.icon},null,8,["innerHTML"])],8,bd))),128)),o.isOwn&&!n.hasSocialLinks?(i(),v(p,{key:0,to:{name:"update_profile",params:{username:o.xprofile.username}}},{default:r(()=>[S(d("+ "+e.$t("Add social links")),1)]),_:1},8,["to"])):_("",!0)])):_("",!0)}const at=F(yd,[["render",kd]]),wd={name:"FollowAction",props:{profile:{type:Object,required:!0},followButtonText:{type:String,default:""}},emits:["refetch"],setup(){return{userStore:Te()}},data(){return{loading:!1,hovering:!1,followBtnText:this.followButtonText||this.$t("Follow")}},computed:{isFollowing(){var e,t;if((e=this.profile)!=null&&e.user_id){if(this.userStore.isFollowing(this.profile.user_id))return!0;const o=(t=this.profile)==null?void 0:t.follow;return o!==void 0&&["1","2"].includes(String(o))}return!1},showFollowAction(){var o;const e=(o=this.profile)==null?void 0:o.user_id,t=this.auth.user_id;return this.hasFeature("followers_module")&&e&&t&&e!=t},isBlocked(){var e,t;if((e=this.profile)!=null&&e.user_id){if(this.userStore.isBlocked(this.profile.user_id))return!0;const o=(t=this.profile)==null?void 0:t.follow;return o!==void 0&&String(o)==="0"}return!1}},methods:{confirmUnfollow(){this.unfollowUser()},async followUser(){this.loading=!0;try{await this.userStore.toggleFollow(this.profile.user_id,this.profile.username),this.$notify.success(this.$t("Successfully followed user")),this.$emit("refetch")}catch(e){this.$handleError(e)}finally{this.loading=!1}},async unfollowUser(){this.loading=!0;try{await this.userStore.toggleFollow(this.profile.user_id,this.profile.username),this.$notify.success(this.$t("Successfully unfollowed user")),this.$emit("refetch")}catch(e){this.$handleError(e)}finally{this.loading=!1}},unblockUser(){this.loading=!0,this.$post("profile/"+this.profile.username+"/unblock").then(e=>{this.userStore.removeFollow(this.profile.user_id),this.$notify.success(e.message)}).finally(()=>{this.loading=!1})}}},Cd={key:0},$d={key:1},Sd={key:0},Vd={key:1};function Ld(e,t,o,u,s,n){const m=j;return n.showFollowAction?(i(),c(V,{key:0},[n.isBlocked?(i(),v(m,{key:0,class:"fcom_secondary_button danger_button",loading:s.loading,disabled:s.loading,style:{"min-width":"90px","max-height":"30px"},onClick:n.unblockUser,onMouseenter:t[0]||(t[0]=p=>s.hovering=!0),onMouseleave:t[1]||(t[1]=p=>s.hovering=!1)},{default:r(()=>[s.hovering?(i(),c("span",$d,d(e.$t("Unblock")),1)):(i(),c("span",Cd,d(e.$t("Blocked")),1))]),_:1},8,["loading","disabled","onClick"])):n.isFollowing?(i(),v(m,{key:1,onClick:n.confirmUnfollow,class:R(["fcom_secondary_button",{danger_button:s.hovering}]),style:{"min-width":"95px","max-height":"30px"},loading:s.loading,disabled:s.loading,onMouseenter:t[2]||(t[2]=p=>s.hovering=!0),onMouseleave:t[3]||(t[3]=p=>s.hovering=!1)},{default:r(()=>[s.hovering?(i(),c("span",Vd,d(e.$t("Unfollow")),1)):(i(),c("span",Sd,d(e.$t("Following")),1))]),_:1},8,["onClick","class","loading","disabled"])):(i(),v(m,{key:2,onClick:n.followUser,class:"fcom_color_button",style:{"max-height":"30px"},loading:s.loading,disabled:s.loading},{default:r(()=>[l("span",null,d(s.followBtnText),1)]),_:1},8,["onClick","loading","disabled"]))],64)):_("",!0)}const Ye=F(wd,[["render",Ld]]),Md={name:"UserRouteLink",props:{xprofile:{default:()=>({})},show_pop:{type:Boolean,default:!0},show_badge:{type:Boolean,default:!1},show_verified:{type:Boolean,default:!0},show_follow:{type:Boolean,default:!1},virtualRef:{default:null}},emits:["popover-mouseenter","popover-mouseleave"],components:{SocialLinks:at,FollowAction:Ye},data(){return{showingPop:!1,userLevel:null}},methods:{initShow(){this.showingPop=!0,this.has_leaderboard&&!this.userLevel&&(this.userLevel=Fe(this.xprofile.total_points))}}},Pd=["href"],Fd={class:"fcom_user_display_name"},Td=["href"],Id={class:"fcom_user_display_name"},Ud={class:"fcom_profile_pop_avatar"},Bd={key:0,class:"fcom_prfile_tagline"},Ed={class:"fcom_level_name"},Ad={style:{display:"block"},class:"fcoml_level_sub meta_line"},Dd={class:"fcom_profile_pop_info"},Rd={class:"pop_info_header"},Hd={class:"header_name"},xd=["href"],jd={class:"fcom_user_display_name"},Od={class:"fcom_user_name"},Nd={key:0,class:"header_actions"},zd={key:0,class:"fcom_profile_pop_bio"},qd=["title"],Gd=["title"],Yd={class:"pop_info_btns"},Zd=["href"],Wd=["href"];function Jd(e,t,o,u,s,n){const m=g("verified-sign"),p=g("UserBadge"),h=g("UserAvatar"),y=et,k=g("follow-action"),b=g("SocialLinks"),$=tt,f=de;return o.show_pop?(i(),v(f,{key:1,visible:o.virtualRef?!0:null,"virtual-ref":o.virtualRef,"virtual-triggering":!!o.virtualRef,width:500,"show-after":o.virtualRef?0:500,trigger:o.virtualRef?null:"hover",onShow:n.initShow,persistent:!1,"popper-class":"fcom_profile_popper","popper-style":"padding: 0;"},{reference:r(()=>[z(e.$slots,"default",{},()=>[l("a",{href:e.$getRouteLink("u/:username",{username:o.xprofile.username}),class:"user_route"},[l("p",Id,d(o.xprofile.display_name),1),o.show_verified&&o.xprofile.is_verified?(i(),v(m,{key:0})):_("",!0),o.show_badge?(i(),v(p,{key:1,profile:o.xprofile},null,8,["profile"])):_("",!0)],8,Td)])]),default:r(()=>[o.virtualRef||s.showingPop?(i(),c("div",{key:0,class:"fcom_profile_pop",onMouseenter:t[0]||(t[0]=w=>o.virtualRef&&e.$emit("popover-mouseenter")),onMouseleave:t[1]||(t[1]=w=>o.virtualRef&&e.$emit("popover-mouseleave"))},[o.xprofile&&o.xprofile.username?(i(),v($,{key:0,gutter:20},{default:r(()=>[a(y,{sm:24,md:8},{default:r(()=>[l("div",Ud,[a(h,{xprofile:o.xprofile},null,8,["xprofile"]),s.userLevel?(i(),c("div",Bd,[l("div",Ed,d(s.userLevel.title),1),l("div",Ad,d(s.userLevel.tagline),1)])):_("",!0)])]),_:1}),a(y,{sm:24,md:16},{default:r(()=>[l("div",Dd,[l("div",Rd,[l("div",Hd,[l("a",{href:e.$getRouteLink("u/:username",{username:o.xprofile.username}),class:"user_route"},[l("p",jd,d(o.xprofile.display_name),1),o.xprofile.is_verified?(i(),v(m,{key:0})):_("",!0),o.show_badge?(i(),v(p,{key:1,profile:o.xprofile},null,8,["profile"])):_("",!0)],8,xd),l("span",Od," @"+d(o.xprofile.username),1)]),o.show_follow?(i(),c("div",Nd,[a(k,{profile:o.xprofile},null,8,["profile"])])):_("",!0)]),o.xprofile.short_description||o.xprofile.short_description_rendered?(i(),c("div",zd,d(e.getExcerpt(o.xprofile.short_description||o.xprofile.short_description_rendered,160)),1)):_("",!0),o.xprofile.created_at?(i(),c("div",{key:1,title:o.xprofile.created_at,class:"meta_line"},d(e.$t("Joined: %s",e.humanDateDiff(o.xprofile.created_at))),9,qd)):_("",!0),o.xprofile.last_activity?(i(),c("div",{key:2,title:o.xprofile.last_activity,class:"meta_line"},d(e.$t("Last seen: %s",e.humanDateDiff(o.xprofile.last_activity))),9,Gd)):_("",!0),l("div",Yd,[l("a",{class:"el-button el-button--primary is-text is-has-bg",href:e.$getRouteLink("u/:username",{username:o.xprofile.username})},d(e.$t("View Profile")),9,Zd),e.appVars.has_chat&&e.hasPermission("can_initiate_message")?(i(),c("a",{key:0,class:"el-button el-button--primary is-text is-has-bg",href:e.$getRouteLink("chat/?user_id=:user_id",{user_id:o.xprofile.user_id})},d(e.$t("Message")),9,Wd)):_("",!0)]),a(b,{style:{"justify-content":"left"},xprofile:o.xprofile,isOwn:!1},null,8,["xprofile"])])]),_:1})]),_:1})):_("",!0)],32)):_("",!0)]),_:3},8,["visible","virtual-ref","virtual-triggering","show-after","trigger","onShow"])):(i(),c("a",{key:0,href:e.$getRouteLink("u/:username",{username:o.xprofile.username}),class:"user_route"},[z(e.$slots,"default",{},()=>[l("p",Fd,d(o.xprofile.display_name),1),o.show_verified&&o.xprofile.is_verified?(i(),v(m,{key:0})):_("",!0),o.show_badge?(i(),v(p,{key:1,profile:o.xprofile},null,8,["profile"])):_("",!0)])],8,Pd))}const Le=F(Md,[["render",Jd]]),Qd={name:"CommentReacts",components:{UserRouteLink:Le},data(){return{centerDialogVisible:!1,reactions:null,loading:!1}},props:{comment:{required:!0,default:null}},methods:{getReactions(){this.reactions||(this.loading=!0,this.$get("comments/"+this.comment.id+"/reactions").then(e=>{this.reactions=e.reactions,e.current_user_follows&&this.setFollowIds(e.current_user_follows)}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1}))}}},Kd={style:{"margin-left":"5px"}},Xd={key:0},eu={key:1},tu={class:"fcom_user_lists"},su={key:2};function ou(e,t,o,u,s,n){const m=q,p=g("UserAvatar"),h=g("UserRouteLink"),y=fe,k=de;return i(),v(k,{persistent:!1,placement:"bottom",title:e.$t("Likes"),width:200,trigger:"click",onShow:n.getReactions},{reference:r(()=>[l("span",Kd,d(o.comment.reactions_count),1)]),default:r(()=>[s.loading?(i(),c("div",Xd,[a(m,{animated:!0,rows:1})])):s.reactions?(i(),c("div",eu,[a(y,{"max-height":"300px"},{default:r(()=>[l("ul",tu,[(i(!0),c(V,null,D(s.reactions,b=>(i(),c("li",null,[b.xprofile?(i(),c(V,{key:0},[a(p,{with_level:!1,xprofile:b.xprofile},null,8,["xprofile"]),a(h,{show_badge:!0,xprofile:b.xprofile,show_follow:!0},null,8,["xprofile"])],64)):_("",!0)]))),256))])]),_:1})])):(i(),c("div",su,[l("p",null,d(e.$t("Failed to load the list")),1)]))]),_:1},8,["title","onShow"])}const iu=F(Qd,[["render",ou]]),nu={name:"NestedReplyBox",components:{SingleComment:Us,FeedTextComposer:lt,CommentReactions:iu,HeartIcon:qe},props:["comment","feed","checkPermission","show_reacts_only","defaultMentions"],emits:["commented","copyLink"],data(){return{open:!1,commentReply:{message:"",media_images:[]},submitting:!1}},computed:{canComment(){return this.hasCommentPermission(this.feed)||!this.checkPermission}},methods:{maybeSave(e){(e.metaKey||e.ctrlKey)&&e.keyCode===13&&this.addComment()},addComment(){!this.commentReply.message||!this.comment.id||(this.submitting=!0,this.$post("feeds/"+this.feed.id+"/comments",{comment:this.commentReply.message,parent_id:this.comment.id,media_images:this.commentReply.media_images,meta:this.commentReply.meta}).then(e=>{this.comment.comments||(this.comment.comments=[]),this.commentReply={message:"",media_images:[]},this.comment.comments.push(e.comment),this.$emit("commented",e.comment),this.feed.comments_count=parseInt(this.feed.comments_count)+1,this.open=!1}).catch(e=>{this.$handleError(e)}).finally(()=>{this.submitting=!1}))},toggleCommentBox(e){var o;if(!this.hasCommentPermission(this.feed)){this.$notify({message:this.$t("Please join the Space to post a comment."),type:"warning"});return}this.open=!this.open;let t=(o=e==null?void 0:e.xprofile)==null?void 0:o.username;this.open&&t&&e.user_id!=this.auth.user_id&&(this.commentReply.message=`@${t}&nbsp;`)},handleCommentDelete(e){this.comment.comments.splice(e,1),this.feed.comments_count--},toggleLike(e){let t=!e.liked;this.$post("feeds/"+this.feed.id+"/comments/"+e.id+"/reactions",{state:t?1:0}).then(o=>{e.liked=o.liked,e.reactions_count=o.reactions_count}).catch(o=>{this.$handleError(o)})},emitCopyLink(e){this.$emit("copyLink",e)}}},lu={key:0,class:"reply_box"},au={class:"fcom_comments_react fcom_reaction_list"},ru={class:"child_comments"},cu=["id"],du={key:0,class:"reply_box"},uu=["onClick"],_u={class:"fcom_comments_react fcom_reaction_list"},mu={key:0,class:"child_reply_wrap"},hu={class:"feed_commenting"},fu={class:"person_avatar"},pu=["alt","src"];function gu(e,t,o,u,s,n){var $;const m=g("HeartIcon"),p=O,h=g("CommentReactions"),y=g("single-comment"),k=j,b=g("feed-text-composer");return i(),c(V,null,[n.canComment?(i(),c("div",lu,[(($=o.feed.meta)==null?void 0:$.comments_disabled)!=="yes"?(i(),c("span",{key:0,onClick:t[0]||(t[0]=f=>n.toggleCommentBox(o.comment)),class:"reply_btn"},d(e.$t("Reply")),1)):_("",!0),l("span",{class:R([{fcom_is_liked:o.comment.liked},"reply_btn"])},[l("div",au,[a(p,{class:R({user_reacted:o.comment.liked}),onClick:t[1]||(t[1]=f=>n.toggleLike(o.comment))},{default:r(()=>[a(m,{filled:o.comment.liked},null,8,["filled"])]),_:1},8,["class"]),parseInt(o.comment.reactions_count)?(i(),v(h,{key:0,comment:o.comment},null,8,["comment"])):_("",!0)])],2),z(e.$slots,"after_reply_box_text")])):_("",!0),!o.show_reacts_only||s.open?(i(),c(V,{key:1},[l("div",ru,[(i(!0),c(V,null,D(o.comment.comments,(f,w)=>(i(),c("div",{id:"comment_"+f.id,class:"each_comment"},[a(y,{onCopyLink:n.emitCopyLink,onDeleted:C=>n.handleCommentDelete(w),comment:f,show_report:!0},{after_comment_text:r(()=>{var C;return[n.canComment?(i(),c("div",du,[((C=o.feed.meta)==null?void 0:C.comments_disabled)!=="yes"?(i(),c("span",{key:0,onClick:M=>n.toggleCommentBox(f),class:"reply_btn"},d(e.$t("Reply")),9,uu)):_("",!0),l("span",{class:R([{fcom_is_liked:f.liked},"reply_btn"])},[l("div",_u,[a(p,{class:R({user_reacted:f.liked}),onClick:M=>n.toggleLike(f)},{default:r(()=>[a(m,{filled:f.liked},null,8,["filled"])]),_:2},1032,["class","onClick"]),parseInt(f.reactions_count)?(i(),v(h,{key:0,comment:f},null,8,["comment"])):_("",!0)])],2)])):_("",!0)]}),_:2},1032,["onCopyLink","onDeleted","comment"])],8,cu))),256))]),s.open?(i(),c("div",mu,[l("div",hu,[l("div",fu,[l("img",{alt:e.$t("Your Photo"),src:e.auth.avatar},null,8,pu)]),l("div",{onKeydown:t[3]||(t[3]=be((...f)=>n.maybeSave&&n.maybeSave(...f),["enter"])),class:"feed_comment_input comment_text"},[a(b,{config:{multipleMedia:!0},context:"comment",defaultMentions:o.defaultMentions?o.defaultMentions:[],disabled:s.submitting,autofocus:s.open,mentionQuery:{space_id:o.feed.space_id},content:s.commentReply,placeholder:e.$t("Leave a reply")},{default:r(()=>[a(k,{loading:s.submitting,disabled:s.submitting,onClick:t[2]||(t[2]=f=>n.addComment()),class:"fcom_primary_button"},{default:r(()=>[S(d(e.$t("Reply")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["defaultMentions","disabled","autofocus","mentionQuery","content","placeholder"])],32)])])):_("",!0)],64)):_("",!0)],64)}const yu=F(nu,[["render",gu]]),vu={name:"FeedComments",components:{SingleComment:Us,NestedReplyBox:yu},props:["feed","show_all","checkPermission","defaultMentions","sortBy","is_single"],emits:["forceShowAll"],data(){return{lastComment:null,loading:!1}},watch:{sortBy(){this.sortComments()}},methods:{fetchComments(){this.loading=!0,this.$get("feeds/"+this.feed.id+"/comments").then(e=>{this.feed.comments=e.comments,this.feed.sticky_comment=e.sticky_comment,this.formatComments(),this.feed.type=="text"&&this.$eventBus.emit("feed_interaction",this.feed.id)}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})},formatComments(){let e={},t=this.feed.comments,o=[];t.forEach(u=>{u.parent_id?o.push(u):e[u.id]=u}),o.forEach(u=>{e[u.parent_id]?(e[u.parent_id].comments||(e[u.parent_id].comments=[]),e[u.parent_id].comments.push(u)):this.feed.sticky_comment&&this.feed.sticky_comment.id==u.parent_id&&(this.feed.sticky_comment.comments||(this.feed.sticky_comment.comments=[]),this.feed.sticky_comment.comments.push(u))}),this.feed.comments=Object.values(e),this.lastComment=this.feed.sticky_comment||this.feed.comments[this.feed.comments.length-1]},handleCommentDelete(e){this.feed.comments.splice(e,1),this.feed.comments_count--,this.formatComments()},handleStickyCommentDelete(){this.feed.sticky_comment=null,this.feed.comments_count--},copyCommentLink(e){let t={name:"single_feed",params:{feed_slug:this.feed.slug},query:{comment_id:e.id}};this.feed.course_id&&(t={name:"view_lesson",params:{lesson_slug:this.feed.slug},query:{comment_id:e.id}});let o=this.$router.resolve(t),u=this.appVars.urls.portal_base;u=u.replace(/\/$/,"");let s=u+o.fullPath;navigator.clipboard.writeText(s).then(()=>{this.$notify.success(this.$t("Link copied to clipboard"))}).catch(n=>{this.$notify.error(this.$t("Failed to copy the link"))})},sortComments(){if(this.feed.comments)return this.sortBy=="oldest"||!this.sortBy?this.feed.comments=this.feed.comments.sort((e,t)=>e.id-t.id):this.sortBy=="latest"?this.feed.comments=this.feed.comments.sort((e,t)=>t.id-e.id):this.sortBy=="popular"?this.feed.comments=this.feed.comments.sort((e,t)=>t.reactions_count-e.reactions_count):this.sortBy=="most_replied"&&(this.feed.comments=this.feed.comments.sort((e,t)=>{var o,u;return(((o=t.comments)==null?void 0:o.length)||0)-(((u=e.comments)==null?void 0:u.length)||0)})),this.feed.comments},maybeShowAllComments(){if(this.is_single||!this.hasFeature("show_post_modal")){this.$emit("forceShowAll");return}this.$eventBus.emit("showFeedModal",{feed:this.feed,view:"comments"})}},mounted(){this.feed.comments?this.formatComments():this.feed.comments_count&&this.fetchComments()}},bu={key:0,class:"feed_comments"},ku=["id"],wu=["id"],Cu={key:1,class:"feed_comments"},$u={class:"each_comment"};function Su(e,t,o,u,s,n){const m=q,p=g("nested-reply-box"),h=g("single-comment");return o.show_all?(i(),c("div",bu,[s.loading?(i(),v(m,{key:0,row:5,class:"feed_comments_skeleton"})):(i(),c(V,{key:1},[z(e.$slots,"before_comments_start"),o.feed.sticky_comment?(i(),c("div",{class:"each_comment",key:o.feed.sticky_comment.id,id:"comment_"+o.feed.sticky_comment.id},[a(h,{comment:o.feed.sticky_comment,space_id:o.feed.space_id,show_report:!0,onCopyLink:n.copyCommentLink,onReload:n.fetchComments,onDeleted:t[0]||(t[0]=y=>n.handleStickyCommentDelete())},pe({_:2},[o.feed.sticky_comment.parent_id?void 0:{name:"after_comment_text",fn:r(()=>[a(p,{feed:o.feed,comment:o.feed.sticky_comment,checkPermission:o.checkPermission,defaultMentions:o.defaultMentions?o.defaultMentions:[],onCopyLink:n.copyCommentLink},null,8,["feed","comment","checkPermission","defaultMentions","onCopyLink"])]),key:"0"}]),1032,["comment","space_id","onCopyLink","onReload"])],8,ku)):_("",!0),(i(!0),c(V,null,D(o.feed.comments,(y,k)=>(i(),c("div",{class:"each_comment",key:y.id,id:"comment_"+y.id},[a(h,{comment:y,space_id:o.feed.space_id,show_report:!0,onCopyLink:n.copyCommentLink,onReload:n.fetchComments,onDeleted:b=>n.handleCommentDelete(k)},pe({_:2},[y.parent_id?void 0:{name:"after_comment_text",fn:r(()=>[a(p,{feed:o.feed,comment:y,checkPermission:o.checkPermission,defaultMentions:o.defaultMentions?o.defaultMentions:[],onCopyLink:n.copyCommentLink},null,8,["feed","comment","checkPermission","defaultMentions","onCopyLink"])]),key:"0"}]),1032,["comment","space_id","onCopyLink","onReload","onDeleted"])],8,wu))),128))],64))])):s.lastComment?(i(),c("div",Cu,[l("div",$u,[a(h,{comment:s.lastComment,space_id:o.feed.space_id,show_report:!0,onCopyLink:n.copyCommentLink,onDeleted:t[2]||(t[2]=y=>n.handleCommentDelete(o.feed.comments.length-1))},pe({_:2},[s.lastComment.parent_id?void 0:{name:"after_comment_text",fn:r(()=>[a(p,{defaultMentions:o.defaultMentions?o.defaultMentions:[],onCopyLink:n.copyCommentLink,show_reacts_only:!0,checkPermission:o.checkPermission,feed:o.feed,comment:s.lastComment},{after_reply_box_text:r(()=>[s.lastComment.comments&&s.lastComment.comments.length?(i(),c("span",{key:0,onClick:t[1]||(t[1]=y=>e.$emit("forceShowAll")),class:"reply_btn last_comment_reply_txt"},d(e.$_n("%d reply","%d replies",s.lastComment.comments.length)),1)):_("",!0)]),_:1},8,["defaultMentions","onCopyLink","checkPermission","feed","comment"])]),key:"0"}]),1032,["comment","space_id","onCopyLink"])]),o.feed.comments_count>1?(i(),c("div",{key:0,onClick:t[3]||(t[3]=y=>n.maybeShowAllComments()),class:"each_comment show_all_comments"},d(e.$t("View more comments")),1)):_("",!0)])):_("",!0)}const Es=F(vu,[["render",Su]]);const Vu={name:"ReactedUsers",components:{UserRouteLink:Le},data(){return{centerDialogVisible:!1,reactions:null,loading:!1}},props:{feed:{type:Object,required:!0,default:()=>({})}},computed:{reactedProfiles(){let e=[],t=null;return this.feed.has_user_react&&(t=this.auth.user_id,e.push({user_id:t,avatar:this.auth.avatar})),this.each(this.feed.reactions,o=>{o.user_id!=t&&o.xprofile&&e.push({user_id:o.user_id,avatar:o.xprofile.avatar})}),e.slice(0,3)}},methods:{getReactions(){this.reactions&&this.reactions.length===this.feed.reactions_count||(this.loading=!0,this.$get("feeds/"+this.feed.id+"/reactions").then(e=>{this.reactions=e.reactions,e.current_user_follows&&this.setFollowIds(e.current_user_follows)}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1}))}}},Lu=["title"],Mu={key:0,class:"reactions_avatars"},Pu=["alt","src"],Fu={key:0},Tu={key:1},Iu={class:"fcom_user_lists"},Uu={key:2};function Bu(e,t,o,u,s,n){const m=q,p=g("UserAvatar"),h=g("UserRouteLink"),y=fe,k=de;return i(),v(k,{persistent:!1,"popper-class":"fcom_feed_reacted_user_list",placement:"bottom",title:e.$t("Likes"),width:210,trigger:"click",onShow:n.getReactions},{reference:r(()=>[l("div",{title:e.$t("Click to view"),class:"fcom_reactions"},[n.reactedProfiles&&n.reactedProfiles.length?(i(),c("div",Mu,[(i(!0),c(V,null,D(n.reactedProfiles,b=>(i(),c("span",{key:b.id,class:"fcom_reaction_avatar fcom_avatar_is_rounded fcom_user_avatar"},[b!=null&&b.avatar?(i(),c("img",{key:0,alt:e.$t("Reacted Users"),src:b.avatar},null,8,Pu)):_("",!0)]))),128))])):_("",!0),l("span",null,d(e.$_n("%s like","%s likes",o.feed.reactions_count)),1)],8,Lu)]),default:r(()=>[s.loading?(i(),c("div",Fu,[a(m,{animated:!0,rows:3})])):s.reactions?(i(),c("div",Tu,[a(y,{"max-height":"300px"},{default:r(()=>[l("ul",Iu,[(i(!0),c(V,null,D(s.reactions,b=>(i(),c("li",null,[b.xprofile?(i(),c(V,{key:0},[a(p,{with_level:!1,xprofile:b.xprofile},null,8,["xprofile"]),a(h,{show_badge:!0,xprofile:b.xprofile,show_follow:!0},null,8,["xprofile"])],64)):_("",!0)]))),256))])]),_:1})])):(i(),c("div",Uu,[l("p",null,d(e.$t("Failed to load the list")),1)]))]),_:1},8,["title","onShow"])}const Eu=F(Vu,[["render",Bu]]),Au={name:"FeedFooter",components:{ReactedUsers:Eu,FeedComments:Es,FeedTextComposer:lt,ChatIcon:ze,HeartIcon:qe},props:["feed","is_single","space_slug","is_modal"],emits:["commented","joinSpace"],data(){return{commenting:!1,comment:{message:"",media_images:[]},saving:!1,show_all_comments:this.is_single,reactions:[],isAutoFocus:!1,showCommentBox:!0,defaultMentions:[],sortBy:"oldest"}},methods:{maybeSave(e){(e.metaKey||e.ctrlKey)&&e.keyCode===13&&this.postComment()},postComment(){this.saving=!0,this.$post("feeds/"+this.feed.id+"/comments",{comment:this.comment.message,media_images:this.comment.media_images,meta:this.comment.meta}).then(e=>{this.feed.comments||(this.feed.comments=[]),this.feed.comments.push(e.comment),this.feed.comments_count=parseInt(this.feed.comments_count)+1,this.comment={message:"",media_images:[]},this.commenting=!1,this.showCommentBox=!1,this.$nextTick(()=>{this.showCommentBox=!0,this.$emit("commented",e.comment)})}).catch(e=>{this.$handleError(e)}).finally(()=>{this.saving=!1})},showCommentForm(){if(!this.is_single&&this.hasFeature("show_post_modal")){this.feed.auto_focus_comment=!0,this.$eventBus.emit("showFeedModal",{feed:this.feed,view:"comments",auto_focus_comment:!0});return}this.show_all_comments=!0,this.commenting?(this.commenting=!1,setTimeout(()=>{this.commenting=!0,this.isAutoFocus=!0},100)):(this.commenting=!0,this.isAutoFocus=!0),this.prepareDefaultMentions()},showAll(){this.show_all_comments=!this.show_all_comments,this.commenting=!this.commenting,this.isAutoFocus=!1,this.prepareDefaultMentions()},maybeShowFeedModal(){if(this.is_single){this.showAll();return}if(!this.hasFeature("show_post_modal")){this.showAll();return}this.feed.auto_focus_comment=!1,this.$eventBus.emit("showFeedModal",{feed:this.feed,view:"comments",auto_focus_comment:!1})},toggleReact(){const e={react_type:"like"};this.feed.has_user_react&&(e.remove=!0);let t=!this.feed.has_user_react;this.$post("feeds/"+this.feed.id+"/react",e).then(o=>{this.feed.has_user_react=t,this.feed.reactions_count=o.new_count}).catch(o=>{this.$handleError(o)})},prepareDefaultMentions(){if(!this.auth.user_id||this.defaultMentions.length)return;let e=this.auth.user_id,t=[];this.feed.user_id!=e&&t.push(this.feed.xprofile);let o=this.feed.comments.slice(-30);this.each(o,u=>{u.user_id!=e&&t.push(u.xprofile)}),this.defaultMentions=Vi(t,"user_id")},changeCommentsSortBy(){this.$storeLocalData("comments_sort_by",this.sortBy)}},mounted(){let e=this.feed.default_comment_sort_by||"oldest";this.sortBy=this.$getLocalData("comments_sort_by",e),this.is_single&&this.prepareDefaultMentions(),this.feed.auto_focus_comment&&setTimeout(()=>{this.commenting=!0,this.isAutoFocus=!0},100)}},Du={ref:"feed_footer",class:"feed_footer"},Ru={class:"fcom_feed_footer_actions"},Hu={class:"fcom_sr_only"},xu={class:"fcom_feed_footer_meta"},ju={key:0},Ou={key:0,class:"fcom_reactions_count feed_reaction_meta"},Nu={class:"feed_comment_count"},zu={key:2,class:"feed_reaction_meta"},qu={key:0,ref:"fcom_comment_sorting",class:"fcom_comment_sorting"},Gu=["id"],Yu={key:0,style:{padding:"0",margin:"0","text-align":"center"}},Zu={key:1,class:"feed_commenting"},Wu={class:"person_avatar"},Ju=["src"],Qu={key:2,class:""},Ku={style:{padding:"0",margin:"0","text-align":"center"}},Xu={key:0,style:{margin:"10px 0"}},e_=["href"];function t_(e,t,o,u,s,n){var C,M,P,T;const m=g("HeartIcon"),p=O,h=g("ChatIcon"),y=g("ReactedUsers"),k=ie,b=ne,$=g("feed-comments"),f=j,w=g("feed-text-composer");return i(),c(V,null,[l("div",Du,[l("div",Ru,[l("ul",null,[l("li",{class:R(["fcom_reaction fcom_reaction_list",{react_active:o.feed.has_user_react}]),onClick:t[0]||(t[0]=I=>n.toggleReact())},[a(p,{class:R({user_reacted:o.feed.has_user_react})},{default:r(()=>[a(m,{filled:o.feed.has_user_react},null,8,["filled"])]),_:1},8,["class"])],2),((C=o.feed.meta)==null?void 0:C.comments_disabled)!=="yes"?(i(),c("li",{key:0,class:"fcom_comment_btn_wrap",onClick:t[1]||(t[1]=I=>n.showCommentForm())},[a(p,null,{default:r(()=>[a(h)]),_:1}),l("span",null,[l("span",Hu,d(e.$t("Comment")),1)])])):_("",!0)])]),l("div",xu,[o.feed.reactions_count||o.feed.comments_count||((M=o.feed.meta)==null?void 0:M.comments_disabled)==="yes"?(i(),c("ul",ju,[o.feed.reactions_count?(i(),c("li",Ou,[a(y,{feed:o.feed},null,8,["feed"])])):_("",!0),o.feed.comments_count>0?(i(),c("li",{key:1,onClick:t[2]||(t[2]=(...I)=>n.maybeShowFeedModal&&n.maybeShowFeedModal(...I)),class:"feed_reaction_meta"},[l("div",Nu,d(e.$_n("%d comment","%d comments",o.feed.comments_count)),1)])):((P=o.feed.meta)==null?void 0:P.comments_disabled)==="yes"?(i(),c("li",zu,d(e.$t("comments disabled")),1)):_("",!0)])):_("",!0)])],512),a($,{sortBy:s.sortBy,defaultMentions:s.defaultMentions,onForceShowAll:n.showAll,show_all:s.show_all_comments,feed:o.feed,is_single:o.is_single},{before_comments_start:r(()=>[o.feed.comments_count>=2?(i(),c("div",qu,[a(b,{"aria-label":e.$t("Sort comments by"),onChange:t[3]||(t[3]=I=>n.changeCommentsSortBy()),modelValue:s.sortBy,"onUpdate:modelValue":t[4]||(t[4]=I=>s.sortBy=I),class:"fcom_off_color fcom_minimal_select","popper-class":"plain_select",placeholder:e.$t("Sort by")},{default:r(()=>[a(k,{value:"oldest",label:e.$t("Earliest")},null,8,["label"]),a(k,{value:"latest",label:e.$t("Latest")},null,8,["label"]),a(k,{value:"popular",label:e.$t("Popular")},null,8,["label"]),a(k,{value:"most_replied",label:e.$t("Most Replied")},null,8,["label"])]),_:1},8,["aria-label","modelValue","placeholder"])],512)):_("",!0)]),_:1},8,["sortBy","defaultMentions","onForceShowAll","show_all","feed","is_single"]),s.commenting||o.is_single?(i(),c("div",{key:0,id:"feed_comment_form_"+o.feed.id,class:"feed_comment feed_commentbox_main"},[((T=o.feed.meta)==null?void 0:T.comments_disabled)==="yes"?(i(),c(V,{key:0},[o.feed.comments_count?(i(),c("p",Yu,d(e.$t("Comments are disabled for this post.")),1)):_("",!0)],64)):e.hasCommentPermission(o.feed)?(i(),c("div",Zu,[l("div",Wu,[l("img",{alt:"",src:e.auth.photo},null,8,Ju)]),s.showCommentBox?(i(),c("div",{key:0,onKeydown:t[6]||(t[6]=be((...I)=>n.maybeSave&&n.maybeSave(...I),["enter"])),class:"feed_comment_input"},[a(w,{context:"comment",is_modal:o.is_modal,config:{multipleMedia:!0},mentionQuery:{space_id:o.feed.space_id},autofocus_changed:s.commenting,defaultMentions:s.defaultMentions,autofocus:s.isAutoFocus,disabled:s.saving,placeholder:e.$t("Write a comment"),content:s.comment},{default:r(()=>[a(f,{loading:s.saving,disabled:s.saving,class:"fcom_primary_button",onClick:t[5]||(t[5]=I=>n.postComment())},{default:r(()=>[S(d(e.$t("Post Comment")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["is_modal","mentionQuery","autofocus_changed","defaultMentions","autofocus","disabled","placeholder","content"])],32)):_("",!0)])):(i(),c("div",Qu,[l("p",Ku,[S(d(e.$t("Please join the Space to post a comment."))+" ",1),e.appVars.auth.user_id?(i(),c("div",Xu,[a(f,{class:"fcom_primary_button",onClick:t[7]||(t[7]=()=>{e.$emit("joinSpace")})},{default:r(()=>[S(d(e.$t("Join Space")),1)]),_:1})])):(i(),c("a",{key:1,href:e.getCurrentAuthUrl()},d(e.appVars.allow_signup?e.$t("Login / Signup"):e.$t("Login")),9,e_))])]))],8,Gu)):_("",!0)],64)}const s_=F(Au,[["render",t_]]),o_={name:"SpaceIcon",props:["space_profile"]},i_=["alt","src"],n_={key:1,class:"fcom_emoji"},l_={key:2,class:"fcom_shape"},a_={key:3,class:"fcom_no_avatar"};function r_(e,t,o,u,s,n){var p,h,y,k;const m=O;return o.space_profile.logo?(i(),c("img",{key:0,alt:e.$t("Space Logo"),src:o.space_profile.logo},null,8,i_)):(p=o.space_profile.settings)!=null&&p.emoji?(i(),c("span",n_,d((h=o.space_profile.settings)==null?void 0:h.emoji),1)):(y=o.space_profile.settings)!=null&&y.shape_svg?(i(),c("span",l_,[a(m,{innerHTML:(k=o.space_profile.settings)==null?void 0:k.shape_svg},null,8,["innerHTML"])])):(i(),c("span",a_))}const He=F(o_,[["render",r_]]);const c_={name:"SingleLineTextarea",props:{modelValue:{type:String,default:""},placeholder:{type:String,default:""},maxlength:{type:Number,default:500},isActive:{type:Boolean,default:!1}},emits:["update:modelValue","enter"],methods:{onInput(e){const t=e.target.value.replace(/\n/g,"");this.$emit("update:modelValue",t),this.$nextTick(this.adjustTextareaHeight)},adjustTextareaHeight(){const e=this.$refs.textarea;e.style.height="auto",e.style.height=e.scrollHeight+"px"}},mounted(){this.adjustTextareaHeight()},watch:{modelValue(){this.$nextTick(this.adjustTextareaHeight)},isActive(e){e&&setTimeout(()=>{this.$refs.textarea.focus()},100)}}},d_=["value","maxlength","placeholder"];function u_(e,t,o,u,s,n){return i(),c("textarea",{value:o.modelValue,onInput:t[0]||(t[0]=(...m)=>n.onInput&&n.onInput(...m)),onKeydown:t[1]||(t[1]=be(Z(m=>e.$emit("enter"),["prevent"]),["enter"])),ref:"textarea",maxlength:o.maxlength,class:"fcom_status_title_input",rows:"1",placeholder:o.placeholder},null,40,d_)}const __=F(c_,[["render",u_]]),m_={name:"EyeIcon"},h_={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},f_=l("path",{d:"M17.9536 9.2035C18.207 9.55877 18.3337 9.7364 18.3337 9.99935C18.3337 10.2623 18.207 10.4399 17.9536 10.7952C16.8152 12.3915 13.908 15.8327 10.0003 15.8327C6.09264 15.8327 3.18541 12.3915 2.04703 10.7952C1.79367 10.4399 1.66699 10.2623 1.66699 9.99935C1.66699 9.7364 1.79367 9.55877 2.04703 9.2035C3.18541 7.60722 6.09264 4.16602 10.0003 4.16602C13.908 4.16602 16.8152 7.60722 17.9536 9.2035Z",stroke:"currentColor","stroke-width":"1.5"},null,-1),p_=l("path",{d:"M12.5 10C12.5 8.61929 11.3807 7.5 10 7.5C8.61929 7.5 7.5 8.61929 7.5 10C7.5 11.3807 8.61929 12.5 10 12.5C11.3807 12.5 12.5 11.3807 12.5 10Z",stroke:"currentColor","stroke-width":"1.5"},null,-1),g_=[f_,p_];function y_(e,t,o,u,s,n){return i(),c("svg",h_,g_)}const v_=F(m_,[["render",y_]]),b_={name:"CalendarIcon"},k_={width:"14",height:"16",viewBox:"0 0 14 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},w_=Ie('<path d="M11 1.3335V2.66683M3 1.3335V2.66683" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M6.99766 8.66699H7.00364M6.99766 11.3337H7.00364M9.66134 8.66699H9.66732M4.33398 8.66699H4.33997M4.33398 11.3337H4.33997" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M1.33398 5.3335H12.6673" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M0.666992 8.16216C0.666992 5.25729 0.666992 3.80486 1.50174 2.90243C2.33648 2 3.67999 2 6.36699 2H7.63366C10.3207 2 11.6642 2 12.4989 2.90243C13.3337 3.80486 13.3337 5.25729 13.3337 8.16216V8.5045C13.3337 11.4094 13.3337 12.8618 12.4989 13.7642C11.6642 14.6667 10.3207 14.6667 7.63366 14.6667H6.36699C3.67999 14.6667 2.33648 14.6667 1.50174 13.7642C0.666992 12.8618 0.666992 11.4094 0.666992 8.5045V8.16216Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M1 5.3335H13" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>',5),C_=[w_];function $_(e,t,o,u,s,n){return i(),c("svg",k_,C_)}const As=F(b_,[["render",$_]]);const S_={name:"CreateStatusForm",emits:["updatePost","added"],props:{space:{type:String,default:""},btn_text:{type:String,default:"Post"},editing_feed:{type:Object,default:()=>({title:"",type:"text",message:"",media_image:"",topic_ids:[],send_announcement_email:"no"})},defaultState:{type:String,default:"idle"},disableSpace:{type:Boolean,default:!1},default_placeholder:{type:String,default:""},initial_placeholder:{type:String,default:""},disableUpload:{type:Boolean,default:!1},saving:{type:Boolean,default:!1}},components:{SpaceIcon:He,FeedTextComposer:lt,SingleLineTextarea:__,EyeIcon:v_,CalendarIcon:As},data(){return{feed:this.editing_feed,isAutoFocus:!1,state:this.defaultState,posting:!1,doingOembed:!1,oembed:null,postableSpaces:[],autofocus_changed:!1,allSpaces:this.appVars.auth.spaces,globalDisabled:this.appVars.features.disable_global_posts,hasPostTitle:this.hasFeature("has_post_title"),scheduleModalVisible:!1,scheduleForm:{date:null,time:null},editorReady:!1}},watch:{"scheduleForm.date":{handler(e){this.scheduleForm.time=null}}},computed:{isEditing(){var e;return(e=this.editing_feed)==null?void 0:e.id},isScheduleDisabled(){return!this.scheduleForm.date||!this.scheduleForm.time},showScheduleInfo(){return this.feed.scheduled_at&&!this.isEditing},showScheduleIcon(){return this.isAdmin()&&!this.isEditing&&this.has_pro},isDateDisabled(){return e=>e<new Date().setHours(0,0,0,0)},getPlaceholder(){const e=this.appVars.topicsConfig.max_topics_per_post;return this.isTopicRequired?this.$_n("Select a topic","Choose up to %s topics",e):this.$_n("Select a topic","Choose up to %s topics (optional)",e)},getButtonLabel(){return this.feed.scheduled_at&&!this.isEditing?this.$t("Schedule"):this.btn_text},getScheduleLabel(){return this.$t("Scheduled for %1$s at %2$s",this.formattedDate(this.feed.scheduled_at),this.formattedTime(this.feed.scheduled_at))},getStartTime(){if(!this.scheduleForm.date||!this.isToday(this.scheduleForm.date))return"00:00";const t=this.dayjs().add(30,"minute");if(!this.isToday(t.toDate()))return"23:50";const o=t.format("HH");let u=parseInt(t.format("mm"),10);return u=Math.ceil(u/10)*10,u===60?this.dayjs(t).add(1,"hour").format("HH")+":00":o+":"+(u<10?"0":"")+u},getPostTitle(){return this.isEditing?this.$t("Edit Post"):this.$t("Create Post")},canPost(){var e,t;return this.space?(t=(e=this.allSpaces[this.space])==null?void 0:e.permissions)==null?void 0:t.can_create_post:this.appVars.auth.user_id},isTopicRequired(){var e,t;return this.currentSpaceSlug?((t=(e=this.allSpaces[this.currentSpaceSlug])==null?void 0:e.settings)==null?void 0:t.topic_required)=="yes":!1},isStateActive(){return this.state=="active"},isCurrentSpaceAdmin(){var e,t;return this.currentSpaceSlug?(t=(e=this.allSpaces[this.currentSpaceSlug])==null?void 0:e.permissions)==null?void 0:t.community_moderator:!1},isCommunityAdmin(){return this.isAdmin()},currentPlaceHolder(){return this.isStateActive?this.default_placeholder?this.default_placeholder:this.$t("Write something here..."):this.initial_placeholder?this.initial_placeholder:this.$t("What's happening, %s",this.auth.first_name)},currentTopics(){var o;let e=this.currentSpaceSlug;if(!e)return[];let t=((o=this.allSpaces[e])==null?void 0:o.topics)||[];return t=Object.values(t),this.isModerator(e)?t:t.filter(u=>u.admin_only!="yes")},canUploadDoc(){var e,t;return this.currentSpaceSlug?(t=(e=this.allSpaces[this.currentSpaceSlug])==null?void 0:e.permissions)==null?void 0:t.can_upload_documents:!1},currentSpaceSlug(){if(this.space)return this.space;let e=this.feed.space;return e&&typeof e=="object"?e==null?void 0:e.slug:e},currentSpaceId(){var e;return this.currentSpaceSlug?(e=this.allSpaces[this.currentSpaceSlug])==null?void 0:e.id:null},feedContext(){const e=this.space||this.currentSpaceSlug;return e&&e!=="__self__post__"?`space-${e}`:"global"}},methods:{...ds(Se,["createFeed"]),changeAutoFocus(){this.feed.title=this.feed.title.replace(/\n/g,""),this.updateAutofocus()},updateAutofocus(){this.autofocus_changed=!1,setTimeout(()=>{this.autofocus_changed=!0},100)},openScheduleModal(){this.scheduleModalVisible=!0},makeActive(){this.editorReady=!0,this.$nextTick(()=>{this.prepareData(),this.state="active",this.hasPostTitle||this.updateAutofocus()})},cancelPost(){this.state="idle",this.postableSpaces=[]},cancelSchedule(){this.scheduleModalVisible=!1,this.scheduleForm.date=null,this.scheduleForm.time=null,this.feed.scheduled_at=null},previewPost(){const e={...this.feed,space:this.space||this.feed.space,is_editing:this.isEditing};this.$eventBus.emit("showPreviewPostModal",e)},initFeed(){return{type:"text",message:"",media_image:"",topic_ids:[],scheduled_at:null,send_announcement_email:"no"}},schedulePost(){if(this.scheduleModalVisible=!1,!this.scheduleForm.date||!this.scheduleForm.time){this.feed.scheduled_at=null;return}this.feed.scheduled_at=`${this.scheduleForm.date} ${this.scheduleForm.time}:00`},post(){if(!this.isStateActive)return;if(this.feed.id){this.$emit("updatePost",this.feed);return}const e=this.feed;if(this.space&&(e.space=this.space),!e.space){this.$refs.fcom_posting_space.classList.add("fcon_shake"),setTimeout(()=>{this.$refs.fcom_posting_space.classList.remove("fcon_shake")},500),this.$notify({title:this.$t("Error"),message:this.$t("Please select a space to post in."),type:"error"});return}if(e.space!="__self__post__"&&e.send_announcement_email=="yes"){let t=this.$t("Are you sure you want to send email to everyone? An automated email will be sent to all the members of the space after 5 minutes of this post");e.scheduled_at&&(t=this.$t("Are you sure you want to send email to everyone? An automated email will be sent to all the members of the space. The email will be sent at the scheduled time.")),this.$confirm(t,this.$t("Sending email to all members?"),{confirmButtonText:this.$t("Yes"),cancelButtonText:this.$t("No"),confirmButtonClass:"fcom_primary_button",cancelButtonClass:"fcom_secondary_button",type:"warning"}).then(()=>{this.postStatus(e)}).catch(()=>{this.feed.send_announcement_email="no",this.state="active",this.$notify({title:this.$t("Cancelled"),message:this.$t("You have cancelled the action."),type:"info"})})}else this.postStatus(e)},feedSpaceChanged(){this.$refs.fcom_posting_space_select.blur(),this.feed.topic_ids=""},async postStatus(e){var t;this.posting=!0;try{const u=await Se().createFeed(this.feedContext,e);if(u.scheduled_at||this.$emit("added",u.feed),this.feed=this.initFeed(),this.state="idle",u.scheduled_at){const s=this.formattedDateTime(u.scheduled_at);this.$notify.success(this.$t("Your post has been scheduled for %s. Please find the scheduled post from your profile",s))}this.editorReady=!1}catch(o){this.$handleError(o),(t=o==null?void 0:o.shakes)!=null&&t.topic_ids&&(this.$refs.fcom_topics_input.classList.add("fcon_shake"),setTimeout(()=>{this.$refs.fcom_topics_input.classList.remove("fcon_shake")},500))}finally{this.posting=!1}},prepareData(){if(this.space)return[];let e=Object.values(this.allSpaces),t=this.appVars.space_groups,o=[],u=[];this.each(t,n=>{let m=e.filter(p=>{let h=p.parent_id==n.id&&p.permissions&&p.permissions.can_create_post;return h&&u.push(p.slug),h});m.length&&o.push({label:n.title,spaces:m})});let s=e.filter(n=>!n.parent_id&&n.permissions&&n.permissions.can_create_post);s&&s.length&&o.push({label:this.$t("Others"),spaces:s}),this.globalDisabled||o.unshift({label:"",spaces:[{title:this.$t("On my profile"),slug:"__self__post__"}]}),this.postableSpaces=o}},mounted(){(this.editing_feed.id||this.defaultState=="active")&&(this.editorReady=!0)}},V_={class:"person_avatar"},L_=["alt","src"],M_={class:"create_header_content"},P_={key:0,class:"fcom_create_status_box_header"},F_={class:"user_infos"},T_={class:"feed_user_name"},I_={key:0,class:"feed_meta_info"},U_={key:1,class:"feed_timestamp"},B_={class:"create_header_action"},E_={key:0,ref:"fcom_topics_input",class:"fcom_topics_input"},A_={style:{margin:"0",display:"block",width:"100%",padding:"5px 0","font-weight":"500"}},D_={key:0,class:"fcom_meta_text"},R_={class:"fcom_post_actions"},H_={key:0,class:"fcom_post_space_name"},x_={class:"target_label"},j_={ref:"fcom_posting_space",style:{"margin-right":"10px"}},O_={key:0,class:"fcom_space_title"},N_={key:1},z_={key:0,class:"fcom_composer_admin_actions"},q_={key:0},G_={class:"dialog_header"},Y_={class:"dialog_left schedule_header_left"},Z_={class:"dialog_body"},W_={class:"fcom_input_help"},J_={class:"dialog_footer"};function Q_(e,t,o,u,s,n){const m=g("EditPen"),p=O,h=g("CalendarIcon"),y=j,k=g("EyeIcon"),b=g("Close"),$=g("SingleLineTextarea"),f=ie,w=ne,C=g("SpaceIcon"),M=bt,P=he,T=g("feed-text-composer"),I=Xe,U=ue,B=fs,A=_e,L=ye;return n.canPost?(i(),c("div",{key:0,class:R([{state_active:n.isStateActive},"create_status_holder"])},[l("div",{class:R(["create_header",{state_active:n.isStateActive}])},[l("div",V_,[l("img",{alt:e.$t("Your Photo"),src:e.auth.avatar},null,8,L_)]),l("div",M_,[n.isStateActive?_("",!0):(i(),c("div",{key:0,onClick:t[0]||(t[0]=(...E)=>n.makeActive&&n.makeActive(...E)),class:"form_placeholder"},d(n.currentPlaceHolder),1)),l("div",{class:R([{fcom_editor_with_title:s.hasPostTitle,"is-active":n.isStateActive},"fcom_create_status_box"])},[n.isStateActive?(i(),c("div",P_,[l("div",F_,[l("div",T_,d(n.getPostTitle),1),o.editing_feed.id?_("",!0):(i(),c("div",I_,[n.showScheduleInfo?(i(),c("div",{key:0,onClick:t[1]||(t[1]=(...E)=>n.openScheduleModal&&n.openScheduleModal(...E)),class:"feed_scheduled_info"},[l("span",null,d(n.getScheduleLabel),1),a(p,null,{default:r(()=>[a(m)]),_:1})])):(i(),c("span",U_,d(e.dayjs().format(e.appVars.date_time_formatter)),1))]))]),l("div",B_,[n.showScheduleIcon?(i(),v(y,{key:0,onClick:n.openScheduleModal,text:""},{default:r(()=>[a(p,null,{default:r(()=>[a(h)]),_:1})]),_:1},8,["onClick"])):_("",!0),a(y,{onClick:n.previewPost,text:""},{default:r(()=>[a(p,null,{default:r(()=>[a(k)]),_:1})]),_:1},8,["onClick"]),n.isEditing?_("",!0):(i(),v(y,{key:1,class:"close_btn",onClick:n.cancelPost,text:""},{default:r(()=>[a(p,null,{default:r(()=>[a(b)]),_:1})]),_:1},8,["onClick"]))])])):_("",!0),s.editorReady?(i(),v(T,{key:1,context:"feed",placeholder:n.currentPlaceHolder,config:{surveyApp:!0,space_id:n.currentSpaceId,is_admin:n.isCurrentSpaceAdmin||n.isCommunityAdmin,spaceSlug:n.currentSpaceSlug,disableUpload:o.disableUpload,multipleMedia:!0,documentsApp:n.canUploadDoc,videoApp:!0},autofocus:s.isAutoFocus||!s.hasPostTitle,onEditorCreated:t[9]||(t[9]=()=>{s.isAutoFocus=!0}),mentionQuery:{space:n.currentSpaceSlug},disabled:s.posting,autofocus_changed:s.autofocus_changed,is_editing:!!n.isEditing,content:s.feed},{before_input:r(()=>[s.hasPostTitle?(i(),v($,{key:0,maxlength:120,autofocus:!0,isActive:n.isStateActive,modelValue:s.feed.title,"onUpdate:modelValue":t[2]||(t[2]=E=>s.feed.title=E),onEnter:t[3]||(t[3]=E=>n.changeAutoFocus()),placeholder:s.hasPostTitle=="required"?e.$t("Short title of this post"):e.$t("Title (optional)")},null,8,["isActive","modelValue","placeholder"])):_("",!0)]),before_composer_footer:r(()=>[z(e.$slots,"before_footer")]),after_input:r(()=>[e.has_pro&&n.currentTopics.length?(i(),c("div",E_,[a(w,{"popper-class":"fcom_topics_select","multiple-limit":e.appVars.topicsConfig.max_topics_per_post,modelValue:s.feed.topic_ids,"onUpdate:modelValue":t[4]||(t[4]=E=>s.feed.topic_ids=E),multiple:e.appVars.topicsConfig.max_topics_per_post>1,placeholder:n.getPlaceholder},{default:r(()=>[(i(!0),c(V,null,D(n.currentTopics,E=>(i(),v(f,{key:E.slug,label:E.title,value:E.id},{default:r(()=>[l("span",A_,d(E.title),1),E.description?(i(),c("span",D_,d(E.description),1)):_("",!0)]),_:2},1032,["label","value"]))),128))]),_:1},8,["multiple-limit","modelValue","multiple","placeholder"])],512)):_("",!0)]),after_composer_footer:r(()=>[e.hasFeature("mention_mail")&&n.isCurrentSpaceAdmin&&s.feed.send_announcement_email?(i(),c("div",z_,[a(P,{disabled:!e.has_pro,"true-value":"yes","false-value":"no",modelValue:s.feed.send_announcement_email,"onUpdate:modelValue":t[8]||(t[8]=E=>s.feed.send_announcement_email=E)},{default:r(()=>[S(d(e.$t("Send announcement email to space members"))+" ",1),e.has_pro?_("",!0):(i(),c("span",q_,"("+d(e.$t("Require Pro"))+")",1))]),_:1},8,["disabled","modelValue"])])):_("",!0)]),default:r(()=>[l("div",R_,[o.space&&n.isStateActive?(i(),c("div",H_,[l("span",null,"#"+d(o.space),1)])):_("",!0),!o.space&&!o.disableSpace?(i(),c(V,{key:1},[l("span",x_,d(e.$t("Posting in:")),1),l("span",j_,[a(w,{modelValue:s.feed.space,"onUpdate:modelValue":t[5]||(t[5]=E=>s.feed.space=E),style:{width:"170px"},ref:"fcom_posting_space_select",class:"fcom_minimal_select",placeholder:e.$t("Select Space"),onChange:t[6]||(t[6]=E=>n.feedSpaceChanged())},{default:r(()=>[(i(!0),c(V,null,D(s.postableSpaces,E=>(i(),v(M,{key:E.label,label:E.label},{default:r(()=>[(i(!0),c(V,null,D(E.spaces,G=>(i(),v(f,{key:G.slug,label:G.title,value:G.slug},{default:r(()=>[G.id?(i(),c("span",O_,[a(C,{space_profile:G},null,8,["space_profile"]),l("span",null,d(e.getExcerpt(G.title,30)),1)])):(i(),c("span",N_,d(e.getExcerpt(G.title,30)),1))]),_:2},1032,["label","value"]))),128))]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","placeholder"])],512)],64)):_("",!0),z(e.$slots,"before_submit_btn"),a(y,{onClick:t[7]||(t[7]=E=>n.post()),disabled:s.posting||n.isEditing&&o.saving,loading:n.isEditing?o.saving:s.posting,class:R(["fcom_primary_button",{fcom_update_button:n.isEditing}])},{default:r(()=>[S(d(n.getButtonLabel),1)]),_:1},8,["disabled","loading","class"])])]),_:3},8,["placeholder","config","autofocus","mentionQuery","disabled","autofocus_changed","is_editing","content"])):_("",!0),z(e.$slots,"after_composer")],2)])],2),a(L,{modelValue:s.scheduleModalVisible,"onUpdate:modelValue":t[12]||(t[12]=E=>s.scheduleModalVisible=E),width:e.modalWidth,"modal-class":"fcom_common_dialog","append-to-body":!0,"close-on-click-modal":!1},{header:r(()=>[l("div",G_,[l("div",Y_,[l("h4",null,d(e.$t("Schedule Post")),1),l("p",null,d(e.$t("Choose a date and time in the future when you want your post to be published")),1)])])]),footer:r(()=>[l("div",J_,[a(y,{class:"fcom_secondary_button",onClick:n.cancelSchedule},{default:r(()=>[S(d(e.$t("Remove Schedule")),1)]),_:1},8,["onClick"]),a(y,{class:"fcom_primary_button",disabled:n.isScheduleDisabled,onClick:n.schedulePost},{default:r(()=>[S(d(e.$t("Select Schedule")),1)]),_:1},8,["disabled","onClick"])])]),default:r(()=>[l("div",Z_,[a(A,{"label-position":"top",class:"fcom_schedule_form"},{default:r(()=>[a(U,{label:e.$t("Date")},{default:r(()=>[a(I,{modelValue:s.scheduleForm.date,"onUpdate:modelValue":t[10]||(t[10]=E=>s.scheduleForm.date=E),type:"date","value-format":"YYYY-MM-DD",format:"YYYY-MM-DD",placeholder:e.$t("Select Date"),"disabled-date":n.isDateDisabled},null,8,["modelValue","placeholder","disabled-date"])]),_:1},8,["label"]),a(U,{label:e.$t("Time")},{default:r(()=>[a(B,{modelValue:s.scheduleForm.time,"onUpdate:modelValue":t[11]||(t[11]=E=>s.scheduleForm.time=E),disabled:!s.scheduleForm.date,style:{width:"210px"},step:"00:10",start:n.getStartTime,end:"23:59",placeholder:e.$t("Select Time")},null,8,["modelValue","disabled","start","placeholder"])]),_:1},8,["label"])]),_:1}),a(U,null,{default:r(()=>[l("p",W_,d(e.$t("The date and time is based on your site's Timezone")),1)]),_:1})])]),_:1},8,["modelValue","width"])],2)):_("",!0)}const Pt=F(S_,[["render",Q_]]),K_={name:"EditFeed",components:{SpaceIcon:He,CreateStatusForm:Pt},data(){return{loading:!1,saving:!1,localDialogVisible:this.dialogVisible,feed:{},autofocus_changed:!1,hasPostTitle:this.hasFeature("has_post_title"),changeSpace:!1,newSpaceId:null,makePublish:!1}},props:{dialogVisible:{type:Boolean,required:!0},feedSlug:{type:String,required:!0},hide_create_form:{type:Boolean,default:!1}},methods:{getFeed(){this.loading=!0,this.$get("feeds/"+this.feedSlug+"/by-slug",{context:"edit"}).then(e=>{this.feed=e.feed}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})},handleUpdatePost(e){var o;let t={id:e.id,title:e.title,message:e.message,space:(o=e==null?void 0:e.space)==null?void 0:o.slug,meta:e.meta,content_type:e.content_type,document_ids:e.document_ids,media:e.media,media_images:e.media_images,survey:e.survey,topic_ids:e.topic_ids,send_announcement_email:e.send_announcement_email};this.changeSpace&&this.newSpaceId&&(t.new_space_id=this.newSpaceId),this.makePublish&&(t.status="published"),this.saving=!0,this.$post(`feeds/${e.id}`,t).then(u=>{this.$notify.success(u.message),this.$emit("updated",u.feed),this.handleClose()}).catch(u=>{this.$handleError(u)}).finally(()=>{this.saving=!1})},handleClose(){this.localDialogVisible=!1,this.$emit("close")}},mounted(){this.getFeed()}},X_={class:"fcom_feed_edit"},em={class:"fcom_feed_edit_dialog_header"},tm={key:0,class:"fcom_feed_edit_dialog_body"},sm={key:0},om={key:0,style:{"margin-top":"5px"}},im={class:"fcom_space_title"};function nm(e,t,o,u,s,n){const m=g("Close"),p=O,h=he,y=g("SpaceIcon"),k=ie,b=ne,$=g("create-status-form"),f=q,w=ye,C=K("loading");return i(),c("div",X_,[a(w,{class:"fcom_feed_edit_dialog",modelValue:s.localDialogVisible,"onUpdate:modelValue":t[3]||(t[3]=M=>s.localDialogVisible=M),width:e.dialogWidth,"append-to-body":!0,overflow:"","before-close":()=>{},"show-close":!1},{default:r(()=>{var M,P;return[N((i(),c("div",null,[l("div",em,[l("span",null,d(e.$t("Edit Feed")),1),a(p,{onClick:n.handleClose},{default:r(()=>[a(m)]),_:1},8,["onClick"])]),s.feed.id?(i(),c("div",tm,[!(o.hide_create_form&&e.auth.user_id)||e.canEditFeed(s.feed)?(i(),v($,{key:0,"default-state":"active",btn_text:e.$t("Update"),editing_feed:s.feed,onUpdatePost:n.handleUpdatePost,saving:s.saving,disableSpace:!0,space:(P=(M=s.feed)==null?void 0:M.space)==null?void 0:P.slug},{after_composer:r(()=>[e.has_pro&&s.feed.space&&e.hasSpaceModeratorAccess(s.feed.space)?(i(),c("div",sm,[a(h,{modelValue:s.changeSpace,"onUpdate:modelValue":t[0]||(t[0]=T=>s.changeSpace=T)},{default:r(()=>[S(d(e.$t("Move to a different space")),1)]),_:1},8,["modelValue"]),s.changeSpace?(i(),c("div",om,[a(b,{modelValue:s.newSpaceId,"onUpdate:modelValue":t[1]||(t[1]=T=>s.newSpaceId=T),placeholder:e.$t("Select a new Space"),style:{width:"100%"}},{default:r(()=>[(i(!0),c(V,null,D(e.appVars.auth.spaces,T=>(i(),v(k,{disabled:s.feed.space_id==T.id,key:T.id,label:T.title,value:T.id},{default:r(()=>[l("span",im,[a(y,{space_profile:T},null,8,["space_profile"]),l("span",null,d(e.getExcerpt(T.title,30)),1)])]),_:2},1032,["disabled","label","value"]))),128))]),_:1},8,["modelValue","placeholder"])])):_("",!0)])):_("",!0)]),before_submit_btn:r(()=>[s.feed.status=="unlisted"?(i(),v(h,{key:0,modelValue:s.makePublish,"onUpdate:modelValue":t[2]||(t[2]=T=>s.makePublish=T)},{default:r(()=>[S(d(e.$t("Publish as a post")),1)]),_:1},8,["modelValue"])):_("",!0)]),_:1},8,["btn_text","editing_feed","onUpdatePost","saving","space"])):_("",!0)])):(i(),v(f,{key:1,rows:5,animated:!0}))])),[[C,s.loading]])]}),_:1},8,["modelValue","width"])])}const Wt=F(K_,[["render",nm]]),lm={name:"Avatar",props:{xprofile:{default:()=>({})},with_level:{type:Boolean,default(){return!0}},is_rounded:{type:Boolean,default(){return!0}},with_completion:{type:Boolean,default(){return!1}},is_online:{type:Boolean,default(){return!1}}},computed:{level(){if(!this.with_level||!this.has_leaderboard)return"";const e=Fe(this.xprofile.total_points);return e?e.level:0},withCompletion(){var o;if(!this.with_completion||!((o=this.xprofile)!=null&&o.total_points))return!1;const e=Fe(this.xprofile.total_points),t=Fe(e.max_points+1);return e.level!==t.level},getOutlineStyle(){if(!this.withCompletion)return{};const e=Fe(this.xprofile.total_points),t=Fe(e.max_points+1),o=this.xprofile.total_points-e.min_points,u=t.min_points-e.min_points,n=o/u*100/100*360;return{backgroundImage:`conic-gradient(rgb(56, 117, 223) ${n}deg, #D9D9D9 ${n}deg)`}}},methods:{setAltImg(e){e.target.src=this.appVars.assets_url+"images/placeholder.png"}}},am=["src"],rm={key:1,class:"fcom_no_image"},cm={key:0,role:"region","aria-label":"User Level",class:"fcom_user_level_mark"};function dm(e,t,o,u,s,n){return i(),c("div",{class:R([{fcom_avatar_is_rounded:o.is_rounded,is_member_online:o.is_online},"fcom_user_avatar"])},[l("span",{style:re(n.getOutlineStyle),class:R({fcom_compilation_avatar:n.withCompletion})},[o.xprofile?(i(),c("img",{key:0,onError:t[0]||(t[0]=(...m)=>n.setAltImg&&n.setAltImg(...m)),src:o.xprofile.avatar,alt:""},null,40,am)):(i(),c("span",rm))],6),n.level||o.is_online?(i(),c("div",cm,[l("span",null,d(n.level),1)])):_("",!0)],2)}const Jt=F(lm,[["render",dm]]),um={name:"SurveyVoters",props:["feed","option","options","totalCount"],components:{UserRouteLink:Le,UserAvatar:Jt},data(){return{voters:[],loading:!1,showVotersDialog:!0}},watch:{option(){this.loadVoters()}},computed:{getVotePercentage(){return this.option.vote_counts?Math.floor(this.option.vote_counts/this.totalCount*100)+"%":"0%"}},methods:{switchOption(e){this.$emit("updateOption",e)},closeDialog(){this.showVotersDialog=!1,this.$emit("close")},loadVoters(){var e;this.loading=!0,this.$get(`feeds/${this.feed.id}/apps/survey-voters/${(e=this.option)==null?void 0:e.slug}`).then(t=>{this.voters=t.voters}).catch(t=>{this.$handleError(t)}).finally(()=>{this.loading=!1})}},mounted(){this.loadVoters()}},_m={class:"dialog_header"},mm={class:"fcom_filter_menu"},hm={class:"fcom_filter_menu_ul"},fm=["onClick"],pm={key:1},gm={class:"feed_meta_info survey_voters_meta"},ym={class:"meta_line"},vm={class:"meta_line"},bm={class:"voters_list"},km={class:"voter_avatar"},wm={class:"voter_info"},Cm=["title"],$m={key:2,class:"not_found"};function Sm(e,t,o,u,s,n){const m=q,p=g("UserAvatar"),h=g("UserRouteLink"),y=fe,k=ye;return i(),v(k,{modelValue:s.showVotersDialog,"onUpdate:modelValue":t[0]||(t[0]=b=>s.showVotersDialog=b),"modal-class":"fcom_common_dialog menu_dialog","close-on-click-modal":!0,"append-to-body":!0,width:e.dialogWidth,style:{"max-width":"800px"},direction:"rtl",onClose:n.closeDialog},{header:r(({close:b})=>[l("div",_m,[l("div",mm,[l("ul",hm,[(i(!0),c(V,null,D(o.options,$=>(i(),c("li",{key:$.slug},[l("a",{onClick:Z(f=>n.switchOption($.slug),["prevent"]),class:R({"router-link-exact-active":o.option.slug==$.slug}),href:"#"},d($.label),11,fm)]))),128))])])])]),default:r(()=>[s.loading?(i(),v(m,{key:0,animated:"",rows:4})):s.voters.length?(i(),c("div",pm,[l("div",gm,[l("span",ym,d(n.getVotePercentage),1),l("span",vm,d(e.$_n("%s Vote","%s Votes",o.option.vote_counts)),1)]),a(y,{"max-height":"800px"},{default:r(()=>[l("div",bm,[(i(!0),c(V,null,D(s.voters,b=>(i(),c("div",{key:b.id,class:"voter_item"},[b.xprofile?(i(),c(V,{key:0},[l("div",km,[a(p,{with_level:!1,xprofile:b.xprofile},null,8,["xprofile"])]),l("div",wm,[a(h,{show_badge:!0,xprofile:b.xprofile},null,8,["xprofile"]),b.xprofile.created_at?(i(),c("div",{key:0,title:b.xprofile.created_at,class:"voter_time"},d(e.$t("Joined %s",e.humanDateDiff(b.xprofile.created_at))),9,Cm)):_("",!0)])],64)):_("",!0)]))),128))])]),_:1})])):(i(),c("div",$m,[l("p",null,d(e.$t("No voters yet")),1)]))]),_:1},8,["modelValue","width","onClose"])}const Vm=F(um,[["render",Sm]]),Lm={name:"SurveyRenderer",props:{feed:{type:Object,required:!0},is_preview:{type:Boolean,default:!1},hasTopMedia:{type:Boolean,default:!1},isChildFeed:{type:Boolean,default:!1}},components:{SurveyVoters:Vm},data(){var e,t;return{inputType:(t=(e=this.feed.meta)==null?void 0:e.survey_config)==null?void 0:t.type,formattedOptions:[],working:!1,totalCount:0,showVotersDialog:!1,selectedOption:null,endingDate:null}},watch:{"feed.meta.survey_config":{handler(e,t){JSON.stringify(e)!==JSON.stringify(t)&&(this.inputType=t.type,this.setupData())},deep:!0}},computed:{isEnded(){return this.endingDate&&this.isPastDate(this.endingDate)},endedDateLabel(){return this.$t("ended %s",this.humanDateDiff(this.endingDate))},endingDateLabel(){return this.$t("ending %s",this.humanDateDiff(this.endingDate))},shouldHideBorder(){var e,t;return!this.hasTopMedia&&(((e=this.feed.meta)==null?void 0:e.media_items)||((t=this.feed.meta)==null?void 0:t.media_preview))||this.isChildFeed}},methods:{getVoteStyle(e){const t=e?e/this.totalCount*100:0,o={width:t+"%"};return t>0&&t<100&&(o["border-top-right-radius"]=0,o["border-bottom-right-radius"]=0),o},showVoters(e){this.selectedOption=e,this.showVotersDialog=!0},updateOption(e){this.selectedOption=this.formattedOptions.find(t=>t.slug===e)},toggleVote(e){if(this.isEnded){this.$notify.error(this.$t("This poll has ended."));return}if(this.showVotersDialog)return;let t=this.formattedOptions[e].voted;this.inputType=="single_choice"&&this.each(this.formattedOptions,o=>{o.voted=!1}),this.formattedOptions[e].voted=!t,this.syncVotes()},syncVotes(){if(this.is_preview)return;let e=[];this.each(this.formattedOptions,t=>{t.voted&&e.push(t.slug)}),this.working=!0,this.$post(`feeds/${this.feed.id}/apps/survey-vote`,{vote_indexes:e}).then(t=>{this.feed.meta.survey_config=t.survey_config,this.setupData()}).catch(t=>{this.$handleError(t)}).finally(()=>{this.working=!1})},setupData(){let e=[],t=0;this.feed.meta.survey_config&&(this.each(this.feed.meta.survey_config.options,o=>{e.push(o),o.vote_counts&&(t+=parseInt(o.vote_counts))}),this.formattedOptions=e,this.totalCount=t,this.endingDate=this.feed.meta.survey_config.end_date)}},mounted(){this.setupData()}},Mm={class:"fcom_app_options"},Pm=["onClick"],Fm={class:"fcom_app_text"},Tm={class:"fcom_app_input_wrap"},Im={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 6 6"},Um=l("circle",{cx:"3",cy:"3",r:"2.5",fill:"currentColor"},null,-1),Bm=[Um],Em={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 8 8"},Am=l("path",{fill:"currentColor",d:"M6.564.75l-3.59 3.612-1.538-1.55L0 4.26 2.974 7.25 8 2.193z"},null,-1),Dm=[Am],Rm=["onClick"],Hm={key:0},xm={class:"feed_meta_info"},jm={key:0,class:"meta_line"},Om=["title"],Nm=["title"];function zm(e,t,o,u,s,n){const m=g("ArrowRight"),p=O,h=g("SurveyVoters");return i(),c(V,null,[l("div",{class:R(["fcom_app_render",{"no-border":n.shouldHideBorder}])},[l("div",Mm,[(i(!0),c(V,null,D(s.formattedOptions,(y,k)=>(i(),c("div",{key:y.slug,onClick:b=>n.toggleVote(k),class:R([y.voted?"fcom_is_voted":"","fcom_app_option"])},[l("div",Fm,[l("span",Tm,[l("span",{class:R("fcom_input_"+s.inputType)},[s.inputType=="single_choice"?(i(),c("svg",Im,Bm)):(i(),c("svg",Em,Dm))],2)]),l("span",null,d(y.label),1)]),l("div",{class:"fcom_app_counts",onClick:b=>n.showVoters(y)},[S(d(y.vote_counts?Math.floor(y.vote_counts/s.totalCount*100)+"%":"")+" ",1),y.vote_counts?(i(),c("span",Hm,"("+d(y.vote_counts)+")",1)):_("",!0),y.vote_counts?(i(),v(p,{key:1,class:"fcom_arrow_icon"},{default:r(()=>[a(m)]),_:1})):_("",!0)],8,Rm),s.totalCount?(i(),c("span",{key:0,style:re(n.getVoteStyle(y.vote_counts)),class:"fc_app_shadow"},null,4)):_("",!0)],10,Pm))),128))]),l("div",xm,[s.totalCount?(i(),c("span",jm,d(e.$_n("%d vote","%d votes",s.totalCount)),1)):_("",!0),s.endingDate?(i(),c(V,{key:1},[n.isEnded?(i(),c("span",{key:0,title:e.$t("Ended at: %s",s.endingDate),class:"meta_line"},d(n.endedDateLabel),9,Om)):(i(),c("span",{key:1,title:e.$t("Will end at: %s",s.endingDate),class:"meta_line"},d(n.endingDateLabel),9,Nm))],64)):_("",!0)])],2),s.showVotersDialog?(i(),v(h,{key:0,feed:o.feed,option:s.selectedOption,options:s.formattedOptions,totalCount:s.totalCount,onUpdateOption:n.updateOption,onClose:t[0]||(t[0]=y=>s.showVotersDialog=!1)},null,8,["feed","option","options","totalCount","onUpdateOption"])):_("",!0)],64)}const Ds=F(Lm,[["render",zm]]),qm={name:"BookmarkIcon",props:["is_active"]},Gm={key:0,style:{color:"#1d9bf0"},class:"bookmark_icon_active",width:"16",height:"20",viewBox:"0 0 16 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},Ym=l("path",{d:"M1.33331 14.9839V8.08944C1.33331 5.06164 1.33331 3.54774 2.30962 2.60712C3.28593 1.6665 4.85728 1.6665 7.99998 1.6665C11.1427 1.6665 12.714 1.6665 13.6903 2.60712C14.6666 3.54774 14.6666 5.06164 14.6666 8.08944V14.9839C14.6666 16.9054 14.6666 17.8662 14.0226 18.2101C12.7754 18.876 10.436 16.6542 9.32498 15.9852C8.68064 15.5972 8.35847 15.4032 7.99998 15.4032C7.64148 15.4032 7.31932 15.5972 6.67498 15.9852C5.56398 16.6542 3.22454 18.876 1.97735 18.2101C1.33331 17.8662 1.33331 16.9054 1.33331 14.9839Z",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Zm=[Ym],Wm={key:1,width:"16",height:"20",viewBox:"0 0 16 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Jm=l("path",{d:"M1.33331 14.9839V8.08944C1.33331 5.06164 1.33331 3.54774 2.30962 2.60712C3.28593 1.6665 4.85728 1.6665 7.99998 1.6665C11.1427 1.6665 12.714 1.6665 13.6903 2.60712C14.6666 3.54774 14.6666 5.06164 14.6666 8.08944V14.9839C14.6666 16.9054 14.6666 17.8662 14.0226 18.2101C12.7754 18.876 10.436 16.6542 9.32498 15.9852C8.68064 15.5972 8.35847 15.4032 7.99998 15.4032C7.64148 15.4032 7.31932 15.5972 6.67498 15.9852C5.56398 16.6542 3.22454 18.876 1.97735 18.2101C1.33331 17.8662 1.33331 16.9054 1.33331 14.9839Z",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Qm=[Jm];function Km(e,t,o,u,s,n){return o.is_active?(i(),c("svg",Gm,Zm)):(i(),c("svg",Wm,Qm))}const Rs=F(qm,[["render",Km]]);const Xm={name:"RenderChildPost",components:{ImageCarousel:Vt,SurveyRenderer:Ds,DocumentLists:Ge,UserRouteLink:Le,MediaPreview:Be,FeedMdContent:Mt},props:["feed_id"],data(){return{feed:null,loading:!1,notFound:null,in_space:this.$route.params.space,hasOverflowContent:!1}},computed:{hasTopMedia(){var t,o,u,s,n,m;if(this.appVars.features.post_layout!="modern"||!this.feed)return!1;let e=["oembed","iframe_html"].includes((o=(t=this.feed.meta)==null?void 0:t.media_preview)==null?void 0:o.type);return e||(e=(s=(u=this.feed.meta)==null?void 0:u.media_preview)==null?void 0:s.is_uploaded),e||(e=((m=(n=this.feed.meta)==null?void 0:n.media_items)==null?void 0:m.length)==1),e},feedClasses(){if(!this.feed)return[];let e=["feed_single"];return e.push("feed_type_"+this.feed.type),this.hasTopMedia&&e.push("feed_modern_layout"),e}},methods:{getFeed(){this.loading=!0,this.$get("feeds/"+this.feed_id+"/by-id").then(e=>{this.feed=e.feed,this.appVars.last_feed_id<e.feed.id&&(this.appVars.last_feed_id=e.feed.id),this.$nextTick(()=>{this.setOverFlow()})}).catch(e=>{typeof e=="object"&&e.xhr_status==404?this.notFound=!0:this.$handleError(e)}).finally(()=>{this.loading=!1})},handleFeedClick(e){e.preventDefault()&&e.stopPropagation();let t={name:"single_feed",params:{feed_slug:this.feed.slug}};this.feed.space&&(t={name:"space_feed",params:{feed_slug:this.feed.slug,space:this.feed.space.slug}}),this.$router.push(t)},setOverFlow(){let e=this.$refs.feed_body;if(!e)return;e.scrollHeight>400&&(this.hasOverflowContent=!0)}},mounted(){this.getFeed()}},eh=["id"],th={key:0,class:"fcom_top_media"},sh={class:"fcom_feed_header_wrap"},oh={class:"feed_header"},ih={key:0,class:"feed_user"},nh={class:"feed_user_name"},lh={class:"feed_meta_info"},ah={key:0,class:"meta_line"},rh=["title","href"],ch={key:1,class:"feed_timestamp"},dh={key:0,class:"feed_title"},uh={class:"feed_title_heading"},_h={key:1,class:"expand-button"};function mh(e,t,o,u,s,n){var w,C,M,P,T,I,U,B,A,L;const m=g("media-preview"),p=g("UserAvatar"),h=g("UserRouteLink"),y=g("FeedMdContent"),k=j,b=g("DocumentLists"),$=g("SurveyRenderer"),f=g("ImageCarousel");return s.feed?(i(),c("div",{key:0,onClick:t[0]||(t[0]=(...E)=>n.handleFeedClick&&n.handleFeedClick(...E)),class:"fcom_child_feed"},[l("div",{id:"feed_id_"+s.feed.id,class:R([n.feedClasses,"feed"])},[n.hasTopMedia?(i(),c("div",th,[s.feed.meta&&s.feed.meta.media_preview?(i(),v(m,{key:0,feed:s.feed},null,8,["feed"])):_("",!0)])):_("",!0),l("div",sh,[l("div",oh,[s.feed.xprofile?(i(),c("div",ih,[a(p,{with_level:!1,xprofile:s.feed.xprofile},null,8,["xprofile"]),l("div",null,[l("div",nh,[a(h,{show_badge:!0,xprofile:s.feed.xprofile,show_follow:!0},null,8,["xprofile"])]),l("div",lh,[s.feed.content_type=="survey"&&((P=(M=(C=(w=s.feed)==null?void 0:w.meta)==null?void 0:C.survey_config)==null?void 0:M.options)!=null&&P.length)?(i(),c("span",ah,d(e.$t("created a poll")),1)):_("",!0),l("a",{title:s.feed.created_at,href:s.feed.permalink,class:"feed_timestamp"},d(e.humanDateDiff(s.feed.created_at)),9,rh),!s.in_space&&s.feed.space?(i(),c("span",ch,d(e.$t("Posted in %s",e.getExcerpt(s.feed.space.title,30))),1)):_("",!0)])])])):_("",!0)])]),l("div",{ref:"feed_body",class:R([{feed_is_overflow_content:s.hasOverflowContent},"feed_body"])},[s.feed.title?(i(),c("div",dh,[l("h2",uh,d(s.feed.title),1)])):_("",!0),a(y,{class_name:"feed_texts",content:s.feed.message_rendered},null,8,["content"]),s.hasOverflowContent?(i(),c("div",_h,[a(k,{class:"btn_expand"},{default:r(()=>[S(d(e.$t("Show More")),1)]),_:1})])):_("",!0)],2),s.feed.content_type=="document"?(i(),v(b,{key:1,document_lists:((I=(T=s.feed)==null?void 0:T.meta)==null?void 0:I.document_lists)||[]},null,8,["document_lists"])):(i(),c(V,{key:2},[s.feed.content_type=="survey"&&((L=(A=(B=(U=s.feed)==null?void 0:U.meta)==null?void 0:B.survey_config)==null?void 0:A.options)!=null&&L.length)?(i(),v($,{key:0,feed:s.feed,isChildFeed:!0},null,8,["feed"])):_("",!0),s.feed.meta?(i(),c(V,{key:1},[s.feed.meta.media_items?(i(),v(f,{key:0,feed:s.feed},null,8,["feed"])):!n.hasTopMedia&&s.feed.meta.media_preview?(i(),v(m,{key:1,feed:s.feed},null,8,["feed"])):_("",!0)],64)):_("",!0)],64))],10,eh)])):_("",!0)}const hh=F(Xm,[["render",mh]]),fh={name:"CustomAppMeta",components:{RenderChildPost:hh},props:{feed:{type:Object,required:!0}}},ph={ref:"fcom_custom_app"},gh={key:0},yh=["innerHTML"];function vh(e,t,o,u,s,n){const m=g("RenderChildPost");return i(),c("div",ph,[o.feed.meta.custom_app_preview.app_name=="child_post"&&o.feed.meta.custom_app_preview.feed_id?(i(),c("div",gh,[a(m,{feed_id:o.feed.meta.custom_app_preview.feed_id},null,8,["feed_id"])])):o.feed.meta.custom_app_preview.custom_html?(i(),c("div",{key:1,innerHTML:o.feed.meta.custom_app_preview.custom_html},null,8,yh)):_("",!0)],512)}const bh=F(fh,[["render",vh]]),kh={name:"FeedAction",components:{EditFeed:Wt},props:{feed:{type:Object,required:!0},hide_create_form:{type:Boolean,default:!1}},emits:["updated","deleted"],data(){return{isEdit:!1,working:!1}},computed:{isReportEnabled(){return this.has_pro&&this.appVars.moderationConfig.is_enabled},showReportOption(){var t,o;return!(((t=this.feed)==null?void 0:t.user_id)==((o=this.auth)==null?void 0:o.user_id))&&this.auth.user_id&&this.isReportEnabled}},methods:{editItem(){this.$refs.popover.hide(),this.isEdit=!0},handleUpdate(e){this.$emit("updated",e);const t=document.getElementById("feed_id_"+e.id);t&&(t.classList.add("fcon_shake"),setTimeout(()=>{t.classList.remove("fcon_shake")},1e3))},reportPost(){this.$refs.popover.hide(),this.$eventBus.emit("showReportContentModal",{reportConfig:this.feed,type:"post"})},copyFeedLink(){navigator.clipboard.writeText(this.feed.permalink).then(()=>{this.$notify.success(this.$t("Link copied to clipboard")),this.$refs.popover.hide()}).catch(e=>{this.$notify.error(this.$t("Failed to copy"))})},toggleSticky(){!this.feed.space_id||this.working||(this.working=!0,this.feed.is_sticky=!this.feed.is_sticky,this.$patch("feeds/"+this.feed.id,{is_sticky:this.feed.is_sticky?1:0}).then(e=>{this.feed.is_sticky=e.feed.is_sticky,this.$emit("reload")}).catch(e=>{this.$handleError(e)}).finally(()=>{this.working=!1}))},toggleSidebarPin(){!this.feed.space_id||this.working||(this.$refs.popover.hide(),this.working=!0,this.feed.priority=!this.feed.priority,this.$patch("feeds/"+this.feed.id,{priority:this.feed.priority?1:0}).then(e=>{this.$notify.success(e.feed.priority?this.$t("Pinned to sidebar"):this.$t("Unpinned from sidebar")),this.feed.priority=e.feed.priority,this.$eventBus.emit("updateSpaceSidebar",this.feed.space_id)}).catch(e=>{this.$handleError(e)}).finally(()=>{this.working=!1}))},toggleCommentStatus(){var t;if(this.working)return;let e=((t=this.feed.meta)==null?void 0:t.comments_disabled)=="yes";this.$refs.popover.hide(),this.working=!0,this.$patch("feeds/"+this.feed.id,{comments_disabled:e?0:1}).then(o=>{var s;let u=((s=o.feed.meta)==null?void 0:s.comments_disabled)=="yes";this.$notify.success(u?this.$t("Comments have been disabled."):this.$t("Comments have been enabled.")),this.feed.meta.comments_disabled=o.feed.meta.comments_disabled}).catch(o=>{this.$handleError(o)}).finally(()=>{this.working=!1})},removePreview(){this.working=!0,this.$del("feeds/"+this.feed.id+"/media-preview").then(e=>{this.feed.meta.media_preview=null}).catch(e=>{this.$handleError(e)}).finally(()=>{this.working=!1})},deleteItem(){this.working||(this.$refs.popover.hide(),this.$confirm(this.$t("Are you sure you want to delete this feed?"),this.$t("Warning"),{confirmButtonText:this.$t("Delete"),cancelButtonText:this.$t("Cancel"),confirmButtonClass:"fcom_primary_button",cancelButtonClass:"fcom_secondary_button",type:"warning"}).then(()=>{this.working||(this.working=!0,this.$emit("deleted"),(this.$route.name==="space_feed"||this.$route.name=="single_feed")&&this.$router.push({name:"all_feeds"}),this.working=!1)}).catch(()=>{}))}}},wh={class:"actions_items"},Ch={key:0},$h={key:1},Sh={key:0},Vh={key:1},Lh={key:0},Mh={key:1};function Ph(e,t,o,u,s,n){const m=g("MoreFilled"),p=O,h=j,y=de,k=g("EditFeed");return i(),c(V,null,[a(y,{persistent:!1,ref:"popover",placement:"bottom",width:200,trigger:"click"},{reference:r(()=>[a(h,{"aria-label":e.$t("View Post actions"),class:"fcom_dot_menu",size:"small",text:""},{default:r(()=>[a(p,null,{default:r(()=>[a(m)]),_:1})]),_:1},8,["aria-label"])]),default:r(()=>{var b,$;return[l("ul",wh,[z(e.$slots,"before_feed_actions_pop"),l("li",{onClick:t[0]||(t[0]=f=>n.copyFeedLink())},d(e.$t("Copy Link")),1),n.showReportOption?(i(),c("li",{key:0,onClick:t[1]||(t[1]=f=>n.reportPost())},d(e.$t("Report Post")),1)):_("",!0),e.canEditFeed(o.feed)?(i(),c(V,{key:1},[l("li",{onClick:t[2]||(t[2]=f=>n.editItem())},d(e.$t("Edit")),1),o.feed.space&&e.hasSpaceAdminAccess(o.feed.space)?(i(),c(V,{key:0},[l("li",{onClick:t[3]||(t[3]=f=>n.toggleSticky())},[o.feed.is_sticky?(i(),c("span",Ch,d(e.$t("Unpin from Top")),1)):(i(),c("span",$h,d(e.$t("Pin to top")),1))]),l("li",{onClick:t[4]||(t[4]=f=>n.toggleSidebarPin())},[o.feed.priority?(i(),c("span",Vh,d(e.$t("Unpin from sidebar")),1)):(i(),c("span",Sh,d(e.$t("Pin to sidebar")),1))])],64)):_("",!0),(b=o.feed.meta)!=null&&b.media_preview?(i(),c("li",{key:1,onClick:t[5]||(t[5]=f=>n.removePreview())},d(e.$t("Remove Preview")),1)):_("",!0),e.hasSpaceAdminAccess(o.feed.space)?(i(),c("li",{key:2,onClick:t[6]||(t[6]=f=>n.toggleCommentStatus())},[(($=o.feed.meta)==null?void 0:$.comments_disabled)=="yes"?(i(),c("span",Lh,d(e.$t("Enable comments")),1)):(i(),c("span",Mh,d(e.$t("Disable comments")),1))])):_("",!0)],64)):_("",!0),e.canDeleteFeed(o.feed)?(i(),c("li",{key:2,onClick:t[7]||(t[7]=f=>n.deleteItem())},d(e.$t("Delete")),1)):_("",!0),z(e.$slots,"after_feed_actions_pop")])]}),_:3},512),s.isEdit?(i(),v(k,{key:0,feedSlug:o.feed.slug,dialogVisible:s.isEdit,hide_create_form:o.hide_create_form,onUpdated:n.handleUpdate,onClose:t[8]||(t[8]=b=>s.isEdit=!1)},null,8,["feedSlug","dialogVisible","hide_create_form","onUpdated"])):_("",!0)],64)}const Hs=F(kh,[["render",Ph]]);const Fh={name:"Feed",components:{DocumentLists:Ge,CustomAppMeta:bh,BookmarkIcon:Rs,StickyIcon:Lt,UserRouteLink:Le,EditFeed:Wt,FeedFooter:s_,MediaPreview:Be,ImageCarousel:Vt,SurveyRenderer:Ds,ReportReview:Is,FeedAction:Hs,FeedMdContent:Mt},emits:["updated","deleted","reload","commented"],props:{feed:{type:Object,required:!0},is_single:{type:Boolean,default:!1},is_route:{type:Boolean,default:!1},show_footer:{type:Boolean,default:!0},show_header:{type:Boolean,default:!0},show_report:{type:Boolean,default:!1},hide_create_form:{type:Boolean,default:!1},is_preview:{type:Boolean,default:!1},show_actions:{type:Boolean,default:!0},is_modal:{type:Boolean,default:!1},isSingleSpacePage:{type:Boolean,default:!1}},data(){return{in_space:this.$route.params.space,working:!1,hasOverflowContent:!1,isExpanded:!1,joiningSpace:!1}},computed:{isReportEnabled(){return this.has_pro&&this.appVars.moderationConfig.is_enabled},showReport(){var e;return this.hasSpaceModeratorAccess(this.feed.space)&&this.isReportEnabled&&this.show_report&&((e=this.feed.meta)==null?void 0:e.reports_count)},space_slug(){let e=!1;return this.feed.space?e=this.feed.space.slug:this.$route.params.space&&(e=this.$route.params.space),e},feedClasses(){let e=[];return e.push("feed_type_"+this.feed.type),this.feed.type=="article"&&e.push(this.feed.featured_image?"feed_has_image":"feed_no_image"),this.is_preview&&e.push("feed_preview"),this.is_single?e.push("feed_single"):e.push("feed_list_item"),this.hasTopMedia&&e.push("feed_modern_layout"),e},feedRoute(){let e={name:"single_feed",params:{feed_slug:this.feed.slug}};return this.space_slug&&(e={name:"space_feed",params:{feed_slug:this.feed.slug,space:this.space_slug}}),e},hasTopMedia(){var t,o,u,s,n,m;if(this.appVars.features.post_layout!="modern")return!1;let e=["oembed","iframe_html"].includes((o=(t=this.feed.meta)==null?void 0:t.media_preview)==null?void 0:o.type);return e||(e=(s=(u=this.feed.meta)==null?void 0:u.media_preview)==null?void 0:s.is_uploaded),e||(e=((m=(n=this.feed.meta)==null?void 0:n.media_items)==null?void 0:m.length)==1),e}},methods:{getTopicRoute(e){return this.space_slug?{name:"space_feeds",params:{space:this.space_slug},query:{topic:e}}:{name:"all_feeds",query:{topic:e}}},getScheduledTime(e){return this.formattedDate(e)+" at "+this.formattedTime(e)},gotoTopicUrl(e){let t=this.getTopicRoute(e);this.$router.push(t)},gotoFeed(e){e&&(e.metaKey||e.ctrlKey)||(e&&(e.preventDefault(),e.stopPropagation()),window.__showing_feed=this.feed,this.$router.push(this.feedRoute))},getSpaceRoute(e){return{name:"space_feeds",params:{space:e}}},getFeedContent(){return this.feed.title},showFullContent(e){if(!this.hasFeature("show_post_modal")){this.hasOverflowContent=!1,this.isExpanded=!0;return}e&&e.stopPropagation(),this.$eventBus.emit("showFeedModal",{feed:this.feed})},parseMessage(e){if(!e)return"";const t=this.$route.params.space?`${this.appVars.urls.portal_base}space/${this.$route.params.space}/home`:this.appVars.urls.global_search;let o=e.replace(/<a\s(?:(?!target="_blank")[^>])*>|<[^>]+>|#([\p{L}\p{M}\p{N}_-]+)/gu,(s,n,m,p)=>s.startsWith("<a")&&!s.includes('target="_blank"')?s.includes(window.location.origin)?s:s.replace("<a",'<a target="_blank" rel="noopener noreferrer nofollow"'):n&&!this.isInsideHtmlTag(p,m)?`<a onclick="window.FluentCommunityUtil.handleSearchClick(event)" href="${t}?search=%23${n}">#${n}</a>`:s);return o.indexOf('<span class="fcom_dynamic_prop" data-type="timestamp"')===-1?o:(s=>s.replace(/<span class="fcom_dynamic_prop" data-type="timestamp" data-timestamp="(\d+)">([^<]+)<\/span>/g,(n,m,p)=>{try{const h=this.dayjs(m*1e3);if(!h.isValid())return n;const k=h.local().format("D MMM YYYY, LT (")+this.currentTimeZoneName+")";return`<span class="fcom_timestamp" title="${p}">${k}</span>`}catch{return n}}))(o)},isInsideHtmlTag(e,t){let o=!1;for(let u=0;u<t;u++)e[u]==="<"&&(o=!0),e[u]===">"&&(o=!1);return o},handleUpdate(e){this.$emit("updated",e),Object.assign(this.feed,e)},handleDelete(){this.$emit("deleted")},handleRemoveBookmark(){this.$emit("deleted")},toggleBookmark(){const e={react_type:"bookmark"};this.feed.bookmarked&&(e.remove=!0),this.feed.bookmarked=!this.feed.bookmarked,this.$post("feeds/"+this.feed.id+"/react",e).then(t=>{this.$notify.success(this.feed.bookmarked?this.$t("Bookmarked"):this.$t("Removed from bookmark")),!this.feed.bookmarked&&this.$route.name==="bookmarks"&&this.$emit("removeFromBookmark")}).catch(t=>{this.$handleError(t),this.feed.bookmarked=!this.feed.bookmarked})},toggleSticky(){this.feed.space_id&&(this.feed.is_sticky=!this.feed.is_sticky,this.$patch("feeds/"+this.feed.id,{is_sticky:this.feed.is_sticky?1:0}).then(e=>{this.feed.is_sticky=e.feed.is_sticky,this.$emit("reload")}).catch(e=>{this.$handleError(e)}))},joinSpace(){this.joiningSpace=!0,this.$post("spaces/"+this.feed.space.slug+"/join").then(e=>{this.appVars.user_membership_slugs.push(this.feed.space.slug),this.$notify.success(e.message),document.location.href=this.feed.permalink}).catch(e=>{this.$handleError(e)}).finally(()=>{this.joiningSpace=!1})}},created(){this.$eventBus.on("updateModerationReport",e=>{var t,o;((t=e.content)==null?void 0:t.id)==((o=this.feed)==null?void 0:o.id)&&(this.feed.meta.reports_count=e.content.meta.reports_count,this.$emit("updated",this.feed))})},mounted(){if(document.dispatchEvent(new CustomEvent("fcomFeedMounted",{detail:{isSingle:this.is_single,feed:this.feed,feedBody:this.$refs.feed_body}})),this.is_single||this.feed.is_sticky||this.feed.priority){this.isExpanded=!0;return}let e=this.$refs.feed_body;if(!e)return;e.scrollHeight>400&&(this.hasOverflowContent=!0)}},Th=["id"],Ih={key:1,class:"fcom_top_media"},Uh={key:2,class:"fcom_feed_header_wrap"},Bh={class:"feed_actions fcom_concat_buttons"},Eh={key:0,class:"fcom_feed_topics"},Ah={class:"feed_header"},Dh={key:0,class:"feed_user"},Rh={class:"feed_user_info"},Hh={class:"feed_user_name"},xh={key:0,class:"feed_status"},jh={key:1,class:"feed_status"},Oh={class:"feed_meta_info"},Nh={key:0,class:"meta_line"},zh=["title","href"],qh=["title","href"],Gh={key:3},Yh={key:0,class:"feed_title"},Zh={key:0,class:"feed_title_heading"},Wh=["href"],Jh={key:1,class:"feed_title_heading"};function Qh(e,t,o,u,s,n){var E,G,se,H,X,x,Q,ce,J,ae,W,te,ct;const m=g("report-review"),p=g("media-preview"),h=j,y=g("StickyIcon"),k=O,b=g("BookmarkIcon"),$=g("FeedAction"),f=g("router-link"),w=g("UserAvatar"),C=g("UserRouteLink"),M=Oe,P=g("FeedMdContent"),T=g("SurveyRenderer"),I=g("ImageCarousel"),U=g("DocumentLists"),B=g("CustomAppMeta"),A=g("feed-footer"),L=K("loading");return N((i(),c("div",{id:"feed_id_"+((E=o.feed)==null?void 0:E.id),class:R([n.feedClasses,"feed"])},[n.showReport?(i(),v(m,{key:0,feed:o.feed},null,8,["feed"])):_("",!0),n.hasTopMedia?(i(),c("div",Ih,[o.feed.meta&&o.feed.meta.media_preview?(i(),v(p,{key:0,feed:o.feed,is_preview:o.is_preview},null,8,["feed","is_preview"])):_("",!0)])):_("",!0),o.show_header?(i(),c("div",Uh,[l("div",Bh,[e.auth.user_id&&!e.hasSpaceAccess((G=o.feed.space)==null?void 0:G.slug)&&!o.is_single&&!o.isSingleSpacePage?(i(),v(h,{key:0,loading:s.joiningSpace,class:"fcom_secondary_button",onClick:t[0]||(t[0]=me=>n.joinSpace())},{default:r(()=>[S(d(e.$t("Join")),1)]),_:1},8,["loading"])):_("",!0),o.show_actions?(i(),c(V,{key:1},[o.feed.is_sticky&&s.in_space?(i(),v(h,{key:0,onClick:t[1]||(t[1]=me=>n.toggleSticky()),"aria-label":e.$t("Toggle Sticky"),class:"no_pad_btn",text:"",size:"small"},{default:r(()=>[a(k,{class:"fcom_sticky"},{default:r(()=>[a(y)]),_:1})]),_:1},8,["aria-label"])):_("",!0),e.auth.user_id?(i(),v(h,{key:1,"aria-label":e.$t("Toggle Bookmark"),size:"small",text:"",onClick:t[2]||(t[2]=me=>n.toggleBookmark()),class:R([{bookmark_active:o.feed.bookmarked},"feed_bookmark no_pad_btn"]),title:o.feed.bookmarked?e.$t("Remove From Bookmark"):e.$t("Bookmark this post")},{default:r(()=>[a(k,{style:{"font-size":"14px"}},{default:r(()=>[a(b,{is_active:o.feed.bookmarked},null,8,["is_active"])]),_:1})]),_:1},8,["aria-label","class","title"])):_("",!0),a($,{feed:o.feed,hide_create_form:o.hide_create_form,onUpdated:n.handleUpdate,onDeleted:n.handleDelete},{before_feed_actions_pop:r(()=>[o.is_route?(i(),c("li",{key:0,onClick:t[3]||(t[3]=me=>e.$emit("reload"))},d(e.$t("Refresh")),1)):_("",!0)]),_:1},8,["feed","hide_create_form","onUpdated","onDeleted"])],64)):_("",!0),z(e.$slots,"after_feed_actions")]),((se=e.appVars.topicsConfig)==null?void 0:se.show_on_post_card)=="yes"&&o.feed.terms&&o.feed.terms.length?(i(),c("div",Eh,[(i(!0),c(V,null,D(o.feed.terms,me=>(i(),v(f,{onClick:Z(cI=>n.gotoTopicUrl(me.slug),["prevent"]),key:me.slug,to:n.getTopicRoute(me.slug),class:"feed_timestamp"},{default:r(()=>[S("#"+d(me.title),1)]),_:2},1032,["onClick","to"]))),128))])):_("",!0),l("div",Ah,[o.feed.xprofile?(i(),c("div",Dh,[a(w,{with_level:!1,xprofile:o.feed.xprofile},null,8,["xprofile"]),l("div",Rh,[l("div",Hh,[a(C,{show_badge:!0,xprofile:o.feed.xprofile,show_follow:!0},null,8,["xprofile"]),o.feed.status=="pending"?(i(),c("span",xh,[a(M,{type:"warning"},{default:r(()=>[S(d(e.$t("In Review")),1)]),_:1})])):_("",!0),o.feed.status=="scheduled"?(i(),c("span",jh,[a(M,{type:"warning"},{default:r(()=>[S(d(e.$t("Scheduled")),1)]),_:1})])):_("",!0)]),l("div",Oh,[o.feed.content_type=="survey"&&((Q=(x=(X=(H=o.feed)==null?void 0:H.meta)==null?void 0:X.survey_config)==null?void 0:x.options)!=null&&Q.length)?(i(),c("span",Nh,d(e.$t("created a poll")),1)):_("",!0),o.feed.status=="scheduled"?(i(),c("a",{key:1,title:o.feed.scheduled_at,onClick:t[4]||(t[4]=(...me)=>n.gotoFeed&&n.gotoFeed(...me)),href:o.feed.permalink,class:"feed_timestamp"},d(n.getScheduledTime(o.feed.scheduled_at)),9,zh)):(i(),c("a",{key:2,title:o.feed.created_at,onClick:t[5]||(t[5]=(...me)=>n.gotoFeed&&n.gotoFeed(...me)),href:o.feed.permalink,class:"feed_timestamp"},d(e.humanDateDiff(o.feed.created_at)),9,qh)),!s.in_space&&o.feed.space?(i(),c("span",Gh,[a(f,{to:n.getSpaceRoute(o.feed.space.slug),class:"feed_timestamp"},{default:r(()=>[S(d(e.$t("Posted in %s",e.getExcerpt(o.feed.space.title,30))),1)]),_:1},8,["to"])])):_("",!0)])])])):_("",!0),z(e.$slots,"after_feed_header")])])):_("",!0),l("div",{ref:"feed_body",class:R([{feed_is_overflow_content:s.hasOverflowContent},"feed_body"])},[o.feed.title?(i(),c("div",Yh,[o.is_single?(i(),c("h2",Jh,d(o.feed.title),1)):(i(),c("h2",Zh,[l("a",{onClick:t[6]||(t[6]=Z((...me)=>n.showFullContent&&n.showFullContent(...me),["prevent"])),href:o.feed.permalink},d(o.feed.title),9,Wh)]))])):_("",!0),a(P,{class_name:"feed_texts",content:n.parseMessage(o.feed.message_rendered)},null,8,["content"]),s.hasOverflowContent&&!s.isExpanded?(i(),c("div",{key:1,onClick:t[7]||(t[7]=me=>n.showFullContent()),class:"expand-button"},[a(h,{class:"btn_expand"},{default:r(()=>[S(d(e.$t("Show More")),1)]),_:1})])):_("",!0)],2),o.feed.content_type=="survey"&&((W=(ae=(J=(ce=o.feed)==null?void 0:ce.meta)==null?void 0:J.survey_config)==null?void 0:ae.options)!=null&&W.length)?(i(),c(V,{key:3},[a(T,{feed:o.feed,is_preview:o.is_preview,hasTopMedia:n.hasTopMedia},null,8,["feed","is_preview","hasTopMedia"]),o.feed.meta.media_items?(i(),v(I,{key:0,is_single:o.is_single,feed:o.feed},null,8,["is_single","feed"])):!n.hasTopMedia&&o.feed.meta.media_preview?(i(),v(p,{key:1,feed:o.feed},null,8,["feed"])):_("",!0)],64)):o.feed.content_type=="document"?(i(),v(U,{key:4,document_lists:((ct=(te=o.feed)==null?void 0:te.meta)==null?void 0:ct.document_lists)||[]},null,8,["document_lists"])):o.feed.meta?(i(),c(V,{key:5},[o.feed.meta.media_items?(i(),v(I,{key:0,is_single:o.is_single,feed:o.feed},null,8,["is_single","feed"])):!n.hasTopMedia&&o.feed.meta.media_preview?(i(),v(p,{key:1,feed:o.feed},null,8,["feed"])):_("",!0),o.feed.meta.custom_app_preview?(i(),v(B,{key:2,feed:o.feed},null,8,["feed"])):_("",!0)],64)):_("",!0),o.show_footer?(i(),v(A,{key:6,feed:o.feed,is_modal:o.is_modal,is_single:o.is_single,space_slug:n.space_slug,onJoinSpace:t[8]||(t[8]=()=>{n.joinSpace()}),onCommented:t[9]||(t[9]=me=>{e.$emit("commented",me)})},null,8,["feed","is_modal","is_single","space_slug"])):_("",!0),z(e.$slots,"after_feed_footer")],10,Th)),[[L,s.working]])}const Ze=F(Fh,[["render",Qh]]),Kh={data(){return{isDarkMode:!1}},methods:{updateDarkMode(){this.isDarkMode=document.documentElement.classList.contains("dark")}},mounted(){this.updateDarkMode(),this.observer=new MutationObserver(this.updateDarkMode),this.observer.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]})},beforeUnmount(){this.observer&&this.observer.disconnect()}},Xh={name:"FeedCard",mixins:[Kh],components:{UserRouteLink:Le,ChatIcon:ze,HeartIcon:qe,StickyIcon:Lt,MediaPreview:Be,ImageCarousel:Vt,UserAvatar:Jt,FeedAction:Hs},props:{feed:{type:Object,required:!0},hide_create_form:{type:Boolean,default:!1}},emits:["updated","deleted"],computed:{feedRoute(){let e={name:"single_feed",params:{feed_slug:this.feed.slug}};return this.feed.space&&(e={name:"space_feed",params:{feed_slug:this.feed.slug,space:this.feed.space.slug}}),e},placeholderImageSrc(){const e=this.isDarkMode?"feed-placeholder-dark.png":"feed-placeholder.png";return this.appVars.assets_url+"images/"+e}},data(){return{in_space:this.$route.params.space}},methods:{handleUpdate(e){this.$emit("updated",e),Object.assign(this.feed,e)},handleDelete(){this.$emit("deleted")},getFeedHref(){return this.hasFeature("show_post_modal")?null:this.$router.resolve(this.feedRoute).href},getSpaceRoute(e){return{name:"space_feeds",params:{space:e}}},goToFeedView(e,t=!1){if(this.hasFeature("show_post_modal")){this.feed.auto_focus_comment=t,this.$eventBus.emit("showFeedModal",{feed:this.feed,view:t?"comments":"",auto_focus_comment:t});return}e.ctrlKey||e.metaKey||(e.preventDefault(),window.__showing_feed=this.feed,this.$router.push(this.feedRoute))},toggleReact(){const e={react_type:"like"};this.feed.has_user_react&&(e.remove=!0),this.feed.has_user_react=!this.feed.has_user_react,this.$post("feeds/"+this.feed.id+"/react",e).then(t=>{this.feed.reactions_count=t.new_count}).catch(t=>{this.$handleError(t),this.feed.has_user_react=!this.feed.has_user_react})}}},ef=["id"],tf={class:"fcom_feed_card_header"},sf=["src"],of=["src"],nf=["src","alt"],lf={class:"feed_card_user"},af={class:"feed_card_body"},rf=["innerHTML"],cf={class:"card_description feed_meta_info"},df=["title","href"],uf={key:0},_f={class:"fcom_feed_card_footer"},mf={class:"num_label"},hf={class:"num_label"},ff={class:"fcom_feed_card_action"};function pf(e,t,o,u,s,n){var w,C,M,P;const m=g("UserAvatar"),p=g("UserRouteLink"),h=g("router-link"),y=g("HeartIcon"),k=O,b=j,$=g("ChatIcon"),f=g("FeedAction");return i(),c("div",{id:"feed_id_"+((w=o.feed)==null?void 0:w.id),class:"fcom_feed_card"},[l("div",tf,[l("div",{onClick:t[0]||(t[0]=(...T)=>n.goToFeedView&&n.goToFeedView(...T)),class:"feed_card_cover"},[o.feed.meta?(i(),c(V,{key:0},[(C=o.feed.meta.media_preview)!=null&&C.image?(i(),c("img",{key:0,src:o.feed.meta.media_preview.image,class:"card_image"},null,8,sf)):(P=(M=o.feed.meta.media_items)==null?void 0:M[0])!=null&&P.url?(i(),c("img",{key:1,src:o.feed.meta.media_items[0].url,class:"card_image"},null,8,of)):(i(),c("img",{key:2,src:n.placeholderImageSrc,class:"card_image",alt:e.$t("Placeholder image")},null,8,nf))],64)):_("",!0)]),l("div",lf,[a(m,{with_level:!1,xprofile:o.feed.xprofile},null,8,["xprofile"])]),l("div",af,[l("div",{onClick:t[1]||(t[1]=(...T)=>n.goToFeedView&&n.goToFeedView(...T)),class:"card_title feed_texts feed_md_content",innerHTML:e.getExcerpt(o.feed.title||o.feed.message_rendered,60)},null,8,rf),l("div",cf,[a(p,{xprofile:o.feed.xprofile,show_verified:!1,show_follow:!0},null,8,["xprofile"]),l("a",{title:o.feed.created_at,onClick:t[2]||(t[2]=(...T)=>n.goToFeedView&&n.goToFeedView(...T)),href:o.feed.permalink,class:"feed_timestamp"},d(e.humanDateDiff(o.feed.created_at)),9,df),!s.in_space&&o.feed.space?(i(),c("span",uf,[a(h,{to:n.getSpaceRoute(o.feed.space.slug),class:"feed_timestamp"},{default:r(()=>[S(d(e.$t(e.getExcerpt(o.feed.space.title,30))),1)]),_:1},8,["to"])])):_("",!0)])])]),l("div",_f,[a(b,{text:""},{default:r(()=>[a(k,{class:R({user_reacted:o.feed.has_user_react}),onClick:t[3]||(t[3]=T=>n.toggleReact())},{default:r(()=>[a(y,{filled:o.feed.has_user_react},null,8,["filled"])]),_:1},8,["class"]),l("span",mf,d(o.feed.reactions_count),1)]),_:1}),a(b,{onClick:t[4]||(t[4]=T=>n.goToFeedView(T,!0)),text:""},{default:r(()=>[a(k,null,{default:r(()=>[a($)]),_:1}),l("span",hf,d(o.feed.comments_count),1)]),_:1})]),l("div",ff,[a(f,{feed:o.feed,hide_create_form:o.hide_create_form,onUpdated:n.handleUpdate,onDeleted:n.handleDelete},null,8,["feed","hide_create_form","onUpdated","onDeleted"])])],8,ef)}const gf=F(Xh,[["render",pf]]),yf={name:"FeedListItem",components:{UserRouteLink:Le,ChatIcon:ze,HeartIcon:qe,StickyIcon:Lt},props:["feed"],computed:{feedRoute(){let e={name:"single_feed",params:{feed_slug:this.feed.slug}};return this.feed.space&&(e={name:"space_feed",params:{feed_slug:this.feed.slug,space:this.feed.space.slug}}),e}},data(){return{in_space:this.$route.params.space}},methods:{getFeedHref(){return this.hasFeature("show_post_modal")?null:this.$router.resolve(this.feedRoute).href},parseMessage(e){if(!e)return"";const t=this.$route.params.space?`${this.appVars.urls.portal_base}space/${this.$route.params.space}/home`:this.appVars.urls.global_search;return e.replace(/<a\s(?:(?!target="_blank")[^>])*>|<[^>]+>|#([\p{L}\p{M}\p{N}_-]+)/gu,(o,u,s,n)=>o.startsWith("<a")&&!o.includes('target="_blank"')?o.includes(window.location.origin)?o:o.replace("<a",'<a target="_blank" rel="noopener"'):u&&!this.isInsideHtmlTag(n,s)?`<a onclick="window.FluentCommunityUtil.handleSearchClick(event)" href="${t}?search=%23${u}">#${u}</a>`:o)},isInsideHtmlTag(e,t){let o=!1;for(let u=0;u<t;u++)e[u]==="<"&&(o=!0),e[u]===">"&&(o=!1);return o},goToFeedView(e,t=!1){if(this.hasFeature("show_post_modal")){this.feed.auto_focus_comment=t,this.$eventBus.emit("showFeedModal",{feed:this.feed,view:t?"comments":"",auto_focus_comment:t});return}e.ctrlKey||e.metaKey||(e.preventDefault(),window.__showing_feed=this.feed,this.$router.push(this.feedRoute))},toggleReact(){const e={react_type:"like"};this.feed.has_user_react&&(e.remove=!0),this.feed.has_user_react=!this.feed.has_user_react,this.$post("feeds/"+this.feed.id+"/react",e).then(t=>{this.feed.reactions_count=t.new_count}).catch(t=>{this.$handleError(t),this.feed.has_user_react=!this.feed.has_user_react})}}},vf=["id"],bf={class:"fcom_feed_data"},kf={key:0,class:"fcom_sticky"},wf={class:"feed_user"},Cf=["href"],$f=["href"],Sf=["innerHTML"],Vf={class:"fcom_feed_meta"},Lf={key:0},Mf={class:"feed_actions"},Pf={class:"num_label"},Ff={class:"num_label"};function Tf(e,t,o,u,s,n){var $,f,w;const m=g("StickyIcon"),p=O,h=g("UserAvatar"),y=g("HeartIcon"),k=j,b=g("ChatIcon");return i(),c("div",{id:"feed_id_"+(($=o.feed)==null?void 0:$.id),class:"fcom_feed_list"},[l("div",bf,[o.feed.is_sticky?(i(),c("div",kf,[a(p,{class:"fcom_sticky"},{default:r(()=>[a(m)]),_:1})])):_("",!0),l("div",wf,[l("a",{href:n.getFeedHref(),onClick:t[0]||(t[0]=(...C)=>n.goToFeedView&&n.goToFeedView(...C))},[a(h,{with_level:!1,xprofile:o.feed.xprofile},null,8,["xprofile"])],8,Cf)]),l("a",{href:n.getFeedHref(),onClick:t[1]||(t[1]=(...C)=>n.goToFeedView&&n.goToFeedView(...C)),class:"feed_body"},[l("div",{class:"feed_texts feed_md_content",innerHTML:e.getExcerpt(o.feed.title||o.feed.message_rendered,250)},null,8,Sf),l("div",Vf,[S(d(((w=(f=o.feed)==null?void 0:f.xprofile)==null?void 0:w.display_name)||"No Name")+" ‚Ä¢ "+d(e.humanDateDiff(o.feed.created_at))+" ",1),!s.in_space&&o.feed.space?(i(),c("span",Lf,"‚Ä¢ #"+d(o.feed.space.slug),1)):_("",!0)])],8,$f)]),l("div",Mf,[a(k,{text:""},{default:r(()=>[a(p,{class:R({user_reacted:o.feed.has_user_react}),onClick:t[2]||(t[2]=C=>n.toggleReact())},{default:r(()=>[a(y,{filled:o.feed.has_user_react},null,8,["filled"])]),_:1},8,["class"]),l("span",Pf,d(o.feed.reactions_count),1)]),_:1}),a(k,{onClick:t[3]||(t[3]=C=>n.goToFeedView(C,!0)),text:""},{default:r(()=>[a(p,null,{default:r(()=>[a(b)]),_:1}),l("span",Ff,d(o.feed.comments_count),1)]),_:1})])],8,vf)}const xs=F(yf,[["render",Tf]]),If={name:"SwitchTimelineIcon"},Uf={width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Bf=l("path",{d:"M4 1H13.75V2.5H4V1ZM1.375 2.875C1.07663 2.875 0.790483 2.75647 0.579505 2.5455C0.368526 2.33452 0.25 2.04837 0.25 1.75C0.25 1.45163 0.368526 1.16548 0.579505 0.954505C0.790483 0.743526 1.07663 0.625 1.375 0.625C1.67337 0.625 1.95952 0.743526 2.1705 0.954505C2.38147 1.16548 2.5 1.45163 2.5 1.75C2.5 2.04837 2.38147 2.33452 2.1705 2.5455C1.95952 2.75647 1.67337 2.875 1.375 2.875ZM1.375 8.125C1.07663 8.125 0.790483 8.00647 0.579505 7.7955C0.368526 7.58452 0.25 7.29837 0.25 7C0.25 6.70163 0.368526 6.41548 0.579505 6.2045C0.790483 5.99353 1.07663 5.875 1.375 5.875C1.67337 5.875 1.95952 5.99353 2.1705 6.2045C2.38147 6.41548 2.5 6.70163 2.5 7C2.5 7.29837 2.38147 7.58452 2.1705 7.7955C1.95952 8.00647 1.67337 8.125 1.375 8.125ZM1.375 13.3C1.07663 13.3 0.790483 13.1815 0.579505 12.9705C0.368526 12.7595 0.25 12.4734 0.25 12.175C0.25 11.8766 0.368526 11.5905 0.579505 11.3795C0.790483 11.1685 1.07663 11.05 1.375 11.05C1.67337 11.05 1.95952 11.1685 2.1705 11.3795C2.38147 11.5905 2.5 11.8766 2.5 12.175C2.5 12.4734 2.38147 12.7595 2.1705 12.9705C1.95952 13.1815 1.67337 13.3 1.375 13.3ZM4 6.25H13.75V7.75H4V6.25ZM4 11.5H13.75V13H4V11.5Z",fill:"currentColor"},null,-1),Ef=[Bf];function Af(e,t,o,u,s,n){return i(),c("svg",Uf,Ef)}const Df=F(If,[["render",Af]]),Rf={name:"SwitchListIcon"},Hf={width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",role:"img",color:"#666666"},xf=l("path",{d:"M2.53168 9.32334C2.79738 9.26497 3.0942 9.25 3.4 9.25H20.6C20.9058 9.25 21.2026 9.26497 21.4683 9.32334C21.7425 9.38357 22.0291 9.49978 22.2647 9.73532C22.5002 9.97086 22.6164 10.2575 22.6767 10.5317C22.735 10.7974 22.75 11.0942 22.75 11.4V12.6C22.75 12.9058 22.735 13.2026 22.6767 13.4683C22.6164 13.7425 22.5002 14.0291 22.2647 14.2647C22.0291 14.5002 21.7425 14.6164 21.4683 14.6767C21.2026 14.735 20.9058 14.75 20.6 14.75H3.4C3.0942 14.75 2.79738 14.735 2.53168 14.6767C2.25749 14.6164 1.97086 14.5002 1.73532 14.2647C1.49978 14.0291 1.38357 13.7425 1.32334 13.4683C1.26497 13.2026 1.25 12.9058 1.25 12.6V11.4C1.25 11.0942 1.26497 10.7974 1.32334 10.5317C1.38357 10.2575 1.49978 9.97086 1.73532 9.73532C1.97086 9.49978 2.25749 9.38357 2.53168 9.32334Z",fill:"var(--fcom-primary-text)"},null,-1),jf=l("path",{opacity:"0.4",d:"M2.53168 1.32334C2.79738 1.26497 3.0942 1.25 3.4 1.25H20.6C20.9058 1.25 21.2026 1.26497 21.4683 1.32334C21.7425 1.38357 22.0291 1.49978 22.2647 1.73532C22.5002 1.97086 22.6164 2.25749 22.6767 2.53168C22.735 2.79738 22.75 3.0942 22.75 3.4V4.6C22.75 4.9058 22.735 5.20262 22.6767 5.46832C22.6164 5.74251 22.5002 6.02914 22.2647 6.26468C22.0291 6.50022 21.7425 6.61643 21.4683 6.67666C21.2026 6.73503 20.9058 6.75 20.6 6.75H3.4C3.0942 6.75 2.79738 6.73503 2.53168 6.67666C2.25749 6.61643 1.97086 6.50022 1.73532 6.26468C1.49978 6.02914 1.38357 5.74251 1.32334 5.46832C1.26497 5.20262 1.25 4.9058 1.25 4.6V3.4C1.25 3.0942 1.26497 2.79738 1.32334 2.53168C1.38357 2.25749 1.49978 1.97086 1.73532 1.73532C1.97086 1.49978 2.25749 1.38357 2.53168 1.32334Z",fill:"var(--fcom-primary-text)"},null,-1),Of=l("path",{opacity:"0.4",d:"M2.53168 17.3233C2.79738 17.265 3.0942 17.25 3.4 17.25H20.6C20.9058 17.25 21.2026 17.265 21.4683 17.3233C21.7425 17.3836 22.0291 17.4998 22.2647 17.7353C22.5002 17.9709 22.6164 18.2575 22.6767 18.5317C22.735 18.7974 22.75 19.0942 22.75 19.4V20.6C22.75 20.9058 22.735 21.2026 22.6767 21.4683C22.6164 21.7425 22.5002 22.0291 22.2647 22.2647C22.0291 22.5002 21.7425 22.6164 21.4683 22.6767C21.2026 22.735 20.9058 22.75 20.6 22.75H3.4C3.0942 22.75 2.79738 22.735 2.53168 22.6767C2.25749 22.6164 1.97086 22.5002 1.73532 22.2647C1.49978 22.0291 1.38357 21.7425 1.32334 21.4683C1.26497 21.2026 1.25 20.9058 1.25 20.6V19.4C1.25 19.0942 1.26497 18.7974 1.32334 18.5317C1.38357 18.2575 1.49978 17.9709 1.73532 17.7353C1.97086 17.4998 2.25749 17.3836 2.53168 17.3233Z",fill:"var(--fcom-primary-text)"},null,-1),Nf=[xf,jf,Of];function zf(e,t,o,u,s,n){return i(),c("svg",Hf,Nf)}const qf=F(Rf,[["render",zf]]),Gf={name:"SwitchCardIcon"},Yf={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor"},Zf=l("path",{d:"M3 4C3 3.44772 3.44772 3 4 3H10C10.5523 3 11 3.44772 11 4V10C11 10.5523 10.5523 11 10 11H4C3.44772 11 3 10.5523 3 10V4ZM3 14C3 13.4477 3.44772 13 4 13H10C10.5523 13 11 13.4477 11 14V20C11 20.5523 10.5523 21 10 21H4C3.44772 21 3 20.5523 3 20V14ZM13 4C13 3.44772 13.4477 3 14 3H20C20.5523 3 21 3.44772 21 4V10C21 10.5523 20.5523 11 20 11H14C13.4477 11 13 10.5523 13 10V4ZM13 14C13 13.4477 13.4477 13 14 13H20C20.5523 13 21 13.4477 21 14V20C21 20.5523 20.5523 21 20 21H14C13.4477 21 13 20.5523 13 20V14ZM15 5V9H19V5H15ZM15 15V19H19V15H15ZM5 5V9H9V5H5ZM5 15V19H9V15H5Z"},null,-1),Wf=[Zf];function Jf(e,t,o,u,s,n){return i(),c("svg",Yf,Wf)}const Qf=F(Gf,[["render",Jf]]),Kf={name:"AllFeeds",emits:["refetch"],inheritAttrs:!1,setup(){const e=Se(),t=xe();return{feedStore:e,uiStore:t}},props:{space:{type:[String,Number],default(){return null}},user_id:{type:[String,Number],default(){return null}},hide_create_form:{type:Boolean,default(){return!1}},hide_filters:{type:Boolean,default(){return!1}},feed_base_url:{type:String,default(){return"feeds"}},default_search:{type:String,default(){return""}},searchIn:{type:Array,default(){return["post_content"]}},layout_style:{type:String,default(){return"timeline"}},feed_name:{type:String,default(){return""}},topic_slug:{type:[String,Number],default(){return null}},can_change_order:{type:Boolean,default(){return!0}},default_order_by:{type:String,default(){return""}}},components:{CreateStatusForm:Pt,Feed:Ze,FeedCard:gf,FeedListItem:xs,SwitchTimelineIcon:Df,SwitchListIcon:qf,SwitchCardIcon:Qf},watch:{space(e){this.fetchFeedsFromStore()},search(){this.feedStore.resetContext(this.feedContext),this.fetchFeedsFromStore()},topic_slug(){this.feedStore.resetContext(this.feedContext),this.fetchFeedsFromStore()},"$route.query.search"(e){this.search=e||""}},computed:{feedContext(){return this.space?`space-${this.space}`:this.user_id?`user-${this.user_id}`:"global"},feeds(){return this.feedStore.getFeedsByContext(this.feedContext)},sticky(){return this.feedStore.getStickyFeed(this.feedContext)},pagination(){return this.feedStore.getPagination(this.feedContext)},loading(){return this.feedStore.isLoading(this.feedContext)},execution_time(){return this.feedStore.getExecutionTime(this.feedContext)},disableAutoLoad(){return this.feedStore.disableAutoLoad(this.feedContext)},currentLayoutStyle(){return this.custom_layout_style},computedPostOrderOptions(){return this.user_id?this.appVars.user_post_order_by_options:this.appVars.post_order_by_options}},data(){return{appReady:!0,sort_by:"",search:this.$route.query.search||"",custom_layout_style:this.layout_style,disable_sticky:!1,boundHandler:null}},methods:{...ds(Se,["fetchFeeds","createFeed","updateFeed","deleteFeed","markStickyAsViewed","resetContext"]),async fetchFeedsFromStore(e=!1){try{await this.feedStore.fetchFeeds(this.feedContext,{feed_base_url:this.feed_base_url,page:e?this.pagination.page:1,per_page:this.pagination.per_page||10,space:this.space,user_id:this.user_id,order_by_type:this.sort_by,search:this.search,disable_sticky:this.disable_sticky,topic_slug:this.topic_slug,search_in:this.searchIn},e)}catch(t){this.$handleError(t)}},handleSortByChange(){this.resetFetch()},feedAdded(e){this.sticky&&this.feedStore.markStickyAsViewed(this.feedContext,this.sticky.id)},async handleDelete(e){const t=this.feeds[e];if(t)try{await this.feedStore.deleteFeed(this.feedContext,t.id,e),this.$notify.success(this.$t("Post deleted successfully"))}catch(o){this.$handleError(o)}},async handleUpdate(e,t){try{await this.feedStore.updateFeed(e.id,e)}catch(o){this.$handleError(o)}},handleLoadMore(){var s;if(this.disableAutoLoad)return!1;if(this.pagination.last_page==this.pagination.page)return;let e=document.querySelector(".all_feeds_holder .feed_outer:last-child");if(!e)return;let t=e.getBoundingClientRect(),o=(s=window.fcomLayoutRef)==null?void 0:s.wrapRef;!o||t.bottom-o.getBoundingClientRect().bottom-t.height>100||this.loading||this.fetchFeedsFromStore(!0)},resetFetch(){!this.hide_filters&&!this.default_search&&!this.user_id&&this.$storeLocalData("feed_sort_by",this.sort_by),this.disable_sticky="yes",this.feedStore.resetContext(this.feedContext),this.fetchFeedsFromStore()},spaceChanged(){this.feedStore.resetContext(this.feedContext),this.fetchFeedsFromStore()},routeNewArticle(){this.space?this.$router.push({name:"space_write_article",params:{space:this.space}}):this.$router.push({name:"write_article"})},switchView(e){this.custom_layout_style!=e&&(this.sticky&&this.feedStore.markStickyAsViewed(this.feedContext,this.sticky.id),this.custom_layout_style=e,this.feed_name&&this.hasFeature("can_switch_layout")&&this.$storeLocalData("feed_layout_style_"+this.feed_name,e),this.$notify.success(this.$t("Layout changed")))}},created(){this.default_search&&(this.search=this.default_search),this.default_order_by&&!this.can_change_order?this.sort_by=this.default_order_by:!this.hide_filters&&!this.default_search&&(this.user_id?this.sort_by="":this.sort_by=this.$getLocalData("feed_sort_by")||""),this.$route.query.sort_by&&(this.sort_by=this.$route.query.sort_by),this.sort_by||(this.sort_by=this.default_order_by||"latest"),this.fetchFeedsFromStore()},mounted(){if(this.feed_name&&this.hasFeature("can_switch_layout")){let e=this.$getLocalData("feed_layout_style_"+this.feed_name);e&&(this.custom_layout_style=e)}this.boundHandler=this.handleLoadMore.bind(this),document.addEventListener("fcom_layout_scroll",this.boundHandler),this.$eventBus.on("doGlobalSearch",e=>{this.loading||this.search!=e&&(this.search=e,this.pagination.page=1,this.$router.push({query:{search:e}}))}),this.$nextTick(()=>{var t;const e=this.uiStore.restoreScrollPosition(this.$route.path);e>0&&((t=window.fcomLayoutRef)!=null&&t.wrapRef)&&setTimeout(()=>{window.fcomLayoutRef.setScrollTop(e)},100)})},beforeUnmount(){this.$eventBus.emit("leaving_all_feeds"),document.removeEventListener("fcom_layout_scroll",this.boundHandler),this.$eventBus.off("doGlobalSearch"),this.feeds&&this.feeds.length>50&&this.feedStore.pruneOldFeeds(),this.sticky&&this.feedStore.markStickyAsViewed(this.feedContext,this.sticky.id)}},Xf={key:1,class:"feed_filters"},ep=l("div",{class:"fcom_feed_divider"},null,-1),tp={id:"feed_short_by",class:"fcom_feed_filter_label"},sp={key:1,class:"fcom_layout_switch"},op={key:2,style:{margin:"0 0 10px"},class:"fcom_search_result_num"},ip={key:0},np={key:3,class:"fcom_sticky_feed"},lp={class:"all_feeds_holder"},ap={key:0,style:{"margin-top":"20px","text-align":"center"}},rp={key:5},cp={class:"feed_outer"},dp={class:"feed"},up={style:{"text-align":"center"},class:"feed_body not_found"},_p={key:0},mp={key:1},hp={key:2};function fp(e,t,o,u,s,n){const m=g("create-status-form"),p=ie,h=ne,y=g("SwitchCardIcon"),k=g("SwitchListIcon"),b=g("SwitchTimelineIcon"),$=O,f=j,w=ot,C=it,M=nt,P=g("feed"),T=g("FeedListItem"),I=g("FeedCard"),U=q;return i(),c(V,null,[z(e.$slots,"before_create_form"),!o.hide_create_form&&e.auth.user_id?(i(),v(m,{key:0,space:o.space,btn_text:e.$t("Post"),onAdded:n.feedAdded},null,8,["space","btn_text","onAdded"])):_("",!0),z(e.$slots,"before_feeds"),o.hide_filters?_("",!0):(i(),c("div",Xf,[ep,o.can_change_order?(i(),c(V,{key:0},[l("span",tp,d(e.$t("Sort by:")),1),a(h,{modelValue:s.sort_by,"onUpdate:modelValue":t[0]||(t[0]=B=>s.sort_by=B),"aria-label":e.$t("Posts Order by"),class:"fcom_minimal_select","popper-class":"plain_select",placeholder:e.$t("Latest Posts"),onChange:t[1]||(t[1]=B=>n.handleSortByChange())},{default:r(()=>[(i(!0),c(V,null,D(n.computedPostOrderOptions,(B,A)=>(i(),v(p,{key:A,value:A,label:B},null,8,["value","label"]))),128))]),_:1},8,["modelValue","aria-label","placeholder"])],64)):_("",!0),o.feed_name&&e.hasFeature("can_switch_layout")?(i(),c("div",sp,[a(M,{"popper-class":"fcom_pop_buttons",trigger:"click"},{dropdown:r(()=>[a(C,{class:"fcom_layout_dropdown_menu"},{default:r(()=>[a(w,{class:R({selected_layout:s.custom_layout_style==="card"})},{default:r(()=>[l("div",{onClick:t[2]||(t[2]=B=>n.switchView("card")),class:"fcom_icon_menu"},[a(y),l("span",null,d(e.$t("Card")),1)])]),_:1},8,["class"]),a(w,{class:R({selected_layout:s.custom_layout_style==="list"})},{default:r(()=>[l("div",{onClick:t[3]||(t[3]=B=>n.switchView("list")),class:"fcom_icon_menu"},[a(k),l("span",null,d(e.$t("List")),1)])]),_:1},8,["class"]),a(w,{class:R({selected_layout:s.custom_layout_style==="timeline"})},{default:r(()=>[l("div",{onClick:t[4]||(t[4]=B=>n.switchView("timeline")),class:"fcom_icon_menu"},[a(b),l("span",null,d(e.$t("Timeline")),1)])]),_:1},8,["class"])]),_:1})]),default:r(()=>[a(f,{type:"info",text:"",title:e.$t("Switch Layout View")},{default:r(()=>[a($,{class:R(["fcom_layout_icon",s.custom_layout_style])},{default:r(()=>[s.custom_layout_style=="card"?(i(),v(y,{key:0})):s.custom_layout_style=="list"?(i(),v(k,{key:1})):(i(),v(b,{key:2}))]),_:1},8,["class"])]),_:1},8,["title"])]),_:1})])):_("",!0)])),n.pagination.total&&s.search?(i(),c("div",op,[S(d(e.$_n("%s result found","%s results found",n.pagination.total))+" ",1),n.execution_time?(i(),c("span",ip,d(e.$t("in %ss",n.execution_time.toFixed(2))),1)):_("",!0)])):_("",!0),n.sticky?(i(),c("div",np,[a(P,{onReload:t[5]||(t[5]=B=>{n.sticky=null,e.fetchFeeds()}),onFeedUpdated:t[6]||(t[6]=B=>{n.sticky=B}),onDeleted:t[7]||(t[7]=()=>{n.sticky=null}),feed:n.sticky,isSingleSpacePage:!!o.space},null,8,["feed","isSingleSpacePage"])])):_("",!0),n.feeds.length?(i(),c("div",{key:4,ref:"all_feeds_wrap",class:R(["fcom_feed_style_"+n.currentLayoutStyle,"all_feeds"])},[l("div",lp,[(i(!0),c(V,null,D(n.feeds,(B,A)=>(i(),c("div",{key:B.id,class:"feed_outer"},[n.currentLayoutStyle=="list"?(i(),v(T,{key:0,feed:B},null,8,["feed"])):n.currentLayoutStyle=="card"?(i(),v(I,{key:1,feed:B,hide_create_form:o.hide_create_form,onUpdated:L=>n.handleUpdate(L,A),onDeleted:()=>n.handleDelete(A)},null,8,["feed","hide_create_form","onUpdated","onDeleted"])):(i(),v(P,{key:2,feed:B,isSingleSpacePage:!!o.space,show_report:!0,layout_style:n.currentLayoutStyle,hide_create_form:o.hide_create_form,onUpdated:L=>n.handleUpdate(L,A),onDeleted:()=>n.handleDelete(A)},null,8,["feed","isSingleSpacePage","layout_style","hide_create_form","onUpdated","onDeleted"]))]))),128))]),n.disableAutoLoad?_("",!0):(i(),c("div",ap,[a(f,{class:"fcom_secondary_button",disabled:n.loading,loading:n.loading,onClick:t[8]||(t[8]=B=>n.fetchFeedsFromStore(!0))},{default:r(()=>[S(d(e.$t("Load more")),1)]),_:1},8,["disabled","loading"])]))],2)):!n.loading&&!n.sticky?(i(),c("div",rp,[l("div",cp,[l("div",dp,[l("div",up,[s.search?(i(),c("p",_p,d(e.$t("No results found based on your search criteria")),1)):o.topic_slug?(i(),c("p",mp,d(e.$t("No posts found for the selected topic")),1)):(i(),c("p",hp,d(e.$t("No posts found!")),1))])])])])):_("",!0),n.loading?(i(),c(V,{key:6},[a(U,{style:{"margin-top":"20px"},class:"white_loaded",animated:!0,rows:5}),n.pagination.page==1?(i(),c(V,{key:0},[a(U,{style:{"margin-top":"20px"},class:"white_loaded",animated:!0,rows:5}),a(U,{style:{"margin-top":"20px"},class:"white_loaded",animated:!0,rows:5})],64)):_("",!0)],64)):_("",!0)],64)}const rt=F(Kf,[["render",fp]]),pp={name:"SearchBar",components:{SpaceIcon:He,AllFeeds:rt,SearchIcon:Ve},data(){return{search:"",SearchIcon:pt(Ve),showingSearch:!1,perform_search:!1,searchGroups:[],search_space:"__all__",searchIn:["post_content"]}},computed:{placeholder(){return this.search_space!="__all__"?this.$t("Search in %s","#"+this.search_space):this.$t("Search here...")}},methods:{initSearch(){this.$route.params.space?this.search_space=this.$route.params.space:this.search_space="__all__",this.showingSearch=!0,this.handleOpen()},toSearch(){this.search&&(this.perform_search?(this.perform_search=!1,this.$nextTick(()=>{this.perform_search=!0})):this.perform_search=!0)},handleScroll(e){if(this.$refs.feedsScroller.wrapRef.scrollHeight-this.$refs.feedsScroller.wrapRef.clientHeight-e.scrollTop<100){let o=this.$refs.feedsRef;!o.loading&&o.pagination.page<o.pagination.last_page&&(o.pagination.page++,o.fetchFeeds(!0))}},keyBind(e){e.key==="k"&&(e.ctrlKey||e.metaKey)&&(this.showingSearch=!this.showingSearch,this.showingSearch&&this.handleOpen())},handleOpen(){this.formatSearchGroups(),this.$nextTick(()=>{this.$refs.seatch_input.focus()})},formatSearchGroups(){if(this.searchGroups.length)return;let e=this.appVars.auth.spaces;e=Object.values(e);let t=this.appVars.space_groups,o=[];this.each(t,u=>{let s=e.filter(n=>n.parent_id==u.id&&n.permissions&&n.permissions.can_view_posts);s.length&&o.push({label:u.title,spaces:s})}),this.searchGroups=o}},mounted(){document.addEventListener("keydown",this.keyBind),this.$eventBus.on("route_updated",()=>{this.showingSearch=!1})},beforeUnmount(){document.removeEventListener("keydown",this.keyBind)}},gp={class:"fcom_search_header"},yp={key:0,class:"fcom_space_title"},vp={key:1},bp={style:{display:"flex","align-items":"center","flex-wrap":"wrap",gap:"10px",margin:"10px 20px 0","justify-content":"center"}},kp={key:0,class:"fcom_search_results"},wp={key:1,class:"fcom_search_welcome"},Cp=l("b",null,"‚åò + K",-1),$p=l("b",null,"Ctrl + K",-1);function Sp(e,t,o,u,s,n){const m=g("SearchIcon"),p=O,h=ie,y=g("SpaceIcon"),k=bt,b=ne,$=ee,f=he,w=ps,C=g("all-feeds"),M=fe,P=ye;return i(),c(V,null,[l("button",{class:"fcom_menu_button",onClick:t[0]||(t[0]=T=>n.initSearch())},[a(p,{id:"fcom_search_icon",class:"fcom_search_icon"},{default:r(()=>[a(m)]),_:1})]),s.showingSearch?(i(),v(P,{key:0,top:"60px",onClose:t[6]||(t[6]=T=>{s.perform_search=!1}),"append-to-body":!0,"lock-scroll":!0,"modal-class":"fcom_search_bar_visible",modelValue:s.showingSearch,"onUpdate:modelValue":t[7]||(t[7]=T=>s.showingSearch=T),"show-close":!1,style:{"max-width":"700px"},width:e.drawerWidth},{header:r(()=>[l("div",gp,[a($,{ref:"seatch_input",size:"large",type:"search",autocomplete:"off",inputmode:"search",onClear:t[2]||(t[2]=T=>s.perform_search=!1),modelValue:s.search,"onUpdate:modelValue":t[3]||(t[3]=T=>s.search=T),placeholder:n.placeholder,onKeyup:be(n.toSearch,["enter"]),onInput:t[4]||(t[4]=T=>s.perform_search=!1),clearable:""},{prefix:r(()=>[a(p,{onClick:n.toSearch},{default:r(()=>[a(m)]),_:1},8,["onClick"])]),append:r(()=>[a(b,{class:"fcom_minimal_select fcom_global_search_append",modelValue:s.search_space,"onUpdate:modelValue":t[1]||(t[1]=T=>s.search_space=T),placeholder:e.$t("All Posts"),style:{width:"100px"}},{default:r(()=>[a(h,{label:e.$t("All Posts"),value:"__all__"},null,8,["label"]),(i(!0),c(V,null,D(s.searchGroups,T=>(i(),v(k,{key:T.label,label:T.label},{default:r(()=>[(i(!0),c(V,null,D(T.spaces,I=>(i(),v(h,{key:I.slug,label:I.title,value:I.slug},{default:r(()=>[I.id?(i(),c("span",yp,[a(y,{space_profile:I},null,8,["space_profile"]),l("span",null,d(e.getExcerpt(I.title,30)),1)])):(i(),c("span",vp,d(e.getExcerpt(I.title,30)),1))]),_:2},1032,["label","value"]))),128))]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["modelValue","placeholder","onKeyup"]),l("div",bp,[l("span",null,d(e.$t("Search in:")),1),a(w,{modelValue:s.searchIn,"onUpdate:modelValue":t[5]||(t[5]=T=>s.searchIn=T),class:"fcom_search_in"},{default:r(()=>[a(f,{value:"post_content",class:"fcom_checkbox"},{default:r(()=>[S(d(e.$t("Post Title & Content")),1)]),_:1}),a(f,{value:"post_comments",class:"fcom_checkbox"},{default:r(()=>[S(d(e.$t("Comments")),1)]),_:1})]),_:1},8,["modelValue"])])])]),default:r(()=>[s.perform_search&&s.search?(i(),c("div",kp,[a(M,{ref:"feedsScroller",onScroll:n.handleScroll,style:{"padding-right":"20px"},height:"70vh"},{default:r(()=>[a(C,{searchIn:s.searchIn,layout_style:"list",feed_name:"search_results",space:s.search_space!="__all__"?s.search_space:"",ref:"feedsRef",default_search:s.search,hide_filters:!1,hide_create_form:!0},null,8,["searchIn","space","default_search"])]),_:1},8,["onScroll"])])):(i(),c("div",wp,[a(p,null,{default:r(()=>[a(m)]),_:1}),l("h3",null,d(e.$t("Search for anything")),1),l("p",null,d(e.$t("Try searching for keywords in posts")),1),l("p",null,[S(d(e.$t("Tip: Quick-launch search with"))+" ",1),Cp,S(" (Mac) "+d(e.$t("or"))+" ",1),$p,S(" (Windows/Linux)")])]))]),_:1},8,["modelValue","width"])):_("",!0)],64)}const Vp=F(pp,[["render",Sp]]);const Lp={name:"SvgShapeGenerator",emits:["update"],data(){return{currentColor:"",selectedShape:"circle"}},computed:{svgShapes(){return{circle:`<svg class="fcom_shape fcom_shape_circle" viewBox="0 0 24 24" fill="${this.currentColor}" width="24px" height="24px"><path d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="12"/></svg>`,square:`<svg class="fcom_shape fcom_shape_square" viewBox="0 0 24 24" fill="${this.currentColor}" width="24px" height="24px"><path d="M0 0h24v24H0z" fill="none"/><rect x="0" y="0" width="24" height="24"/></svg>`,triangle:`<svg class="fcom_shape fcom_shape_triangle" viewBox="0 0 24 24" fill="${this.currentColor}" width="24px" height="24px"><path d="M0 0h24v24H0z" fill="none"/><path d="M21 12L2 2v20z"/></svg>`,star:`<svg class="fcom_shape fcom_shape_star" viewBox="0 0 24 24" width="24" height="24"><polygon points="12,2.4 14.6,8.4 21.6,8.4 15.6,13.2 18,19.6 12,15.6 6,19.6 8.4,13.2 2.4,8.4 9.4,8.4" fill="${this.currentColor}"/></svg>`,heart:`<svg class="fcom_shape fcom_shape_heart"  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" fill="${this.currentColor}"/></svg>`,diamond:`<svg class="fcom_shape fcom_shape_diamond" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><polygon points="12,2 22,12 12,22 2,12" fill="${this.currentColor}"/></svg>`}}},methods:{selectShape(e){this.selectedShape=e,this.$emit("update",this.svgShapes[e])},colorChanged(e){this.currentColor=e,this.$emit("update",this.svgShapes[this.selectedShape])}}},Mp={class:"fcom_svg_generator"},Pp={class:"fcom_form_item"},Fp={class:"fcom_form_item"},Tp=["innerHTML"];function Ip(e,t,o,u,s,n){const m=kt,p=st,h=ge;return i(),c("div",Mp,[l("div",Pp,[l("label",null,d(e.$t("Select Shape Color:")),1),a(m,{predefine:e.appVars.suggestedColors,modelValue:s.currentColor,"onUpdate:modelValue":t[0]||(t[0]=y=>s.currentColor=y),onActiveChange:n.colorChanged,size:"large","show-alpha":""},null,8,["predefine","modelValue","onActiveChange"])]),l("div",Fp,[l("label",null,d(e.$t("Select Shape:")),1),a(h,{onChange:t[1]||(t[1]=y=>n.selectShape(s.selectedShape)),modelValue:s.selectedShape,"onUpdate:modelValue":t[2]||(t[2]=y=>s.selectedShape=y)},{default:r(()=>[(i(!0),c(V,null,D(n.svgShapes,(y,k)=>(i(),v(p,{key:k,value:k},{default:r(()=>[l("div",{innerHTML:y},null,8,Tp)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])])])}const Up=F(Lp,[["render",Ip]]),Bp={name:"LogoEmojiSelector",components:{EmojiPicker:Ps,ImageUploader:Re,SvgShapeGenerator:Up},props:{config:{type:Object,required:!0,default:()=>({emoji:"",logo:"",shape_svg:""})},fallback_mark:{type:String,default:'<span class="fcom_no_avatar"></span>'},custom_svg:{type:Boolean,default:!1}},data(){return{emoji:this.config.emoji||"",logo:this.config.logo||"",shape_svg:this.config.shape_svg||"",visible:!1,selectedTab:"emoji"}},methods:{setData(e){e=="emoji"?(this.logo="",this.shape_svg=""):e=="shape_svg"?(this.emoji="",this.logo=""):(this.emoji="",this.shape_svg=""),this.$emit("update",{logo:this.logo,emoji:this.emoji,shape_svg:this.shape_svg})},handleLogoPhotoUpload(e){this.logo=e,this.setData("logo")},handleShapeChanged(e){this.shape_svg=e,this.setData("shape_svg")}},computed:{currentMark(){return this.logo?`<img alt="" src="${this.logo}" style="width: 20px; height: 20px; aspect-ratio: 1/1;">`:this.emoji.trim()?`<span style="font-size: 20px">${this.emoji.trim()}</span>`:this.shape_svg?'<i class="fcom_shape el-icon">'+this.shape_svg+"</i>":this.fallback_mark}},mounted(){if(this.logo)this.selectedTab="logo";else if(this.emoji)this.selectedTab="emoji";else if(this.shape_svg){if(this.custom_svg&&!/fcom_shape/.test(this.shape_svg)){this.selectedTab="shape_svg";return}this.selectedTab="shape"}}},Ep=["innerHTML"];function Ap(e,t,o,u,s,n){const m=j,p=g("EmojiPicker"),h=ee,y=wt,k=g("SvgShapeGenerator"),b=Pe,$=g("ImageUploader"),f=Ct,w=de;return i(),v(w,{placement:"bottom",width:450,persistent:!1,style:{padding:"0"},visible:s.visible,ref:"logo_emoji_pop",class:"logo_emoji_pop"},{reference:r(()=>[a(m,{onClick:t[0]||(t[0]=C=>s.visible=!s.visible),text:""},{default:r(()=>[l("span",{class:"logo_emoji_holder",style:{cursor:"pointer"},innerHTML:n.currentMark||""},null,8,Ep)]),_:1})]),default:r(()=>[a(f,{modelValue:s.selectedTab,"onUpdate:modelValue":t[6]||(t[6]=C=>s.selectedTab=C),type:"border-card"},{default:r(()=>[a(y,{name:"emoji",label:e.$t("Emoji")},{default:r(()=>[a(h,{onChange:t[2]||(t[2]=C=>n.setData("emoji")),modelValue:s.emoji,"onUpdate:modelValue":t[3]||(t[3]=C=>s.emoji=C),placeholder:e.$t("Select or paste your emoji here"),style:{width:"100%"}},pe({_:2},[e.has_pro?{name:"append",fn:r(()=>[a(p,{close_on_select:!0,onEmojiSelected:t[1]||(t[1]=C=>{s.emoji=C,n.setData("emoji")})})]),key:"0"}:void 0]),1032,["modelValue","placeholder"])]),_:1},8,["label"]),a(y,{name:"shape",label:e.$t("Shape")},{default:r(()=>[a(k,{onUpdate:n.handleShapeChanged},null,8,["onUpdate"])]),_:1},8,["label"]),o.custom_svg?(i(),v(y,{key:0,name:"shape_svg",label:e.$t("Custom SVG")},{default:r(()=>[a(h,{rows:4,type:"textarea",onChange:t[4]||(t[4]=C=>n.setData("shape_svg")),modelValue:s.shape_svg,"onUpdate:modelValue":t[5]||(t[5]=C=>s.shape_svg=C),placeholder:e.$t("Paste your SVG here"),style:{width:"100%"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):_("",!0),a(y,{name:"logo",label:e.$t("Custom Image")},{default:r(()=>[s.logo?(i(),v(b,{key:0,alt:e.$t("Logo"),src:s.logo,style:{"max-width":"100px"}},null,8,["alt","src"])):_("",!0),a($,{can_remove:!!s.logo,additionalData:{resize:!0,max_width:400},onUploaded:n.handleLogoPhotoUpload},null,8,["can_remove","onUploaded"])]),_:1},8,["label"])]),_:1},8,["modelValue"]),a(m,{onClick:t[7]||(t[7]=C=>{s.visible=!1}),type:"success",plain:"",style:{"margin-top":"20px"}},{default:r(()=>[S(d(e.$t("Close")),1)]),_:1})]),_:1},8,["visible"])}const Ft=F(Bp,[["render",Ap]]),Dp={name:"SlugInput",emits:["update:modelValue"],props:{modelValue:{type:String,default:""},placeholder:{type:String,default:""},disabled:{type:Boolean,default:!1},is_inital_inactive:{type:Boolean,default:!1},edit_notice:{type:String,default:""},popMessage:{type:String,default:""},prefix:{type:String,default:""}},data(){return{model:this.modelValue,showEdit:this.is_inital_inactive}},methods:{updateSlug(){this.model=this.model.replace(/\s/g,"-"),this.model=this.model.replace(/[^a-zA-Z0-9-_]/g,""),this.$emit("update:modelValue",this.model)},confirmEditInit(){this.$confirm(this.popMessage||this.$t("Are you sure you want to change the slug?"),this.$t("Warning"),{confirmButtonText:this.$t("Yes"),cancelButtonText:this.$t("No"),confirmButtonClass:"fcom_primary_button",cancelButtonClass:"fcom_secondary_button",type:"warning"}).then(()=>{this.showEdit=!1})}}},Rp={key:0,class:"fcom_slug_input_info"},Hp=["innerHTML"];function xp(e,t,o,u,s,n){const m=j,p=ee;return i(),c(V,null,[a(p,{class:"fcom_slug_input",disabled:o.disabled,readonly:s.showEdit,modelValue:s.model,"onUpdate:modelValue":t[1]||(t[1]=h=>s.model=h),ref:"input",placeholder:o.placeholder,onInput:n.updateSlug},pe({_:2},[o.prefix?{name:"prepend",fn:r(()=>[l("span",null,d(o.prefix),1)]),key:"0"}:void 0,s.showEdit?{name:"append",fn:r(()=>[a(m,{onClick:t[0]||(t[0]=h=>n.confirmEditInit()),text:"",type:"info"},{default:r(()=>[S(d(e.$t("change")),1)]),_:1})]),key:"1"}:void 0]),1032,["disabled","readonly","modelValue","placeholder","onInput"]),!s.showEdit&&o.edit_notice?(i(),c("div",Rp,[l("p",{innerHTML:o.edit_notice},null,8,Hp)])):_("",!0)],64)}const Tt=F(Dp,[["render",xp]]);const jp={name:"TopicSelector",props:["modelValue","creatable","space_id"],emits:["update:modelValue"],components:{SlugInput:Tt},data(){return{topics:[],selected:this.modelValue,loading:!1,creatingTopic:!1,newTopic:{title:"OK"}}},computed:{maxTopicsPerSpace(){var e;return((e=this.appVars.topicsConfig)==null?void 0:e.max_topics_per_space)||20},isTopicLimitReached(){var e;return((e=this.selected)==null?void 0:e.length)>=this.maxTopicsPerSpace}},methods:{getTopicsPlaceholder(){return this.$_n("Choose a topic","Choose up to %s topics",this.maxTopicsPerSpace)},initCreatetopic(){this.newTopic={title:"",description:"",slug:""}},fetchTopics(){this.loading=!0,this.$get("admin/topics",{optionsOnly:!0,space_id:this.space_id}).then(e=>{this.topics=e.topics}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})},createTopic(){if(!this.newTopic.title||this.newTopic.title.length<2){this.$notify.error(this.$t("Title must be at least 2 characters long"));return}this.creatingTopic=!0;let e={title:this.newTopic.title,description:this.newTopic.description,slug:this.newTopic.slug,is_inline:!0};this.$post("admin/topics",e).then(t=>{this.$notify.success(t.message),this.fetchTopics(),this.selected.push(t.topic.id),this.$refs.creating_topic_ref.hide()}).catch(t=>{this.$handleError(t)}).finally(()=>{this.creatingTopic=!1})}},watch:{selected(){this.$emit("update:modelValue",this.selected)}},mounted(){this.fetchTopics()}},Op={class:"fcom_topic_selector"},Np={key:0,class:"fcom_meta_text"};function zp(e,t,o,u,s,n){const m=ie,p=ne,h=g("Plus"),y=O,k=j,b=ee,$=ue,f=g("slug-input"),w=_e,C=de,M=K("loading");return i(),c("div",Op,[N((i(),v(p,{modelValue:s.selected,"onUpdate:modelValue":t[0]||(t[0]=P=>s.selected=P),"popper-class":"fcom_topics_from_settings",style:{width:"100%"},filterable:!0,multiple:!0,clearable:"","multiple-limit":n.maxTopicsPerSpace,placeholder:n.getTopicsPlaceholder()},{default:r(()=>[(i(!0),c(V,null,D(s.topics,P=>(i(),v(m,{key:P.slug,label:P.title,value:P.id},{default:r(()=>[l("span",null,d(P.title),1),P.description?(i(),c("span",Np,d(P.description),1)):_("",!0)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","multiple-limit","placeholder"])),[[M,s.loading]]),e.isAdmin()&&o.creatable?(i(),v(C,{key:0,ref:"creating_topic_ref",onShow:n.initCreatetopic,placement:"bottom",width:400,trigger:"click"},{reference:r(()=>[a(k,{disabled:n.isTopicLimitReached,class:"fcom_secondary_button"},{default:r(()=>[a(y,null,{default:r(()=>[a(h)]),_:1}),l("span",null,d(e.$t("New")),1)]),_:1},8,["disabled"])]),default:r(()=>[a(w,{modelValue:s.newTopic,"onUpdate:modelValue":t[5]||(t[5]=P=>s.newTopic=P),"label-position":"top"},{default:r(()=>[a($,{label:e.$t("Title")},{default:r(()=>[a(b,{modelValue:s.newTopic.title,"onUpdate:modelValue":t[1]||(t[1]=P=>s.newTopic.title=P),placeholder:e.$t("Title of the topic")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a($,{label:e.$t("Slug (optional)")},{default:r(()=>[a(f,{modelValue:s.newTopic.slug,"onUpdate:modelValue":t[2]||(t[2]=P=>s.newTopic.slug=P),placeholder:e.$t("Slug of the topic")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a($,{label:e.$t("Description (optional)")},{default:r(()=>[a(b,{modelValue:s.newTopic.description,"onUpdate:modelValue":t[3]||(t[3]=P=>s.newTopic.description=P),type:"textarea",rows:3,placeholder:e.$t("Description of the topic")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a($,null,{default:r(()=>[a(k,{class:"fcom_primary_button",onClick:t[4]||(t[4]=P=>n.createTopic()),loading:s.creatingTopic},{default:r(()=>[S(d(e.$t("Create")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["onShow"])):_("",!0)])}const js=F(jp,[["render",zp]]),qp={name:"ListViewIcon"},Gp={width:"160",height:"158",viewBox:"0 0 160 158",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Yp=Ie('<rect x="0.5" y="0.5" width="159" height="157" rx="5.5" fill="transparent"></rect><rect x="0.5" y="0.5" width="159" height="157" rx="5.5" stroke="var(--fcom-secondary-border)"></rect><rect x="12.5" y="12.5" width="135" height="27" rx="3.5" fill="transparent"></rect><rect x="12.5" y="12.5" width="135" height="27" rx="3.5" stroke="var(--fcom-secondary-border)"></rect><path d="M20 26C20 21.5817 23.5817 18 28 18C32.4183 18 36 21.5817 36 26C36 30.4183 32.4183 34 28 34C23.5817 34 20 30.4183 20 26Z" fill="var(--fcom-secondary-border)"></path><g clip-path="url(#clip0_3601_59265)"><ellipse cx="27.9996" cy="33.6" rx="6.4" ry="4.8" fill="var(--fcom-primary-bg)" fill-opacity="0.72"></ellipse><circle opacity="0.9" cx="27.9998" cy="24.4" r="3.2" fill="var(--fcom-primary-bg)"></circle></g><path d="M44 26C44 24.3431 45.3431 23 47 23H137C138.657 23 140 24.3431 140 26C140 27.6569 138.657 29 137 29H47C45.3431 29 44 27.6569 44 26Z" fill="var(--fcom-secondary-border)"></path><rect x="12.5" y="48.5" width="135" height="27" rx="3.5" fill="transparent"></rect><rect x="12.5" y="48.5" width="135" height="27" rx="3.5" stroke="var(--fcom-secondary-border)"></rect><path d="M20 62C20 57.5817 23.5817 54 28 54C32.4183 54 36 57.5817 36 62C36 66.4183 32.4183 70 28 70C23.5817 70 20 66.4183 20 62Z" fill="var(--fcom-secondary-border)"></path><g clip-path="url(#clip1_3601_59265)"><ellipse cx="27.9996" cy="69.6001" rx="6.4" ry="4.8" fill="var(--fcom-primary-bg)" fill-opacity="0.72"></ellipse><circle opacity="0.9" cx="27.9998" cy="60.4" r="3.2" fill="var(--fcom-primary-bg)"></circle></g><path d="M44 62C44 60.3431 45.3431 59 47 59H137C138.657 59 140 60.3431 140 62C140 63.6569 138.657 65 137 65H47C45.3431 65 44 63.6569 44 62Z" fill="var(--fcom-secondary-border)"></path><rect x="12.5" y="84.5" width="135" height="27" rx="3.5" fill="transparent"></rect><rect x="12.5" y="84.5" width="135" height="27" rx="3.5" stroke="var(--fcom-secondary-border)"></rect><path d="M20 98C20 93.5817 23.5817 90 28 90C32.4183 90 36 93.5817 36 98C36 102.418 32.4183 106 28 106C23.5817 106 20 102.418 20 98Z" fill="var(--fcom-secondary-border)"></path><g clip-path="url(#clip2_3601_59265)"><ellipse cx="27.9996" cy="105.6" rx="6.4" ry="4.8" fill="var(--fcom-primary-bg)" fill-opacity="0.72"></ellipse><circle opacity="0.9" cx="27.9998" cy="96.3999" r="3.2" fill="var(--fcom-primary-bg)"></circle></g><path d="M44 98C44 96.3431 45.3431 95 47 95H137C138.657 95 140 96.3431 140 98C140 99.6569 138.657 101 137 101H47C45.3431 101 44 99.6569 44 98Z" fill="var(--fcom-secondary-border)"></path><rect x="12.5" y="120.5" width="135" height="27" rx="3.5" fill="transparent"></rect><rect x="12.5" y="120.5" width="135" height="27" rx="3.5" stroke="var(--fcom-secondary-border)"></rect><path d="M20 134C20 129.582 23.5817 126 28 126C32.4183 126 36 129.582 36 134C36 138.418 32.4183 142 28 142C23.5817 142 20 138.418 20 134Z" fill="var(--fcom-secondary-border)"></path><g clip-path="url(#clip3_3601_59265)"><ellipse cx="27.9996" cy="141.6" rx="6.4" ry="4.8" fill="var(--fcom-primary-bg)" fill-opacity="0.72"></ellipse><circle opacity="0.9" cx="27.9998" cy="132.4" r="3.2" fill="var(--fcom-primary-bg)"></circle></g><path d="M44 134C44 132.343 45.3431 131 47 131H137C138.657 131 140 132.343 140 134C140 135.657 138.657 137 137 137H47C45.3431 137 44 135.657 44 134Z" fill="var(--fcom-secondary-border)"></path><defs><clipPath id="clip0_3601_59265"><rect x="20" y="18" width="16" height="16" rx="8" fill="transparent"></rect></clipPath><clipPath id="clip1_3601_59265"><rect x="20" y="54" width="16" height="16" rx="8" fill="transparent"></rect></clipPath><clipPath id="clip2_3601_59265"><rect x="20" y="90" width="16" height="16" rx="8" fill="transparent"></rect></clipPath><clipPath id="clip3_3601_59265"><rect x="20" y="126" width="16" height="16" rx="8" fill="transparent"></rect></clipPath></defs>',23),Zp=[Yp];function Wp(e,t,o,u,s,n){return i(),c("svg",Gp,Zp)}const Jp=F(qp,[["render",Wp]]),Qp={name:"TimelineViewIcon"},Kp={width:"160",height:"158",viewBox:"0 0 160 158",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Xp=Ie('<rect x="0.5" y="0.5" width="159" height="157" rx="5.5" fill="transparent"></rect><rect x="0.5" y="0.5" width="159" height="157" rx="5.5" stroke="var(--fcom-secondary-border)"></rect><rect x="12.5" y="12.5" width="135" height="60" rx="3.5" fill="transparent"></rect><rect x="12.5" y="12.5" width="135" height="60" rx="3.5" stroke="var(--fcom-secondary-border)"></rect><path d="M20 24C20 21.7909 21.7909 20 24 20H136C138.209 20 140 21.7909 140 24C140 26.2091 138.209 28 136 28H24C21.7909 28 20 26.2091 20 24Z" fill="var(--fcom-secondary-border)"></path><path d="M20 37C20 34.7909 21.7909 33 24 33H130.286C132.495 33 134.286 34.7909 134.286 37C134.286 39.2091 132.495 41 130.286 41H24C21.7909 41 20 39.2091 20 37Z" fill="var(--fcom-secondary-border)"></path><path d="M20 57C20 52.5817 23.5817 49 28 49C32.4183 49 36 52.5817 36 57C36 61.4183 32.4183 65 28 65C23.5817 65 20 61.4183 20 57Z" fill="var(--fcom-secondary-border)"></path><g clip-path="url(#clip0_3601_59186)"><ellipse cx="27.9996" cy="64.6001" rx="6.4" ry="4.8" fill="var(--fcom-primary-bg)" fill-opacity="0.72"></ellipse><circle opacity="0.9" cx="27.9998" cy="55.4" r="3.2" fill="var(--fcom-primary-bg)"></circle></g><path d="M44 53C44 51.3431 45.3431 50 47 50H81C82.6569 50 84 51.3431 84 53C84 54.6569 82.6569 56 81 56H47C45.3431 56 44 54.6569 44 53Z" fill="var(--fcom-secondary-border)"></path><path d="M44 62C44 60.8954 44.8954 60 46 60H66C67.1046 60 68 60.8954 68 62C68 63.1046 67.1046 64 66 64H46C44.8954 64 44 63.1046 44 62Z" fill="var(--fcom-secondary-border)"></path><rect x="12.5" y="85.5" width="135" height="60" rx="3.5" fill="transparent"></rect><rect x="12.5" y="85.5" width="135" height="60" rx="3.5" stroke="var(--fcom-secondary-border)"></rect><path d="M20 97C20 94.7909 21.7909 93 24 93H136C138.209 93 140 94.7909 140 97C140 99.2091 138.209 101 136 101H24C21.7909 101 20 99.2091 20 97Z" fill="var(--fcom-secondary-border)"></path><path d="M20 110C20 107.791 21.7909 106 24 106H130.286C132.495 106 134.286 107.791 134.286 110C134.286 112.209 132.495 114 130.286 114H24C21.7909 114 20 112.209 20 110Z" fill="var(--fcom-secondary-border)"></path><path d="M20 130C20 125.582 23.5817 122 28 122C32.4183 122 36 125.582 36 130C36 134.418 32.4183 138 28 138C23.5817 138 20 134.418 20 130Z" fill="var(--fcom-secondary-border)"></path><g clip-path="url(#clip1_3601_59186)"><ellipse cx="27.9996" cy="137.6" rx="6.4" ry="4.8" fill="var(--fcom-primary-bg)" fill-opacity="0.72"></ellipse><circle opacity="0.9" cx="27.9998" cy="128.4" r="3.2" fill="var(--fcom-primary-bg)"></circle></g><path d="M44 126C44 124.343 45.3431 123 47 123H81C82.6569 123 84 124.343 84 126C84 127.657 82.6569 129 81 129H47C45.3431 129 44 127.657 44 126Z" fill="var(--fcom-secondary-border)"></path><path d="M44 135C44 133.895 44.8954 133 46 133H66C67.1046 133 68 133.895 68 135C68 136.105 67.1046 137 66 137H46C44.8954 137 44 136.105 44 135Z" fill="var(--fcom-secondary-border)"></path><defs><clipPath id="clip0_3601_59186"><rect x="20" y="49" width="16" height="16" rx="8" fill="transparent"></rect></clipPath><clipPath id="clip1_3601_59186"><rect x="20" y="122" width="16" height="16" rx="8" fill="transparent"></rect></clipPath></defs>',19),e1=[Xp];function t1(e,t,o,u,s,n){return i(),c("svg",Kp,e1)}const s1=F(Qp,[["render",t1]]),o1={name:"SpaceGroupSelector",props:["modelValue","space_id"],emits:["update:modelValue"],data(){return{loading:!1,selected:this.modelValue,groups:[]}},watch:{selected(e){this.$emit("update:modelValue",e)}},methods:{getGroups(){this.loading=!0,this.$get("spaces/space_groups",{options_only:"yes",space_id:this.space_id}).then(e=>{this.groups=e.groups}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})}},mounted(){this.getGroups()}};function i1(e,t,o,u,s,n){const m=ie,p=ne,h=K("loading");return N((i(),v(p,{placeholder:e.$t("Select Menu Group"),clearable:"",modelValue:s.selected,"onUpdate:modelValue":t[0]||(t[0]=y=>s.selected=y)},{default:r(()=>[(i(!0),c(V,null,D(s.groups,y=>(i(),v(m,{key:y.id,value:y.id.toString(),label:y.title},null,8,["value","label"]))),128))]),_:1},8,["placeholder","modelValue"])),[[h,s.loading]])}const Qt=F(o1,[["render",i1]]),n1={name:"global_form_builder",props:{formData:{type:Object,required:!1,default(){return{}}},submitButtonText:{type:String,required:!1,default:"Save"},formFields:{type:Array,required:!0,default(){return[]}},disableSubmit:{type:Boolean,required:!1,default:!1}},methods:{handleSubmit(){this.$emit("submit",this.formData)}}},l1={class:"fcom_form_builder"},a1=["innerHTML"],r1={key:8},c1={key:9,class:"fcom_help_text"},d1=["innerHTML"];function u1(e,t,o,u,s,n){const m=ee,p=Ue,h=ge,y=ie,k=ne,b=he,$=ps,f=Xe,w=kt,C=ue,M=j,P=_e;return i(),c("div",l1,[a(P,{"label-position":"top",model:o.formData,onSubmit:Z(e.doNothing,["prevent"])},{default:r(()=>[(i(!0),c(V,null,D(o.formFields,(T,I)=>(i(),v(C,{key:e.index,label:T.label},pe({default:r(()=>[T.type=="text"?(i(),v(m,{key:0,modelValue:o.formData[I],"onUpdate:modelValue":U=>o.formData[I]=U,placeholder:T.placeholder,type:T.data_type||"text"},null,8,["modelValue","onUpdate:modelValue","placeholder","type"])):T.type=="radio"?(i(),v(h,{key:1,modelValue:o.formData[I],"onUpdate:modelValue":U=>o.formData[I]=U},{default:r(()=>[(i(!0),c(V,null,D(T.options,(U,B)=>(i(),v(p,{key:B,value:U.value,label:U.label},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):T.type=="select"?(i(),v(k,{key:2,class:"fcom_select",multiple:T.is_multiple,clearable:"",filterable:"",modelValue:o.formData[I],"onUpdate:modelValue":U=>o.formData[I]=U,placeholder:T.placeholder},{default:r(()=>[(i(!0),c(V,null,D(T.options,(U,B)=>(i(),v(y,{key:B,label:U.label,value:U.value},null,8,["label","value"]))),128))]),_:2},1032,["multiple","modelValue","onUpdate:modelValue","placeholder"])):T.type=="checkbox"?(i(),v($,{key:3,modelValue:o.formData[I],"onUpdate:modelValue":U=>o.formData[I]=U},{default:r(()=>[(i(!0),c(V,null,D(T.options,(U,B)=>(i(),v(b,{key:B,value:U.value,label:U.label},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):T.type=="inline_checkbox"?(i(),v(b,{key:4,modelValue:o.formData[I],"onUpdate:modelValue":U=>o.formData[I]=U,"true-value":T.true_value||"yes","false-value":T.false_value||"no"},{default:r(()=>[S(d(T.checkbox_label),1)]),_:2},1032,["modelValue","onUpdate:modelValue","true-value","false-value"])):T.type=="date"?(i(),v(f,{key:5,modelValue:o.formData[I],"onUpdate:modelValue":U=>o.formData[I]=U,type:T.data_type||"date","value-format":T.value_format||"YYYY-MM-DD",format:T.value_format||"YYYY-MM-DD",placeholder:T.placeholder},null,8,["modelValue","onUpdate:modelValue","type","value-format","format","placeholder"])):T.type=="color_picker"?(i(),v(w,{key:6,modelValue:o.formData[I],"onUpdate:modelValue":U=>o.formData[I]=U},null,8,["modelValue","onUpdate:modelValue"])):T.type=="raw_html"?(i(),c("div",{key:7,innerHTML:T.content},null,8,a1)):(i(),c("div",r1,[l("pre",null,d(T),1)])),T.help_text?(i(),c("div",c1,[l("p",{innerHTML:T.help_text},null,8,d1)])):_("",!0)]),_:2},[T.label?{name:"label",fn:r(()=>[S(d(T.label),1)]),key:"0"}:void 0]),1032,["label"]))),128)),o.disableSubmit?_("",!0):(i(),v(C,{key:0},{default:r(()=>[a(M,{class:"fcom_primary_button",onClick:Z(n.handleSubmit,["prevent"])},{default:r(()=>[S(d(o.submitButtonText),1)]),_:1},8,["onClick"])]),_:1}))]),_:1},8,["model","onSubmit"])])}const Os=F(n1,[["render",u1]]),_1={name:"CardViewIcon"},m1={xmlns:"http://www.w3.org/2000/svg",width:"160",height:"158",viewBox:"0 0 160 158",fill:"none"},h1=Ie('<rect x="0.5" y="0.5" width="159" height="157" rx="5.5" fill="transparent"></rect><rect x="0.5" y="0.5" width="159" height="157" rx="5.5" stroke="var(--fcom-secondary-border)"></rect><rect x="12.5" y="12.5" width="63" height="62" rx="3.5" fill="transparent"></rect><rect x="12.5" y="12.5" width="63" height="62" rx="3.5" stroke="var(--fcom-secondary-border)"></rect><path d="M20 24.5714C20 22.0467 22.0467 20 24.5714 20H63.4286C65.9533 20 68 22.0467 68 24.5714V42.4286C68 44.9533 65.9533 47 63.4286 47H24.5714C22.0467 47 20 44.9533 20 42.4286V24.5714Z" fill="var(--fcom-primary-border)"></path><path d="M20 56C20 54.3431 21.3431 53 23 53H65C66.6569 53 68 54.3431 68 56C68 57.6569 66.6569 59 65 59H23C21.3431 59 20 57.6569 20 56Z" fill="var(--fcom-secondary-border)"></path><path d="M20 66C20 64.3431 21.3431 63 23 63H41C42.6569 63 44 64.3431 44 66C44 67.6569 42.6569 69 41 69H23C21.3431 69 20 67.6569 20 66Z" fill="var(--fcom-secondary-border)"></path><rect x="84.5" y="12.5" width="63" height="62" rx="3.5" fill="transparent"></rect><rect x="84.5" y="12.5" width="63" height="62" rx="3.5" stroke="var(--fcom-secondary-border)"></rect><path d="M92 24.5714C92 22.0467 94.0467 20 96.5714 20H135.429C137.953 20 140 22.0467 140 24.5714V42.4286C140 44.9533 137.953 47 135.429 47H96.5714C94.0467 47 92 44.9533 92 42.4286V24.5714Z" fill="var(--fcom-primary-border)"></path><path d="M92 56C92 54.3431 93.3431 53 95 53H137C138.657 53 140 54.3431 140 56C140 57.6569 138.657 59 137 59H95C93.3431 59 92 57.6569 92 56Z" fill="var(--fcom-secondary-border)"></path><path d="M92 66C92 64.3431 93.3431 63 95 63H113C114.657 63 116 64.3431 116 66C116 67.6569 114.657 69 113 69H95C93.3431 69 92 67.6569 92 66Z" fill="var(--fcom-secondary-border)"></path><rect x="12.5" y="83.5" width="63" height="62" rx="3.5" fill="transparent"></rect><rect x="12.5" y="83.5" width="63" height="62" rx="3.5" stroke="var(--fcom-secondary-border)"></rect><path d="M20 95.5714C20 93.0467 22.0467 91 24.5714 91H63.4286C65.9533 91 68 93.0467 68 95.5714V113.429C68 115.953 65.9533 118 63.4286 118H24.5714C22.0467 118 20 115.953 20 113.429V95.5714Z" fill="var(--fcom-primary-border)"></path><path d="M20 127C20 125.343 21.3431 124 23 124H65C66.6569 124 68 125.343 68 127C68 128.657 66.6569 130 65 130H23C21.3431 130 20 128.657 20 127Z" fill="var(--fcom-secondary-border)"></path><path d="M20 137C20 135.343 21.3431 134 23 134H41C42.6569 134 44 135.343 44 137C44 138.657 42.6569 140 41 140H23C21.3431 140 20 138.657 20 137Z" fill="var(--fcom-secondary-border)"></path><rect x="84.5" y="83.5" width="63" height="62" rx="3.5" fill="transparent"></rect><rect x="84.5" y="83.5" width="63" height="62" rx="3.5" stroke="var(--fcom-secondary-border)"></rect><path d="M92 95.5714C92 93.0467 94.0467 91 96.5714 91H135.429C137.953 91 140 93.0467 140 95.5714V113.429C140 115.953 137.953 118 135.429 118H96.5714C94.0467 118 92 115.953 92 113.429V95.5714Z" fill="var(--fcom-primary-border)"></path><path d="M92 127C92 125.343 93.3431 124 95 124H137C138.657 124 140 125.343 140 127C140 128.657 138.657 130 137 130H95C93.3431 130 92 128.657 92 127Z" fill="var(--fcom-secondary-border)"></path><path d="M92 137C92 135.343 93.3431 134 95 134H113C114.657 134 116 135.343 116 137C116 138.657 114.657 140 113 140H95C93.3431 140 92 138.657 92 137Z" fill="var(--fcom-secondary-border)"></path>',22),f1=[h1];function p1(e,t,o,u,s,n){return i(),c("svg",m1,f1)}const g1=F(_1,[["render",p1]]),y1={name:"CreateSpaceForm",emits:["completed"],components:{SpaceGroupSelector:Qt,SlugInput:Tt,ImageUploader:Re,LogoEmojiSelector:Ft,TopicSelector:js,ListViewIcon:Jp,TimelineViewIcon:s1,FormBuilder:Os,CardViewIcon:g1},props:{community:{required:!1,default:null},parent_id:{required:!1,default:null},savingCount:{required:!1,default:0},disable_redirect:{required:!1,default:!1}},data(){return{saving:!1,privacies:Bs,form:{title:"",slug:"",privacy:"private",parent_id:"",description:"",settings:{custom_lock_screen:"no",restricted_post_only:"no",emoji:"üöÄ",shape_svg:"",can_request_join:"yes",layout_style:"timeline",show_sidebar:"yes",members_page_status:"members_only",document_library:"no",document_access:"members_only",document_upload:"admin_only"},topic_ids:[]},dataLoaded:!1,showingSections:["basic"],postOrderOptions:this.appVars.post_order_by_options,commentOrderOptions:this.appVars.comment_order_by_options,metaSettings:null,fetchingMetaBoxes:!1}},watch:{savingCount(){this.submit()}},computed:{isDefaultLockscreen(){return this.form.settings.custom_lock_screen=="no"&&this.form.privacy=="private"}},methods:{submit(){this.saving=!0;let e="spaces",t={space:this.form},o=this.$post;if(this.form.id&&(e+="/"+this.form.id+"/by-id",t={space_id:this.form.id,data:{slug:this.form.slug,title:this.form.title,privacy:this.form.privacy,description:this.form.description,group_chat_support:this.form.group_chat_support,settings:this.form.settings,logo:this.form.logo,parent_id:this.form.parent_id??"",cover_photo:this.form.cover_photo,topic_ids:this.form.topic_ids}},o=this.$put,this.metaSettings)){let u={};this.each(this.metaSettings,(s,n)=>{u[n]=s.settings}),t.meta_settings=u}o(e,t).then(u=>{if(this.$eventBus.emit("reloadMenu"),!this.form.id&&!this.disable_redirect){let s=this.$router.resolve({name:"space_feeds",params:{space:u.space.slug}}).href;window.location.href=s;return}this.$notify.success(u.message),this.$emit("completed",u.space),u.redirect_url&&!this.disable_redirect&&(window.location.href=u.redirect_url)}).catch(u=>{this.form.id||(this.showingSections=["basic"]),this.$handleError(u)}).finally(()=>{this.saving=!1})},handleCoverPhotoUpload(e){this.form.cover_photo=e},handleLogoPhotoUpload(e){this.form.logo=e},fetchMetaBoxes(){this.community.id&&(this.fetchingMetaBoxes=!0,this.$get("spaces/"+this.community.slug+"/meta-settings",{space_id:this.community.id}).then(e=>{this.metaSettings=e.meta_settings}).catch(e=>{this.$handleError(e)}).finally(()=>{this.fetchingMetaBoxes=!1}))}},mounted(){if(this.community&&this.community.id){this.community.chat_thread_id&&(this.community.group_chat_support="yes"),this.form=this.community;let e=[];this.community.topics&&this.each(this.community.topics,t=>{e.push(t.id)}),this.form.topic_ids=e,this.fetchMetaBoxes(this.community.id)}else this.parent_id?(this.form.parent_id=this.parent_id,this.$route.query.parent_id):this.$route.query.parent_id&&(this.form.parent_id=this.$route.query.parent_id);this.form.id&&(this.showingSections=["basic","customization"]),this.dataLoaded=!0}},v1={key:0},b1={class:"fcom_form_section"},k1={class:"fcom_help_text"},w1={class:"fcom_form_section"},C1={style:{"font-weight":"bold"}},$1=["innerHTML"],S1={key:0},V1={class:"fcom_help_text"},L1={key:0},M1={key:1,class:"fcom_form_section"},P1={class:"fcom_lined_checkboxes"},F1={key:0,class:"fcom_pro_feature"},T1={key:0,style:{background:"var(--fcom-active-bg, #f0f3f5)",padding:"10px 15px","margin-bottom":"10px","border-radius":"8px"}},I1={class:"fcom_form_section"},U1={class:"fcom_svg_radio_item"},B1={class:"svg_radio_label"},E1={class:"fcom_svg_radio_item"},A1={class:"svg_radio_label"},D1={class:"fcom_svg_radio_item"},R1={class:"svg_radio_label"},H1={class:"fcom_help_text"},x1={class:"fcom_form_section"},j1={class:"fcom_help_text"},O1=["href"],N1={class:"fcom_image_uploader_wrapper"},z1={class:"fcom_help_text"},q1={class:"fcom_image_uploader_wrapper"},G1={class:"fcom_help_text"},Y1={class:"fcom_space_form_bottom"},Z1={key:0},W1={style:{"margin-top":"20px"},class:"fcom_form_section"};function J1(e,t,o,u,s,n){const m=g("logo-emoji-selector"),p=ee,h=ue,y=g("SlugInput"),k=g("space-group-selector"),b=ie,$=ne,f=Ue,w=ge,C=he,M=g("TimelineViewIcon"),P=g("ListViewIcon"),T=g("CardViewIcon"),I=g("topic-selector"),U=Pe,B=g("EditPen"),A=O,L=j,E=g("Delete"),G=g("ImageUploader"),se=_e,H=g("form-builder"),X=K("loading");return i(),c("div",null,[a(se,{onSubmit:t[28]||(t[28]=Z(x=>e.doNothing(),["prevent"])),modelValue:s.form,"onUpdate:modelValue":t[29]||(t[29]=x=>s.form=x),"label-position":"top",class:"fcom_space_form"},{default:r(()=>[s.showingSections.indexOf("basic")!==-1?(i(),c(V,{key:0},[s.form.id?_("",!0):(i(),c("h4",v1,d(e.$t("Basic Info")),1)),l("div",b1,[l("h4",null,d(e.$t("General")),1),a(h,{label:e.$t("Space Title")},{default:r(()=>[a(p,{type:"text",placeholder:e.$t("Your Space Title"),modelValue:s.form.title,"onUpdate:modelValue":t[1]||(t[1]=x=>s.form.title=x)},{prepend:r(()=>{var x,Q;return[s.dataLoaded?(i(),v(m,{key:0,custom_svg:!0,onUpdate:t[0]||(t[0]=ce=>{s.form.settings.emoji=ce.emoji,s.form.logo=ce.logo,s.form.settings.shape_svg=ce.shape_svg}),config:{logo:s.form.logo,emoji:((x=s.form.settings)==null?void 0:x.emoji)||"",shape_svg:((Q=s.form.settings)==null?void 0:Q.shape_svg)||""}},null,8,["config"])):_("",!0)]}),_:1},8,["placeholder","modelValue"])]),_:1},8,["label"]),s.dataLoaded?(i(),v(h,{key:0,label:e.$t("Slug (optional)")},{default:r(()=>[a(y,{popMessage:e.$t("The URLs of this space posts will be changed to the new slug. If you have lots of contents in this space, you should not change it. Are you sure you want to change it?"),is_inital_inactive:!!s.form.id,modelValue:s.form.slug,"onUpdate:modelValue":t[2]||(t[2]=x=>s.form.slug=x),placeholder:e.$t("Space Slug (no space or special chars)")},null,8,["popMessage","is_inital_inactive","modelValue","placeholder"])]),_:1},8,["label"])):_("",!0),a(h,{label:e.$t("Description")},{default:r(()=>[a(p,{type:"textarea",rows:3,placeholder:e.$t("Space Description"),modelValue:s.form.description,"onUpdate:modelValue":t[3]||(t[3]=x=>s.form.description=x)},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),a(h,{label:e.$t("Menu Group")},{default:r(()=>[s.dataLoaded?(i(),v(k,{key:0,modelValue:s.form.parent_id,"onUpdate:modelValue":t[4]||(t[4]=x=>s.form.parent_id=x),space_id:s.form.id},null,8,["modelValue","space_id"])):_("",!0),l("div",k1,[l("p",null,d(e.$t("Select a menu group to where this space will be added to the sidebar. If you do not select a menu group, it will be available on the all spaces page.")),1)])]),_:1},8,["label"])]),l("div",w1,[l("h4",null,d(e.$t("Access Control")),1),a(h,{label:e.$t("Privacy")},{default:r(()=>[a($,{"popper-class":"rich_select",modelValue:s.form.privacy,"onUpdate:modelValue":t[5]||(t[5]=x=>s.form.privacy=x),placeholder:e.$t("Select Privacy")},{default:r(()=>[(i(!0),c(V,null,D(s.privacies,(x,Q)=>(i(),v(b,{key:Q,label:x.label,value:Q},{default:r(()=>[l("span",C1,d(e.$labelize(x.label)),1),l("p",{innerHTML:x.description},null,8,$1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),s.form.privacy=="private"?(i(),c(V,{key:0},[a(h,{label:e.$t("Lock Screen Type")},{default:r(()=>[a(w,{modelValue:s.form.settings.custom_lock_screen,"onUpdate:modelValue":t[6]||(t[6]=x=>s.form.settings.custom_lock_screen=x),class:""},{default:r(()=>[a(f,{value:"yes"},{default:r(()=>[S(d(e.$t("Custom Lock Screen")),1)]),_:1}),a(f,{value:"no"},{default:r(()=>[S(d(e.$t("Default Lock Screen")),1)]),_:1}),a(f,{disabled:!e.has_pro,value:"redirect"},{default:r(()=>[S(d(e.$t("Redirect to an URL"))+" ",1),e.has_pro?_("",!0):(i(),c("span",S1,d(e.$t("Require Pro")),1))]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),s.form.settings.custom_lock_screen=="redirect"&&e.has_pro?(i(),v(h,{key:0,label:e.$t("Provide the Redirect URL")},{default:r(()=>[a(p,{modelValue:s.form.settings.onboard_redirect_url,"onUpdate:modelValue":t[7]||(t[7]=x=>s.form.settings.onboard_redirect_url=x),type:"text",placeholder:e.$t("Redirect URL for unenrolled users")},null,8,["modelValue","placeholder"]),l("div",V1,[l("p",null,d(e.$t("This link will be used to redirect the non-members. This may be your sales page for this space")),1)])]),_:1},8,["label"])):_("",!0)],64)):_("",!0),n.isDefaultLockscreen?(i(),v(h,{key:1,style:{"margin-bottom":"0"}},{default:r(()=>[a(C,{"true-value":"yes","false-value":"no",modelValue:s.form.settings.can_request_join,"onUpdate:modelValue":t[8]||(t[8]=x=>s.form.settings.can_request_join=x),class:"fcom_checkbox"},{default:r(()=>[S(d(e.$t("Allow users to request to join this Space")),1)]),_:1},8,["modelValue"])]),_:1})):_("",!0),n.isDefaultLockscreen?(i(),v(h,{key:2},{default:r(()=>[a(C,{"true-value":"yes","false-value":"no",modelValue:s.form.settings.show_paywalls,"onUpdate:modelValue":t[9]||(t[9]=x=>s.form.settings.show_paywalls=x),class:"fcom_checkbox"},{default:r(()=>[S(d(e.$t("Show Paywalls in Default Lock Screen")),1)]),_:1},8,["modelValue"])]),_:1})):_("",!0),a(h,{label:e.$t("Who can view space members")},{default:r(()=>[a($,{modelValue:s.form.settings.members_page_status,"onUpdate:modelValue":t[10]||(t[10]=x=>s.form.settings.members_page_status=x)},{default:r(()=>[a(b,{value:"members_only",label:e.$t("Members Only")},null,8,["label"]),a(b,{value:"admin_only",label:e.$t("Admin/Moderators Only")},null,8,["label"]),a(b,{value:"logged_in",label:e.$t("Any Logged in users")},null,8,["label"]),a(b,{value:"everybody",label:e.$t("Anyone")},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"])])],64)):_("",!0),s.showingSections.indexOf("customization")!==-1?(i(),c(V,{key:1},[s.form.id?_("",!0):(i(),c("h4",L1,d(e.$t("Customization")),1)),s.form.settings?(i(),c("div",M1,[l("h4",null,d(e.$t("Features Customizations")),1),a(h,null,{default:r(()=>[l("div",P1,[a(C,{class:"fcom_checkbox","true-value":"yes","false-value":"no",modelValue:s.form.settings.restricted_post_only,"onUpdate:modelValue":t[11]||(t[11]=x=>s.form.settings.restricted_post_only=x)},{default:r(()=>[S(d(e.$t("Only admin or moderators can create post")),1)]),_:1},8,["modelValue"]),a(C,{class:"fcom_checkbox","true-value":"yes","false-value":"no",modelValue:s.form.settings.show_sidebar,"onUpdate:modelValue":t[12]||(t[12]=x=>s.form.settings.show_sidebar=x)},{default:r(()=>[S(d(e.$t("Show Right Sidebar on Space")),1)]),_:1},8,["modelValue"]),a(C,{class:"fcom_checkbox","true-value":"yes","false-value":"no",modelValue:s.form.settings.hide_members_count,"onUpdate:modelValue":t[13]||(t[13]=x=>s.form.settings.hide_members_count=x)},{default:r(()=>[S(d(e.$t("Hide Members count from spaces page (when members page access unavailable)")),1)]),_:1},8,["modelValue"]),a(C,{class:"fcom_checkbox",disabled:!e.has_pro,"true-value":"yes","false-value":"no",modelValue:s.form.settings.document_library,"onUpdate:modelValue":t[14]||(t[14]=x=>s.form.settings.document_library=x)},{default:r(()=>[S(d(e.$t("Enable File/Document Library for this space"))+" ",1),e.has_pro?_("",!0):(i(),c("span",F1," ("+d(e.$t("Pro Feature"))+") ",1))]),_:1},8,["disabled","modelValue"])])]),_:1}),s.form.settings.document_library=="yes"?(i(),c("div",T1,[a(h,{label:e.$t("Document Library Access (View & Download)")},{default:r(()=>[a(w,{modelValue:s.form.settings.document_access,"onUpdate:modelValue":t[15]||(t[15]=x=>s.form.settings.document_access=x),class:"fcom_radio_group_inline"},{default:r(()=>[a(f,{value:"members_only"},{default:r(()=>[S(d(e.$t("Members of this space")),1)]),_:1}),a(f,{value:"logged_in"},{default:r(()=>[S(d(e.$t("Any Logged in users")),1)]),_:1}),a(f,{value:"everybody"},{default:r(()=>[S(d(e.$t("Public")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(h,{label:e.$t("Who can upload the documents?")},{default:r(()=>[a(w,{style:{"margin-bottom":"0"},modelValue:s.form.settings.document_upload,"onUpdate:modelValue":t[16]||(t[16]=x=>s.form.settings.document_upload=x),class:"fcom_radio_group_inline"},{default:r(()=>[a(f,{value:"members_only"},{default:r(()=>[S(d(e.$t("Any Members")),1)]),_:1}),a(f,{value:"admin_only"},{default:r(()=>[S(d(e.$t("Admin/Moderators Only")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])])):_("",!0),a(h,{label:e.$t("Default Post Sort By")},{default:r(()=>[a($,{modelValue:s.form.settings.default_post_sort_by,"onUpdate:modelValue":t[17]||(t[17]=x=>s.form.settings.default_post_sort_by=x),clearable:"",class:"fcom_select",placeholder:e.$t("Latest Posts Sort")},{default:r(()=>[(i(!0),c(V,null,D(s.postOrderOptions,(x,Q)=>(i(),v(b,{key:Q,value:Q,label:x},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(C,{class:"fcom_checkbox","true-value":"yes","false-value":"no",modelValue:s.form.settings.disable_post_sort_by,"onUpdate:modelValue":t[18]||(t[18]=x=>s.form.settings.disable_post_sort_by=x)},{default:r(()=>[S(d(e.$t("Disable Post Sort By Options")),1)]),_:1},8,["modelValue"]),a(h,{label:e.$t("Default Comment Sort By")},{default:r(()=>[a($,{modelValue:s.form.settings.default_comment_sort_by,"onUpdate:modelValue":t[19]||(t[19]=x=>s.form.settings.default_comment_sort_by=x),clearable:"",class:"fcom_select",placeholder:e.$t("Latest Comments Sort")},{default:r(()=>[(i(!0),c(V,null,D(s.commentOrderOptions,(x,Q)=>(i(),v(b,{key:Q,value:Q,label:x},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])])):_("",!0),l("div",I1,[l("h4",null,d(e.$t("Layout")),1),a(h,{label:e.$t("Default Layout Styles")},{default:r(()=>[a(w,{modelValue:s.form.settings.layout_style,"onUpdate:modelValue":t[20]||(t[20]=x=>s.form.settings.layout_style=x),class:"fcom_svg_radio_group"},{default:r(()=>[l("div",U1,[a(f,{value:"timeline"},{default:r(()=>[a(M,{style:{width:"100px",height:"auto"}}),l("p",B1,d(e.$t("Timeline")),1)]),_:1})]),l("div",E1,[a(f,{value:"list"},{default:r(()=>[a(P,{style:{width:"100px",height:"auto"}}),l("p",A1,d(e.$t("List")),1)]),_:1})]),l("div",D1,[a(f,{value:"card"},{default:r(()=>[a(T,{style:{width:"100px",height:"auto"}}),l("p",R1,d(e.$t("Card")),1)]),_:1})])]),_:1},8,["modelValue"]),l("div",H1,[l("p",null,d(e.$t("User can change the layout style to their own preference.")),1)])]),_:1},8,["label"])]),l("div",x1,[l("h4",null,d(e.$t("Others")),1),e.has_pro&&s.dataLoaded?(i(),v(h,{key:0,label:e.$t("Topic navigation")},{default:r(()=>[a(I,{creatable:!0,space_id:s.form.id,modelValue:s.form.topic_ids,"onUpdate:modelValue":t[21]||(t[21]=x=>s.form.topic_ids=x)},null,8,["space_id","modelValue"]),l("div",j1,[l("p",null,[S(d(e.$t("Categorize your posts and allow members to filter spaces with the topic navigation bar. You can define up to 20 topics per space."))+" ",1),e.isAdmin()?(i(),c("a",{key:0,target:"_blank",rel:"noopener",href:e.$getRouteLink("admin/settings/topics-settings")},d(e.$t("Manage all topics.")),9,O1)):_("",!0)])]),a(C,{"true-value":"yes","false-value":"no",modelValue:s.form.settings.topic_required,"onUpdate:modelValue":t[22]||(t[22]=x=>s.form.settings.topic_required=x)},{default:r(()=>[S(d(e.$t("Make members select a topic")),1)]),_:1},8,["modelValue"])]),_:1},8,["label"])):_("",!0),e.appVars.has_chat?(i(),v(h,{key:1,label:e.$t("Group Chat?")},{default:r(()=>[a(C,{"true-value":"yes","false-value":"no",modelValue:s.form.group_chat_support,"onUpdate:modelValue":t[23]||(t[23]=x=>s.form.group_chat_support=x)},{default:r(()=>[S(d(e.$t("Enable group chat for this space members")),1)]),_:1},8,["modelValue"])]),_:1},8,["label"])):_("",!0),a(h,{label:e.$t("Thumbnail / Open Graph Image (Recommended Size: 1200 x 630)")},{default:r(()=>[s.form.settings.og_image?(i(),v(U,{key:0,alt:e.$t("Thumbnail / Open Graph Image"),src:s.form.settings.og_image,style:{"max-width":"100px",height:"auto"}},null,8,["alt","src"])):_("",!0),l("div",N1,[a(G,{isTextBtn:!1,removeIcon:!0,can_remove:!!s.form.settings.og_image,additionalData:{resize:!1,disable_convert:"yes",max_width:1200,max_height:630},onUploaded:t[24]||(t[24]=x=>{s.form.settings.og_image=x})},pe({remove:r(()=>[a(A,null,{default:r(()=>[a(E)]),_:1})]),_:2},[s.form.settings.og_image?{name:"trigger",fn:r(()=>[a(L,{class:"fcom_plain_button"},{default:r(()=>[a(A,null,{default:r(()=>[a(B)]),_:1})]),_:1})]),key:"0"}:void 0]),1032,["can_remove"])]),l("div",z1,[l("p",null,d(e.$t("Will be used on card preview and social sharing preview.")),1)])]),_:1},8,["label"]),a(h,{label:e.$t("Featured Image (Recommended size: 1600x500) - Optional")},{default:r(()=>[s.form.cover_photo?(i(),v(U,{key:0,src:s.form.cover_photo,alt:e.$t("Featured Image Preview"),style:{"max-width":"100px",height:"auto"}},null,8,["src","alt"])):_("",!0),l("div",q1,[a(G,{isTextBtn:!1,removeIcon:!0,can_remove:!!s.form.cover_photo,additionalData:{resize:!0,max_width:1600},onUploaded:n.handleCoverPhotoUpload},pe({remove:r(()=>[a(A,null,{default:r(()=>[a(E)]),_:1})]),_:2},[s.form.cover_photo?{name:"trigger",fn:r(()=>[a(L,{class:"fcom_plain_button"},{default:r(()=>[a(A,null,{default:r(()=>[a(B)]),_:1})]),_:1})]),key:"0"}:void 0]),1032,["can_remove","onUploaded"])]),l("div",G1,[l("p",null,d(e.$t("If you add this image, it will be shown on the space homepage")),1)])]),_:1},8,["label"]),s.form.id?_("",!0):(i(),v(h,{key:2,style:{"margin-top":"45px"}},{default:r(()=>[s.showingSections.indexOf("basic")===-1?(i(),v(L,{key:0,class:"plain_button",text:"",onClick:t[25]||(t[25]=()=>{s.showingSections=["basic"]})},{default:r(()=>[l("span",null,d(e.$t("Go Back")),1)]),_:1})):_("",!0),N((i(),v(L,{class:"fcom_primary_button",disabled:s.saving,onClick:t[26]||(t[26]=x=>n.submit())},{default:r(()=>[l("span",null,d(e.$t("Create")),1)]),_:1},8,["disabled"])),[[X,s.saving]])]),_:1}))])],64)):(i(),v(h,{key:2},{default:r(()=>[l("div",Y1,[a(L,{onClick:t[27]||(t[27]=()=>{s.showingSections=["customization"]}),class:"fcom_primary_button"},{default:r(()=>[l("span",null,d(e.$t("Continue")),1)]),_:1})])]),_:1}))]),_:1},8,["modelValue"]),N((i(),c("div",null,[s.metaSettings&&Object.keys(s.metaSettings).length>0?(i(),c("div",Z1,[(i(!0),c(V,null,D(s.metaSettings,x=>(i(),c("div",W1,[l("h4",null,d(x.section_title),1),a(H,{formData:x.settings,formFields:x.fields,disableSubmit:!0},null,8,["formData","formFields"])]))),256))])):_("",!0)])),[[X,s.fetchingMetaBoxes]])])}const It=F(y1,[["render",J1]]),Q1={name:"CreateCorseForm",components:{FormBuilder:Os,SpaceGroupSelector:Qt,TopicSelector:js,SlugInput:Tt,ImageUploader:Re,LogoEmojiSelector:Ft,CrepeEditor:St},emits:["completed","close"],props:{course:{required:!1,default:{title:"",description:"",privacy:"public",course_type:"self_paced",cover_photo:"",parent_id:"",status:"draft",category_ids:[],settings:{emoji:"",custom_lock_screen:"no",shape_svg:"",disable_comments:"no",hide_members_count:"no"}}},savingCount:{required:!1,default:0},parent_id:{required:!1,default:null},disable_redirect:{required:!1,default:!1}},data(){return{saving:!1,privacies:pd,form:{slug:"",title:"",description:"",privacy:"public",course_type:"self_paced",cover_photo:"",parent_id:"",status:"draft",category_ids:[],settings:{emoji:"",custom_lock_screen:"no",shape_svg:"",course_details:"",course_layout:"classic"}},courseTypes:gd,dataLoaded:!1,metaSettings:null,fetchingMetaBoxes:!1,appReady:!1,courseInstructors:[],fetchingInstructors:!1}},watch:{savingCount(){this.submit(!0)}},methods:{submit(e=!1){this.saving=!0;let t="admin/courses",o=this.form,u=this.$post;if(this.form.id&&(t+="/"+this.form.id,o={title:this.form.title,privacy:this.form.privacy,course_type:this.form.course_type,description:this.form.description,status:this.form.status,slug:this.form.slug,logo:this.form.logo,cover_photo:this.form.cover_photo,space_id:this.form.id,parent_id:this.form.parent_id,settings:this.form.settings,category_ids:this.form.category_ids},u=this.$put,this.form.created_by&&this.isAdmin()&&(o.created_by=this.form.created_by),this.metaSettings)){let s={};this.each(this.metaSettings,(n,m)=>{s[m]=n.settings}),o.meta_settings=s}u(t,o).then(s=>{if(!this.form.id&&!this.disable_redirect){let n=this.$getRouteLink("admin/manage-courses/edit/"+s.course.id+"/lessons");window.location.href=n,this.form={};return}this.$eventBus.emit("reloadMenu"),this.$notify.success(s.message),this.$emit("completed",s.course),e&&this.$emit("close")}).catch(s=>{this.$handleError(s)}).finally(()=>{this.saving=!1})},searchUsers(e=""){e&&e.length<3||this.fetchCourseInstructors(e)},handlePhotoUpload(e){this.form.cover_photo=e},fetchMetaBoxes(){this.course.id&&(this.fetchingMetaBoxes=!0,this.$get("admin/courses/"+this.course.id+"/meta-settings").then(e=>{this.metaSettings=e.meta_settings}).catch(e=>{this.$handleError(e)}).finally(()=>{this.fetchingMetaBoxes=!1}))},fetchCourseInstructors(e=""){this.fetchingInstructors=!0,this.$get("admin/courses/"+this.course.id+"/instructors/search",{search:e}).then(t=>{this.courseInstructors=t.instructors}).catch(t=>{this.$handleError(t)}).finally(()=>{this.fetchingInstructors=!1})}},mounted(){var t,o,u,s,n;this.course.id?(this.form=this.course,this.form.created_by=parseInt(this.form.created_by),this.fetchMetaBoxes(),this.fetchCourseInstructors()):this.parent_id&&(this.form.parent_id=this.parent_id);const e=(o=(t=this.course)==null?void 0:t.settings)==null?void 0:o.course_type;e&&!((u=this.form)!=null&&u.course_type)&&(this.form.course_type=e),(!((n=(s=this.form)==null?void 0:s.settings)!=null&&n.course_layout)||!this.has_pro)&&(this.form.settings.course_layout="classic"),this.dataLoaded=!0,this.$nextTick(()=>{this.appReady=!0})}},K1={key:0},X1={class:"fcom_form_section"},eg={class:"fcom_help_text"},tg={class:"fcom_help_text"},sg={class:"fcom_form_section"},og={style:{"font-weight":"bold"}},ig={key:0},ng={class:"fcom_help_text"},lg={style:{"font-weight":"bold"}},ag={class:"fcom_form_section"},rg={class:"fcom_lined_checkboxes"},cg={key:0},dg={class:"fcom_help_text"},ug={key:0,class:"fcom_form_section"},_g={class:"fcom_select_photo",style:{float:"left"}},mg=["src","alt"],hg={style:{float:"right",color:"#8492a6","font-size":"13px"}},fg={class:"fcom_lined_checkboxes"},pg={class:"fcom_form_section"},gg={class:"fcom_help_text"},yg=["href"],vg={class:"fcom_image_uploader_wrapper"},bg={class:"fcom_help_text"},kg={key:0},wg={style:{"margin-top":"20px"},class:"fcom_form_section"},Cg={key:1},$g=["href"];function Sg(e,t,o,u,s,n){const m=g("logo-emoji-selector"),p=ee,h=ue,y=g("SlugInput"),k=g("crepe-editor"),b=g("space-group-selector"),$=Ue,f=ge,w=ie,C=ne,M=he,P=g("topic-selector"),T=Pe,I=g("EditPen"),U=O,B=j,A=g("Delete"),L=g("ImageUploader"),E=_e,G=g("form-builder"),se=K("loading");return e.hasFeature("has_course")?(i(),c("div",K1,[a(E,{onSubmit:t[21]||(t[21]=Z(H=>e.doNothing(),["prevent"])),modelValue:s.form,"onUpdate:modelValue":t[22]||(t[22]=H=>s.form=H),"label-position":"top"},{default:r(()=>[l("div",X1,[l("h4",null,d(e.$t("General")),1),a(h,{label:e.$t("Course Title")},{default:r(()=>[a(p,{type:"text",placeholder:e.$t("Your Course Title"),modelValue:s.form.title,"onUpdate:modelValue":t[1]||(t[1]=H=>s.form.title=H)},{prepend:r(()=>{var H,X;return[s.dataLoaded?(i(),v(m,{key:0,custom_svg:!0,config:{logo:s.form.logo,emoji:(H=s.form.settings)==null?void 0:H.emoji,shape_svg:((X=s.form.settings)==null?void 0:X.shape_svg)||""},onUpdate:t[0]||(t[0]=x=>{s.form.settings.emoji=x.emoji,s.form.logo=x.logo,s.form.settings.shape_svg=x.shape_svg})},null,8,["config"])):_("",!0)]}),_:1},8,["placeholder","modelValue"])]),_:1},8,["label"]),s.dataLoaded?(i(),v(h,{key:0,label:e.$t("Slug (optional)")},{default:r(()=>[a(y,{popMessage:e.$t("The URLs of this course lessons will be changed to the new slug. If you have lots of lessons and sections in this course, you should not change it. Are you sure you want to change it?"),is_inital_inactive:!!s.form.id,modelValue:s.form.slug,"onUpdate:modelValue":t[2]||(t[2]=H=>s.form.slug=H),placeholder:e.$t("Course Slug (no spaces or special characters)")},null,8,["popMessage","is_inital_inactive","modelValue","placeholder"])]),_:1},8,["label"])):_("",!0),a(h,{label:e.$t("Short Description")},{default:r(()=>[a(p,{type:"textarea",placeholder:e.$t("Course Description"),modelValue:s.form.description,"onUpdate:modelValue":t[3]||(t[3]=H=>s.form.description=H)},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),a(h,{class:"form_label_with_tooltip",label:e.$t("Course Details")},{default:r(()=>[s.appReady?(i(),v(k,{key:0,modelValue:s.form.settings.course_details,"onUpdate:modelValue":t[4]||(t[4]=H=>s.form.settings.course_details=H),autofocus:!0,placeholder:e.$t("Add any additional information or notes about this course here"),disable_media:!0},null,8,["modelValue","placeholder"])):_("",!0),l("div",eg,[l("p",null,d(e.$t("This section will be displayed on the course landing page. Add extra details, notes, or instructions to help learners understand the course better.")),1)])]),_:1},8,["label"]),a(h,{label:e.$t("Menu Group")},{default:r(()=>[s.dataLoaded?(i(),v(b,{key:0,modelValue:s.form.parent_id,"onUpdate:modelValue":t[5]||(t[5]=H=>s.form.parent_id=H),space_id:s.form.id},null,8,["modelValue","space_id"])):_("",!0),l("div",tg,[l("p",null,d(e.$t("Select a menu group to where this course will be added to the sidebar. If you do not select a menu group, it will be available on the all courses page.")),1)])]),_:1},8,["label"]),a(h,{label:e.$t("Status")},{default:r(()=>[a(f,{modelValue:s.form.status,"onUpdate:modelValue":t[6]||(t[6]=H=>s.form.status=H),class:"fcom_radio_group"},{default:r(()=>[a($,{value:"published"},{default:r(()=>[S(d(e.$t("Published")),1)]),_:1}),a($,{value:"draft"},{default:r(()=>[S(d(e.$t("Draft")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])]),l("div",sg,[l("h4",null,d(e.$t("Access Control")),1),a(h,{label:e.$t("Privacy")},{default:r(()=>[a(C,{"popper-class":"rich_select",modelValue:s.form.privacy,"onUpdate:modelValue":t[7]||(t[7]=H=>s.form.privacy=H),placeholder:e.$t("Select Privacy")},{default:r(()=>[(i(!0),c(V,null,D(s.privacies,(H,X)=>(i(),v(w,{key:X,label:H.label,value:X},{default:r(()=>[l("span",og,d(H.label),1),l("p",null,d(H.description),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),s.form.privacy=="private"?(i(),c(V,{key:0},[a(h,{label:e.$t("Lock Screen Type")},{default:r(()=>[a(f,{modelValue:s.form.settings.custom_lock_screen,"onUpdate:modelValue":t[8]||(t[8]=H=>s.form.settings.custom_lock_screen=H),class:"fcom_radio_group"},{default:r(()=>[a($,{value:"yes"},{default:r(()=>[S(d(e.$t("Custom")),1)]),_:1}),a($,{value:"no"},{default:r(()=>[S(d(e.$t("Default")),1)]),_:1}),a($,{disabled:!e.has_pro,value:"redirect"},{default:r(()=>[S(d(e.$t("Redirect to an URL"))+" ",1),e.has_pro?_("",!0):(i(),c("span",ig,d(e.$t("Require Pro")),1))]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),s.form.settings.custom_lock_screen=="redirect"&&e.has_pro?(i(),v(h,{key:0,label:e.$t("Provide the Redirect URL")},{default:r(()=>[a(p,{modelValue:s.form.settings.onboard_redirect_url,"onUpdate:modelValue":t[9]||(t[9]=H=>s.form.settings.onboard_redirect_url=H),type:"text",placeholder:e.$t("Redirect URL for unenrolled users")},null,8,["modelValue","placeholder"]),l("div",ng,[l("p",null,d(e.$t("This link will be used to redirect the unenrolled or public users. This may be your sales page for this course")),1)])]),_:1},8,["label"])):_("",!0),s.form.settings.custom_lock_screen=="no"?(i(),v(h,{key:1},{default:r(()=>[a(M,{"true-value":"yes","false-value":"no",modelValue:s.form.settings.show_paywalls,"onUpdate:modelValue":t[10]||(t[10]=H=>s.form.settings.show_paywalls=H),class:"fcom_checkbox"},{default:r(()=>[S(d(e.$t("Show Paywalls in the default lock screen")),1)]),_:1},8,["modelValue"])]),_:1})):_("",!0)],64)):_("",!0),a(h,{label:e.$t("Enrollment Type")},{default:r(()=>[a(C,{"popper-class":"rich_select",modelValue:s.form.course_type,"onUpdate:modelValue":t[11]||(t[11]=H=>s.form.course_type=H),placeholder:e.$t("Select Type")},{default:r(()=>[(i(!0),c(V,null,D(s.courseTypes,(H,X)=>(i(),v(w,{key:X,label:H.label,value:X},{default:r(()=>[l("span",lg,d(H.label),1),l("p",null,d(H.description),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),l("div",ag,[l("h4",null,d(e.$t("Features Customizations")),1),a(h,null,{default:r(()=>[l("div",rg,[s.form.privacy=="public"&&s.form.course_type=="self_paced"?(i(),v(M,{key:0,"true-value":"yes","false-value":"no",modelValue:s.form.settings.public_lesson_view,"onUpdate:modelValue":t[12]||(t[12]=H=>s.form.settings.public_lesson_view=H),class:"fcom_checkbox"},{default:r(()=>[S(d(e.$t("Public users can view the lessons without enrolling in the course")),1)]),_:1},8,["modelValue"])):_("",!0),a(M,{"true-value":"yes","false-value":"no",modelValue:s.form.settings.disable_comments,"onUpdate:modelValue":t[13]||(t[13]=H=>s.form.settings.disable_comments=H),class:"fcom_checkbox"},{default:r(()=>[S(d(e.$t("Disable comments for all the lessons for this course")),1)]),_:1},8,["modelValue"]),a(M,{"true-value":"yes","false-value":"no",modelValue:s.form.settings.hide_members_count,"onUpdate:modelValue":t[14]||(t[14]=H=>s.form.settings.hide_members_count=H),class:"fcom_checkbox"},{default:r(()=>[S(d(e.$t("Hide students count from courses page")),1)]),_:1},8,["modelValue"])])]),_:1}),a(h,{label:e.$t("Course Layout")},{default:r(()=>[a(f,{modelValue:s.form.settings.course_layout,"onUpdate:modelValue":t[15]||(t[15]=H=>s.form.settings.course_layout=H),class:"fcom_radio_group"},{default:r(()=>[a($,{value:"classic"},{default:r(()=>[S(d(e.$t("Classic")),1)]),_:1}),a($,{disabled:!e.has_pro,value:"modern"},{default:r(()=>[S(d(e.$t("Modern"))+" ",1),e.has_pro?_("",!0):(i(),c("span",cg,"("+d(e.$t("Available on Pro"))+")",1))]),_:1},8,["disabled"])]),_:1},8,["modelValue"]),l("div",dg,[l("p",null,d(e.$t("Classic is the default layout. For a more visual and engaging experience, the Modern layout displays the featured image or embedded video thumbnail.")),1)])]),_:1},8,["label"])]),s.form.id?(i(),c("div",ug,[l("h4",null,d(e.$t("Course Instructor")),1),a(h,{label:e.$t("Instructor")},{default:r(()=>[a(C,{disabled:!e.isAdmin(),class:"rich_select",filterable:"",remote:"",loading:s.fetchingInstructors,"remote-method":n.searchUsers,placeholder:e.$t("Select User"),modelValue:s.form.created_by,"onUpdate:modelValue":t[16]||(t[16]=H=>s.form.created_by=H)},{default:r(()=>[(i(!0),c(V,null,D(s.courseInstructors,H=>(i(),v(w,{class:"fcom_with_photo_option",key:H.ID,label:H.display_name+" ("+(H.user_email||H.ID)+")",value:H.ID},{default:r(()=>[l("span",_g,[l("img",{src:H.photo,alt:H.display_name},null,8,mg),l("span",null,d(H.display_name),1)]),l("span",hg,d(H.user_email||H.ID),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["disabled","loading","remote-method","placeholder","modelValue"])]),_:1},8,["label"]),a(h,null,{default:r(()=>[l("div",fg,[a(M,{"true-value":"yes","false-value":"no",modelValue:s.form.settings.hide_instructor_view,"onUpdate:modelValue":t[17]||(t[17]=H=>s.form.settings.hide_instructor_view=H),class:"fcom_checkbox"},{default:r(()=>[S(d(e.$t("Hide course instructor view from course overview page")),1)]),_:1},8,["modelValue"]),s.form.settings.hide_instructor_view!="yes"?(i(),v(M,{key:0,"true-value":"yes","false-value":"no",modelValue:s.form.settings.show_instructor_students_count,"onUpdate:modelValue":t[18]||(t[18]=H=>s.form.settings.show_instructor_students_count=H),class:"fcom_checkbox"},{default:r(()=>[S(d(e.$t("Show students count in course instructor view")),1)]),_:1},8,["modelValue"])):_("",!0)])]),_:1})])):_("",!0),l("div",pg,[l("h4",null,d(e.$t("Others")),1),e.has_pro&&s.dataLoaded?(i(),v(h,{key:0,label:e.$t("Topic navigation")},{default:r(()=>[a(P,{modelValue:s.form.category_ids,"onUpdate:modelValue":t[19]||(t[19]=H=>s.form.category_ids=H)},null,8,["modelValue"]),l("div",gg,[l("p",null,d(e.$t("Categorize your course and allow members to filter courses with the topic navigation bar in the courses directory. You can define up to 20 topics per course.")),1),l("p",null,[e.isAdmin()?(i(),c("a",{key:0,target:"_blank",rel:"noopener",href:e.$getRouteLink("admin/settings/topics-settings")},d(e.$t("Manage all topics")),9,yg)):_("",!0)])])]),_:1},8,["label"])):_("",!0),a(h,{label:e.$t("Thumbnail / Open Graph Image (Recommended Size: 1200 x 630)")},{default:r(()=>[s.form.cover_photo?(i(),v(T,{key:0,alt:e.$t("Cover Photo"),src:s.form.cover_photo,style:{"max-width":"100px",height:"auto"}},null,8,["alt","src"])):_("",!0),l("div",vg,[a(L,{isTextBtn:!1,can_remove:!!s.form.cover_photo,additionalData:{resize:!1,disable_convert:"yes",max_width:1200,max_height:630},onUploaded:n.handlePhotoUpload},pe({remove:r(()=>[a(U,null,{default:r(()=>[a(A)]),_:1})]),_:2},[s.form.cover_photo?{name:"trigger",fn:r(()=>[a(B,{class:"fcom_plain_button"},{default:r(()=>[a(U,null,{default:r(()=>[a(I)]),_:1})]),_:1})]),key:"0"}:void 0]),1032,["can_remove","onUploaded"])]),l("div",bg,[l("p",null,d(e.$t("Will be used on course card preview and social sharing preview.")),1)])]),_:1},8,["label"]),s.form.id?_("",!0):(i(),v(h,{key:1},{default:r(()=>[a(B,{class:"fcom_primary_button",disabled:s.saving,onClick:t[20]||(t[20]=H=>n.submit()),loading:s.saving},{default:r(()=>[l("span",null,d(e.$t("Create")),1)]),_:1},8,["disabled","loading"])]),_:1}))])]),_:1},8,["modelValue"]),N((i(),c("div",null,[s.metaSettings&&Object.keys(s.metaSettings).length>0?(i(),c("div",kg,[(i(!0),c(V,null,D(s.metaSettings,H=>(i(),c("div",wg,[l("h4",null,d(H.section_title),1),a(G,{formData:H.settings,formFields:H.fields,disableSubmit:!0},null,8,["formData","formFields"])]))),256))])):_("",!0)])),[[se,s.fetchingMetaBoxes]])])):(i(),c("div",Cg,[l("p",null,d(e.$t("Course Module is disabled. Please enable the course module first")),1),l("a",{class:"el-button el-button--default fcom_primary_button",href:e.$getRouteLink("admin/settings/features")},d(e.$t("Go to features settings")),9,$g)]))}const Vg=F(Q1,[["render",Sg]]),Lg={name:"SpaceIcon"},Mg={version:"1.1",viewBox:"0 0 128 128","xml:space":"preserve"},Pg=Ie('<g><path d="M64,42c-13.2,0-24,10.8-24,24s10.8,24,24,24s24-10.8,24-24S77.2,42,64,42z M64,82c-8.8,0-16-7.2-16-16s7.2-16,16-16   s16,7.2,16,16S72.8,82,64,82z"></path><path d="M64,100.8c-14.9,0-29.2,6.2-39.4,17.1l-2.7,2.9l5.8,5.5l2.7-2.9c8.8-9.4,20.7-14.6,33.6-14.6s24.8,5.2,33.6,14.6l2.7,2.9   l5.8-5.5l-2.7-2.9C93.2,107.1,78.9,100.8,64,100.8z"></path><path d="M97,47.9v8c9.4,0,18.1,3.8,24.6,10.7l5.8-5.5C119.6,52.7,108.5,47.9,97,47.9z"></path><path d="M116.1,20c0-10.5-8.6-19.1-19.1-19.1S77.9,9.5,77.9,20S86.5,39.1,97,39.1S116.1,30.5,116.1,20z M85.9,20   c0-6.1,5-11.1,11.1-11.1s11.1,5,11.1,11.1s-5,11.1-11.1,11.1S85.9,26.1,85.9,20z"></path><path d="M31,47.9c-11.5,0-22.6,4.8-30.4,13.2l5.8,5.5c6.4-6.9,15.2-10.7,24.6-10.7V47.9z"></path><path d="M50.1,20C50.1,9.5,41.5,0.9,31,0.9S11.9,9.5,11.9,20S20.5,39.1,31,39.1S50.1,30.5,50.1,20z M31,31.1   c-6.1,0-11.1-5-11.1-11.1S24.9,8.9,31,8.9s11.1,5,11.1,11.1S37.1,31.1,31,31.1z"></path></g>',1),Fg=[Pg];function Tg(e,t,o,u,s,n){return i(),c("svg",Mg,Fg)}const Ig=F(Lg,[["render",Tg]]),Ug={name:"CourseIcon"},Bg={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},Eg=l("path",{d:"M10.734 5.84746L14.7114 6.9072M9.88139 9.01146L11.8701 9.54132M9.98031 14.9723L10.7758 15.1843C13.0258 15.7838 14.1508 16.0835 15.037 15.5747C15.9233 15.0659 16.2247 13.9473 16.8276 11.71L17.6802 8.54599C18.2831 6.3087 18.5845 5.19006 18.0728 4.30879C17.5611 3.42752 16.4362 3.12778 14.1862 2.52831L13.3907 2.31636C11.1407 1.71688 10.0157 1.41714 9.12948 1.92594C8.24322 2.43474 7.94178 3.55338 7.3389 5.79067L6.4863 8.95466C5.88342 11.1919 5.58198 12.3106 6.09367 13.1919C6.60536 14.0731 7.73034 14.3729 9.98031 14.9723Z",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round"},null,-1),Ag=l("path",{d:"M9.99996 17.4559L9.20634 17.672C6.96165 18.2832 5.83931 18.5889 4.95512 18.0701C4.07093 17.5513 3.7702 16.4107 3.16874 14.1295L2.31814 10.9035C1.71668 8.62232 1.41595 7.48174 1.92643 6.58318C2.36802 5.80591 3.33329 5.83421 4.58329 5.83411",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round"},null,-1),Dg=[Eg,Ag];function Rg(e,t,o,u,s,n){return i(),c("svg",Bg,Dg)}const Hg=F(Ug,[["render",Rg]]),xg={name:"SpaceCourseSelector",components:{SpaceIcon:He},emits:["update:modelValue","selectedType","selectedSlug"],props:{modelValue:{type:[String,Number,Array],default:""},placeholder_text:{type:String,default:""},is_multiple:{type:Boolean,default:!1},memberships:{type:Array,default:[]}},data(){return{all_spaces:[],selected_spaces:"",loading:!1,formattedSpaceGroups:[],app_ready:!1}},watch:{selected_spaces(e){this.is_multiple?this.$emit("update:modelValue",Array.isArray(e)?e:[]):this.$emit("update:modelValue",e||"")}},methods:{isMemberOfSpace(e){return this.memberships&&this.memberships.includes(e.toString())},fetch(){this.loading=!0,this.$get("admin/all_space_courses").then(e=>{this.all_spaces=e.all_spaces,this.formatSpaceGroups()}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})},emitChanges(){this.$emit("update:modelValue",this.selected_spaces||"");const e=Array.isArray(this.selected_spaces)&&this.selected_spaces.length?this.selected_spaces[0]:this.selected_spaces,t=this.all_spaces.find(o=>o.id==e);this.$emit("selectedSlug",(t==null?void 0:t.slug)||""),this.$emit("selectedType",(t==null?void 0:t.type)=="course"?"course":"space")},formatSpaceGroups(){if(this.all_spaces.length==0)return;let e=this.all_spaces,t=this.appVars.space_groups,o=[],u=[];this.each(t,n=>{let m=e.filter(p=>{let h=p.parent_id==n.id;return h&&u.push(p.slug),h});m.length&&o.push({label:n.title,spaces:m})});let s=e.filter(n=>n.parent_id===null);s&&s.length&&o.push({label:this.$t("Uncategorized"),spaces:s}),this.formattedSpaceGroups=o}},mounted(){this.is_multiple?this.selected_spaces=Array.isArray(this.modelValue)?this.modelValue:[]:this.selected_spaces=this.modelValue||"",this.fetch(),this.app_ready=!0}},jg={key:0,class:"fcom_space_title"},Og={key:0},Ng={key:1};function zg(e,t,o,u,s,n){const m=g("SpaceIcon"),p=ie,h=bt,y=ne,k=K("loading");return s.app_ready?(i(),v(y,{key:0,onChange:n.emitChanges,modelValue:s.selected_spaces,"onUpdate:modelValue":t[0]||(t[0]=b=>s.selected_spaces=b),filterable:"",multiple:o.is_multiple,placeholder:o.placeholder_text,style:{width:"100%"}},{default:r(()=>[(i(!0),c(V,null,D(s.formattedSpaceGroups,b=>N((i(),v(h,{key:b.label,label:b.label},{default:r(()=>[(i(!0),c(V,null,D(b.spaces,$=>(i(),v(p,{key:$.slug,label:$.title,disabled:n.isMemberOfSpace($.id),value:$.id.toString()},{default:r(()=>[$.id?(i(),c("span",jg,[a(m,{space_profile:$},null,8,["space_profile"]),l("span",null,[S(d(e.getExcerpt($.title,50))+" ",1),$.type=="course"?(i(),c("span",Og," ("+d(e.$t("course"))+")",1)):_("",!0)])])):(i(),c("span",Ng,d(e.getExcerpt($.title,50)),1))]),_:2},1032,["label","disabled","value"]))),128))]),_:2},1032,["label"])),[[k,s.loading]])),128))]),_:1},8,["onChange","modelValue","multiple","placeholder"])):_("",!0)}const Kt=F(xg,[["render",zg]]),qg={name:"SidebarLinkForm",components:{SpaceGroupSelector:Qt,LogoEmojiSelector:Ft,SpaceCourseSelector:Kt},emits:["completed"],data(){return{saving:!1,form:{title:"",privacy:"public",parent_id:"",settings:{permalink:"",new_tab:"yes",emoji:"üîó",shape_svg:"",memberships:[]}},dataLoaded:!1}},props:{link:{type:Object,default:()=>({})},parent_id:{type:[Number,String],default:null}},methods:{saveSettings(){this.saving=!0,this.$post("admin/links",{link:this.form}).then(e=>{this.$eventBus.emit("reloadMenu"),this.$emit("completed",e.link),this.$notify.success(e.message)}).catch(e=>{this.$handleError(e)}).finally(()=>{this.saving=!1})}},mounted(){this.link&&this.link.id?this.form=this.link:this.parent_id?this.form.parent_id=this.parent_id:this.$route.query.parent_id&&(this.form.parent_id=this.$route.query.parent_id),this.dataLoaded=!0}},Gg={class:"fcom_form_section"},Yg={class:"fcom_help_text"},Zg={class:"fcom_help_text"},Wg={class:"fcom_help_text"},Jg={key:0},Qg={key:1};function Kg(e,t,o,u,s,n){const m=g("logo-emoji-selector"),p=ee,h=ue,y=he,k=g("space-group-selector"),b=Ue,$=ge,f=g("SpaceCourseSelector"),w=j,C=_e,M=K("loading");return i(),v(C,{onSubmit:t[8]||(t[8]=Z(P=>e.doNothing(),["prevent"])),modelValue:s.form,"onUpdate:modelValue":t[9]||(t[9]=P=>s.form=P),"label-position":"top",class:"fcom_space_form"},{default:r(()=>[l("div",Gg,[a(h,{label:e.$t("Link Title")},{default:r(()=>[a(p,{type:"text",placeholder:e.$t("Your Link Title"),modelValue:s.form.title,"onUpdate:modelValue":t[1]||(t[1]=P=>s.form.title=P)},{prepend:r(()=>{var P,T;return[s.dataLoaded?(i(),v(m,{key:0,custom_svg:!0,onUpdate:t[0]||(t[0]=I=>{s.form.settings.emoji=I.emoji,s.form.logo=I.logo,s.form.settings.shape_svg=I.shape_svg}),config:{logo:s.form.logo,emoji:((P=s.form.settings)==null?void 0:P.emoji)||"",shape_svg:((T=s.form.settings)==null?void 0:T.shape_svg)||""}},null,8,["config"])):_("",!0)]}),_:1},8,["placeholder","modelValue"])]),_:1},8,["label"]),a(h,{label:e.$t("Permalink")},{default:r(()=>[a(p,{placeholder:e.$t("URL of the link"),modelValue:s.form.settings.permalink,"onUpdate:modelValue":t[2]||(t[2]=P=>s.form.settings.permalink=P)},null,8,["placeholder","modelValue"]),l("div",Yg,[a(y,{modelValue:s.form.settings.new_tab,"onUpdate:modelValue":t[3]||(t[3]=P=>s.form.settings.new_tab=P),"true-value":"yes","false-value":"no"},{default:r(()=>[S(d(e.$t("Open this link in new tab")),1)]),_:1},8,["modelValue"])])]),_:1},8,["label"]),a(h,{label:e.$t("Menu Group")},{default:r(()=>[s.dataLoaded?(i(),v(k,{key:0,modelValue:s.form.parent_id,"onUpdate:modelValue":t[4]||(t[4]=P=>s.form.parent_id=P),space_id:s.form.id},null,8,["modelValue","space_id"])):_("",!0),l("div",Zg,[l("p",null,d(e.$t("Select a menu group to where this link will be added to the sidebar.")),1)])]),_:1},8,["label"]),a(h,{label:e.$t("Visibility")},{default:r(()=>[a($,{modelValue:s.form.privacy,"onUpdate:modelValue":t[5]||(t[5]=P=>s.form.privacy=P)},{default:r(()=>[a(b,{label:e.$t("Everyone"),value:"public"},null,8,["label"]),a(b,{label:e.$t("Logged-in users only"),value:"logged_in"},null,8,["label"]),a(b,{label:e.$t("By Space/Course Memberships"),value:"members_only"},null,8,["label"])]),_:1},8,["modelValue"]),l("div",Wg,d(e.$t("Select who can see this link.")),1)]),_:1},8,["label"]),s.form.privacy=="members_only"?(i(),v(h,{key:0,label:e.$t("Select Space/Course Memberships")},{default:r(()=>[a(f,{modelValue:s.form.settings.membership_ids,"onUpdate:modelValue":t[6]||(t[6]=P=>s.form.settings.membership_ids=P),placeholder_text:e.$t("Select Memberships"),is_multiple:!0},null,8,["modelValue","placeholder_text"])]),_:1},8,["label"])):_("",!0),a(h,{style:{"margin-top":"45px"}},{default:r(()=>[N((i(),v(w,{class:"fcom_primary_button",disabled:s.saving,onClick:t[7]||(t[7]=P=>n.saveSettings())},{default:r(()=>[s.form.id?(i(),c("span",Jg,d(e.$t("Update")),1)):(i(),c("span",Qg,d(e.$t("Create Link")),1))]),_:1},8,["disabled"])),[[M,s.saving]])]),_:1})])]),_:1},8,["modelValue"])}const Xg=F(qg,[["render",Kg]]),ey={name:"SpaceCreateModal",components:{CreateCourseForm:Vg,ArrowLeftBold:bo,CreateSpaceForm:It,SpaceIcon:Ig,CourseIcon:Hg,SidebarLinkForm:Xg},data(){return{step:"choose_type",spaceConfig:null,parent_id:null,createSpaceModal:!1,select_type:"space_form",disable_redirect:!1}},computed:{currentTitle(){return this.step==="choose_type"?this.$t("Choose a Space Type"):this.step==="space_form"?this.$t("Create a Discussion Space"):this.step==="course_form"?this.$t("Create a Course"):this.step==="link_form"?this.$t("Create a Link"):""}},methods:{handleNextStep(){this.step=this.select_type},handleClose(){this.createSpaceModal=!1,this.step="choose_type",this.select_type="space_form";const{create_space:e,parent_id:t,...o}=this.$route.query;this.$router.replace({query:o})},handleCompleted(e){this.createSpaceModal=!1,this.step="choose_type",this.select_type="space_form",this.$eventBus.emit("spaceCreated",e)}},created(){this.$eventBus.on("createSpaceModal",e=>{this.createSpaceModal=!0,e&&(e.parent_id&&(this.parent_id=e.parent_id),e.disable_redirect?this.disable_redirect=!0:this.disable_redirect=!1,e.spaceConfig?(this.step="space_form",this.select_type="space_form"):e.course_config&&(this.select_type="course_form",this.step="course_form"))})}},ty={class:"dialog_header"},sy={class:"dialog_left"},oy={class:"dialog_body"},iy={key:0,class:"fcom_choose_space_type"},ny={class:"fcom_choices"},ly={class:"fcom_choice_btn"},ay={class:"fcom_choice_btn"},ry={key:0},cy={class:"fcom_choice_btn"},dy={key:0},uy={class:"dialog_footer"};function _y(e,t,o,u,s,n){const m=g("ArrowLeftBold"),p=O,h=j,y=g("SpaceIcon"),k=g("CourseIcon"),b=g("Link"),$=g("create-space-form"),f=g("create-course-form"),w=g("sidebar-link-form"),C=ye;return s.createSpaceModal?(i(),v(C,{key:0,top:"100px","modal-class":"fcom_common_dialog","append-to-body":!0,"close-on-click-modal":!1,width:e.drawerWidth,modelValue:s.createSpaceModal,"onUpdate:modelValue":t[5]||(t[5]=M=>s.createSpaceModal=M),direction:"rtl",onClose:n.handleClose},pe({header:r(()=>[l("div",ty,[l("div",sy,[s.step!="choose_type"?(i(),v(h,{key:0,onClick:t[0]||(t[0]=M=>s.step="choose_type"),text:""},{default:r(()=>[a(p,null,{default:r(()=>[a(m)]),_:1})]),_:1})):_("",!0),l("h4",null,d(n.currentTitle),1)])])]),default:r(()=>[l("div",oy,[s.step=="choose_type"?(i(),c("div",iy,[l("div",ny,[l("div",{onClick:t[1]||(t[1]=M=>s.select_type="space_form"),class:R([{fcom_choice_active:s.select_type=="space_form"},"fcom_choice"])},[l("div",ly,[a(p,null,{default:r(()=>[a(y)]),_:1}),l("h4",null,d(e.$t("Discussion Space")),1)])],2),l("div",{onClick:t[2]||(t[2]=M=>s.select_type="course_form"),class:R([{fcom_choice_active:s.select_type=="course_form"},"fcom_choice"])},[l("div",ay,[a(p,null,{default:r(()=>[a(k)]),_:1}),l("h4",null,d(e.$t("Course")),1)]),e.hasFeature("has_course")?_("",!0):(i(),c("p",ry,d(e.$t("Course Module is disabled")),1))],2),l("div",{onClick:t[3]||(t[3]=M=>s.select_type="link_form"),class:R([{fcom_choice_active:s.select_type=="link_form"},"fcom_choice"])},[l("div",cy,[a(p,null,{default:r(()=>[a(b)]),_:1}),l("h4",null,d(e.$t("Link")),1)]),e.appVars.pro?_("",!0):(i(),c("p",dy,d(e.$t("Pro Required")),1))],2)])])):s.step=="space_form"?(i(),v($,{key:1,disable_redirect:s.disable_redirect,parent_id:s.parent_id,onCompleted:n.handleCompleted},null,8,["disable_redirect","parent_id","onCompleted"])):s.step=="course_form"?(i(),v(f,{key:2,disable_redirect:s.disable_redirect,parent_id:s.parent_id,onCompleted:n.handleCompleted},null,8,["disable_redirect","parent_id","onCompleted"])):s.step=="link_form"?(i(),v(w,{key:3,parent_id:s.parent_id,onCompleted:n.handleCompleted},null,8,["parent_id","onCompleted"])):_("",!0)])]),_:2},[s.step=="choose_type"?{name:"footer",fn:r(()=>[l("div",uy,[a(h,{disabled:!s.select_type,class:"fcom_primary_button",onClick:t[4]||(t[4]=M=>n.handleNextStep())},{default:r(()=>[S(d(e.$t("Next")),1)]),_:1},8,["disabled"])])]),key:"0"}:void 0]),1032,["width","modelValue","onClose"])):_("",!0)}const my=F(ey,[["render",_y]]),hy={name:"ExpandIcon"},fy={xmlns:"http://www.w3.org/2000/svg",id:"icon-20-expand",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},py=l("path",{d:"M14 2H18V6",fill:"currentColor",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),gy=l("path",{d:"M12 8L18 2",fill:"currentColor",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),yy=l("path",{d:"M6 18H2V14",fill:"currentColor",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),vy=l("path",{d:"M8 12L2 18",fill:"currentColor",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),by=[py,gy,yy,vy];function ky(e,t,o,u,s,n){return i(),c("svg",fy,by)}const wy=F(hy,[["render",ky]]),Cy={name:"ReportContentModal",data(){return{reportConfig:null,showModal:!1,saving:!1,contentType:"",reportReason:"",reportExplanation:""}},computed:{currentTitle(){return this.contentType=="comment"?this.$t("Report Comment"):this.$t("Report Post")}},methods:{closeModal(){this.showModal=!1},showReportContentModal(e){this.showModal=!0,this.reportReason="",this.reportExplanation="",this.contentType=e.type,this.reportConfig=e.reportConfig},validateAndSubmit(){if(!this.reportReason){this.$handleError(this.$t("Please select a reason for reporting this content"));return}this.submitReport()},getParentId(){return this.contentType=="comment"?this.reportConfig.id:null},getPostId(){return this.contentType=="post"?this.reportConfig.id:this.reportConfig.post_id},submitReport(){this.saving=!0,this.$post("moderation/report",{content_type:this.contentType,user_id:this.auth.user_id,post_id:this.getPostId(),parent_id:this.getParentId(),reason:this.reportReason,explanation:this.reportExplanation}).then(e=>{this.$notify.success(e.message),this.$eventBus.emit("updateModerationReport",{content:e.content}),this.closeModal()}).catch(e=>{this.$handleError(e)}).finally(()=>{this.saving=!1})}},created(){this.$eventBus.on("showReportContentModal",this.showReportContentModal)}},$y={class:"dialog_header"},Sy={class:"dialog_left"},Vy={class:"dialog_body"},Ly={class:"fcom_report_content_form"},My={class:"dialog_footer"};function Py(e,t,o,u,s,n){const m=ie,p=ne,h=ue,y=ee,k=_e,b=j,$=ye;return s.showModal?(i(),v($,{key:0,"modal-class":"fcom_common_dialog","append-to-body":!0,"close-on-click-modal":!1,width:e.drawerWidth,modelValue:s.showModal,"onUpdate:modelValue":t[4]||(t[4]=f=>s.showModal=f),direction:"rtl",onClose:n.closeModal},{header:r(()=>[l("div",$y,[l("div",Sy,[l("h4",null,d(n.currentTitle),1)])])]),footer:r(()=>[l("div",My,[a(b,{class:"fcom_secondary_button",onClick:t[2]||(t[2]=f=>n.closeModal())},{default:r(()=>[S(d(e.$t("Cancel")),1)]),_:1}),a(b,{class:"fcom_primary_button",onClick:t[3]||(t[3]=f=>n.validateAndSubmit()),loading:s.saving},{default:r(()=>[S(d(e.$t("Report")),1)]),_:1},8,["loading"])])]),default:r(()=>[l("div",Vy,[l("div",Ly,[a(k,{ref:"reportForm","label-position":"top"},{default:r(()=>[a(h,{label:e.$t("Reason")},{default:r(()=>[a(p,{modelValue:s.reportReason,"onUpdate:modelValue":t[0]||(t[0]=f=>s.reportReason=f),placeholder:e.$t("Please select a reason for reporting this content")},{default:r(()=>[(i(!0),c(V,null,D(e.appVars.report_reasons,(f,w)=>(i(),v(m,{key:w,label:f,value:w},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(h,{label:e.$t("Explanation")},{default:r(()=>[a(y,{modelValue:s.reportExplanation,"onUpdate:modelValue":t[1]||(t[1]=f=>s.reportExplanation=f),placeholder:e.$t("Provide an explanation (Optional)"),type:"textarea",rows:4,maxlength:1e3,"show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},512)])])]),_:1},8,["width","modelValue","onClose"])):_("",!0)}const Fy=F(Cy,[["render",Py]]),Ty={name:"Pagination",emits:["fetch","per_page_change"],props:{pagination:{required:!0,type:Object},extra_sizes:{required:!1,type:Array,default(){return[]}},hide_on_single:{required:!1,type:Boolean,default(){return!0}}},computed:{page_sizes(){const e=[];this.pagination.per_page<10&&e.push(this.pagination.per_page);const t=[10,20,50,80,100,120,150];return[...e,...t,...this.extra_sizes]},pager_layout(){return this.isMobile?"total, sizes, jumper, prev, next":"total, sizes, jumper , prev, pager, next"}},methods:{changePage(e){this.pagination.page=e,this.$emit("fetch")},changeSize(e){this.pagination.per_page=e,this.$emit("per_page_change",e),this.$emit("fetch")}}},Iy={class:"fcom_pagination_wrap"};function Uy(e,t,o,u,s,n){const m=fi;return i(),c("div",Iy,[a(m,{background:!1,size:"small","pager-count":5,layout:n.pager_layout,onCurrentChange:n.changePage,onSizeChange:n.changeSize,"hide-on-single-page":o.hide_on_single,"current-page":o.pagination.page,"page-sizes":n.page_sizes,"page-size":o.pagination.per_page,total:o.pagination.total},null,8,["layout","onCurrentChange","onSizeChange","hide-on-single-page","current-page","page-sizes","page-size","total"])])}const ke=F(Ty,[["render",Uy]]),By={name:"ReportReviewModal",components:{Pagination:ke},data(){return{isOpen:!1,loading:!1,content:{},postReports:[],type:null,ignoring:!1,unpublishing:!1,pagination:{page:1,per_page:10,total:0}}},computed:{getReason(){return e=>this.appVars.report_reasons[e]},getUnpublishBtnText(){return this.$t("Unpublish")+" "+this.$t(this.ucFirst(this.type))}},methods:{closeModal(){this.isOpen=!1,this.content={},this.type=null,this.postReports=[],this.pagination={page:1,per_page:10,total:0}},showReportReviewModal(e){this.isOpen=!0,this.content=e.content,this.type=e.type,this.getPostReports()},getPostReports(){var t;this.loading=!0;let e={page:this.pagination.page,per_page:this.pagination.per_page,content_type:this.type,space_id:(t=this.content)==null?void 0:t.space_id};this.type=="comment"?e.parent_id=this.content.id:e.post_id=this.content.id,this.$get("moderation/reports",e).then(o=>{this.postReports=o.reports.data,this.report=o.reports.data[0],this.pagination.total=o.reports.total}).catch(o=>{this.$handleError(o)}).finally(()=>{this.loading=!1})},ignoreReport(){var e;this.ignoring=!0,this.$put("moderation/reports/"+this.report.id,{space_id:(e=this.content)==null?void 0:e.space_id,status:"ignored"}).then(t=>{this.$notify.success(t.message),this.isOpen=!1,this.$eventBus.emit("updateModerationReport",{content:t.content}),this.closeModal()}).catch(t=>{this.$handleError(t)}).finally(()=>{this.ignoring=!1})},unpublishReport(){var e;this.unpublishing=!0,this.$put("moderation/reports/"+this.report.id,{space_id:(e=this.content)==null?void 0:e.space_id,status:"unpublished"}).then(t=>{this.$notify.success(t.message),this.isOpen=!1,this.$eventBus.emit("updateModerationReport",{content:t.content}),this.closeModal()}).catch(t=>{this.$handleError(t)}).finally(()=>{this.unpublishing=!1})}},created(){this.$eventBus.on("showReportReviewModal",this.showReportReviewModal)}},Ey={class:"dialog_body"},Ay={class:"report_details"},Dy={class:"report_details_header"},Ry={class:"report_details_header_left"},Hy={class:"report_details_header_right"},xy={key:1},jy={class:"report_reason"},Oy=["title"],Ny={key:0,class:"report_details_body"},zy=["innerHTML"],qy={key:2,role:"region","aria-label":"Pagination",class:"pagination_wrap"},Gy={class:"dialog_footer report_footer"};function Yy(e,t,o,u,s,n){const m=g("UserAvatar"),p=g("UserRouteLink"),h=q,y=g("Pagination"),k=j,b=ye;return i(),v(b,{modelValue:s.isOpen,"onUpdate:modelValue":t[3]||(t[3]=$=>s.isOpen=$),"modal-class":"fcom_common_dialog",id:"fluent_comminity_body",width:e.dialogWidth,"append-to-body":!0,"close-on-click-modal":!1,direction:"rtl",onClose:n.closeModal},{footer:r(()=>[l("div",Gy,[a(k,{class:"fcom_secondary_button",onClick:t[1]||(t[1]=$=>n.ignoreReport()),loading:s.ignoring},{default:r(()=>[S(d(e.$t("Ignore Reports")),1)]),_:1},8,["loading"]),a(k,{class:"fcom_primary_button",onClick:t[2]||(t[2]=$=>n.unpublishReport()),loading:s.unpublishing},{default:r(()=>[S(d(n.getUnpublishBtnText),1)]),_:1},8,["loading"])])]),default:r(()=>{var $,f;return[l("div",Ey,[l("h4",null,d(e.$t("Reports")+" ("+((f=($=s.content)==null?void 0:$.meta)==null?void 0:f.reports_count)+")"),1),l("div",Ay,[s.loading?(i(),v(h,{key:1,rows:5,animated:!0})):(i(!0),c(V,{key:0},D(s.postReports,w=>(i(),c("div",{key:w.id,class:"report_details_item"},[l("div",Dy,[l("div",Ry,[w.reporter?(i(),v(m,{key:0,with_level:!1,xprofile:w.reporter},null,8,["xprofile"])):_("",!0)]),l("div",Hy,[l("div",null,[w.reporter?(i(),v(p,{key:0,show_verified:!1,xprofile:w.reporter},null,8,["xprofile"])):(i(),c("span",xy,d(e.$t("By System")),1)),S(),l("span",null,d(e.$t("reported for ")),1),l("span",jy,d(n.getReason(w.reason)||"--"),1)]),l("div",{title:w.created_at,class:"meta_line"},d(e.humanDateDiff(w.created_at)),9,Oy)])]),w.explanation?(i(),c("div",Ny,[l("div",{innerHTML:w.explanation},null,8,zy)])):_("",!0)]))),128)),s.pagination.total?(i(),c("div",qy,[a(y,{hide_on_single:!0,onFetch:t[0]||(t[0]=w=>n.getPostReports()),pagination:s.pagination},null,8,["pagination"])])):_("",!0)])])]}),_:1},8,["modelValue","width","onClose"])}const Zy=F(By,[["render",Yy]]),Wy={name:"PreviewPostModal",components:{Feed:Ze},data(){return{loading:!1,isOpen:!1,previewData:null,allSpaces:this.appVars.auth.spaces}},methods:{closeModal(){this.isOpen=!1,this.previewData=null},showPreviewPostModal(e){if(e!=null&&e.message){if(!(e!=null&&e.space)&&!(e!=null&&e.is_editing)){this.$handleError({message:this.$t("Please select a space to preview.")});return}}else{this.$handleError({message:this.$t("Please write a message to preview.")});return}this.isOpen=!0,this.preparePreviewData(e),this.generatePreview()},preparePreviewData(e){this.previewData={...e,xprofile:this.appVars.auth,space:this.allSpaces[e==null?void 0:e.space],created_at:dayjs.utc().subtract(this.appVars.date_offset,"s").format("YYYY-MM-DD HH:mm:ss"),content_type:this.determineContentType(e),meta:this.prepareMetadata(e),terms:this.processTopicIds(e)}},determineContentType(e){return e!=null&&e.survey?"survey":e!=null&&e.document_ids?"document":"post"},prepareMetadata(e){return{...e==null?void 0:e.meta,survey_config:e==null?void 0:e.survey,document_lists:e==null?void 0:e.document_ids}},processTopicIds(e){let t=e==null?void 0:e.topic_ids;return t?(t=Array.isArray(t)?t:[t],t.map(o=>this.currentTopics(e==null?void 0:e.space).find(u=>u.id==o))):[]},currentTopics(e){var o;if(!e)return[];let t=((o=this.allSpaces[e])==null?void 0:o.topics)||[];return t=Object.values(t),this.isModerator(e)?t:t.filter(u=>u.admin_only!="yes")},generatePreview(){this.loading=!0,this.$post("feeds/markdown-preview",{text:this.previewData.message,feed:this.previewData,with:["meta"]}).then(e=>{this.previewData.message_rendered=e.html,this.previewData.meta={...this.previewData.meta,...e.meta}}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})}},created(){this.$eventBus.on("showPreviewPostModal",this.showPreviewPostModal)}};function Jy(e,t,o,u,s,n){const m=q,p=j,h=g("Feed"),y=fe,k=ye;return s.previewData?(i(),v(k,{key:0,modelValue:s.isOpen,"onUpdate:modelValue":t[0]||(t[0]=b=>s.isOpen=b),class:"fcom_feed_modal",width:e.dialogWidth,"align-center":!0,"append-to-body":!0,"close-on-click-modal":!1,onClose:n.closeModal},{default:r(()=>[a(y,{ref:"feed_dialog_scroller","max-height":"calc(100dvh - 40px)"},{default:r(()=>[s.loading?(i(),v(m,{key:0,rows:4,animated:!0})):(i(),v(h,{key:1,feed:s.previewData,is_single:!0,is_preview:!0,show_actions:!1,show_footer:!1},{after_feed_actions:r(()=>[a(p,{style:{padding:"0 5px"},class:"no_pad_bt fcom_close_pop",onClick:n.closeModal,text:""},null,8,["onClick"])]),_:1},8,["feed"]))]),_:1},512)]),_:1},8,["modelValue","width","onClose"])):_("",!0)}const Qy=F(Wy,[["render",Jy]]),Ky={name:"UnfinishedChangesModal",emits:["proceed"],data(){return{isVisible:!1,message:""}},methods:{handleCancel(){this.isVisible=!1,window.fcom_pending_modal_close=!1},handleProceed(){this.isVisible=!1,window.fcom_pending_modal_close?(this.$emit("proceed"),window.fcom_pending_modal_close=!1,window.fcom_modal_comment_unsaved=!1):this.$eventBus.emit("unsavedChangesProceeded")},showModal(e){e==="feed"?this.message=this.$t("You haven't finished your post yet. Do you want to leave without finishing?"):e==="comment"&&(this.message=this.$t("You haven't finished your comment yet. Do you want to leave without finishing?")),this.isVisible=!0}},mounted(){this.$eventBus.on("showUnsavedChangesModal",this.showModal)},beforeUnmount(){this.$eventBus.off("showUnsavedChangesModal",this.showModal)}},Xy={class:"dialog_header"},e2={class:"dialog_left"},t2={class:"dialog_body"},s2={class:"dialog_footer"};function o2(e,t,o,u,s,n){const m=j,p=ye;return i(),v(p,{"modal-class":"fcom_common_dialog fcom_editor_unfinished_dialog",modelValue:s.isVisible,"onUpdate:modelValue":t[0]||(t[0]=h=>s.isVisible=h),width:e.modalWidth,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":!0,"show-close":!1},{header:r(()=>[l("div",Xy,[l("div",e2,[l("h4",null,d(e.$t("Leave Page?")),1)])])]),footer:r(()=>[l("div",s2,[a(m,{class:"fcom_secondary_button",onClick:n.handleCancel},{default:r(()=>[S(d(e.$t("Cancel")),1)]),_:1},8,["onClick"]),a(m,{class:"fcom_primary_button",onClick:n.handleProceed},{default:r(()=>[S(d(e.$t("Leave")),1)]),_:1},8,["onClick"])])]),default:r(()=>[l("div",t2,[l("span",null,d(s.message),1)])]),_:1},8,["modelValue","width"])}const i2=F(Ky,[["render",o2]]),n2={name:"MentionPopover",components:{UserRouteLink:Le},setup(){return{userStore:Te()}},data(){return{xprofile:null,virtualRef:null,hideTimeout:null,cache:{},cacheTTL:5*60*1e3,requestId:0}},methods:{getCached(e){const t=this.cache[e];return t?Date.now()-t.timestamp>this.cacheTTL?(delete this.cache[e],null):t.data:null},setCache(e,t){this.cache[e]={data:t,timestamp:Date.now()}},async showPopover({username:e,triggerElement:t}){this.cancelHide();const o=++this.requestId;let u=this.getCached(e);if(!u){try{u=await this.userStore.fetchProfile(e)}catch{return}this.setCache(e,u)}o===this.requestId&&(this.xprofile=u,this.virtualRef=t)},cancelHide(){clearTimeout(this.hideTimeout)},startHideTimeout(){this.cancelHide(),this.hideTimeout=setTimeout(()=>{this.virtualRef=null},200)}},mounted(){this.$eventBus.on("show_mention_popover",this.showPopover),this.$eventBus.on("hide_mention_popover",this.startHideTimeout)},beforeUnmount(){this.$eventBus.off("show_mention_popover",this.showPopover),this.$eventBus.off("hide_mention_popover",this.startHideTimeout),clearTimeout(this.hideTimeout)}};function l2(e,t,o,u,s,n){const m=g("UserRouteLink");return s.virtualRef&&s.xprofile?(i(),v(m,{key:0,xprofile:s.xprofile,virtualRef:s.virtualRef,show_badge:!0,show_follow:!0,onPopoverMouseenter:n.cancelHide,onPopoverMouseleave:n.startHideTimeout},null,8,["xprofile","virtualRef","onPopoverMouseenter","onPopoverMouseleave"])):_("",!0)}const a2=F(n2,[["render",l2]]);let r2=window.fluentComAdmin.el_i18n;for(const[e,t]of Object.entries(r2))gs.el[e]=t;const c2={name:"PortalApplication",components:{NotificationsPop:Tn,SearchBar:Vp,Feed:Ze,SpaceCreateModal:my,ReportContentModal:Fy,ElConfigProvider:ys,ExpandIcon:wy,ReportReviewModal:Zy,PreviewPostModal:Qy,UnfinishedChangesModal:i2,MentionPopover:a2},setup(){const e=Cs(),t=Se();return{tickerStore:e,feedStore:t}},data(){return{loading:!1,mobileMenuItems:this.appVars.mobileMenuItems,hasSearchHolder:!1,hasNotificationHolder:!1,isSmallScreen:!1,popFeed:null,shopPopFeed:!1,prevUrl:null,enLang:gs,loadedStyles:{},tickerDismissed:!1}},computed:{newFeedsCount(){return this.feedStore.getNewPostsCount("global")||0}},watch:{$route(e,t){var n,m;if(this.popFeed&&(this.prevUrl=e.href,this.closeFeedModal()),(n=e.meta)!=null&&n.lazy_styles&&this.loadLazyStyles(e.meta.lazy_styles),(m=e.meta)!=null&&m.in_space&&e.params.space){let p=e.params.space;const h=document.querySelectorAll(`.fcom_space_${p} .fcom_unread_count`);for(let y=0,k=h.length;y<k;y++)h[y].remove()}if(e.name==t.name&&e.path===t.path&&e.query.topic!=t.query.topic){this.$eventBus.emit("topic_changed",e.query.topic);return}e.query.create_space&&e.query.parent_id&&this.$eventBus.emit("open_create_space_modal",e.query.create_space),this.$eventBus.emit("route_updated",{to:e,from:t});const o=e.name;document.body.setAttribute("data-route",o),document.dispatchEvent(new CustomEvent("route_updated",{detail:{to:e,from:t}})),document.querySelectorAll(".feed_layout").forEach(p=>{p.classList.remove("space_opened")}),this.isSmallScreen&&document.querySelector(".feed_layout")&&document.querySelector(".feed_layout").classList.remove("space_opened");const u=e.meta.active_menu;document.querySelectorAll(".fcom_general_menu a").forEach(p=>{p.classList.remove("router-link-exact-active")}),u&&document.querySelectorAll(".fcom_general_menu a.fcom_"+u).forEach(p=>{p.classList.add("router-link-exact-active")}),document.querySelectorAll(".fcom_sidebar_contents a").forEach(p=>{p.classList.remove("router-link-exact-active")}),u&&document.querySelectorAll(".fcom_sidebar_contents a.fcom_"+u).forEach(p=>{p.classList.add("router-link-exact-active")});const s=(p,h)=>{var y;if(h)try{(y=document.querySelector(p+h))==null||y.classList.add("router-link-exact-active")}catch(k){console.error(k)}};e.meta.in_course&&s(".fcom_space_",e.params.course_slug),e.meta.in_space&&s(".space_contents a.fcom_space_",e.params.space)}},methods:{dismissTicker(){this.tickerDismissed=!0,this.feedStore.clearNewPostsCount("global"),console.log("[App] Ticker dismissed")},routeToAllFeeds(){this.changeTitle(this.$t("Feeds")),this.tickerDismissed=!0,this.feedStore.clearNewPostsCount("global"),this.$router.push({name:"dashboard",query:{stamp:new Date().getTime(),sort_by:"latest"}})},reloadSidebarMenu(){this.$get("options/sidebar-menu-html").then(e=>{e.sidebar_html&&document.getElementById("fcom_sidebar_wrap")&&(document.getElementById("fcom_sidebar_wrap").innerHTML=e.sidebar_html,document.dispatchEvent(new CustomEvent("sidebar_menu_reloaded"))),e.auth_spaces&&(this.auth=e.auth_spaces)})},showFeedModal(e){this.popFeed=e.feed,this.shopPopFeed=!0,this.prevUrl=window.location.href,window.history.pushState({},"",e.feed.permalink),document.body.classList.add("fcom_post_modal_opened"),e.view=="comments"&&this.$nextTick(()=>{setTimeout(()=>{var u;let t=(u=this.$refs.feed_dialog_scroller)==null?void 0:u.wrapRef;if(!t)return;let o=t.querySelector(".feed_footer");o&&t.scrollTo({top:o.offsetTop-100,behavior:"smooth"})},100)})},handleNewComment(e){this.$nextTick(()=>{var u;let t=(u=this.$refs.feed_dialog_scroller)==null?void 0:u.wrapRef;if(!t)return;let o=t.querySelector(".feed_single");o&&setTimeout(()=>{t.scrollTo({top:o.scrollHeight,behavior:"smooth"})},100)})},closeFeedModal(){if(window.fcom_modal_comment_unsaved){window.fcom_pending_modal_close=!0,this.$refs.unfinishedChangesModal.showModal("comment");return}this.proceedCloseFeedModal()},proceedCloseFeedModal(){this.shopPopFeed=!1,this.popFeed=null,this.prevUrl&&window.history.pushState({},"",this.prevUrl),document.body.classList.remove("fcom_post_modal_opened")},gotToFeed(){let e={name:"single_feed",params:{feed_slug:this.popFeed.slug}};this.popFeed.space&&(e={name:"space_feed",params:{feed_slug:this.popFeed.slug,space:this.popFeed.space.slug}}),this.popFeed.auto_focus_comment=!1,window.__showing_feed=this.popFeed,this.$router.push(e),this.$nextTick(()=>{this.closeFeedModal()})},loadLazyStyles(e){this.each(e,t=>{if(!this.appVars.lazy_styles[t]||this.loadedStyles[t])return;this.loadedStyles[t]=!0;let o=document.createElement("link");o.rel="stylesheet",o.href=this.appVars.lazy_styles[t],o.type="text/css",o.id=t,o.media="all",document.head.appendChild(o)})}},created(){this.hasNotificationHolder=this.auth.user_id&&document.getElementsByClassName("fcom_notification_holder").length,this.hasSearchHolder=!!document.getElementsByClassName("fcom_search_holder").length,this.$eventBus.on("fresh_feeds_loaded",e=>{let t=e.space;t||(t="__all"),this.feedMonitorCache[t]=e.feeds[0].id}),document.addEventListener("doCustomGlobalSearch",e=>{this.$eventBus.emit("doGlobalSearch",e.detail.search)}),this.$eventBus.on("reloadMenu",()=>{this.reloadSidebarMenu()}),this.$eventBus.on("toTop",e=>{window.fcomLayoutRef&&(e||(e=0),window.fcomLayoutRef.scrollTo({top:e,behavior:"instant"}))}),this.isSmallScreen=window.innerWidth<=1024},mounted(){this.$eventBus.on("showFeedModal",this.showFeedModal),this.auth.user_id&&(console.log("[App] Starting new Pinia ticker with random intervals (45-75s)..."),this.tickerStore.start()),this.$watch("$route",e=>{e.name==="dashboard"&&(this.tickerDismissed=!1)})},beforeUnmount(){this.tickerStore.isActive&&(console.log("[App] Stopping Pinia ticker..."),this.tickerStore.stop())}},d2={key:0,class:"fcom_new_ticker"},u2={key:1,class:"fcom_mobile_menu"},_2={class:"focm_menu_items"},m2=["innerHTML"],h2=["innerHTML"],f2=["href"],p2=["innerHTML"],g2=["innerHTML"];function y2(e,t,o,u,s,n){const m=g("router-view"),p=O,h=g("router-link"),y=pi,k=g("ExpandIcon"),b=j,$=g("feed"),f=fe,w=ye,C=g("search-bar"),M=g("notifications-pop"),P=g("space-create-modal"),T=g("unfinished-changes-modal"),I=g("preview-post-modal"),U=g("report-content-modal"),B=g("report-review-modal"),A=g("mention-popover"),L=ys;return i(),v(L,{locale:s.enLang},{default:r(()=>[a(m,{class:R(e.appVars.route_classes)},null,8,["class"]),(i(),v(Qe,{to:"body"},[u.tickerStore.isActive&&n.newFeedsCount>0&&!s.tickerDismissed?(i(),c("div",d2,[l("div",{onClick:t[0]||(t[0]=E=>n.routeToAllFeeds()),class:"fcom_ticker_menu"},d(e.$_n("A new post is available","%s new posts available",n.newFeedsCount)),1),l("div",{onClick:t[1]||(t[1]=E=>n.dismissTicker()),class:"fcom_ticker_dismiss"}," x ")])):_("",!0),s.mobileMenuItems&&s.mobileMenuItems.length?(i(),c("div",u2,[l("div",_2,[(i(!0),c(V,null,D(s.mobileMenuItems,E=>(i(),c("div",null,[E.route?(i(),v(h,{key:0,"aria-label":e.$t("Go to %s",E.title),class:"focm_menu_item",to:E.route},{default:r(()=>[a(p,null,{default:r(()=>[E.icon?(i(),v(xt(E.icon),{key:0})):E.icon_svg?(i(),c("span",{key:1,innerHTML:E.icon_svg},null,8,m2)):_("",!0)]),_:2},1024),E.html?(i(),c("span",{key:0,innerHTML:E.html},null,8,h2)):_("",!0)]),_:2},1032,["aria-label","to"])):(i(),c("a",{key:1,href:E.permalink,class:"focm_menu_item"},[E.icon_svg?(i(),v(p,{key:0},{default:r(()=>[l("span",{innerHTML:E.icon_svg},null,8,p2)]),_:2},1024)):_("",!0),l("span",{innerHTML:E.html},null,8,g2)],8,f2))]))),256))])])):_("",!0),a(w,{ref:"fcom_feed_modal","destroy-on-close":"",modelValue:s.shopPopFeed,"onUpdate:modelValue":t[2]||(t[2]=E=>s.shopPopFeed=E),"close-on-click-modal":!0,"close-on-press-escape":!0,"before-close":()=>{n.closeFeedModal()},class:"fcom_feed_modal",width:"100%"},{default:r(()=>[a(f,{ref:"feed_dialog_scroller","max-height":"calc(100dvh - 40px)"},{default:r(()=>[s.popFeed?(i(),v($,{key:0,onCommented:n.handleNewComment,is_single:!0,feed:s.popFeed,is_modal:!0},{after_feed_actions:r(()=>[a(y,{direction:"vertical"}),a(b,{onClick:n.gotToFeed,class:"no_pad_btn",text:""},{default:r(()=>[a(p,null,{default:r(()=>[a(k)]),_:1})]),_:1},8,["onClick"]),a(b,{style:{padding:"0 5px"},class:"no_pad_bt fcom_close_pop",onClick:n.closeFeedModal,text:""},null,8,["onClick"])]),_:1},8,["onCommented","feed"])):_("",!0)]),_:1},512)]),_:1},8,["modelValue","before-close"])])),s.hasSearchHolder?(i(),v(Qe,{key:0,to:".fcom_search_holder"},[a(C)])):_("",!0),s.hasNotificationHolder?(i(),v(Qe,{key:1,to:".fcom_notification_holder"},[a(M)])):_("",!0),e.isAdmin?(i(),v(P,{key:2})):_("",!0),a(T,{ref:"unfinishedChangesModal",onProceed:n.proceedCloseFeedModal},null,8,["onProceed"]),a(I),a(U),a(B),a(A)]),_:1},8,["locale"])}const v2=F(c2,[["render",y2]]),b2={name:"ContentLayout",props:["title","content_class","wrapper_class"],data(){return{throttledScrollHandler:null,lastScrolledTop:0}},created(){this.throttledScrollHandler=Li(e=>{e>this.lastScrolledTop?document.body.classList.add("fcom_scrolling-down"):document.body.classList.remove("fcom_scrolling-down"),this.lastScrolledTop=e,document.dispatchEvent(new CustomEvent("fcom_layout_scroll",{detail:{scrollTop:e}}))},1e3)},methods:{handleLayoutScroll(e){this.throttledScrollHandler(e.scrollTop)}},mounted(){window.fcomLayoutRef=this.$refs.layoutScrollbarRef}},k2={key:0,class:"fhr_content_layout_header"},w2={role:"region","aria-label":"Actions",class:"fhr_page_actions"};function C2(e,t,o,u,s,n){const m=fe;return i(),c("div",{class:R([o.wrapper_class,"fhr_content_layout"])},[a(m,{"min-size":100,always:!0,noresize:!0,native:!0,onScroll:n.handleLayoutScroll,ref:"layoutScrollbarRef",height:"calc(100dvh - var(--fcom-header-height, 0px) - var(--fcom-mobile-menu-height, 0px))"},{default:r(()=>[z(e.$slots,"header",{},()=>[o.title?(i(),c("div",k2,[z(e.$slots,"title",{},()=>[l("h1",{role:"region","aria-label":"Page Title",style:{cursor:"pointer"},onClick:t[0]||(t[0]=p=>e.$eventBus.emit("toTop")),class:"fhr_page_title"},d(o.title),1)]),l("div",w2,[z(e.$slots,"actions")])])):_("",!0)]),z(e.$slots,"sub_header"),l("div",{class:R([o.content_class,"fhr_content_layout_body"])},[z(e.$slots,"default")],2)]),_:3},8,["onScroll"])],2)}const ve=F(b2,[["render",C2]]),$2={name:"Dashboard",components:{Layout:ve},data(){return{greetings:"",notices:[]}},mounted(){this.$route.query.sort_by=="latest"&&this.$storeLocalData("feed_sort_by",""),this.$router.push({name:"all_feeds"})}},S2={key:0,class:"dashboard_actions"},V2=["innerHTML"],L2={key:1};function M2(e,t,o,u,s,n){const m=g("layout");return i(),v(m,{title:s.greetings},{default:r(()=>[s.notices.length?(i(),c("div",S2,[l("h4",null,d(e.$t("Action required")),1),l("ul",null,[(i(!0),c(V,null,D(s.notices,p=>(i(),c("li",{innerHTML:p},null,8,V2))),256))])])):(i(),c("div",L2,[l("p",null,d(e.$t("All is well! This dashboard will be updated with something awesome!")),1)]))]),_:1},8,["title"])}const P2=F($2,[["render",M2]]),F2={name:"AppLayout",props:["wrapper_class"]},T2={class:"feeds_main"};function I2(e,t,o,u,s,n){const m=g("router-view");return i(),c("div",{class:R([o.wrapper_class,"feeds"])},[l("div",T2,[z(e.$slots,"before_route_view"),z(e.$slots,"default",{},()=>[a(m)]),z(e.$slots,"after_route_view")])],2)}const we=F(F2,[["render",I2]]),U2={name:"NotificationOnboard",data(){return{pushEnabled:!1,permission:"",requestInProgress:!1,confirmed:!1}},computed:{hasPush(){return this.appVars.has_push_notification&&this.pushEnabled&&this.permission!=="granted"}},methods:{async processSubscribe(){if(this.permission==="denied"){let t=`<div style="text-align: center; margin-bottom: 15px;">
                    <img src="${window.fluentNotifyPublic.assets_url+"images/instruction-unblock.png"}" alt="Unblock Notifications Instructions" style="max-width: 100%; height: auto; border: 1px solid #ddd; border-radius: 4px;"/>
                </div>`;this.$messageBox.alert(this.$t('You have blocked or denied notifications for this site. Please reset permission and then click "Retry Button" to receive push notifications.')+t,this.$t("Notifications Blocked"),{dangerouslyUseHTMLString:!0,confirmButtonText:this.$t("Retry")}).then(()=>{window.fluentNotify&&(this.permission=window.fluentNotify.getPermission(),this.processSubscribe())});return}window.fluentNotify&&(this.requestInProgress=!0,await window.fluentNotify.subscribe()?(this.$notify.success(this.$t("You have successfully subscribed to push notifications.")),this.permission=window.fluentNotify.getPermission(),this.confirmed=!0):this.$notify.error(this.$t("Failed to subscribe to push notifications. Please try again.")),this.requestInProgress=!1,this.permission=window.fluentNotify.getPermission())},watchForPermissionChange(){var e,t;this.pushEnabled=(e=window.fluentNotify)==null?void 0:e.isAvailable,this.permission=(t=window.fluentNotify)==null?void 0:t.getPermission()}},mounted(){var e,t;window.fluentNotify?(this.pushEnabled=(e=window.fluentNotify)==null?void 0:e.isAvailable,this.permission=(t=window.fluentNotify)==null?void 0:t.getPermission()):document.addEventListener("fluent-notify-initialized",this.watchForPermissionChange)},beforeUnmount(){document.removeEventListener("fluent-notify-initialized",this.watchForPermissionChange)}},B2={key:0,class:"app_side_widget widget_push_notification"},E2={class:"widget_header"},A2={style:{display:"flex","column-gap":"8px","align-items":"center",color:"var(--el-color-danger, #f56c6c)"}},D2=l("svg",{width:"24px",height:"24px","stroke-width":"1.5",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",color:"currentColor"},[l("path",{d:"M18.1336 11C18.7155 16.3755 21 18 21 18H3C3 18 6 15.8667 6 8.4C6 6.70261 6.63214 5.07475 7.75736 3.87452C8.88258 2.67428 10.4087 2 12 2C12.3373 2 12.6717 2.0303 13 2.08949",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),l("path",{d:"M19 8C20.6569 8 22 6.65685 22 5C22 3.34315 20.6569 2 19 2C17.3431 2 16 3.34315 16 5C16 6.65685 17.3431 8 19 8Z",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),l("path",{d:"M13.73 21C13.5542 21.3031 13.3019 21.5547 12.9982 21.7295C12.6946 21.9044 12.3504 21.9965 12 21.9965C11.6496 21.9965 11.3054 21.9044 11.0018 21.7295C10.6982 21.5547 10.4458 21.3031 10.27 21",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1),R2={class:"widget_body notifications_wrap"},H2={style:{"margin-top":"10px"},class:"onboard_actions"},x2={key:0},j2={key:1},O2={key:0},N2={key:1,class:"app_side_widget widget_push_notification"};function z2(e,t,o,u,s,n){const m=O,p=j;return n.hasPush?(i(),c("div",B2,[l("div",E2,[l("h3",A2,[a(m,{style:{"font-size":"120%"}},{default:r(()=>[D2]),_:1}),l("span",null,d(e.$t("Never Miss a Reply")),1)])]),l("div",R2,[l("p",null,d(e.$t("Get notified about replies to your posts and important community updates via web push notifications.")),1),l("div",H2,[a(p,{loading:s.requestInProgress,type:"primary",onClick:t[0]||(t[0]=h=>n.processSubscribe())},{default:r(()=>[s.requestInProgress?(i(),c("span",j2,d(e.$t("Processing...")),1)):(i(),c("span",x2,d(e.$t("Turn On Push Notifications")),1))]),_:1},8,["loading"])]),s.requestInProgress?(i(),c("p",O2,d(e.$t("Please click Allow to enable notifications.")),1)):_("",!0)])])):s.confirmed?(i(),c("div",N2,[l("p",null,d(e.$t("You will get push notifications on replies and imprortant updates.")),1)])):_("",!0)}const Ns=F(U2,[["render",z2]]),q2={name:"RecentActivities",components:{NotificationOnboard:Ns},props:{context:{default(){return{}}},widget_title:{type:String,default(){return""}},pinned_widget_title:{type:String,default(){return""}},with_pins:{type:Boolean,default(){return!1}},is_trending:{type:Boolean,default(){return!1}},with_pending_count:{type:Boolean,default(){return!1}}},data(){return{activities:[],loading:!1,pinned_posts:[],pending_count:0,after_contents:"",before_contents:""}},methods:{getActivities(){this.loading=!0,this.$get("activities",{page:1,per_page:5,context:this.context,with_pins:this.with_pins?1:0,is_trending:this.is_trending?1:0,with_pending_count:this.with_pending_count?1:0}).then(e=>{this.activities=e.activities.data,this.after_contents=e.after_contents,this.before_contents=e.before_contents,e.pinned_posts&&(this.pinned_posts=e.pinned_posts),e.pending_count&&(this.pending_count=e.pending_count)}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})},goToActivity(e){this.$router.push(e.route)},getActivityLink(e){const t=this.$router.resolve(e.route);let o=this.appVars.urls.portal_base;return o=o.replace(/\/$/,""),o+t.fullPath}},mounted(){this.getActivities()}},G2=["innerHTML"],Y2={key:1,class:"app_side_widget fcom_widget_highlight"},Z2={class:"widget_header"},W2={role:"region","aria-label":"Pending Members"},J2={class:"widget_body"},Q2={key:2,role:"region","aria-label":"Featured Posts",class:"app_side_widget widget_recent_activities"},K2={class:"widget_header"},X2={class:"widget_body notifications_wrap"},ev={class:"notification_wrap"},tv=["href"],sv={class:"notification_item"},ov={class:"notification_avatar"},iv={class:"notification_content"},nv=["innerHTML"],lv={style:{"margin-top":"5px"},class:"feed_timestamp"},av={role:"region","aria-label":"Space Activities",class:"app_side_widget widget_recent_activities"},rv={class:"widget_header"},cv={class:"widget_body notifications_wrap"},dv={class:"notification_wrap"},uv=["href"],_v={class:"notification_avatar"},mv={class:"notification_content"},hv=["innerHTML"],fv=["title"],pv={key:2,class:"notification_wrap"},gv={class:"notification_item"},yv={class:"notification_content"},vv={class:"no_notifications"},bv=["innerHTML"];function kv(e,t,o,u,s,n){const m=g("NotificationOnboard"),p=j,h=g("UserAvatar"),y=q;return i(),c(V,null,[s.before_contents?(i(),c("div",{key:0,innerHTML:s.before_contents},null,8,G2)):_("",!0),a(m),s.pending_count&&o.with_pending_count?(i(),c("div",Y2,[l("div",Z2,[l("h3",W2,d(e.$t("Pending Members")),1)]),l("div",J2,[l("p",null,d(e.$t("%s people requested to join the community.",s.pending_count)),1)]),a(p,{role:"link","aria-label":"View pending members",onClick:t[0]||(t[0]=k=>e.$router.push({name:"space_members",query:{view_pending:"yes"}})),type:"danger"},{default:r(()=>[S(d(e.$t("View pending members")),1)]),_:1})])):_("",!0),o.with_pins&&s.pinned_posts.length?(i(),c("div",Q2,[l("div",K2,[l("h3",null,d(o.pinned_widget_title||e.$t("Featured Posts")),1)]),l("div",X2,[(i(!0),c(V,null,D(s.pinned_posts,k=>{var b;return i(),c("div",ev,[l("a",{class:"no_style_link",href:k.permalink},[l("div",sv,[l("div",ov,[a(h,{with_level:!1,xprofile:k.xprofile},null,8,["xprofile"])]),l("div",iv,[l("div",{innerHTML:k.message},null,8,nv),l("span",lv,d((b=k.xprofile)==null?void 0:b.display_name),1)])])],8,tv)])}),256))])])):_("",!0),l("div",av,[l("div",rv,[l("h3",null,d(o.widget_title||e.$t("Recent Activities")),1)]),l("div",cv,[s.loading?(i(),v(y,{key:0,style:{"min-width":"320px"},animated:!0,rows:5})):s.activities.length?(i(!0),c(V,{key:1},D(s.activities,k=>(i(),c("div",dv,[l("a",{href:n.getActivityLink(k),class:"notification_item"},[l("div",_v,[a(h,{with_level:!1,xprofile:k.xprofile},null,8,["xprofile"])]),l("div",mv,[l("div",{innerHTML:k.message},null,8,hv),l("span",{title:k.updated_at,class:"notification_time_stamp"},d(e.humanDateDiff(k.updated_at)),9,fv)])],8,uv)]))),256)):(i(),c("div",pv,[l("div",gv,[l("div",yv,[l("div",vv,d(e.$t("No recent activities found")),1)])])]))])]),s.after_contents?(i(),c("div",{key:3,innerHTML:s.after_contents},null,8,bv)):_("",!0)],64)}const Ut=F(q2,[["render",kv]]),wv={name:"BgImageUpload",emits:["update:modelValue"],props:{modelValue:{type:String,required:!1},button_text:{type:String,default(){return""}},can_remove:{type:Boolean,default:!1},is_multiple:{type:Boolean,default:!1},additional_data:{type:Object,default:()=>({})}},data(){return{imageUrl:this.modelValue}},computed:{action_url(){return this.appVars.rest.url+"/feeds/media-upload"},headers(){return{"X-WP-Nonce":this.appVars.rest.nonce}}},methods:{handleSuccess(e){this.imageUrl=e.media.url,this.$emit("update:modelValue",this.imageUrl)},handleError(e){this.$handleError(JSON.parse(e.message))},removeImage(){this.imageUrl="",this.$emit("update:modelValue","")}}};function Cv(e,t,o,u,s,n){const m=Pe,p=j,h=vt,y=g("CloseBold"),k=O;return i(),c(V,null,[a(h,{action:n.action_url,headers:n.headers,accept:"image/*",class:"fcom_bg_upload",multiple:o.is_multiple,data:o.additional_data,"show-file-list":!1,"on-success":n.handleSuccess,"on-error":n.handleError},{default:r(()=>[z(e.$slots,"trigger",{},()=>[z(e.$slots,"default",{},()=>[s.imageUrl?(i(),v(m,{key:0,alt:e.$t("Image Preview"),src:s.imageUrl},null,8,["alt","src"])):(i(),v(p,{key:1,class:"fcom_btn_upload",text:""},{default:r(()=>[S(d(o.button_text||e.$t("Upload Image")),1)]),_:1}))])])]),_:3},8,["action","headers","multiple","data","on-success","on-error"]),s.imageUrl&&o.can_remove?(i(),v(p,{key:0,class:"fcom_bg_remove",text:"",size:"small",onClick:n.removeImage},{default:r(()=>[a(k,null,{default:r(()=>[a(y)]),_:1})]),_:1},8,["onClick"])):_("",!0)],64)}const zs=F(wv,[["render",Cv]]),$v={name:"WelcomeBannerConfig",props:["savingCount"],emits:["saved"],components:{MediaEmbeder:Zt,BgImageUpload:zs,CrepeEditor:St},data(){return{saving:!1,loading:!1,currentTab:"login",appReady:!1,bannerData:{login:{enable:"no",mediaType:"image",title:"",description:"",allowClose:"yes",bannerImage:"",ctaButtons:[],bannerVideo:{}},logout:{enable:"no",mediaType:"image",title:"",description:"",bannerImage:"",ctaButtons:[],bannerVideo:{}}}}},watch:{savingCount(){this.saveSettings()}},computed:{isEnabled(){return this.bannerData[this.currentTab].enabled=="yes"}},methods:{switchOption(e){this.appReady=!1,this.currentTab=e,this.$nextTick(()=>{this.appReady=!0})},addButton(){this.bannerData[this.currentTab].ctaButtons.push({label:"",link:"",type:"primary",newTab:"yes"})},removeButton(e){this.bannerData[this.currentTab].ctaButtons.splice(e,1)},getSettings(){this.loading=!0,this.$get("admin/welcome-banner").then(e=>{this.bannerData=e.settings,this.appReady=!0}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})},saveSettings(){this.saving=!0,this.$post("admin/welcome-banner",{settings:this.bannerData}).then(e=>{this.$notify.success(e.message),this.$emit("saved"),this.Storage.remove("fcom_welcome_banner_closed_auth"),this.Storage.remove("fcom_welcome_banner_closed_guest")}).catch(e=>{this.$handleError(e)}).finally(()=>{this.saving=!1})}},mounted(){this.getSettings()}},Sv={class:"fcom_customizer_container"},Vv={class:"fcom_wc_banner_header"},Lv={class:"fcom_wc_banner_options"},Mv={class:"fcom_filter_menu"},Pv={class:"fcom_filter_menu_ul"},Fv={key:0,class:"fcom_wc_banner_content"},Tv={class:"fcom_wc_banner_content_header"},Iv={class:"fcom_wc_banner_media_type"},Uv={key:0,class:"fcom_banner_image_holder"},Bv={key:1,class:"fcom_banner_image_preview"},Ev={key:0,class:"fcom_wc_banner_cta_buttons"},Av={class:"fcom_wc_help_text"},Dv={class:"fcom_wc_banner_content_footer"};function Rv(e,t,o,u,s,n){const m=vs,p=Ue,h=ge,y=g("BgImageUpload"),k=Pe,b=g("CloseBold"),$=O,f=j,w=g("media-embeder"),C=ee,M=ue,P=g("crepe-editor"),T=ie,I=ne,U=gi,B=he,A=_e,L=q;return i(),c("div",Sv,[l("div",Vv,[l("h4",null,d(e.$t("Welcome Banner")),1)]),l("div",Lv,[l("div",Mv,[l("ul",Pv,[l("li",null,[l("a",{onClick:t[0]||(t[0]=Z(E=>n.switchOption("login"),["prevent"])),class:R({"router-link-exact-active":s.currentTab=="login"}),href:"#"},d(e.$t("Logged in")),3)]),l("li",null,[l("a",{onClick:t[1]||(t[1]=Z(E=>n.switchOption("logout"),["prevent"])),class:R({"router-link-exact-active":s.currentTab=="logout"}),href:"#"},d(e.$t("Logged out")),3)])])])]),s.loading?(i(),v(L,{key:1,rows:5})):(i(),c("div",Fv,[l("div",Tv,[l("h4",null,d(s.currentTab==="login"?e.$t("Enable for logged in members"):e.$t("Enable for logged out members")),1),a(m,{modelValue:s.bannerData[s.currentTab].enabled,"onUpdate:modelValue":t[2]||(t[2]=E=>s.bannerData[s.currentTab].enabled=E),"active-value":"yes","inactive-value":"no",class:"fcom_switch"},null,8,["modelValue"])]),l("div",{class:R(["fcom_wc_banner_content_body",{fcom_wc_disabled:!n.isEnabled}])},[l("div",Iv,[l("p",null,d(e.$t("Media type")),1),a(h,{modelValue:s.bannerData[s.currentTab].mediaType,"onUpdate:modelValue":t[3]||(t[3]=E=>s.bannerData[s.currentTab].mediaType=E),class:"fcom_radio_group"},{default:r(()=>[a(p,{label:e.$t("Image"),value:"image"},null,8,["label"]),a(p,{label:e.$t("Video"),value:"video"},null,8,["label"])]),_:1},8,["modelValue"])]),s.bannerData[s.currentTab].mediaType==="image"?(i(),c(V,{key:0},[s.bannerData[s.currentTab].bannerImage?(i(),c("div",Bv,[a(k,{alt:e.$t("Image Preview"),src:s.bannerData[s.currentTab].bannerImage},null,8,["alt","src"]),a(f,{class:"fcom_secondary_button",text:"",onClick:t[5]||(t[5]=E=>s.bannerData[s.currentTab].bannerImage="")},{default:r(()=>[a($,null,{default:r(()=>[a(b)]),_:1})]),_:1})])):(i(),c("div",Uv,[l("h4",null,d(e.$t("Featured Image")),1),l("p",null,d(e.$t("Set a featured image at the top of the welcome banner. Recommended image dimension: 1680x600")),1),a(y,{modelValue:s.bannerData[s.currentTab].bannerImage,"onUpdate:modelValue":t[4]||(t[4]=E=>s.bannerData[s.currentTab].bannerImage=E)},null,8,["modelValue"])]))],64)):_("",!0),s.bannerData[s.currentTab].mediaType==="video"?(i(),v(w,{key:1,media:s.bannerData[s.currentTab].bannerVideo},null,8,["media"])):_("",!0),a(A,{onSubmit:t[9]||(t[9]=Z(E=>e.doNothing(),["prevent"])),"label-position":"top",class:"fcom_form_container"},{default:r(()=>[a(M,{label:e.$t("Title")},{default:r(()=>[a(C,{modelValue:s.bannerData[s.currentTab].title,"onUpdate:modelValue":t[6]||(t[6]=E=>s.bannerData[s.currentTab].title=E)},null,8,["modelValue"])]),_:1},8,["label"]),a(M,{label:e.$t("Description")},{default:r(()=>[s.appReady?(i(),v(P,{key:0,modelValue:s.bannerData[s.currentTab].description,"onUpdate:modelValue":t[7]||(t[7]=E=>s.bannerData[s.currentTab].description=E)},null,8,["modelValue"])):_("",!0)]),_:1},8,["label"]),a(M,{label:e.$t("Call to Action")},{default:r(()=>{var E;return[((E=s.bannerData[s.currentTab].ctaButtons)==null?void 0:E.length)>0?(i(),c("div",Ev,[(i(!0),c(V,null,D(s.bannerData[s.currentTab].ctaButtons,(G,se)=>{var H;return i(),c("div",{key:se,class:"fcom_wc_banner_cta_button"},[a(M,{label:se?"":e.$t("Button Label")},{default:r(()=>[a(C,{modelValue:G.label,"onUpdate:modelValue":X=>G.label=X},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"]),a(M,{label:se?"":e.$t("Button Link")},{default:r(()=>[a(C,{modelValue:G.link,"onUpdate:modelValue":X=>G.link=X},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"]),a(M,{label:se?"":e.$t("Button Type"),class:"fcom_wc_banner_select"},{default:r(()=>[a(I,{modelValue:G.type,"onUpdate:modelValue":X=>G.type=X,class:"fcom_select",placeholder:e.$t("Select type")},{default:r(()=>[a(T,{label:e.$t("Primary"),value:"primary"},null,8,["label"]),a(T,{label:e.$t("Secondary"),value:"secondary"},null,8,["label"]),a(T,{label:e.$t("Text"),value:"text"},null,8,["label"]),a(T,{label:e.$t("Link"),value:"link"},null,8,["label"])]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label"]),a(M,{label:se?"":e.$t("Open in new tab"),class:"fcom_wc_banner_select"},{default:r(()=>[a(I,{modelValue:G.newTab,"onUpdate:modelValue":X=>G.newTab=X,class:"fcom_select"},{default:r(()=>[a(T,{label:e.$t("Yes"),value:"yes"},null,8,["label"]),a(T,{label:e.$t("No"),value:"no"},null,8,["label"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"]),((H=s.bannerData[s.currentTab].ctaButtons)==null?void 0:H.length)>1?(i(),v(f,{key:0,text:"",class:"wc_button_remove",onClick:X=>n.removeButton(se)},{default:r(()=>[a($,null,{default:r(()=>[a(b)]),_:1})]),_:2},1032,["onClick"])):_("",!0)])}),128)),a(U,{underline:!1,onClick:n.addButton},{default:r(()=>[S(d("+ "+e.$t("Add button")),1)]),_:1},8,["onClick"])])):(i(),v(U,{key:1,underline:!1,onClick:n.addButton},{default:r(()=>[S(d("+ "+e.$t("Add button")),1)]),_:1},8,["onClick"]))]}),_:1},8,["label"]),s.currentTab=="login"?(i(),v(M,{key:0},{default:r(()=>[a(B,{modelValue:s.bannerData[s.currentTab].allowClose,"onUpdate:modelValue":t[8]||(t[8]=E=>s.bannerData[s.currentTab].allowClose=E),"true-value":"yes","false-value":"no",class:"fcom_checkbox"},{default:r(()=>[S(d(e.$t("Allow members to close the welcome banner")),1)]),_:1},8,["modelValue"]),l("span",Av,d(e.$t("If allowed, members will be able to hide the banner")),1)]),_:1})):_("",!0)]),_:1})],2),l("div",Dv,[a(f,{class:"fcom_primary_button",disabled:s.saving,loading:s.saving,onClick:n.saveSettings},{default:r(()=>[S(d(e.$t("Update Info")),1)]),_:1},8,["disabled","loading","onClick"])])]))])}const Hv=F($v,[["render",Rv]]);const xv={name:"FluentDnD",props:{items:{type:Array,required:!0},itemClass:{type:String},itemStyle:{type:String},rowKey:{type:String,default:"id"}},emits:["dragStart","dragEnd","drop"],data(){return{draggingIndex:null,startIndex:null}},methods:{dragStart(e,t){this.draggingIndex=t,this.startIndex=t,e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",""),this.$emit("dragEnd",t)},dragEnd(){this.draggingIndex=null,this.startIndex=null},dragOver(e,t){if(e.preventDefault(),this.draggingIndex===null)return;const o=this.items[this.draggingIndex],u=this.items[t];if(o===u)return;const s=e.currentTarget.getBoundingClientRect(),n=s.top+s.height/2,m=e.clientY;(this.draggingIndex<t&&m>n||this.draggingIndex>t&&m<n)&&(this.reorderItems(this.draggingIndex,t),this.draggingIndex=t)},dropEnd(e,t){this.draggingIndex===null||this.startIndex===t||(this.draggingIndex=null,this.$emit("drop",{index:t,newItems:this.items}))},reorderItems(e,t){const o=this.items.splice(e,1)[0];this.items.splice(t,0,o)}}},jv={class:"drag-container"},Ov=["onDragstart","onDragover","onDrop"];function Nv(e,t,o,u,s,n){return i(),c("div",jv,[a(ro,{name:"flip-list",tag:"div",class:"drag-group"},{default:r(()=>[(i(!0),c(V,null,D(o.items,(m,p)=>(i(),c("div",{key:m[o.rowKey],onDragstart:h=>n.dragStart(h,p),onDragend:t[0]||(t[0]=(...h)=>n.dragEnd&&n.dragEnd(...h)),onDragover:Z(h=>n.dragOver(h,p),["prevent"]),onDrop:Z(h=>n.dropEnd(h,p),["prevent"]),draggable:!0,class:R(["drag-item",`${o.itemClass} hello_${p}`,{dragging:s.draggingIndex===p}]),style:re(o.itemStyle)},[z(e.$slots,"item",{data:m,index:p},void 0,!0)],46,Ov))),128))]),_:3})])}const zv=F(xv,[["render",Nv],["__scopeId","data-v-51d9f44b"]]),qv={name:"MenuGroupSettings",components:{SpaceCourseSelector:Kt,FluentDnD:zv,LogoEmojiSelector:Ft},data(){return{loading:!1,saving:!1,editingItem:null,editLinkModal:!1,isDragging:!1,isSpaceDragging:!1,draggingIndex:null,draggedSpaceIndex:null,isEditMode:!1}},emits:["save"],props:{menuItems:{type:Array,required:!0},title:{type:String,required:!0},has_svg:{type:Boolean,default:!0},use_icon_selector:{type:Boolean,default:!1},has_enable_disable:{type:Boolean,default:!0},custom_svg:{type:Boolean,default:!1}},methods:{initEditLink(e){!e.is_system&&!e.privacy&&(e.privacy="public",e.membership_ids=[]),this.isEditMode=!!e.title,this.editingItem=e,this.$nextTick(()=>{this.editLinkModal=!0})},removeLink(e){this.$confirm(this.$t("Are you sure you want to remove this link?"),this.$t("Warning"),{confirmButtonText:this.$t("Yes"),cancelButtonText:this.$t("Cancel"),confirmButtonClass:"fcom_primary_button",cancelButtonClass:"fcom_secondary_button",type:"warning"}).then(()=>{this.menuItems.splice(e,1),this.saveMenuItems()}).catch(()=>{})},createOrUpdateLink(){if(this.isEditMode&&(!this.editingItem.title||!this.editingItem.title.trim())){this.$notify.error(this.$t("Link title cannot be empty."));return}this.editingItem.slug||(this.editingItem.slug="fcom_custom_"+this.editingItem.title.toLowerCase().replace(/[^a-z0-9]/g,"_"),this.menuItems.push(this.editingItem)),this.editLinkModal=!1,this.saveMenuItems(),this.editingItem=null},saveMenuItems(){this.$emit("save")},drop({index:e}){this.draggingIndex=null,this.saveMenuItems()},beforeCloseDrawer(e){if(this.isEditMode&&(!this.editingItem.title||!this.editingItem.title.trim())){this.$notify.error(this.$t("Link title cannot be empty."));return}e()}}},Gv={key:0,class:"fcom_section_primary"},Yv={class:"fcom_section_primary_item"},Zv={class:"fcom_section_primary_item_title"},Wv={class:"fcom_heading_item"},Jv={class:"fcom_section_item_actions"},Qv={class:"fcom_section_items menu-items-container"},Kv={key:0,style:{padding:"1rem"}},Xv={class:"fcom_section_item_title"},e0={class:"fcom_heading_item"},t0=l("div",{class:"fcom_drag_handle"}," ‚ãÆ‚ãÆ ",-1),s0={key:0,class:"community_avatar"},o0=["src"],i0={key:1,class:"fcom_emoji"},n0={key:2,class:"fcom_shape"},l0=["innerHTML"],a0={class:"fcom_section_item_actions"},r0={key:0},c0={key:1},d0={key:0},u0={class:"fcom_help_text"};function _0(e,t,o,u,s,n){const m=j,p=O,h=Oe,y=g("FluentDnD"),k=g("logo-emoji-selector"),b=ee,$=ue,f=he,w=Ue,C=ge,M=g("SpaceCourseSelector"),P=_e,T=$t;return i(),c(V,null,[o.menuItems?(i(),c("div",Gv,[l("div",Yv,[l("div",Zv,[l("div",Wv,[z(e.$slots,"title",{},()=>[l("h4",null,d(o.title),1)])])]),l("div",Jv,[a(m,{class:"fcom_primary_button",onClick:t[0]||(t[0]=I=>n.initEditLink({enabled:"yes",privacy:"public",membership_ids:[],new_tab:"yes"}))},{default:r(()=>[S(d(e.$t("Add New Link")),1)]),_:1})])]),l("div",Qv,[o.menuItems.length?_("",!0):(i(),c("div",Kv,[l("p",null,d(e.$t("No link has been added for this section")),1)])),a(y,{items:o.menuItems,"row-key":"slug",onDrop:n.drop,"item-class":"fcom_section_item","item-style":"padding: 15px 15px 15px 35px"},{item:r(({data:I,index:U})=>[l("div",Xv,[l("p",e0,[o.use_icon_selector?(i(),c(V,{key:0},[t0,I.icon_image?(i(),c("div",s0,[a(p,null,{default:r(()=>[l("img",{alt:"",style:{"max-width":"16px","max-height":"16px"},src:I.icon_image},null,8,o0)]),_:2},1024)])):I.emoji?(i(),c("span",i0,d(I.emoji),1)):I.shape_svg?(i(),c("span",n0,[a(p,{innerHTML:I.shape_svg},null,8,["innerHTML"])])):_("",!0)],64)):I.icon_svg?(i(),v(p,{key:1},{default:r(()=>[l("span",{innerHTML:I.icon_svg},null,8,l0)]),_:2},1024)):_("",!0),l("span",null,d(I.title),1),I.is_unavailable=="yes"?(i(),v(h,{key:2,type:"danger"},{default:r(()=>[S(d(e.$t("unavailable")),1)]),_:1})):I.enabled=="yes"?(i(),v(h,{key:3,type:"success"},{default:r(()=>[S(d(e.$t("enabled")),1)]),_:1})):(i(),v(h,{key:4,type:"info"},{default:r(()=>[S(d(e.$t("disabled")),1)]),_:1}))])]),l("div",a0,[l("div",null,[a(m,{onClick:B=>n.initEditLink(I),size:"small"},{default:r(()=>[S(d(e.$t("Edit")),1)]),_:2},1032,["onClick"]),I.is_system!="yes"?(i(),v(m,{key:0,onClick:B=>n.removeLink(U),type:"danger",plain:"",size:"small"},{default:r(()=>[S(d(e.$t("Delete")),1)]),_:2},1032,["onClick"])):_("",!0)])])]),_:1},8,["items","onDrop"])])])):_("",!0),a(T,{"modal-class":"fcom_common_dialog",id:"fluent_comminity_body",class:"fcom_high_drawer","close-on-click-modal":!1,size:e.drawerWidth,modelValue:s.editLinkModal,"onUpdate:modelValue":t[11]||(t[11]=I=>s.editLinkModal=I),direction:"rtl","before-close":n.beforeCloseDrawer},{header:r(()=>[s.editingItem&&(s.editingItem.slug||s.editingItem.is_system)?(i(),c("h4",r0,d(e.$t("Edit Link")),1)):(i(),c("h4",c0,d(e.$t("Add Custom Link")),1))]),default:r(()=>[s.editingItem?(i(),c("div",d0,[a(P,{onSubmit:t[10]||(t[10]=Z(I=>e.doNothing(),["prevent"])),"label-position":"top"},{default:r(()=>[a($,{label:e.$t("Name of the Link")},{default:r(()=>[a(b,{placeholder:e.$t("Public Name of the item"),modelValue:s.editingItem.title,"onUpdate:modelValue":t[2]||(t[2]=I=>s.editingItem.title=I)},pe({_:2},[o.use_icon_selector&&s.editingItem.is_system!="yesw"?{name:"prepend",fn:r(()=>[a(k,{custom_svg:o.custom_svg,fallback_mark:"",onUpdate:t[1]||(t[1]=I=>{s.editingItem.emoji=I.emoji,s.editingItem.icon_image=I.logo,s.editingItem.shape_svg=I.shape_svg}),config:{logo:s.editingItem.icon_image,emoji:s.editingItem.emoji||"",shape_svg:s.editingItem.shape_svg||""}},null,8,["custom_svg","config"])]),key:"0"}:void 0]),1032,["placeholder","modelValue"])]),_:1},8,["label"]),a($,{label:e.$t("URL")},{default:r(()=>[a(b,{disabled:s.editingItem.is_system=="yes",type:"url",placeholder:e.$t("Url of the item"),modelValue:s.editingItem.permalink,"onUpdate:modelValue":t[3]||(t[3]=I=>s.editingItem.permalink=I)},null,8,["disabled","placeholder","modelValue"])]),_:1},8,["label"]),o.has_svg?(i(),v($,{key:0,label:e.$t("SVG Code for Icon (Simplified SVG Code) / Emoji")},{default:r(()=>[a(b,{placeholder:e.$t("SVG Code. No url please / You can use emoji"),type:"textarea",rows:3,modelValue:s.editingItem.icon_svg,"onUpdate:modelValue":t[4]||(t[4]=I=>s.editingItem.icon_svg=I)},null,8,["placeholder","modelValue"])]),_:1},8,["label"])):_("",!0),o.has_enable_disable?(i(),v($,{key:1},{default:r(()=>[a(f,{"true-value":"yes","false-value":"no",modelValue:s.editingItem.enabled,"onUpdate:modelValue":t[5]||(t[5]=I=>s.editingItem.enabled=I),class:"fcom_checkbox"},{default:r(()=>[S(d(e.$t("Enable this link")),1)]),_:1},8,["modelValue"])]),_:1})):_("",!0),s.editingItem.is_system?_("",!0):(i(),c(V,{key:2},[a($,null,{default:r(()=>[a(f,{"true-value":"yes","false-value":"no",modelValue:s.editingItem.new_tab,"onUpdate:modelValue":t[6]||(t[6]=I=>s.editingItem.new_tab=I),class:"fcom_checkbox"},{default:r(()=>[S(d(e.$t("Open this link in a new tab.")),1)]),_:1},8,["modelValue"])]),_:1}),a($,{label:e.$t("Visibility")},{default:r(()=>[a(C,{modelValue:s.editingItem.privacy,"onUpdate:modelValue":t[7]||(t[7]=I=>s.editingItem.privacy=I)},{default:r(()=>[a(w,{label:e.$t("Everyone"),value:"public"},null,8,["label"]),a(w,{label:e.$t("Logged-in only"),value:"logged_in"},null,8,["label"]),a(w,{label:e.$t("Public only"),value:"logged_out_only"},null,8,["label"]),a(w,{label:e.$t("By Space/Course Memberships"),value:"members_only"},null,8,["label"])]),_:1},8,["modelValue"]),l("div",u0,d(e.$t("Select who can see this link.")),1)]),_:1},8,["label"]),s.editingItem.privacy=="members_only"?(i(),v($,{key:0,label:e.$t("Select Space/Course Memberships")},{default:r(()=>[a(M,{modelValue:s.editingItem.membership_ids,"onUpdate:modelValue":t[8]||(t[8]=I=>s.editingItem.membership_ids=I),placeholder_text:e.$t("Select Memberships"),is_multiple:!0},null,8,["modelValue","placeholder_text"])]),_:1},8,["label"])):_("",!0)],64)),a($,null,{default:r(()=>[a(m,{class:"fcom_primary_button",onClick:t[9]||(t[9]=I=>n.createOrUpdateLink())},{default:r(()=>[S(d(e.$t("Save")),1)]),_:1})]),_:1})]),_:1})])):_("",!0)]),_:1},8,["size","modelValue","before-close"])],64)}const qs=F(qv,[["render",_0]]),m0={name:"ManageFeedLinks",components:{MenuGroupSettings:qs},props:["savingCount"],emits:["saved"],data(){return{loading:!1,menuItems:[]}},watch:{savingCount(){this.saveMenuItems()}},methods:{getMenuItems(){this.loading=!0,this.$get("feeds/links").then(e=>{this.menuItems=e.links}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})},saveMenuItems(){let e="feeds/links";this.$post(e,{links:this.menuItems}).then(t=>{this.$notify.success(t.message),this.menuItems=t.links,this.$emit("saved")}).catch(t=>{this.$handleError(t)})}},mounted(){this.getMenuItems()}},h0={class:"fcom_customizer_container"},f0={key:0,class:"fcom_card_sections"};function p0(e,t,o,u,s,n){const m=g("menu-group-settings"),p=q;return i(),c("div",h0,[s.loading?_("",!0):(i(),c("div",f0,[a(m,{custom_svg:!0,use_icon_selector:!0,has_svg:!1,title:e.$t("Manage Links"),menuItems:s.menuItems,onSave:t[0]||(t[0]=h=>n.saveMenuItems())},null,8,["title","menuItems"])])),s.loading?(i(),v(p,{key:1,rows:5,animated:""})):_("",!0)])}const g0=F(m0,[["render",p0]]),y0={name:"FeedCustomizer",props:["customize_tab"],components:{WelcomeBannerConfig:Hv,ManageFeedLinks:g0},data(){return{saving:!1,savingCount:0,changesExist:!1,currentTab:this.customize_tab}},methods:{savedData(){this.saving=!1,this.changesExist=!0},saveChanges(){this.changesExist=!0,this.savingCount=this.savingCount+1},handleBack(){this.$emit("updated",this.changesExist)}}},v0={class:"fcom_full_editor"},b0={class:"fcom_full_editor_header"},k0={class:"fcom_editor_menu object_menu"},w0={class:"fcom_space_menu_ul"},C0={class:"full_editor_actions"};function $0(e,t,o,u,s,n){const m=g("ArrowLeft"),p=O,h=j,y=bs,k=g("welcome-banner-config"),b=fe,$=Ce,f=g("manage-feed-links"),w=De;return i(),c("div",v0,[a(w,null,{default:r(()=>[a(y,{class:"fcom_full_editor_header_wrap"},{default:r(()=>[l("div",b0,[l("div",{onClick:t[0]||(t[0]=(...C)=>n.handleBack&&n.handleBack(...C)),class:"fcom_back_header"},[a(p,null,{default:r(()=>[a(m)]),_:1}),S(" "+d(e.$t("Feed")),1)]),l("div",k0,[l("ul",w0,[e.has_pro?(i(),c("li",{key:0,onClick:t[1]||(t[1]=C=>s.currentTab="welcome")},[l("a",{class:R({"router-link-exact-active":s.currentTab==="welcome"}),href:"#"},d(e.$t("Welcome Banner")),3)])):_("",!0),l("li",{onClick:t[2]||(t[2]=C=>s.currentTab="manage_links")},[l("a",{class:R({"router-link-exact-active":s.currentTab==="manage_links"}),href:"#"},d(e.$t("Feed Links")),3)])])]),l("div",C0,[a(h,{class:"fcom_primary_button",disabled:s.saving,loading:s.saving,onClick:n.saveChanges},{default:r(()=>[S(d(e.$t("Save Changes")),1)]),_:1},8,["disabled","loading","onClick"])])])]),_:1}),a(w,{class:"fcom_full_editor_container"},{default:r(()=>[s.currentTab=="welcome"?(i(),v($,{key:0,class:"fcom_full_editor_main"},{default:r(()=>[a(b,null,{default:r(()=>[a(k,{savingCount:s.savingCount,onSaved:n.savedData},null,8,["savingCount","onSaved"])]),_:1})]),_:1})):s.currentTab=="manage_links"?(i(),v($,{key:1,class:"fcom_full_editor_main"},{default:r(()=>[a(b,null,{default:r(()=>[a(f,{savingCount:s.savingCount,onSaved:n.savedData},null,8,["savingCount","onSaved"])]),_:1})]),_:1})):_("",!0)]),_:1})]),_:1})])}const S0=F(y0,[["render",$0]]),V0={name:"FeedMenu",components:{FeedCustomizer:S0},data(){return{customizeTab:"welcome",customizeSpace:!1,popoverVisible:!1}},methods:{openCustomizer(e){this.popoverVisible=!1,this.customizeTab=e,this.customizeSpace=!0},togglePopover(){this.popoverVisible=!this.popoverVisible},updatedFeedSettings(e){this.customizeSpace=!1,e&&location.reload()}}},L0={class:"actions_items"},M0={key:0};function P0(e,t,o,u,s,n){const m=g("MoreFilled"),p=O,h=j,y=de,k=g("feed-customizer");return i(),c(V,null,[l("div",null,[a(y,{placement:"bottom",ref:"feed_actions",persistent:!1,visible:s.popoverVisible,onHide:t[2]||(t[2]=b=>s.popoverVisible=!1)},{reference:r(()=>[a(h,{"aria-label":e.$t("View actions"),class:"fcom_dot_menu",size:"small",text:"",onClick:n.togglePopover},{default:r(()=>[a(p,null,{default:r(()=>[a(m)]),_:1})]),_:1},8,["aria-label","onClick"])]),default:r(()=>[l("ul",L0,[e.has_pro?(i(),c("li",{key:0,onClick:t[0]||(t[0]=b=>n.openCustomizer("welcome"))},d(e.$t("Welcome Banner")),1)):_("",!0),l("li",{onClick:t[1]||(t[1]=b=>n.openCustomizer("manage_links"))},d(e.$t("Manage Links")),1)])]),_:1},8,["visible"])]),s.customizeSpace?(i(),c("div",M0,[(i(),v(Qe,{to:"body"},[a(k,{customize_tab:s.customizeTab,onClose:t[3]||(t[3]=b=>s.customizeSpace=!1),onUpdated:n.updatedFeedSettings},null,8,["customize_tab","onUpdated"])]))])):_("",!0)],64)}const F0=F(V0,[["render",P0]]),T0={name:"RenderSpaceLinks",props:{links:{type:Array,required:!0}},computed:{enabledLinks(){return this.links.filter(e=>e.enabled!=="no")}}},I0={class:"object_menu"},U0={class:"fcom_space_menu_ul"},B0=["target","href"],E0=["src"],A0={key:1,class:"fcom_emoji"},D0={key:2,style:{"font-size":"120%"},class:"fcom_shape"};function R0(e,t,o,u,s,n){const m=O;return i(),c("div",I0,[l("ul",U0,[(i(!0),c(V,null,D(n.enabledLinks,p=>(i(),c("li",{key:p.slug},[l("a",{target:p.new_tab=="yes"?"_blank":"",rel:"noopener nofollow",href:p.permalink},[p.icon_image?(i(),c("img",{key:0,alt:"",src:p.icon_image},null,8,E0)):p.emoji?(i(),c("span",A0,d(p.emoji),1)):p.shape_svg?(i(),c("span",D0,[a(m,{innerHTML:p.shape_svg},null,8,["innerHTML"])])):_("",!0),l("span",null,d(p.title),1)],8,B0)]))),128))])])}const Xt=F(T0,[["render",R0]]),H0={name:"FeedsRoute",components:{SpaceIcon:He,Layout:ve,AppLayout:we,RecentActivities:Ut,FeedMenu:F0,RenderSpaceLinks:Xt},data(){return{transiting:!1}},methods:{goToProfile(){this.$router.push({name:"update_profile",params:{username:this.auth.username}})},resetRoute(){this.transiting=!0,this.$nextTick(()=>{this.transiting=!1})}},mounted(){window.scrollTo(0,0)}},x0={key:0,"aria-label":"Feed Links",class:"fcom_sub_header"},j0={key:0,class:"fcom_profile_complete_btn_wrap"},O0={key:1},N0={key:0,class:"fcom_feed_box"},z0={key:0,class:"fcom_main_side_wrap"},q0={class:"fcom_side_box"};function G0(e,t,o,u,s,n){const m=g("render-space-links"),p=j,h=g("feed-menu"),y=g("router-view"),k=Ce,b=g("recent-activities"),$=Ne,f=De,w=g("layout"),C=g("app-layout");return i(),v(C,{wrapper_class:"fcom_single_layout fcom_max_layout"},{default:r(()=>[a(w,{wrapper_class:"no_bg_layout",title:e.$t("Feed")},{title:r(()=>[l("h1",{onClick:t[0]||(t[0]=M=>{e.$eventBus.emit("toTop"),n.resetRoute()}),class:"fcom_page_title clickable"},d(e.$t("Feed")),1)]),sub_header:r(()=>{var M;return[((M=e.appVars.feed_links)==null?void 0:M.length)>0?(i(),c("nav",x0,[a(m,{links:e.appVars.feed_links},null,8,["links"])])):_("",!0)]}),actions:r(()=>[e.auth.compilation_score<100?(i(),c("div",j0,[a(p,{onClick:n.goToProfile,type:"danger"},{default:r(()=>[S(d(e.$t("Complete your profile"))+" ("+d(e.auth.compilation_score)+"%)",1)]),_:1},8,["onClick"])])):_("",!0),e.isAdmin()?(i(),c("div",O0,[a(h)])):_("",!0)]),default:r(()=>[a(f,{class:"fcom_resp_container fcom_space_container fcom_main_container"},{default:r(()=>[a(k,{class:"fcom_main"},{default:r(()=>[s.transiting?_("",!0):(i(),c("div",N0,[a(y)]))]),_:1}),a($,{class:"fcom_resp_side",width:"306px"},{default:r(()=>[e.isMobile?_("",!0):(i(),c("div",z0,[l("div",q0,[a(b,{is_trending:!0,pinned_widget_title:e.$t("Trending Posts"),with_pins:!0},null,8,["pinned_widget_title"])])]))]),_:1})]),_:1})]),_:1},8,["title"])]),_:1})}const Y0=F(H0,[["render",G0]]);const Z0={name:"NewPostsBanner",components:{ArrowUp:us},props:{context:{type:String,default:"global"},minScrollToShow:{type:Number,default:500}},setup(){return{feedStore:Se()}},data(){return{show:!1,count:0,scrollPosition:0}},mounted(){this.$eventBus.on("feeds_updated",this.handleFeedUpdates),document.addEventListener("fcom_layout_scroll",this.handleScroll),this.checkNewPosts()},beforeUnmount(){this.$eventBus.off("feeds_updated",this.handleFeedUpdates),document.removeEventListener("fcom_layout_scroll",this.handleScroll)},methods:{handleFeedUpdates({context:e,added:t}){e===this.context&&t>0&&this.scrollPosition>this.minScrollToShow&&(this.count=this.feedStore.getNewPostsCount(this.context),this.show=!0)},handleScroll(e){this.scrollPosition=e.detail.scrollTop,this.scrollPosition<100&&this.show&&this.dismissBanner()},checkNewPosts(){const e=this.feedStore.getNewPostsCount(this.context);e>0&&this.scrollPosition>this.minScrollToShow&&(this.count=e,this.show=!0)},scrollToTop(){window.fcomLayoutRef&&window.fcomLayoutRef.setScrollTop(0),this.dismissBanner()},dismissBanner(){this.show=!1,this.feedStore.clearNewPostsCount(this.context),this.count=0}}},W0={class:"fcom_new_posts_text"};function J0(e,t,o,u,s,n){const m=g("ArrowUp"),p=O;return i(),v(co,{name:"slide-down"},{default:r(()=>[s.show?(i(),c("div",{key:0,class:"fcom_new_posts_banner",onClick:t[0]||(t[0]=(...h)=>n.scrollToTop&&n.scrollToTop(...h))},[a(p,{class:"fcom_new_posts_icon"},{default:r(()=>[a(m)]),_:1}),l("span",W0,d(s.count===1?e.$t("1 new post available"):e.$t("{count} new posts available",{count:s.count})),1)])):_("",!0)]),_:1})}const Q0=F(Z0,[["render",J0],["__scopeId","data-v-e4ec71f4"]]),K0={name:"AllFeeds",components:{Feeds:rt,NewPostsBanner:Q0},setup(){const e=Cs(),t=xe();return{tickerStore:e,uiStore:t}},beforeRouteLeave(e,t,o){if(e.name==="single_feed"||e.name==="space_feed"){let s=0;window.fcomLayoutRef&&window.fcomLayoutRef.wrapRef&&(s=window.fcomLayoutRef.wrapRef.scrollTop),this.uiStore.saveScrollPosition(t.path,s)}else this.uiStore.clearScrollPosition();o()},mounted(){var e,t;if(this.changeTitle(this.$t("All Feeds")),(e=this.appVars.features)!=null&&e.enable_feed_ticker){const o=((t=this.appVars.features)==null?void 0:t.ticker_interval)||3e4;this.tickerStore.start(o)}},beforeUnmount(){var e;(e=this.appVars.features)!=null&&e.enable_feed_ticker&&this.tickerStore.stop()}},X0={key:0,class:"notices fcom_notice_wrap"},eb=["innerHTML"];function tb(e,t,o,u,s,n){var y;const m=g("WelcomeBanner"),p=g("NewPostsBanner"),h=g("feeds");return i(),c(V,null,[e.appVars.portal_notices&&e.appVars.portal_notices.length?(i(),c("div",X0,[(i(!0),c(V,null,D(e.appVars.portal_notices,k=>(i(),c("div",{innerHTML:k},null,8,eb))),256))])):_("",!0),e.appVars.welcome_banner?(i(),v(m,{key:1})):_("",!0),(y=e.appVars.features)!=null&&y.enable_feed_ticker?(i(),v(p,{key:2,context:"global"})):_("",!0),a(h,{space:"",feed_name:"all_feeds",can_change_order:e.appVars.features.disable_feed_sort_by!=="yes",default_order_by:e.appVars.features.default_feed_sort_by||"",layout_style:e.appVars.features.default_feed_layout},null,8,["can_change_order","default_order_by","layout_style"])],64)}const sb=F(K0,[["render",tb]]),ob={name:"ViewFeed",components:{Feed:Ze},props:["feed_slug"],data(){return{loading:!0,feed:null,notFound:!1}},watch:{feed_slug(){this.feed=null,this.$nextTick(()=>{this.getFeed()})}},methods:{getFeed(){this.feed=null,this.loading=!0,this.$get("feeds/"+this.feed_slug+"/by-slug").then(e=>{this.feed=e.feed,this.appVars.last_feed_id<e.feed.id&&(this.appVars.last_feed_id=e.feed.id),e.current_user_follows&&this.setFollowIds(e.current_user_follows),this.changeFeedTitle(),this.$nextTick(()=>{this.checkCommentScroll()}),this.$eventBus.emit("feed_interaction",this.feed.id)}).catch(e=>{this.$handleError(e),typeof e=="object"&&e.xhr_status==404&&(this.notFound=!0)}).finally(()=>{this.loading=!1})},changeFeedTitle(){this.changeTitle(this.feed.title||"Feed")},checkCommentScroll(){this.$route.query.comment_id?setTimeout(()=>{const e=document.getElementById("comment_"+this.$route.query.comment_id);e?(e.classList.add("fcom_highlight_comment"),e.style.scrollMarginTop="100px",e.scrollIntoView({behavior:"instant"})):this.$eventBus.emit("toTop",0)},100):this.$eventBus.emit("toTop",0)}},mounted(){window.__showing_feed&&window.__showing_feed.slug==this.feed_slug?(this.feed=window.__showing_feed,window.__showing_feed=null,this.$nextTick(()=>{this.changeFeedTitle(),this.checkCommentScroll()}),this.$eventBus.emit("feed_interaction",this.feed.id)):this.getFeed()}},ib={key:0,class:"fcom_feed_report_wrap"},nb={class:"fcom_feed_report_content"},lb={key:3,class:"error-container"},ab={style:{padding:"20px",background:"var(--fcom-primary-bg)","border-radius":"8px"},class:"error-content"},rb={class:"error-title"},cb={class:"error-message"},db={class:"error-explanation"},ub={style:{"list-style":"disc",margin:"0 0 0 20px"},class:"error-reasons"},_b={style:{"margin-top":"20px"},class:"error-actions"},mb=["href"];function hb(e,t,o,u,s,n){const m=g("feed"),p=q;return i(),c("div",null,[s.feed&&s.feed.status=="unpublished"?(i(),c("div",ib,[l("div",nb,[l("span",null,d(e.$t("This content has been unpublished by community moderation. Only the author and moderators can view it.")),1)])])):_("",!0),s.feed?(i(),v(m,{key:1,is_single:!0,is_route:!0,show_report:!0,feed:s.feed,onReload:n.getFeed},null,8,["feed","onReload"])):s.loading?(i(),v(p,{key:2,rows:5,animated:!0,class:"white_loaded"})):s.notFound?(i(),c("div",lb,[l("div",ab,[l("h1",rb,d(e.$t("Post Not Found")),1),l("p",cb,d(e.$t("Sorry, the requested post could not be found.")),1),l("p",db,d(e.$t("This may be due to one of the following reasons:")),1),l("ul",ub,[l("li",null,d(e.$t("You do not have permission to view this post")),1),l("li",null,d(e.$t("The post URL may be incorrect")),1),l("li",null,d(e.$t("The post has been deleted")),1)]),l("div",_b,[l("a",{href:e.$getRouteLink(""),class:"el-button fcom_primary_button"},d(e.$t("Back to home")),9,mb)])])])):_("",!0)])}const ns=F(ob,[["render",hb]]),fb={name:"SpaceHeader",emits:["refetch","doSearch"],components:{ImageUploader:Re},props:{space:{type:String,required:!0},space_profile:{required:!1}},data(){return{updating:!1}},computed:{profile(){return this.space_profile?(this.search="",this.space_profile):{title:".......",slug:"..",cover_photo:this.appVars.assets_url+"images/placeholer.png",permissions:{}}},isMod(){return this.profile.permissions.community_moderator}},methods:{handleCoverPhotoUpload(e){this.space_profile.cover_photo=e,this.updateSpace({cover_photo:e})},updateSpace(e){this.space_profile.id&&(this.updating=!0,this.$put("spaces/"+this.space+"/by-slug",{data:e}).then(t=>{this.$notify.success(t.message),this.$emit("refetch"),this.$eventBus.emit("reloadMenu")}).catch(t=>{this.$handleError(t)}).finally(()=>{this.updating=!1}))}},mounted(){this.$eventBus.on("doGlobalSearch",e=>{this.search_term=e})}},pb={key:0,class:"object_header space_header"},gb={key:0,style:{"text-align":"right"},class:"object_media_uploader"};function yb(e,t,o,u,s,n){const m=j,p=g("image-uploader"),h=K("loading");return n.profile.cover_photo?N((i(),c("div",pb,[l("div",{style:re({backgroundImage:"url("+n.profile.cover_photo+")"}),class:"object_cover"},[n.isMod?(i(),c("div",gb,[a(p,{additionalData:{resize:!0,max_width:1500},onUploaded:n.handleCoverPhotoUpload},{default:r(()=>[a(m,{size:"small",plain:"",type:"primary"},{default:r(()=>[S(d(e.$t("Change Cover")),1)]),_:1})]),_:1},8,["onUploaded"]),a(m,{style:{"margin-top":"10px"},size:"small",plain:"",type:"danger",onClick:t[0]||(t[0]=Z(y=>n.updateSpace({cover_photo:""}),["prevent"]))},{default:r(()=>[S(d(e.$t("Remove")),1)]),_:1})])):_("",!0)],4)])),[[h,s.updating]]):_("",!0)}const vb=F(fb,[["render",yb]]),bb={name:"SpaceMenuItems",props:["space","profile"]},kb={"aria-label":"Space menu"},wb={class:"fcom_space_menu_ul"},Cb=["innerHTML"],$b=["href","target","innerHTML"],Sb={key:1};function Vb(e,t,o,u,s,n){var p,h;const m=g("router-link");return i(),c("nav",kb,[l("ul",wb,[(h=(p=o.profile)==null?void 0:p.header_links)!=null&&h.length?(i(!0),c(V,{key:0},D(o.profile.header_links,y=>(i(),c("li",null,[y.route?(i(),v(m,{key:0,to:y.route},{default:r(()=>[l("span",{innerHTML:y.title},null,8,Cb)]),_:2},1032,["to"])):(i(),c("a",{key:1,class:R(y.css_class??""),href:y.url,target:y.is_external?"_blank":"_self",innerHTML:y.title},null,10,$b))]))),256)):_("",!0),e.isMobile?(i(),c("li",Sb,[a(m,{to:{name:"space_about"}},{default:r(()=>[S(d(e.$t("About")),1)]),_:1})])):_("",!0)])])}const Lb=F(bb,[["render",Vb]]),Mb={name:"ImagePlaceholder"},Pb={width:"240",height:"240",viewBox:"0 0 240 240",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Fb=l("rect",{width:"240",height:"240",fill:"#F5F6F7"},null,-1),Tb=l("path",{d:"M133.125 121.65L129.33 116.7C129 116.26 128.56 116.04 128.01 116.04C127.46 116.04 127.02 116.26 126.69 116.7L121.163 123.96C120.723 124.51 120.654 125.088 120.956 125.693C121.259 126.298 121.768 126.6 122.483 126.6H148.718C149.433 126.6 149.941 126.298 150.244 125.693C150.546 125.088 150.478 124.51 150.038 123.96L142.035 113.483C141.705 113.043 141.265 112.823 140.715 112.823C140.165 112.823 139.725 113.043 139.395 113.483L133.125 121.65ZM115.8 139.8C113.985 139.8 112.431 139.154 111.139 137.861C109.846 136.569 109.2 135.015 109.2 133.2V93.6C109.2 91.785 109.846 90.2313 111.139 88.9388C112.431 87.6462 113.985 87 115.8 87H155.4C157.215 87 158.769 87.6462 160.061 88.9388C161.354 90.2313 162 91.785 162 93.6V133.2C162 135.015 161.354 136.569 160.061 137.861C158.769 139.154 157.215 139.8 155.4 139.8H115.8ZM115.8 133.2H155.4V93.6H115.8V133.2ZM102.6 153C100.785 153 99.2313 152.354 97.9388 151.061C96.6462 149.769 96 148.215 96 146.4V103.5C96 102.565 96.3163 101.781 96.9488 101.149C97.5813 100.516 98.365 100.2 99.3 100.2C100.235 100.2 101.019 100.516 101.651 101.149C102.284 101.781 102.6 102.565 102.6 103.5V146.4H145.5C146.435 146.4 147.219 146.716 147.851 147.349C148.484 147.981 148.8 148.765 148.8 149.7C148.8 150.635 148.484 151.419 147.851 152.051C147.219 152.684 146.435 153 145.5 153H102.6Z",fill:"#98A2B3"},null,-1),Ib=[Fb,Tb];function Ub(e,t,o,u,s,n){return i(),c("svg",Pb,Ib)}const Bt=F(Mb,[["render",Ub]]),Bb={name:"LockscreenPaywallMeta",components:{ImagePlaceholder:Bt},props:{field:{type:Object,required:!0},space_id:{type:[String,Number],required:!0}},data(){return{loading:!1,editTab:"paywall",availablePaywalls:[]}},methods:{initAddPaywall(){this.field.paywalls=this.field.paywalls||[],this.field.paywalls.push("")},removePaywall(e){const t=this.field.paywalls||[];t.splice(t.indexOf(e),1),this.field.paywalls=t},isPaywallAdded(e){var t;return(t=this.field.paywalls)==null?void 0:t.includes(e.toString())},getAvailablePaywalls(){this.loading=!0,this.$get("cart/spaces/"+this.space_id+"/paywalls",{space_id:this.space_id}).then(e=>{this.availablePaywalls=e.paywalls}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})}},mounted(){this.getAvailablePaywalls()}},Eb={key:0,class:"fcom_paywalls"},Ab={class:"fcom_paywall"},Db={class:"fcom_select_photo",style:{float:"left"}},Rb=["src"],Hb={key:0,class:"fcom_description"},xb={class:"fcom_paywall_actions"},jb={class:"fcom_color_input_wrap"},Ob={class:"fcom_color_input_wrap"},Nb={class:"fcom_color_input_wrap"},zb={class:"fcom_color_input_wrap"};function qb(e,t,o,u,s,n){const m=g("image-placeholder"),p=ie,h=bt,y=ne,k=g("Delete"),b=O,$=j,f=q,w=wt,C=ee,M=ue,P=he,T=_e,I=kt,U=Ct;return i(),v(U,{modelValue:s.editTab,"onUpdate:modelValue":t[12]||(t[12]=B=>s.editTab=B)},{default:r(()=>[a(w,{label:e.$t("Paywalls"),name:"paywall"},{default:r(()=>[s.loading?(i(),v(f,{key:1,rows:2,animated:""})):(i(),c("div",Eb,[(i(!0),c(V,null,D(o.field.paywalls,(B,A)=>(i(),c("div",Ab,[a(y,{modelValue:o.field.paywalls[A],"onUpdate:modelValue":L=>o.field.paywalls[A]=L,placeholder:e.$t("Select Paywall")},{default:r(()=>[(i(!0),c(V,null,D(s.availablePaywalls,L=>(i(),v(h,{key:L.ID,label:L.post_title},{default:r(()=>[(i(!0),c(V,null,D(L.variants,E=>(i(),v(p,{key:E.id,value:E.id.toString(),label:E.variation_title,disabled:n.isPaywallAdded(E.id),class:"fcom_with_photo_option"},{default:r(()=>[l("span",Db,[E.photo?(i(),c("img",{key:0,src:E.photo},null,8,Rb)):(i(),v(m,{key:1})),l("span",null,d(E.variation_title),1)])]),_:2},1032,["value","label","disabled"]))),128))]),_:2},1032,["label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"]),a(b,{onClick:L=>n.removePaywall(B)},{default:r(()=>[a(k)]),_:2},1032,["onClick"])]))),256)),!o.field.paywalls||Object.keys(o.field.paywalls).length<1?(i(),c("div",Hb,[l("p",null,d(e.$t("Please add paywall pricing options")),1)])):_("",!0),l("div",xb,[a($,{style:{width:"100%"},class:"fcom_plain_button",onClick:n.initAddPaywall},{default:r(()=>[l("span",null,d("+ "+e.$t("Add Paywall")),1)]),_:1},8,["onClick"])])]))]),_:1},8,["label"]),a(w,{label:e.$t("Content"),name:"content"},{default:r(()=>[a(T,{onSubmit:t[2]||(t[2]=Z(B=>e.doNothing(),["prevent"])),"label-position":"top",class:"fcom_form_container"},{default:r(()=>[a(M,{label:e.$t("Button Label")},{default:r(()=>[a(C,{modelValue:o.field.button_text,"onUpdate:modelValue":t[0]||(t[0]=B=>o.field.button_text=B),placeholder:e.$t("Button Label")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(M,null,{default:r(()=>[a(P,{modelValue:o.field.show_description,"onUpdate:modelValue":t[1]||(t[1]=B=>o.field.show_description=B),"true-value":"yes","false-value":"no"},{default:r(()=>[S(d(e.$t("Show Paywall Description")),1)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["label"]),a(w,{label:e.$t("Design"),name:"design"},{default:r(()=>[a(T,{onSubmit:t[11]||(t[11]=Z(B=>e.doNothing(),["prevent"])),"label-position":"top",class:"fcom_form_container"},{default:r(()=>[a(M,{label:e.$t("Background Color")},{default:r(()=>[l("div",jb,[a(I,{predefine:e.appVars.suggestedColors,modelValue:o.field.background_color,"onUpdate:modelValue":t[3]||(t[3]=B=>o.field.background_color=B)},null,8,["predefine","modelValue"]),a(C,{modelValue:o.field.background_color,"onUpdate:modelValue":t[4]||(t[4]=B=>o.field.background_color=B)},null,8,["modelValue"])])]),_:1},8,["label"]),a(M,{label:e.$t("Text Color")},{default:r(()=>[l("div",Ob,[a(I,{predefine:e.appVars.suggestedColors,modelValue:o.field.text_color,"onUpdate:modelValue":t[5]||(t[5]=B=>o.field.text_color=B)},null,8,["predefine","modelValue"]),a(C,{modelValue:o.field.text_color,"onUpdate:modelValue":t[6]||(t[6]=B=>o.field.text_color=B)},null,8,["modelValue"])])]),_:1},8,["label"]),a(M,{label:e.$t("Button Label")},{default:r(()=>[l("div",Nb,[a(I,{predefine:e.appVars.suggestedColors,modelValue:o.field.button_text_color,"onUpdate:modelValue":t[7]||(t[7]=B=>o.field.button_text_color=B)},null,8,["predefine","modelValue"]),a(C,{modelValue:o.field.button_text_color,"onUpdate:modelValue":t[8]||(t[8]=B=>o.field.button_text_color=B)},null,8,["modelValue"])])]),_:1},8,["label"]),a(M,{label:e.$t("Button Background")},{default:r(()=>[l("div",zb,[a(I,{predefine:e.appVars.suggestedColors,modelValue:o.field.button_color,"onUpdate:modelValue":t[9]||(t[9]=B=>o.field.button_color=B),"show-alpha":""},null,8,["predefine","modelValue"]),a(C,{modelValue:o.field.button_color,"onUpdate:modelValue":t[10]||(t[10]=B=>o.field.button_color=B)},null,8,["modelValue"])])]),_:1},8,["label"])]),_:1})]),_:1},8,["label"])]),_:1},8,["modelValue"])}const Gb=F(Bb,[["render",qb]]),Yb={name:"LockscreenMeta",components:{BgImageUpload:zs,LockscreenPaywallMeta:Gb},props:["lockscreen","space_id"],emits:["editField","updatePaywalls"],data(){return{loading:!1,editing:!1,editTab:"content",editingField:null,availablePaywalls:[]}},computed:{lockscreenFields(){return this.lockscreen},getFieldIcon(){return e=>{const t={image:"Picture",block:"Tickets",lesson:"Memo",paywall:"Money"};return e.name=="action"?"Iphone":t[e.type]}}},methods:{toggleHidden(e){e.hidden=!e.hidden,e.type=="paywall"&&!e.hidden&&this.updateField(e)},updateField(e){this.editing=!0,this.editingField=e;const t=e.type=="block"?e:null;this.$emit("editField",t)},backToFields(){this.editing=!1,this.editingField=null,this.$emit("editField",null)},moveUp(e){if(e==0)return;const t=this.lockscreen[e],o=this.lockscreen[e-1];this.lockscreen.splice(e-1,2,t,o)},moveDown(e){if(e==this.lockscreen.length-1)return;const t=this.lockscreen[e],o=this.lockscreen[e+1];this.lockscreen.splice(e,2,o,t)}}},Zb={key:0,class:"fcom_lockscreen_meta"},Wb={class:"fcom_meta_section lockscreen_meta"},Jb={class:"fcom_description"},Qb={class:"fcom_meta_section lockscreen_meta"},Kb={class:"fcom_meta_label"},Xb={class:"fcom_meta_content"},ek={class:"fcom_meta_block"},tk={class:"fcom_block_label"},sk={class:"fcom_meta_sorting"},ok={class:"fcom_block_action"},ik={key:1,class:"fcom_lockscreen_meta"},nk={class:"fcom_edit_title"},lk={class:"fcom_edit_content"},ak={class:"fcom_color_input_wrap"},rk={class:"fcom_color_input_wrap"},ck={class:"fcom_color_input_wrap"},dk={class:"fcom_color_input_wrap"},uk={class:"fcom_color_input_wrap"},_k={key:1,class:"fcom_description"},mk={key:2,class:"fcom_description"};function hk(e,t,o,u,s,n){const m=O,p=g("Top"),h=g("Bottom"),y=g("EditPen"),k=g("Hide"),b=g("View"),$=g("Back"),f=ee,w=ue,C=he,M=_e,P=wt,T=g("BgImageUpload"),I=kt,U=Ct,B=g("lockscreen-paywall-meta");return s.editing?(i(),c("div",ik,[l("div",nk,[a(m,{onClick:n.backToFields},{default:r(()=>[a($)]),_:1},8,["onClick"]),l("p",null,d(e.$labelize(s.editingField.label)),1)]),l("div",lk,[s.editingField.type=="image"?(i(),v(U,{key:0,modelValue:s.editTab,"onUpdate:modelValue":t[18]||(t[18]=A=>s.editTab=A)},{default:r(()=>[a(P,{label:e.$t("Content"),name:"content"},{default:r(()=>[a(M,{onSubmit:t[5]||(t[5]=Z(A=>e.doNothing(),["prevent"])),model:s.editingField,"label-position":"top",class:"fcom_form_container"},{default:r(()=>[a(w,{label:e.$t("Heading")},{default:r(()=>[a(f,{modelValue:s.editingField.heading,"onUpdate:modelValue":t[0]||(t[0]=A=>s.editingField.heading=A),placeholder:e.$t("Heading")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(w,{label:e.$t("Description")},{default:r(()=>[a(f,{modelValue:s.editingField.description,"onUpdate:modelValue":t[1]||(t[1]=A=>s.editingField.description=A),type:"textarea",placeholder:e.$t("Description")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(w,{label:e.$t("Button Label")},{default:r(()=>[a(f,{modelValue:s.editingField.button_text,"onUpdate:modelValue":t[2]||(t[2]=A=>s.editingField.button_text=A),placeholder:e.$t("Button Label")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(w,{label:e.$t("Button Link")},{default:r(()=>[a(f,{modelValue:s.editingField.button_link,"onUpdate:modelValue":t[3]||(t[3]=A=>s.editingField.button_link=A)},null,8,["modelValue"])]),_:1},8,["label"]),s.editingField.type=="image"?(i(),v(w,{key:0},{default:r(()=>[a(C,{modelValue:s.editingField.new_tab,"onUpdate:modelValue":t[4]||(t[4]=A=>s.editingField.new_tab=A),"true-value":"yes","false-value":"no"},{default:r(()=>[S(d(e.$t("Open in New Tab")),1)]),_:1},8,["modelValue"])]),_:1})):_("",!0)]),_:1},8,["model"])]),_:1},8,["label"]),a(P,{label:e.$t("Design"),name:"design"},{default:r(()=>[a(M,{onSubmit:t[17]||(t[17]=Z(A=>e.doNothing(),["prevent"])),model:s.editingField,"label-position":"top",class:"fcom_form_container"},{default:r(()=>[a(w,{label:e.$t("Background Image"),class:"fcom_bg_image"},{default:r(()=>[a(T,{modelValue:s.editingField.background_image,"onUpdate:modelValue":t[6]||(t[6]=A=>s.editingField.background_image=A),can_remove:!0},null,8,["modelValue"])]),_:1},8,["label"]),a(w,{label:e.$t("Overlay Color")},{default:r(()=>[l("div",ak,[a(I,{predefine:e.appVars.suggestedColors,modelValue:s.editingField.overlay_color,"onUpdate:modelValue":t[7]||(t[7]=A=>s.editingField.overlay_color=A)},null,8,["predefine","modelValue"]),a(f,{modelValue:s.editingField.overlay_color,"onUpdate:modelValue":t[8]||(t[8]=A=>s.editingField.overlay_color=A)},null,8,["modelValue"])])]),_:1},8,["label"]),a(w,{label:e.$t("Heading Color")},{default:r(()=>[l("div",rk,[a(I,{predefine:e.appVars.suggestedColors,modelValue:s.editingField.heading_color,"onUpdate:modelValue":t[9]||(t[9]=A=>s.editingField.heading_color=A)},null,8,["predefine","modelValue"]),a(f,{modelValue:s.editingField.heading_color,"onUpdate:modelValue":t[10]||(t[10]=A=>s.editingField.heading_color=A)},null,8,["modelValue"])])]),_:1},8,["label"]),a(w,{label:e.$t("Text Color")},{default:r(()=>[l("div",ck,[a(I,{predefine:e.appVars.suggestedColors,modelValue:s.editingField.text_color,"onUpdate:modelValue":t[11]||(t[11]=A=>s.editingField.text_color=A)},null,8,["predefine","modelValue"]),a(f,{modelValue:s.editingField.text_color,"onUpdate:modelValue":t[12]||(t[12]=A=>s.editingField.text_color=A)},null,8,["modelValue"])])]),_:1},8,["label"]),a(w,{label:e.$t("Button Label")},{default:r(()=>[l("div",dk,[a(I,{predefine:e.appVars.suggestedColors,modelValue:s.editingField.button_text_color,"onUpdate:modelValue":t[13]||(t[13]=A=>s.editingField.button_text_color=A)},null,8,["predefine","modelValue"]),a(f,{modelValue:s.editingField.button_text_color,"onUpdate:modelValue":t[14]||(t[14]=A=>s.editingField.button_text_color=A)},null,8,["modelValue"])])]),_:1},8,["label"]),a(w,{label:e.$t("Button Background")},{default:r(()=>[l("div",uk,[a(I,{predefine:e.appVars.suggestedColors,modelValue:s.editingField.button_color,"onUpdate:modelValue":t[15]||(t[15]=A=>s.editingField.button_color=A),"show-alpha":""},null,8,["predefine","modelValue"]),a(f,{modelValue:s.editingField.button_color,"onUpdate:modelValue":t[16]||(t[16]=A=>s.editingField.button_color=A)},null,8,["modelValue"])])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["label"])]),_:1},8,["modelValue"])):s.editingField.type=="block"?(i(),c("div",_k,d(e.$t("Edit the field from block editor ")),1)):s.editingField.type=="lesson"?(i(),c("div",mk,d(e.$t("Edit lessons from lesson editor ")),1)):s.editingField.type=="paywall"?(i(),v(B,{key:3,field:s.editingField,space_id:o.space_id},null,8,["field","space_id"])):_("",!0)])])):(i(),c("div",Zb,[l("div",Wb,[l("div",Jb,[l("p",null,d(e.$t("This page is only visible to non-members viewing a private space.")),1)])]),l("div",Qb,[l("div",Kb,d(e.$t("Page Blocks")),1),l("div",Xb,[l("ul",ek,[(i(!0),c(V,null,D(n.lockscreenFields,(A,L)=>(i(),c("li",{class:R(["fcom_block_list",{block_hidden:A.hidden}])},[l("div",tk,[a(m,{class:"fcom_el_icon"},{default:r(()=>[(i(),v(xt(n.getFieldIcon(A))))]),_:2},1024),l("p",null,d(e.$labelize(A.label)),1)]),l("div",sk,[a(m,{onClick:E=>n.moveUp(L)},{default:r(()=>[a(p)]),_:2},1032,["onClick"]),a(m,{onClick:E=>n.moveDown(L)},{default:r(()=>[a(h)]),_:2},1032,["onClick"])]),l("div",ok,[a(m,{onClick:E=>n.updateField(A)},{default:r(()=>[a(y)]),_:2},1032,["onClick"]),A.hidden?(i(),v(m,{key:0,onClick:E=>n.toggleHidden(A)},{default:r(()=>[a(k)]),_:2},1032,["onClick"])):(i(),v(m,{key:1,onClick:E=>n.toggleHidden(A)},{default:r(()=>[a(b)]),_:2},1032,["onClick"]))])],2))),256))])])])]))}const fk=F(Yb,[["render",hk]]),pk={name:"BlockEditor",emits:["update:modelValue"],props:{modelValue:{type:String,required:!1}},data(){return{loading:!0,has_error:!1,all_loaded:!1,html:this.modelValue}},methods:{attach(){const e=this.$refs.block_editor;this.loading=!1,this.all_loaded=!0,window.wp.attachEditor(e,{iso:{toolbar:{undo:!0,navigation:!0,documentInspector:null},blocks:{allowBlocks:["core/button","core/buttons","core/code","core/column","core/columns","core/embed","core/group","core/heading","core/image","core/list","core/list-item","core/missing","core/paragraph","core/preformatted","core/pullquote","core/quote","core/separator","core/spacer","core/table","core/verse","core/html"]},__experimentalOnChange:function(t){console.log(t)},sidebar:{inserter:!1,inspector:!0}},editor:{__experimentalOnChange:function(t){console.log(t)},__experimentalOnInput(t){console.log(t)},__experimentalOnSelection(t){console.log(t)},onSaveContent:function(t){console.log(t)}}}),e.addEventListener("change",t=>{this.html=t.target.value,this.$emit("update:modelValue",t.target.value)})},loadScript(e){return new Promise((t,o)=>{const u=document.createElement("script");u.src=e,u.onload=t,u.onerror=o,document.head.append(u)})},async loadScripts(){const e=this.appVars.block_editor_assets.scripts;for(const t in e)try{await this.loadScript(e[t]),console.log(`${t} JS loaded`)}catch(o){this.has_error=!0,console.error(`Failed to load js ${t}:`,o)}this.attach()},loadCSSFile(e){return new Promise((t,o)=>{const u=document.createElement("link");u.rel="stylesheet",u.href=e,u.onload=t,u.onerror=o,document.head.append(u)})},async loadCSSFiles(){const t=this.appVars.block_editor_assets.styles.map(this.loadCSSFile);try{await Promise.all(t),console.log("All CSS files loaded")}catch(o){console.error("Failed to load some CSS files:",o)}}},mounted(){window.fl_block_editor_loaded?this.attach():(this.loadCSSFiles(),this.loadScripts(),window.fl_block_editor_loaded=!0)},beforeUnmount(){window.wp.detachEditor(this.$refs.block_editor)}},gk={class:"fcom_block_editor"};function yk(e,t,o,u,s,n){const m=q;return i(),c("div",gk,[N(l("div",null,[l("textarea",{ref:"block_editor",id:"fcom_block_editor",name:"block_editor"},`
                `+d(s.html)+`
            `,513)],512),[[cs,s.all_loaded]]),s.all_loaded?_("",!0):(i(),v(m,{key:0,class:"white_loaded",rows:7,animated:!0}))])}const vk=F(pk,[["render",yk]]);const bk={name:"FullEditorFrame",emits:["update:modelValue","titleUpdated","featuredMediaUpdated","metaUpdated","manageDocuments","useAlternateEditor"],props:{editorPath:{type:String,default:"/editor"},modelValue:{type:String,default:""},editorParams:{type:Object,default:()=>({})},frameHeight:{type:String,default:"500px"},documentTitle:{type:String,default:""},featured_image_id:{type:[String,Number],default:""},metaSettings:{type:Object,default:()=>null}},data(){return{editorData:{content:""},editorFrame:null,editorOrigin:null,lastUpdate:"No updates yet",dataSent:!1,isFailing:!1}},computed:{notLoading(){return!this.dataSent&&this.isFailing}},mounted(){setTimeout(()=>{this.isFailing=!0},1e4),this.editorData.content=this.modelValue,this.editorData.title=this.documentTitle,this.editorData.featured_image_id=this.featured_image_id,this.metaSettings&&(this.editorData.metaSettings=this.metaSettings),this.createEditorIframe(),window.addEventListener("message",this.handleEditorMessage)},beforeUnmount(){window.removeEventListener("message",this.handleEditorMessage),this.editorFrame&&(this.editorFrame.onload=null,this.$refs.iframeContainer.removeChild(this.editorFrame),this.editorFrame=null)},methods:{createEditorIframe(){const e=new URL(this.editorPath,window.location.origin);this.editorOrigin=e.origin,this.editorFrame=document.createElement("iframe");let t=this.appVars.wp_lesson_editor_frame;if(this.editorParams){const o=new URLSearchParams(this.editorParams);t+="&"+o.toString()}this.editorFrame.src=t,this.editorFrame.style.width="100%",this.editorFrame.style.height=this.frameHeight,this.$refs.iframeContainer.appendChild(this.editorFrame)},editorFailed(){this.$emit("useAlternateEditor")},sendDataToEditor(){if(this.editorFrame&&this.editorFrame.contentWindow){const e=JSON.parse(JSON.stringify(this.editorData));this.editorFrame.contentWindow.postMessage({type:"UPDATE_EDITOR",data:e},"*"),this.dataSent=!0}else alert("Editor frame is not loaded or contentWindow is not accessible.")},syncMetaToEditor(e){this.editorFrame&&this.editorFrame.contentWindow&&this.editorFrame.contentWindow.postMessage({type:"SYNC_META",data:JSON.parse(JSON.stringify(e))},"*")},handleEditorMessage(e){const{action:t,content:o}=e.data;t==="EDITOR_UPDATED"?this.dataSent&&(this.editorData.content=o,this.$emit("update:modelValue",o)):t==="TITLE_UPDATED"?(this.editorData.title=o,this.$emit("titleUpdated",o)):t==="FEATURED_MEDIA_UPDATED"?this.$emit("featuredMediaUpdated",o):t==="META_UPDATED"?this.$emit("metaUpdated",o):t==="MANAGE_DOCUMENTS"?this.$emit("manageDocuments"):t==="EDITOR_READY"&&(console.log("EDITOR_READY"),this.sendDataToEditor())}}},kk=e=>(ht("data-v-03a63740"),e=e(),ft(),e),wk={key:0,style:{display:"flex","justify-content":"center","align-items":"center","column-gap":"10px"}},Ck=kk(()=>l("p",null,"Problem with loading the editor?",-1)),$k=["element-loading-text"],Sk={ref:"iframeContainer",class:"iframe-container"};function Vk(e,t,o,u,s,n){const m=j,p=q,h=K("loading");return i(),c(V,null,[n.notLoading?(i(),c("div",wk,[Ck,a(m,{onClick:t[0]||(t[0]=y=>n.editorFailed())},{default:r(()=>[S("Use Alternative Editor")]),_:1})])):_("",!0),N((i(),c("div",{"element-loading-text":e.$t("Loading editor. Please wait...."),class:"editor-container"},[s.dataSent?_("",!0):(i(),v(p,{key:0,style:{margin:"50px"},animated:!0,rows:2})),l("div",Sk,null,512)],8,$k)),[[h,!s.dataSent]])],64)}const Lk=F(bk,[["render",Vk],["__scopeId","data-v-03a63740"]]),Mk={name:"CircleIcon",props:{fill:{type:String,default:"currentColor"}}},Pk=["fill"],Fk=l("path",{d:"M10 2.5C14.1421 2.5 17.5 5.85786 17.5 10C17.5 14.1421 14.1421 17.5 10 17.5C5.85786 17.5 2.5 14.1421 2.5 10C2.5 5.85786 5.85786 2.5 10 2.5Z",fill:"none",stroke:"currentColor"},null,-1),Tk=[Fk];function Ik(e,t,o,u,s,n){return i(),c("svg",{fill:o.fill,width:"20",height:"20",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},Tk,8,Pk)}const es=F(Mk,[["render",Ik]]),Uk={name:"LessonIcon"},Bk={width:"60",height:"48",viewBox:"0 0 60 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ek=l("rect",{width:"60",height:"48",rx:"4",fill:"#F2F5F8"},null,-1),Ak=l("path",{d:"M30 16.5L21 21.75L30 27L37.5 22.625V28.125H39V21.75L30 16.5ZM23.9993 25.1179V28.5001C25.3676 30.3217 27.5461 31.5001 29.9998 31.5001C32.4535 31.5001 34.6321 30.3217 36.0004 28.5001L36.0001 25.1185L30.0002 28.6184L23.9993 25.1179Z",fill:"#525866"},null,-1),Dk=[Ek,Ak];function Rk(e,t,o,u,s,n){return i(),c("svg",Bk,Dk)}const Gs=F(Uk,[["render",Rk]]),Hk={name:"PlayIcon"},xk={width:"20",height:"19",viewBox:"0 0 20 19",fill:"none",xmlns:"http://www.w3.org/2000/svg"},jk=Ie('<g filter="url(#filter0_d_6543_69201)"><path d="M10 16.5C5.85775 16.5 2.5 13.1422 2.5 9C2.5 4.85775 5.85775 1.5 10 1.5C14.1422 1.5 17.5 4.85775 17.5 9C17.5 13.1422 14.1422 16.5 10 16.5ZM8.9665 6.31125C8.92136 6.28113 8.8689 6.26383 8.8147 6.26117C8.76051 6.25851 8.7066 6.27059 8.65873 6.29615C8.61086 6.3217 8.57082 6.35975 8.54287 6.40626C8.51492 6.45277 8.5001 6.50599 8.5 6.56025V11.4398C8.5001 11.494 8.51492 11.5472 8.54287 11.5937C8.57082 11.6402 8.61086 11.6783 8.65873 11.7039C8.7066 11.7294 8.76051 11.7415 8.8147 11.7388C8.8689 11.7362 8.92136 11.7189 8.9665 11.6888L12.6258 9.24975C12.6669 9.22236 12.7006 9.18524 12.724 9.14166C12.7473 9.09809 12.7595 9.04943 12.7595 9C12.7595 8.95057 12.7473 8.90191 12.724 8.85834C12.7006 8.81476 12.6669 8.77764 12.6258 8.75025L8.96575 6.31125H8.9665Z" fill="white"></path></g><defs><filter id="filter0_d_6543_69201" x="0.5" y="0.5" width="19" height="19" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"></feColorMatrix><feOffset dy="1"></feOffset><feGaussianBlur stdDeviation="1"></feGaussianBlur><feComposite in2="hardAlpha" operator="out"></feComposite><feColorMatrix type="matrix" values="0 0 0 0 0.0392157 0 0 0 0 0.0509804 0 0 0 0 0.0784314 0 0 0 0.03 0"></feColorMatrix><feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_6543_69201"></feBlend><feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_6543_69201" result="shape"></feBlend></filter></defs>',2),Ok=[jk];function Nk(e,t,o,u,s,n){return i(),c("svg",xk,Ok)}const Ys=F(Hk,[["render",Nk]]),zk={name:"PlayPlaceholderIcon"},qk={width:"60",height:"48",viewBox:"0 0 60 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Gk=Ie('<rect width="60" height="48" rx="4" fill="#F2F5F8"></rect><g clip-path="url(#clip0_6463_70077)"><g filter="url(#filter0_d_6463_70077)"><path d="M30 31.5C25.8578 31.5 22.5 28.1423 22.5 24C22.5 19.8578 25.8578 16.5 30 16.5C34.1423 16.5 37.5 19.8578 37.5 24C37.5 28.1423 34.1423 31.5 30 31.5ZM28.9665 21.3112C28.9214 21.2811 28.8689 21.2638 28.8147 21.2612C28.7605 21.2585 28.7066 21.2706 28.6587 21.2961C28.6109 21.3217 28.5708 21.3598 28.5429 21.4063C28.5149 21.4528 28.5001 21.506 28.5 21.5602V26.4398C28.5001 26.494 28.5149 26.5472 28.5429 26.5937C28.5708 26.6402 28.6109 26.6783 28.6587 26.7039C28.7066 26.7294 28.7605 26.7415 28.8147 26.7388C28.8689 26.7362 28.9214 26.7189 28.9665 26.6888L32.6258 24.2498C32.6669 24.2224 32.7006 24.1852 32.724 24.1417C32.7473 24.0981 32.7595 24.0494 32.7595 24C32.7595 23.9506 32.7473 23.9019 32.724 23.8583C32.7006 23.8148 32.6669 23.7776 32.6258 23.7502L28.9658 21.3112H28.9665Z" fill="#525866"></path></g></g><defs><filter id="filter0_d_6463_70077" x="20.5" y="15.5" width="19" height="19" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"></feColorMatrix><feOffset dy="1"></feOffset><feGaussianBlur stdDeviation="1"></feGaussianBlur><feComposite in2="hardAlpha" operator="out"></feComposite><feColorMatrix type="matrix" values="0 0 0 0 0.0392157 0 0 0 0 0.0509804 0 0 0 0 0.0784314 0 0 0 0.03 0"></feColorMatrix><feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_6463_70077"></feBlend><feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_6463_70077" result="shape"></feBlend></filter><clipPath id="clip0_6463_70077"><rect width="20" height="20" fill="white" transform="translate(20 14)"></rect></clipPath></defs>',3),Yk=[Gk];function Zk(e,t,o,u,s,n){return i(),c("svg",qk,Yk)}const Zs=F(zk,[["render",Zk]]),Wk={name:"_LockscreenLessonEditor",components:{CircleIcon:es,LessonIcon:Gs,PlayIcon:Ys,PlayPlaceholderIcon:Zs},props:{sections:{type:Array,required:!0},is_editor:{type:Boolean,default:!1},settings:{type:Object,required:!1}},computed:{lessonsCount(){return this.sections.reduce((e,t)=>e+t.lessons.length,0)},sectionsCount(){return this.sections.reduce((e,t)=>e+(t.lessons.length?1:0),0)},lessonDuration(){return e=>{const t=e.lessons.reduce((o,u)=>o+(u.meta.video_length||0),0);return this.formatSeconds(t)||null}}},methods:{isEnabledMedia(e){var t;return((t=e.meta)==null?void 0:t.enable_media)=="yes"},hasMediaVideo(e){var o;const t=(o=e.meta)==null?void 0:o.media;return this.isEnabledMedia(e)&&(t==null?void 0:t.content_type)=="video"&&(t==null?void 0:t.html)},showPlayIcon(e){return this.hasMediaVideo(e)&&(this.hasMediaImage(e)||e.featured_image)},hasMediaImage(e){var t,o;return this.isEnabledMedia(e)&&((o=(t=e.meta)==null?void 0:t.media)==null?void 0:o.image)},isModernLayout(){var e;return this.has_pro&&((e=this.settings)==null?void 0:e.course_layout)==="modern"},isFreePreview(e){var t;return this.has_pro&&((t=e==null?void 0:e.meta)==null?void 0:t.free_preview_lesson)=="yes"},maybeGotoLesson(e,t){if(!this.is_editor){if(this.isFreePreview(e)){this.gotoLesson(e);return}t.is_locked&&t.unlock_date&&this.$notify.info({message:this.$t("This lesson will be unlocked on %s",t.unlock_date),type:"info"})}},gotoLesson(e){this.$router.push({name:"view_lesson",params:{lesson_slug:e.slug}}),setTimeout(()=>{window.location.reload()},100)},formatSeconds(e){if(e<1)return null;let t=Math.floor(e/3600),o=Math.floor(e%3600/60),u=e%60,s="";return t>0&&(s+=`${t}h `),o>0&&(s+=`${o}m `),u>0&&(s+=`${u}s`),s.trim()||null}}},Jk={class:"fcom_course_sections"},Qk={class:"fcom_course_intro"},Kk={class:"fcom_course_labels"},Xk={class:"fcom_course_info"},e3=l("span",null," ‚Ä¢ ",-1),t3={class:"fcom_card_sections"},s3={class:"fcom_section_items"},o3=["onClick"],i3={class:"fcom_section_primary_item_title"},n3={class:"title_line_container"},l3={class:"title_line"},a3={class:"fcom_meta_text"},r3={key:0,class:"fcom_meta_text"},c3={class:"fcom_section_primary_item_actions"},d3=["onClick"],u3={class:"fcom_heading_item clickable"},_3={class:"lesson_feature_media"},m3=["src","alt"],h3=["src","alt"],f3={class:"lesson_title"},p3=["innerHTML"],g3={class:"lesson_duration"},y3={key:0},v3={key:1},b3=["innerHTML"];function k3(e,t,o,u,s,n){const m=g("ArrowRight"),p=g("ArrowDown"),h=O,y=g("CircleIcon"),k=g("Lock"),b=g("PlayPlaceholderIcon"),$=g("LessonIcon"),f=g("PlayIcon");return i(),c("div",Jk,[l("div",Qk,[l("div",Kk,[l("h3",null,d(e.$t("Course Content")),1),l("p",Xk,[S(d(e.$_n("%s Topic","%s Topics",n.sectionsCount))+" ",1),e3,S(" "+d(e.$_n("%s Lesson","%s Lessons",n.lessonsCount)),1)])])]),l("div",t3,[l("div",s3,[(i(!0),c(V,null,D(o.sections,w=>(i(),c("div",{key:w.id,class:"fcom_section_primary"},[w.lessons.length?(i(),c("div",{key:0,onClick:C=>w.is_closed=!w.is_closed,class:R(["clickable fcom_section_primary_item",{is_closed:w.is_closed}])},[l("div",i3,[l("div",n3,[l("div",l3,[l("h4",null,d(w.title),1)]),l("span",a3,d(e.$t("%d lessons",w.lessons.length)),1),n.lessonDuration(w)?(i(),c("span",r3," ‚Ä¢ "+d(n.lessonDuration(w)),1)):_("",!0)])]),l("div",c3,[a(h,{class:"clickable"},{default:r(()=>[w.is_closed?(i(),v(m,{key:0,class:"fcom_arrow_icon"})):(i(),v(p,{key:1}))]),_:2},1024)])],10,o3)):_("",!0),w.is_closed?_("",!0):(i(!0),c(V,{key:1},D(w.lessons,C=>(i(),c("div",{key:C.id,class:R(["fcom_section_item",{is_locked:!n.isFreePreview(C)}])},[l("div",{onClick:M=>n.maybeGotoLesson(C,w),class:"fcom_section_item_title"},[l("p",u3,[a(h,null,{default:r(()=>[n.isFreePreview(C)?(i(),v(y,{key:0})):(i(),v(k,{key:1}))]),_:2},1024),n.isModernLayout?(i(),c(V,{key:0},[l("span",_3,[C.featured_image?(i(),c("img",{key:0,src:C.featured_image,alt:C.title},null,8,m3)):n.hasMediaImage(C)?(i(),c("img",{key:1,src:C.meta.media.image,alt:C.title},null,8,h3)):n.hasMediaVideo(C)?(i(),v(b,{key:2})):(i(),v($,{key:3})),n.showPlayIcon(C)?(i(),v(f,{key:4,class:"play_icon"})):_("",!0)]),l("span",f3,[l("span",{innerHTML:C.title},null,8,p3),l("span",g3,[C.meta.video_length?(i(),c("span",y3,d(n.formatSeconds(C.meta.video_length)),1)):(i(),c("span",v3,d("---")))])])],64)):(i(),c("span",{key:1,innerHTML:C.title},null,8,b3))])],8,d3)],2))),128))]))),128))])])])}const Ws=F(Wk,[["render",k3]]),w3={name:"LockscreenPaywallView",components:{ImagePlaceholder:Bt},props:{space_id:{type:[String,Number],required:!0},field:{type:Object,required:!0},editable:{type:Boolean,default:!1}},data(){return{loading:!1,availablePaywalls:[]}},computed:{buttonStyles(){return{backgroundColor:this.field.button_color,borderColor:this.field.button_color,color:this.field.button_text_color}},cardStyles(){return{backgroundColor:this.field.background_color||"transparent",color:this.field.text_color||"var(--fcom-primary-text, #2B2E33)"}},filteredPaywalls(){return!Array.isArray(this.field.paywalls)||!Array.isArray(this.availablePaywalls)?[]:this.field.paywalls.map(e=>{for(const t of this.availablePaywalls)if(Array.isArray(t.variants)){const o=t.variants.find(u=>String(u.id)===String(e));if(o)return{...o,description:t.post_excerpt}}return null}).filter(Boolean)}},methods:{isSubscriptionPaywall(e){var t;return((t=e.other_info)==null?void 0:t.payment_type)=="subscription"},getRepeatInterval(e){var u;const t=(u=e.other_info)==null?void 0:u.repeat_interval;return t&&{daily:this.$t("day"),weekly:this.$t("week"),monthly:this.$t("month"),quarterly:this.$t("quarter"),half_yearly:this.$t("half year"),yearly:this.$t("year")}[t]||""},fetchAvailablePaywalls(){if(!this.space_id){this.availablePaywalls=[];return}const e={space_id:this.space_id};this.editable||(e.paywall_ids=this.field.paywalls),this.loading=!0,this.$get("cart/spaces/"+this.space_id+"/paywalls",e).then(t=>{this.availablePaywalls=t.paywalls||[]}).catch(t=>{this.$handleError(t)}).finally(()=>{this.loading=!1})}},mounted(){this.hasFeature("has_fluentcart")&&this.fetchAvailablePaywalls()}},C3={class:"fcom_paywall_cards"},$3={class:"paywall_header"},S3={class:"paywall_body"},V3=["innerHTML"],L3={key:0,class:"subscription"},M3={class:"paywall_footer"},P3={key:0,style:{"margin-bottom":"8px"}},F3=["href"];function T3(e,t,o,u,s,n){const m=q,p=Ot,h=g("ImagePlaceholder");return i(),c("div",C3,[s.loading?(i(),v(m,{key:0,rows:3,animated:!0})):(i(!0),c(V,{key:1},D(n.filteredPaywalls,y=>(i(),c("div",{key:y.id,class:"fcom_paywall",style:re(n.cardStyles)},[l("div",$3,[y.photo?(i(),v(p,{key:0,src:y.photo},null,8,["src"])):(i(),v(p,{key:1},{default:r(()=>[a(h)]),_:1})),l("span",null,d(y.variation_title),1)]),l("div",S3,[l("span",{innerHTML:y.total_price},null,8,V3),n.isSubscriptionPaywall(y)?(i(),c("span",L3,"¬†/ "+d(n.getRepeatInterval(y)),1)):_("",!0)]),l("div",M3,[o.field.show_description=="yes"&&(y!=null&&y.description)?(i(),c("span",P3,d(y.description),1)):_("",!0),o.editable?N((i(),c("input",{key:1,class:"el-button fcom_primary_button link_button",style:re(n.buttonStyles),type:"text","onUpdate:modelValue":t[0]||(t[0]=k=>o.field.button_text=k)},null,4)),[[uo,o.field.button_text]]):(i(),c("a",{key:2,class:"el-button fcom_primary_button link_button",style:re(n.buttonStyles),href:y.checkout_url},d(o.field.button_text),13,F3))])],4))),128))])}const Js=F(w3,[["render",T3]]),I3={name:"LockScreenEditor",props:["title","lockscreen","sections","saving","loading","space_id","settings"],emits:["save","close"],components:{LockscreenLessonEditor:Ws,MediaEmbeder:Zt,BlockEditor:vk,LockscreenMeta:fk,LockscreenPaywallView:Js,FullEditorFrame:Lk},data(){return{editingField:null,useClassic:!1}},computed:{lockscreenFields(){return this.lockscreen.filter(e=>!e.hidden)},imageStyles(){return e=>({backgroundImage:`url(${e.background_image})`,backgroundColor:e.overlay_color})},headingStyles(){return e=>({color:e.heading_color})},descriptionStyles(){return e=>({color:e.text_color})},buttonStyles(){return e=>({backgroundColor:e.button_color,color:e.button_text_color})}},methods:{updateHeading(e,t){t.heading=e.target.innerText},updateDescription(e,t){t.description=e.target.innerText},updateButtonLabel(e,t){t.button_text=e.target.innerText},visibleBlock(e){this.editingField=e},updateEditField(e){this.editingField=e,(e==null?void 0:e.type)==="block"&&setTimeout(()=>{const t=document.getElementById("fcomBlockContent");t&&t.scrollIntoView({behavior:"smooth"})},300)},saveChanges(){this.editingField=null,this.$emit("save")},switchToClassic(){this.useClassic=!0}}},U3={class:"fcom_editor_topbar"},B3={class:"fcom_editor_content"},E3={class:"fcom_item"},A3={class:"fcom_content"},D3=["onBlur"],R3=["onBlur"],H3=["onBlur"],x3={key:1,class:"fcom_content_wrap"},j3={id:"fcomBlockContent"},O3={key:2,class:"fcom_content_wrap"},N3={key:3,class:"fcom_paywall_wrap"};function z3(e,t,o,u,s,n){const m=g("lockscreen-meta"),p=Ne,h=g("Lock"),y=O,k=g("block-editor"),b=g("FullEditorFrame"),$=g("lockscreen-lesson-editor"),f=q,w=g("lockscreen-paywall-view"),C=fe,M=Ce;return i(),c(V,null,[a(p,{class:"fcom_full_editor_side lockscreen_editor",width:"250px"},{default:r(()=>[z(e.$slots,"before_meta"),a(m,{lockscreen:o.lockscreen,space_id:o.space_id,onEditField:n.updateEditField},null,8,["lockscreen","space_id","onEditField"])]),_:3}),a(M,{class:"fcom_full_editor_main lockscreen_editor"},{default:r(()=>[a(C,null,{default:r(()=>[l("div",U3,[a(y,null,{default:r(()=>[a(h)]),_:1}),l("h3",null,d(o.title),1)]),l("div",B3,[(i(!0),c(V,null,D(n.lockscreenFields,P=>{var T;return i(),c("div",E3,[P.type=="image"?(i(),c("div",{key:0,class:"fcom_image_wrap",style:re(n.imageStyles(P))},[l("div",A3,[l("h2",{style:re(n.headingStyles(P)),contenteditable:"true",onBlur:I=>n.updateHeading(I,P)},d(P.heading),45,D3),P.description?(i(),c("p",{key:0,style:re(n.descriptionStyles(P)),contenteditable:"true",onBlur:I=>n.updateDescription(I,P)},d(P.description),45,R3)):_("",!0),P.button_text?(i(),c("button",{key:1,class:"fcom_btn",style:re(n.buttonStyles(P)),contenteditable:"true",onBlur:I=>n.updateButtonLabel(I,P)},d(P.button_text),45,H3)):_("",!0)])],4)):_("",!0),P.type=="block"?(i(),c("div",x3,[l("div",j3,[s.useClassic?(i(),v(k,{key:0,modelValue:P.content,"onUpdate:modelValue":I=>P.content=I},null,8,["modelValue","onUpdate:modelValue"])):(i(),v(b,{key:1,ref_for:!0,ref:"fullEditorFrame",onUseAlternateEditor:n.switchToClassic,editorParams:{context:"lockscreen",space_id:o.space_id},frameHeight:"calc(100vh - 160px)",documentTitle:"",modelValue:P.content,"onUpdate:modelValue":I=>P.content=I},null,8,["onUseAlternateEditor","editorParams","frameHeight","modelValue","onUpdate:modelValue"]))])])):_("",!0),P.type=="lesson"?(i(),c("div",O3,[o.loading?(i(),v(f,{key:1,rows:5,animated:!0})):(i(),v($,{key:0,sections:o.sections,is_editor:!0,settings:o.settings},null,8,["sections","settings"]))])):_("",!0),P.type=="paywall"&&((T=P.paywalls)==null?void 0:T.length)>0?(i(),c("div",N3,[a(w,{space_id:o.space_id,field:P,editable:!0},null,8,["space_id","field"])])):_("",!0)])}),256))])]),_:1})]),_:1})],64)}const q3=F(I3,[["render",z3]]),G3={name:"SpaceLockscreen",props:["spaceProfile","savingCount"],emits:["close"],components:{LockScreenEditor:q3},data(){return{saving:!1,loading:!1,lockscreen:null}},watch:{savingCount(){this.saveChanges()}},methods:{saveChanges(){this.lockscreen&&(this.saving=!0,this.$put("spaces/"+this.spaceProfile.slug+"/lockscreens",{lockscreen:this.lockscreen}).then(e=>{this.$notify.success(e.message)}).catch(e=>{this.$handleError(e)}).finally(()=>{this.saving=!1}))},getLockscreen(){this.loading=!0,this.$get("spaces/"+this.spaceProfile.slug+"/lockscreens").then(e=>{this.lockscreen=e.lockscreen}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})}},mounted(){this.getLockscreen()}},Y3={key:0,class:"fcom_lockscreen_meta"},Z3={class:"fcom_description"},W3={class:"white_loaded"};function J3(e,t,o,u,s,n){const m=g("lock-screen-editor"),p=q,h=Ce;return s.lockscreen?(i(),v(m,{key:0,title:o.spaceProfile.title,space_id:o.spaceProfile.id,settings:o.spaceProfile.settings,lockscreen:s.lockscreen,saving:s.saving,loading:s.loading,onSave:n.saveChanges,onClose:t[0]||(t[0]=y=>e.$emit("close"))},{before_meta:r(()=>[o.spaceProfile.settings.custom_lock_screen!="yes"?(i(),c("div",Y3,[l("div",Z3,[l("p",null,d(e.$t("__LOCK_SCRREN_DESC")),1)])])):_("",!0)]),_:1},8,["title","space_id","settings","lockscreen","saving","loading","onSave"])):s.loading?(i(),v(h,{key:1,class:"fcom_full_editor_main lockscreen_editor"},{default:r(()=>[l("div",W3,[a(p,{animated:!0,rows:10})])]),_:1})):_("",!0)}const Q3=F(G3,[["render",J3]]),K3={name:"ManageSpaceLinks",components:{MenuGroupSettings:qs},props:["spaceProfile","savingCount"],emits:["close"],data(){return{saving:!1}},watch:{savingCount(){this.saveMenuItems(!0)}},methods:{saveMenuItems(e=!1){this.saving=!0;let t="spaces/"+this.spaceProfile.slug+"/links";this.spaceProfile.type=="course"&&(t="admin/courses/"+this.spaceProfile.id+"/links"),this.$post(t,{links:this.spaceProfile.settings.links,space_id:this.spaceProfile.id}).then(o=>{this.$notify.success(o.message),this.spaceProfile.settings.links=o.links,e&&this.$emit("close")}).catch(o=>{this.$handleError(o)}).finally(()=>{this.saving=!1})}}},X3={style:{"max-width":"800px",padding:"20px",margin:"0 auto"}},ew={class:"fcom_card_sections"};function tw(e,t,o,u,s,n){const m=g("menu-group-settings"),p=fe,h=Ce;return i(),v(h,{class:"fcom_full_editor_main lockscreen_editor"},{default:r(()=>[a(p,null,{default:r(()=>[l("div",X3,[l("div",ew,[a(m,{custom_svg:!0,use_icon_selector:!0,has_svg:!1,onSave:t[0]||(t[0]=y=>n.saveMenuItems()),title:e.$t("Manage Links"),menuItems:o.spaceProfile.settings.links},null,8,["title","menuItems"])])])]),_:1})]),_:1})}const sw=F(K3,[["render",tw]]),ow={name:"AddPaywallModal",props:{modelValue:{type:Boolean,default:!1},spaceProfile:{type:Object,required:!0}},emits:["update:modelValue","added"],data(){return{products:[],productID:null,saving:!1,creatingProduct:!1,fetchingProducts:!1,newPaywall:{title:"",price:0}}},computed:{addPaywallModal:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}},methods:{isProductAdded(e){var t,o;return(o=(t=this.spaceProfile.settings)==null?void 0:t.cart_product_ids)==null?void 0:o.includes(e)},initCreateProduct(){this.productID=null,this.newPaywall={title:"",price:0}},createProduct(){var e,t;this.creatingProduct=!0,this.$post("cart/products/create",{title:(e=this.newPaywall)==null?void 0:e.title,price:(t=this.newPaywall)==null?void 0:t.price}).then(o=>{var u;this.products.push(o.product),this.productID=(u=o.product)==null?void 0:u.id,this.productID&&this.addPaywall()}).catch(o=>{this.$handleError(o)}).finally(()=>{this.creatingProduct=!1})},searchProducts(e=""){e&&e.length<3||this.fetchProducts(e)},fetchProducts(e=""){this.fetchingProducts=!0,this.$get("cart/products/search",{search:e}).then(t=>{this.products=t.products}).catch(t=>{this.$handleError(t)}).finally(()=>{this.fetchingProducts=!1})},addPaywall(){this.saving=!0,this.$post("cart/spaces/"+this.spaceProfile.id+"/paywalls",{cart_product_id:this.productID,space_id:this.spaceProfile.id}).then(e=>{var t;this.$notify.success(e.message),this.$emit("added",(t=e.paywall)==null?void 0:t.ID),this.addPaywallModal=!1}).catch(e=>{this.$handleError(e)}).finally(()=>{this.saving=!1})}},mounted(){this.fetchProducts()}},iw={class:"fcom_topic_selector"},nw={class:"fcom_select_photo",style:{float:"left"}},lw=["src","alt"],aw=["innerHTML"];function rw(e,t,o,u,s,n){const m=ie,p=ne,h=g("Plus"),y=O,k=j,b=ee,$=ue,f=_e,w=de,C=$t,M=K("loading");return i(),v(C,{"modal-class":"fcom_common_dialog",class:"fcom_high_drawer",size:e.drawerWidth,modelValue:n.addPaywallModal,"onUpdate:modelValue":t[6]||(t[6]=P=>n.addPaywallModal=P),"close-on-click-modal":!1,visible:n.addPaywallModal,direction:"rtl"},{header:r(()=>[l("h4",null,d(e.$t("Add Paywall")),1)]),default:r(()=>[a(f,{onSubmit:t[5]||(t[5]=Z(P=>e.doNothing(),["prevent"])),"label-position":"top"},{default:r(()=>[a($,null,{default:r(()=>[l("div",iw,[N((i(),v(p,{style:{width:"100%"},modelValue:s.productID,"onUpdate:modelValue":t[0]||(t[0]=P=>s.productID=P),filterable:"",clearable:"",remote:"",loading:s.fetchingProducts,"remote-method":n.searchProducts,placeholder:e.$t("Search Product")},{default:r(()=>[(i(!0),c(V,null,D(s.products,P=>(i(),v(m,{key:P.id,label:P.title,value:P.id,disabled:n.isProductAdded(P.id),class:"fcom_with_photo_option"},{default:r(()=>[l("span",nw,[l("img",{src:P.image,alt:P.title},null,8,lw),l("span",null,d(P.title),1)]),l("span",{style:{float:"right",color:"#8492a6","font-size":"13px"},innerHTML:P.price},null,8,aw)]),_:2},1032,["label","value","disabled"]))),128))]),_:1},8,["modelValue","loading","remote-method","placeholder"])),[[M,s.fetchingProducts]]),a(w,{ref:"creating_product_ref",onShow:n.initCreateProduct,placement:"bottom",width:400,trigger:"click"},{reference:r(()=>[a(k,{class:"fcom_secondary_button"},{default:r(()=>[a(y,null,{default:r(()=>[a(h)]),_:1}),l("span",null,d(e.$t("New")),1)]),_:1})]),default:r(()=>[a(f,{modelValue:s.newPaywall,"onUpdate:modelValue":t[4]||(t[4]=P=>s.newPaywall=P),"label-position":"top"},{default:r(()=>[a($,{label:e.$t("Title")},{default:r(()=>[a(b,{modelValue:s.newPaywall.title,"onUpdate:modelValue":t[1]||(t[1]=P=>s.newPaywall.title=P),placeholder:e.$t("Title of the product")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a($,{label:e.$t("Price")},{default:r(()=>[a(b,{modelValue:s.newPaywall.price,"onUpdate:modelValue":t[2]||(t[2]=P=>s.newPaywall.price=P),type:"number",placeholder:e.$t("Price of the product"),min:0},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a($,null,{default:r(()=>[a(k,{class:"fcom_primary_button",onClick:t[3]||(t[3]=P=>n.createProduct()),loading:s.creatingProduct,disabled:s.creatingProduct},{default:r(()=>[S(d(e.$t("Create")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["onShow"])])]),_:1}),a($,null,{default:r(()=>[a(k,{class:"fcom_primary_button",loading:s.saving,onClick:n.addPaywall},{default:r(()=>[S(d(e.$t("Add")),1)]),_:1},8,["loading","onClick"])]),_:1})]),_:1})]),_:1},8,["size","modelValue","visible"])}const cw=F(ow,[["render",rw]]),dw={name:"ManagePaywalls",components:{ImagePlaceholder:Bt,AddPaywallModal:cw},props:["spaceProfile","savingCount"],emits:["close"],data(){return{paywalls:[],loading:!1,removing:!1,addPaywallModal:!1,removePaywallModal:!1,revokeAccess:!1,removePaywall:null,installing:!1,hasFluentCart:this.hasFeature("has_fluentcart")}},computed:{spaceType(){return this.spaceProfile.type=="course"?this.$t("courses"):this.$t("spaces")}},methods:{copyCheckoutUrl(e){this.$toClipboard(e,this.$t("Checkout URL copied to clipboard"))},initRemovePaywall(e){this.$nextTick(()=>{this.removePaywallModal=!0,this.removePaywall=e})},initAddPaywall(){this.$nextTick(()=>{this.addPaywallModal=!0})},resetPaywall(){var t;const e=((t=this.spaceProfile.settings)==null?void 0:t.cart_product_ids)||[];e.splice(e.indexOf(this.removePaywall.ID),1),this.spaceProfile.settings.cart_product_ids=e,this.removePaywall=null,this.revokeAccess=!1,this.getPaywalls()},paywallAdded(e){var o;const t=((o=this.spaceProfile.settings)==null?void 0:o.cart_product_ids)||[];t.includes(e)||t.push(e),this.spaceProfile.settings.cart_product_ids=t,this.getPaywalls()},getPaywalls(){this.loading=!0,this.$get("cart/spaces/"+this.spaceProfile.id+"/paywalls",{space_id:this.spaceProfile.id}).then(e=>{this.paywalls=e.paywalls}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})},deletePaywall(){this.removing=!0,this.$del("cart/spaces/"+this.spaceProfile.id+"/paywalls",{cart_product_id:this.removePaywall.ID,revoke_access:this.revokeAccess}).then(e=>{this.$notify.success(e.message),this.removePaywallModal=!1,this.resetPaywall()}).catch(e=>{this.$handleError(e)}).finally(()=>{this.removing=!1})},installPlugin(){this.installing=!0,this.$post("settings/install_plugin",{plugin:"fluent-cart"}).then(e=>{e.is_installed?this.$notify.success(e.message):this.$handleError(this.$t("Sorry, FluentCart could not be installed")),this.hasFluentCart=!0,this.getPaywalls()}).catch(e=>{this.$handleError(e)}).finally(()=>{this.installing=!1})}},mounted(){var t;(((t=this.spaceProfile.settings)==null?void 0:t.cart_product_ids)||[])&&this.hasFluentCart&&this.getPaywalls()}},uw={style:{"max-width":"800px",padding:"20px",margin:"0 auto"}},_w={class:"fcom_card_sections"},mw={class:"fcom_card_section_heading"},hw={class:"fcom_section_primary_item_title"},fw={class:"fcom_heading_item"},pw={key:0,class:"fcom_section_item_actions"},gw={class:"fcom_section_primary"},yw={class:"fcom_section_primary_item"},vw={class:"fcom_section_primary_item_title"},bw={class:"fcom_heading_item"},kw={class:"fcom_shape"},ww={class:"fcom_section_item_actions"},Cw=["href"],$w=["href"],Sw={class:"fcom_section_items"},Vw={class:"fcom_section_item_title"},Lw={class:"fcom_heading_item"},Mw={class:"fcom_shape"},Pw={class:"fcom_section_item_actions"},Fw=["innerHTML"],Tw={key:2,style:{padding:"1rem"}},Iw={key:1,class:"fcom_section_item"},Uw={class:"fcom_section_primary"},Bw={class:"fcom_section_primary_item"},Ew=["disabled"],Aw={class:"dialog_header"},Dw={class:"dialog_left"},Rw={class:"dialog_body"},Hw={style:{"text-align":"center"}},xw={class:"fcom_heading_item",style:{"justify-content":"center"}},jw={class:"fcom_shape"},Ow={style:{margin:"1rem 0px 0.8rem"}},Nw={class:"dialog_footer"};function zw(e,t,o,u,s,n){const m=j,p=q,h=Ot,y=g("MoreFilled"),k=O,b=ot,$=it,f=nt,w=g("ImagePlaceholder"),C=fe,M=Ce,P=g("AddPaywallModal"),T=he,I=ye,U=K("loading");return i(),c(V,null,[a(M,{class:"fcom_full_editor_main lockscreen_editor"},{default:r(()=>[a(C,null,{default:r(()=>[l("div",uw,[l("div",_w,[l("div",mw,[l("div",hw,[l("div",fw,[z(e.$slots,"title",{},()=>[l("h4",null,d(e.$t("Manage Paywalls")),1)])])]),s.hasFluentCart?(i(),c("div",pw,[a(m,{class:"fcom_primary_button",onClick:t[0]||(t[0]=B=>n.initAddPaywall())},{default:r(()=>[S(d(e.$t("Add Paywall")),1)]),_:1})])):_("",!0)]),s.hasFluentCart?(i(),c(V,{key:0},[s.loading||s.removing?(i(),v(p,{key:0,class:"white_loaded",rows:5,animated:!0})):s.paywalls.length?(i(!0),c(V,{key:1},D(s.paywalls,B=>(i(),c("div",{class:"fcom_section_item",key:B.ID},[l("div",gw,[l("div",yw,[l("div",vw,[l("h4",bw,[l("span",kw,[a(h,{src:B==null?void 0:B.thumbnail},null,8,["src"])]),l("span",null,d((B==null?void 0:B.post_title)||""),1)])]),l("div",ww,[a(f,{trigger:"click","popper-class":"fcom_pop_action"},{dropdown:r(()=>[a($,null,{default:r(()=>[a(b,null,{default:r(()=>[l("a",{href:B==null?void 0:B.view_url,target:"_blank",rel:"noopener"},d(e.$t("View Product")),9,Cw)]),_:2},1024),a(b,null,{default:r(()=>[l("a",{href:B==null?void 0:B.admin_url,target:"_blank",rel:"noopener"},d(e.$t("Edit Product")),9,$w)]),_:2},1024),a(b,{type:"danger",onClick:A=>n.initRemovePaywall(B)},{default:r(()=>[S(d(e.$t("Delete Paywall")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),default:r(()=>[a(m,{"aria-label":e.$t("View actions"),size:"small",class:"fcom_dot_menu",text:""},{default:r(()=>[a(k,null,{default:r(()=>[a(y)]),_:1})]),_:1},8,["aria-label"])]),_:2},1024)])]),l("div",Sw,[(i(!0),c(V,null,D(B.variants,A=>(i(),c("div",{class:"fcom_section_item",key:A.id},[l("div",Vw,[l("div",Lw,[l("span",Mw,[A.photo?(i(),v(h,{key:0,src:A.photo},null,8,["src"])):(i(),v(h,{key:1},{default:r(()=>[a(w)]),_:1}))]),l("span",null,d(A.variation_title),1)])]),l("div",Pw,[l("span",{class:"fcom_price",innerHTML:A.total_price},null,8,Fw),a(f,{trigger:"click"},{dropdown:r(()=>[a($,null,{default:r(()=>[a(b,{onClick:L=>n.copyCheckoutUrl(A.checkout_url)},{default:r(()=>[S(d(e.$t("Copy Checkout URL")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),default:r(()=>[a(m,{"aria-label":e.$t("View actions"),size:"small",class:"fcom_dot_menu",text:"",style:{padding:"0 6px"}},{default:r(()=>[a(k,null,{default:r(()=>[a(y)]),_:1})]),_:1},8,["aria-label"])]),_:2},1024)])]))),128))])])]))),128)):(i(),c("div",Tw,[l("p",null,d(e.$t("No paywall has been added yet")),1)]))],64)):(i(),c("div",Iw,[l("div",Uw,[l("div",Bw,[l("span",null,[S(d(e.$t("To monetize your ")+n.spaceType+", ")+" ",1),N((i(),c("a",{disabled:s.installing,onClick:t[1]||(t[1]=(...B)=>n.installPlugin&&n.installPlugin(...B)),class:"fcom_link"},[S(d(e.$t("click here")),1)],8,Ew)),[[U,s.installing]]),S(" "+d(e.$t("to install and activate FluentCart.")),1)])])])]))])])]),_:3})]),_:3}),s.addPaywallModal?(i(),v(P,{key:0,modelValue:s.addPaywallModal,"onUpdate:modelValue":t[2]||(t[2]=B=>s.addPaywallModal=B),spaceProfile:o.spaceProfile,onAdded:n.paywallAdded},null,8,["modelValue","spaceProfile","onAdded"])):_("",!0),a(I,{"modal-class":"fcom_common_dialog","close-on-click-modal":!1,"append-to-body":!0,width:e.drawerWidth,modelValue:s.removePaywallModal,"onUpdate:modelValue":t[5]||(t[5]=B=>s.removePaywallModal=B),direction:"rtl",onClose:t[6]||(t[6]=B=>s.removePaywallModal=!1)},{header:r(()=>[l("div",Aw,[l("div",Dw,[l("h4",null,d(e.$t("Delete Paywall")),1)])])]),footer:r(()=>[l("div",Nw,[a(m,{class:"fcom_primary_button",disabled:s.removing,onClick:n.deletePaywall},{default:r(()=>[S(d(e.$t("Delete")),1)]),_:1},8,["disabled","onClick"]),a(m,{class:"fcom_secondary_button",onClick:t[4]||(t[4]=B=>s.removePaywallModal=!1)},{default:r(()=>[S(d(e.$t("Cancel")),1)]),_:1})])]),default:r(()=>{var B,A;return[l("div",Rw,[l("div",Hw,[l("h4",xw,[l("span",jw,[a(h,{src:(B=s.removePaywall)==null?void 0:B.thumbnail},null,8,["src"])]),l("span",null,d((A=s.removePaywall)==null?void 0:A.post_title),1)]),l("p",Ow,d(e.$t("Are you sure you want to delete this paywall? This action cannot be undone.")),1),a(T,{modelValue:s.revokeAccess,"onUpdate:modelValue":t[3]||(t[3]=L=>s.revokeAccess=L),"true-value":"yes","false-value":"no"},{default:r(()=>[S(d(e.$t("Also remove the this space from the product integration?")),1)]),_:1},8,["modelValue"])])])]}),_:1},8,["width","modelValue"])],64)}const qw=F(dw,[["render",zw]]),Gw={name:"SpaceCustomizer",props:["space_profile"],emits:["close","completed"],components:{SpaceLockscreen:Q3,CreateSpaceForm:It,ManageSpaceLinks:sw,ManagePaywalls:qw},data(){return{saving:!1,currentTab:"general",savingCount:0,hasPro:window.fluentComAdmin.pro}},methods:{saveChanges(){if(!this.hasPro&&this.currentTab=="lock_screen"){this.$notify({title:this.$t("Pro Required"),message:this.$t("This feature is only available in the pro version."),type:"error"});return}this.savingCount=this.savingCount+1}},mounted(){this.$router.push({query:{...this.$route.query,customize_space:1}})},unmounted(){const e={...this.$route.query};delete e.customize_space,this.$router.push({query:e})}},Yw={key:0,class:"fcom_full_editor"},Zw={class:"fcom_full_editor_header fcom_space_settings_nav"},Ww={class:"fcom_editor_menu object_menu"},Jw={class:"fcom_space_menu_ul"},Qw={class:"full_editor_actions"},Kw={style:{"max-width":"800px",margin:"0 auto"},class:"fcom_full_editor_content"};function Xw(e,t,o,u,s,n){const m=g("ArrowLeft"),p=O,h=j,y=bs,k=g("create-space-form"),b=fe,$=Ce,f=g("space-lockscreen"),w=g("manage-space-links"),C=g("manage-paywalls"),M=De;return o.space_profile?(i(),c("div",Yw,[a(M,null,{default:r(()=>[a(y,{class:"fcom_full_editor_header_wrap"},{default:r(()=>{var P;return[l("div",Zw,[l("div",{onClick:t[0]||(t[0]=T=>e.$emit("completed")),class:"fcom_back_header"},[a(p,null,{default:r(()=>[a(m)]),_:1}),S(" "+d(o.space_profile.title),1)]),l("div",Ww,[l("ul",Jw,[l("li",{onClick:t[1]||(t[1]=T=>s.currentTab="general")},[l("a",{class:R({"router-link-exact-active":s.currentTab==="general"}),href:"#"},d(e.$t("General Settings")),3)]),l("li",{onClick:t[2]||(t[2]=T=>s.currentTab="paywalls")},[l("a",{class:R({"router-link-exact-active":s.currentTab==="paywalls"}),href:"#"},d(e.$t("Paywalls")),3)]),o.space_profile.privacy=="private"&&((P=o.space_profile.settings)==null?void 0:P.custom_lock_screen)=="yes"?(i(),c("li",{key:0,onClick:t[3]||(t[3]=T=>s.currentTab="lock_screen")},[l("a",{class:R({"router-link-exact-active":s.currentTab==="lock_screen"}),href:"#"},d(e.$t("Lock Screen")),3)])):_("",!0),l("li",{onClick:t[4]||(t[4]=T=>s.currentTab="manage_links")},[l("a",{class:R({"router-link-exact-active":s.currentTab==="manage_links"}),href:"#"},d(e.$t("Space Links")),3)])])]),l("div",Qw,[a(h,{class:"fcom_primary_button",disabled:s.saving,loading:s.saving,onClick:n.saveChanges},{default:r(()=>[S(d(!s.hasPro&&s.currentTab=="lock_screen"?e.$t("Save Changes (Pro Required)"):e.$t("Save Changes")),1)]),_:1},8,["disabled","loading","onClick"]),a(h,{onClick:t[5]||(t[5]=T=>e.$emit("completed")),text:""},{default:r(()=>[S(" X ")]),_:1})])])]}),_:1}),a(M,{class:"fcom_full_editor_container editor_customizer_container"},{default:r(()=>[s.currentTab=="general"?(i(),v($,{key:0,class:"fcom_full_editor_main lockscreen_editor"},{default:r(()=>[a(b,null,{default:r(()=>[l("div",Kw,[a(k,{savingCount:s.savingCount,community:o.space_profile},null,8,["savingCount","community"])])]),_:1})]),_:1})):s.currentTab=="lock_screen"?(i(),v(f,{key:1,savingCount:s.savingCount,onClose:t[6]||(t[6]=P=>e.$emit("close")),spaceProfile:o.space_profile},null,8,["savingCount","spaceProfile"])):s.currentTab=="manage_links"?(i(),v(w,{key:2,savingCount:s.savingCount,onClose:t[7]||(t[7]=P=>e.$emit("close")),spaceProfile:o.space_profile},null,8,["savingCount","spaceProfile"])):s.currentTab=="paywalls"?(i(),v(C,{key:3,savingCount:s.savingCount,onClose:t[8]||(t[8]=P=>e.$emit("close")),spaceProfile:o.space_profile},null,8,["savingCount","spaceProfile"])):_("",!0)]),_:1})]),_:1})])):_("",!0)}const e8=F(Gw,[["render",Xw]]),t8={name:"SpaceMenu",emits:["refetch","doSearch"],components:{ImageUploader:Re,SpaceMenuItems:Lb,SpaceCustomizer:e8},setup(){return{spaceStore:je()}},props:{space:{type:String,required:!0},space_profile:{required:!1}},data(){return{joining:!1,updating:!1,editLockscreen:!1,search_term:this.$route.query.search||"",SearchIcon:pt(Ve),customizeSpace:!1,drawerVisible:!1}},computed:{profile(){return this.space_profile?(this.search="",this.space_profile):{title:".......",slug:"..",cover_photo:this.appVars.assets_url+"images/placeholer.png",permissions:{}}},showActions(){return this.auth.user_id&&(this.profile.membership||this.isAdmin())},isMod(){return this.profile.permissions.community_moderator}},methods:{async join(){this.joining=!0;try{const e=await this.spaceStore.joinSpace(this.space,this.space_profile);this.appVars.user_membership_slugs.push(this.space),this.$notify.success(this.$t("Successfully joined the space")),this.profile.membership=e.user_status,this.$emit("refetch"),this.$eventBus.emit("reloadMenu")}catch(e){this.$handleError(e)}finally{this.joining=!1}},async leave(){try{await this.$confirm(this.$t("Are you sure you want to leave this community?"),this.$t("Leave Space"),{confirmButtonText:this.$t("Leave Space"),cancelButtonText:this.$t("Cancel"),confirmButtonClass:"fcom_primary_button",cancelButtonClass:"fcom_secondary_button",type:"warning"}),this.joining=!0;try{await this.spaceStore.leaveSpace(this.space);const e=this.appVars.user_membership_slugs.indexOf(this.space);e!==-1&&this.appVars.user_membership_slugs.splice(e,1),this.$notify.success(this.$t("Successfully left the space")),this.profile.membership=null,this.$emit("refetch"),this.$eventBus.emit("leaveCommunity",this.space),this.$eventBus.emit("reloadMenu")}catch(e){this.$handleError(e)}finally{this.joining=!1}}catch{}},initDeleteSpace(){this.$refs.space_actions.hide(),this.$confirm(this.$t("Are you sure you want to delete this space?"),this.$t("Warning"),{confirmButtonText:this.$t("Yes, Delete the Space"),cancelButtonText:this.$t("No"),confirmButtonClass:"fcom_primary_button",cancelButtonClass:"fcom_secondary_button",type:"warning"}).then(()=>{this.$promt(this.$t("Please Type %s to confirm. Please note, all the posts, comments, activities of this Space will be delete.",'"DELETE"'),this.$t("Delete Space"),{confirmButtonText:this.$t("Confirm Delete"),cancelButtonText:this.$t("Cancel"),confirmButtonClass:"fcom_primary_button",cancelButtonClass:"fcom_secondary_button"}).then(e=>{e.value==="DELETE"?this.deleteSpace():this.$notify.error(this.$t("The verification string does not match"))})})},deleteSpace(){this.$del("spaces/"+this.space_profile.slug).then(e=>{this.$notify.success(e.message),this.$router.push({name:"all_feeds"}),this.$eventBus.emit("reloadMenu")}).catch(e=>{this.$handleError(e)})},initEdit(){this.customizeSpace=!0},performSearch(){this.$eventBus.emit("doGlobalSearch",this.search_term)}},mounted(){this.$eventBus.on("doGlobalSearch",e=>{this.search_term=e}),this.$route.query.customize_space&&(this.customizeSpace=!0)}},s8={class:"space_header"},o8={class:"object_menu"},i8={key:0,class:"menu_actions"},n8=["href"],l8={class:"actions_items"},a8=l("li",{class:"fcom_li_separator"},null,-1),r8={key:0};function c8(e,t,o,u,s,n){const m=g("space-menu-items"),p=j,h=g("MoreFilled"),y=O,k=de,b=g("space-customizer"),$=K("loading");return i(),c(V,null,[N((i(),c("div",s8,[l("div",o8,[a(m,{space:o.space,profile:n.profile,class:"fcom_desktop_only"},null,8,["space","profile"]),n.profile.id?(i(),c("div",i8,[e.auth.user_id?n.profile.membership?_("",!0):(i(),v(p,{key:1,disabled:s.joining,loading:s.joining,onClick:t[0]||(t[0]=f=>n.join()),class:"fcom_primary_button"},{default:r(()=>[S(d(e.$t("Join")),1)]),_:1},8,["disabled","loading"])):(i(),c("a",{key:0,href:e.getCurrentAuthUrl(),class:"el-button fcom_primary_button fcom_join_space_auth"},d(e.$t("Join")),9,n8)),n.showActions?(i(),v(k,{key:2,persistent:!1,ref:"space_actions",placement:"bottom",width:200,trigger:"click"},{reference:r(()=>[a(p,{"aria-label":e.$t("View actions"),class:"fcom_dot_menu",size:"small",text:""},{default:r(()=>[a(y,null,{default:r(()=>[a(h)]),_:1})]),_:1},8,["aria-label"])]),default:r(()=>[a(m,{space:o.space,profile:n.profile,class:"fcom_linked_menus fcom_sm_only"},null,8,["space","profile"]),l("ul",l8,[e.hasSpaceAdminAccess(n.profile)?(i(),c(V,{key:0},[l("li",{onClick:t[1]||(t[1]=()=>{n.initEdit(),e.$refs.space_actions.hide()})},d(e.$t("Space Settings")),1),a8],64)):_("",!0),n.profile.membership?(i(),c("li",{key:1,onClick:t[2]||(t[2]=()=>{e.$refs.space_actions.hide(),n.leave()})},d(e.$t("Leave Space")),1)):_("",!0),e.isAdmin()?(i(),c("li",{key:2,onClick:t[3]||(t[3]=(...f)=>n.initDeleteSpace&&n.initDeleteSpace(...f))},d(e.$t("Delete")),1)):_("",!0)])]),_:1},512)):_("",!0)])):_("",!0)])])),[[$,s.updating]]),s.customizeSpace&&o.space_profile?(i(),c("div",r8,[(i(),v(Qe,{to:"body"},[a(b,{space_profile:o.space_profile,onClose:t[4]||(t[4]=f=>s.customizeSpace=null),onCompleted:t[5]||(t[5]=f=>{s.customizeSpace=!1,e.$emit("refetch")})},null,8,["space_profile"])]))])):_("",!0)],64)}const Qs=F(t8,[["render",c8]]),d8={name:"AboutSpace",components:{RecentActivities:Ut},props:["space_profile","has_permission"],data(){return{privacies:Bs}}},u8={class:"fcom_main_side_wrap"},_8={role:"region","aria-label":"About Space",class:"app_side_widget widget_recent_activities"},m8={class:"widget_header"},h8={key:0,class:"widget_body"},f8=["innerHTML"],p8={class:"space_meta"},g8={class:"space_meta_item"},y8={class:"meta_label"},v8={class:"meta_desc"};function b8(e,t,o,u,s,n){var k,b,$;const m=g("Guide"),p=O,h=q,y=g("recent-activities");return i(),c("div",u8,[l("div",_8,[l("div",m8,[l("h3",null,d(e.$t("About")),1)]),o.space_profile?(i(),c("div",h8,[l("div",{class:"space_description",innerHTML:o.space_profile.description_rendered},null,8,f8),l("div",p8,[l("div",g8,[l("div",y8,[a(p,null,{default:r(()=>[a(m)]),_:1}),l("span",null,d((k=s.privacies[o.space_profile.privacy])==null?void 0:k.label),1)]),l("div",v8,d((b=s.privacies[o.space_profile.privacy])==null?void 0:b.space_description),1)])])])):(i(),v(h,{key:1,animated:!0}))]),o.space_profile&&o.has_permission?(i(),v(y,{key:0,with_pins:!0,with_pending_count:!0,widget_title:e.$t("Recent Space Activities"),context:{type:"space",space_slug:($=o.space_profile)==null?void 0:$.slug,space_id:o.space_profile.id}},null,8,["widget_title","context"])):_("",!0)])}const Ks=F(d8,[["render",b8]]),k8={name:"CustomLockscreenView",props:["profile","sections"],components:{LockscreenLessonEditor:Ws,LockscreenPaywallView:Js},computed:{lockscreenFields(){var e,t;return(t=(e=this.profile)==null?void 0:e.lockscreen_config.lockScreen)==null?void 0:t.filter(o=>!o.hidden)},buttonLink(){return e=>e.button_link||"javascript:void(0)"},imageStyles(){return e=>({backgroundImage:`url(${e.background_image})`,backgroundColor:e.overlay_color})},headingStyles(){return e=>({color:e.heading_color})},descriptionStyles(){return e=>({color:e.text_color})},buttonStyles(){return e=>({backgroundColor:e.button_color,color:e.button_text_color})}}},w8={class:"fcom_custom_lockscreen"},C8={class:"fcom_lockscreen_content"},$8={class:"fcom_item"},S8={class:"fcom_content"},V8=["href","target"],L8={key:1,class:"fcom_content_wrap"},M8=["innerHTML"],P8={key:2,class:"fcom_content_wrap"},F8={key:3,class:"fcom_paywall_wrap"};function T8(e,t,o,u,s,n){const m=g("lockscreen-lesson-editor"),p=g("lockscreen-paywall-view");return i(),c("div",w8,[l("div",C8,[(i(!0),c(V,null,D(n.lockscreenFields,h=>{var y;return i(),c("div",$8,[h.type=="image"?(i(),c("div",{key:0,class:"fcom_image_wrap",style:re(n.imageStyles(h))},[l("div",S8,[l("h2",{style:re(n.headingStyles(h))},d(h.heading),5),l("p",{style:re(n.descriptionStyles(h))},d(h.description),5),h.button_text?(i(),c("a",{key:0,class:"fcom_btn",href:n.buttonLink(h),style:re(n.buttonStyles(h)),target:h.new_tab=="yes"?"_blank":"_self"},d(h.button_text),13,V8)):_("",!0)])],4)):_("",!0),h.type=="block"&&h.content?(i(),c("div",L8,[l("div",{class:"fcom_custom_editor_html",innerHTML:h.content},null,8,M8)])):_("",!0),h.type=="lesson"?(i(),c("div",P8,[a(m,{sections:o.sections,settings:o.profile.settings},null,8,["sections","settings"])])):_("",!0),h.type=="paywall"&&((y=h.paywalls)==null?void 0:y.length)>0?(i(),c("div",F8,[a(p,{space_id:o.profile.id,field:h},null,8,["space_id","field"])])):_("",!0)])}),256))])])}const Xs=F(k8,[["render",T8]]),I8={name:"DefaultLockscreenPaywall",components:{ImagePlaceholder:Bt},props:{space_id:{type:[String,Number],required:!0}},data(){return{loading:!1,availablePaywalls:[]}},methods:{isSubscriptionPaywall(e){var t;return((t=e.other_info)==null?void 0:t.payment_type)=="subscription"},getRepeatInterval(e){var u;const t=(u=e.other_info)==null?void 0:u.repeat_interval;return{daily:this.$t("day"),weekly:this.$t("week"),monthly:this.$t("month"),yearly:this.$t("year")}[t]||""},fetchAvailablePaywalls(){this.loading=!0,this.$get("cart/spaces/"+this.space_id+"/paywalls",{space_id:this.space_id}).then(e=>{this.availablePaywalls=e.paywalls||[]}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})}},mounted(){this.fetchAvailablePaywalls()}},U8={class:"space_default_lock_box fcom_paywall_cards"},B8={class:"paywall_header"},E8={class:"paywall_body"},A8=["innerHTML"],D8={key:0,class:"subscription"},R8={class:"paywall_footer"},H8={key:0,style:{"margin-bottom":"8px"}},x8=["href"];function j8(e,t,o,u,s,n){const m=q,p=Ot,h=g("ImagePlaceholder");return i(),c("div",U8,[s.loading?(i(),v(m,{key:0,rows:3,animated:!0})):(i(!0),c(V,{key:1},D(s.availablePaywalls,y=>(i(),c(V,{key:y.ID},[(i(!0),c(V,null,D(y.variants,k=>(i(),c("div",{key:k.id,class:"fcom_paywall"},[l("div",B8,[k.photo?(i(),v(p,{key:0,src:k.photo},null,8,["src"])):(i(),v(p,{key:1},{default:r(()=>[a(h)]),_:1})),l("span",null,d(k.variation_title),1)]),l("div",E8,[l("span",{innerHTML:k.total_price},null,8,A8),n.isSubscriptionPaywall(k)?(i(),c("span",D8,"¬†/ "+d(n.getRepeatInterval(k)),1)):_("",!0)]),l("div",R8,[k!=null&&k.description?(i(),c("span",H8,d(y.post_excerpt),1)):_("",!0),l("a",{class:"el-button fcom_primary_button link_button",href:k.checkout_url},d(e.$t("Join Now")),9,x8)])]))),128))],64))),128))])}const eo=F(I8,[["render",j8]]),O8={name:"LockscreenView",components:{CustomLockscreenView:Xs,DefaultLockscreenPaywall:eo},props:["space_profile","joining"],emits:["join"],computed:{isDefaultScreen(){return this.space_profile},isNonMember(){var e;return(e=this.space_profile.permissions)==null?void 0:e.is_non_member}},mounted(){var e;(e=this.space_profile.lockscreen_config)!=null&&e.redirect_url&&(window.location.href=this.space_profile.lockscreen_config.redirect_url)}},N8={key:0,style:{margin:"30px","text-align":"center"}},z8={key:0,class:"space_lock_box space_default_lock_box"},q8={class:"space_lock_box space_default_lock_box"},G8={class:"lock_desc"},Y8=["href"],Z8={class:"lock_desc"},W8=["href"],J8={key:2},Q8={key:2,class:"space_lock_box"},K8={class:"lock_desc"},X8=["href"];function e4(e,t,o,u,s,n){var b,$;const m=g("Lock"),p=O,h=j,y=g("default-lockscreen-paywall"),k=g("custom-lockscreen-view");return(b=this.space_profile.lockscreen_config)!=null&&b.redirect_url?(i(),c("h3",N8,d(e.$t("Please wait....")),1)):o.space_profile.lockscreen_config?(i(),c(V,{key:1},[o.space_profile.permissions&&o.space_profile.permissions.is_pending?(i(),c("div",z8,[a(p,null,{default:r(()=>[a(m)]),_:1}),l("h4",null,d(e.$t("Membership Request Under Review")),1)])):o.space_profile.lockscreen_config.showCustom?(i(),c("div",J8,[a(k,{profile:o.space_profile},null,8,["profile"])])):(i(),c(V,{key:1},[l("div",q8,[a(p,null,{default:r(()=>[a(m)]),_:1}),l("h4",null,d(e.$t("This is a private space")),1),o.space_profile.lockscreen_config.canSendRequest?(i(),c(V,{key:0},[l("p",G8,d(e.$t("Please send a join request and an admin will review your join request.")),1),e.auth.user_id?(i(),v(h,{key:0,disabled:o.joining,loading:o.joining,class:"fcom_primary_button",onClick:t[0]||(t[0]=f=>e.$emit("join"))},{default:r(()=>[S(d(e.$t("Request Access")),1)]),_:1},8,["disabled","loading"])):(i(),c("a",{key:1,href:e.getCurrentAuthUrl(),class:"fcom_btn el-button el-button--primary fcom_primary_button"},d(e.$t("Login or Signup")),9,Y8))],64)):(i(),c(V,{key:1},[l("p",Z8,d(e.$t("Members have to be invited to this space.")),1),e.auth.user_id?_("",!0):(i(),c("a",{key:0,href:e.getCurrentAuthUrl(),class:"fcom_btn el-button el-button--primary"},d(e.$t("Login or Signup")),9,W8))],64))]),o.space_profile.lockscreen_config.showPaywalls?(i(),v(y,{key:0,space_id:($=o.space_profile)==null?void 0:$.id},null,8,["space_id"])):_("",!0)],64))],64)):e.auth.user_id?_("",!0):(i(),c("div",Q8,[a(p,null,{default:r(()=>[a(m)]),_:1}),l("h4",null,d(e.$t("Please login/signup to join this community")),1),l("p",K8,d(e.$t("To join the discussion of this community, please login or signup")),1),l("a",{href:e.getCurrentAuthUrl(),class:"fcom_btn el-button el-button--primary"},d(e.appVars.allow_signup?e.$t("Login / Signup"):e.$t("Login")),9,X8)]))}const t4=F(O8,[["render",e4]]),s4={name:"SpaceView",components:{RenderSpaceLinks:Xt,AboutSpace:Ks,Layout:ve,AppLayout:we,SpaceHeader:vb,RecentActivities:Ut,CreateSpaceForm:It,SpaceMenu:Qs,LockscreenView:t4,SpaceIcon:He},setup(){return{spaceStore:je()}},props:["space"],data(){return{search:"",joining:!1,pending_count:0}},computed:{space_profile(){return this.spaceStore.getCurrentSpace},loading(){return this.spaceStore.isLoading(this.space)},has_permission(){return this.space_profile?!!this.space_profile.permissions.can_view_posts:!1},isDefaultScreen(){var e,t;return((t=(e=this.space_profile)==null?void 0:e.settings)==null?void 0:t.custom_lock_screen)=="no"},isCustomLockScreen(){var e;return!!((e=this.space_profile)!=null&&e.lockscreen_config)&&!this.hasSpaceModeratorAccess(this.space_profile)},isNonMember(){var e,t;return(t=(e=this.space_profile)==null?void 0:e.permissions)==null?void 0:t.is_non_member},showSpaceHeader(){var e;return!this.isCustomLockScreen&&this.$route.name=="space_feeds"&&((e=this.space_profile)==null?void 0:e.cover_photo)},showSideBar(){var e,t;return!this.isCustomLockScreen&&this.$route.meta.show_sidebar&&((t=(e=this.space_profile)==null?void 0:e.settings)==null?void 0:t.show_sidebar)!="no"},showSpaceMenu(){return!this.isCustomLockScreen},showProfileLogo(){return!this.isCustomLockScreen},feedCssClasses(){var o,u;const e=[];e.push(this.showSideBar?"fcom_has_space_sidebar":"fcom_hide_space_sidebar");let t=((u=(o=this.space_profile)==null?void 0:o.settings)==null?void 0:u.layout_style)||"timeline";return e.push("fcom_layout_"+t),e.push("fcom_route_"+this.$route.name),e},wrapperLayoutClasses(){var e;return["fcom_single_layout","fcom_max_layout","fcom_space_"+((e=this.space_profile)==null?void 0:e.slug),"fcom_space_route_"+this.$route.name]}},watch:{space(){this.search="",this.getSpaceProfile()}},methods:{async getSpaceProfile(){try{const e=await this.spaceStore.fetchSpace(this.space);this.auth.spaces[e.slug]=e,e.pending_count!==void 0&&(this.pending_count=e.pending_count),this.changeTitle(e.title),this.$nextTick(()=>{window.fcomLayoutRef&&window.fcomLayoutRef.wrapRef&&(window.fcomLayoutRef.setScrollTop(0),console.log("[SpaceRoute] Scrolled to top"))})}catch(e){this.$handleError(e)}},async processJoin(){this.joining=!0;try{const e=await this.spaceStore.joinSpace(this.space);this.$notify.success(this.$t("Successfully joined the space")),await this.getSpaceProfile()}catch(e){this.$handleError(e)}finally{this.joining=!1}},resetRoute(){this.$nextTick(()=>{})}},async mounted(){const e=this.spaceStore.getSpaceBySlug(this.space);e?(this.spaceStore.setCurrentSpace(this.space),this.changeTitle(e.title),this.$nextTick(()=>{window.fcomLayoutRef&&window.fcomLayoutRef.wrapRef&&(window.fcomLayoutRef.setScrollTop(0),console.log("[SpaceRoute] Scrolled to top (cached)"))})):await this.getSpaceProfile()},beforeUnmount(){this.spaceStore.clearCurrentSpace()}},o4={key:0,"aria-label":"Space Links",class:"fcom_sub_header"},i4={class:"space_route"},n4={key:0},l4={key:1,class:"space_holder"},a4={key:2};function r4(e,t,o,u,s,n){const m=g("Lock"),p=O,h=g("space-icon"),y=g("router-link"),k=g("space-menu"),b=g("render-space-links"),$=g("space-header"),f=q,w=g("lockscreen-view"),C=g("router-view"),M=Ce,P=g("AboutSpace"),T=Ne,I=De,U=g("layout"),B=g("app-layout");return i(),v(B,{wrapper_class:n.wrapperLayoutClasses},{default:r(()=>[a(U,{wrapper_class:["no_bg_layout",{custom_lockscreen:n.isCustomLockScreen},"fcom_route_"+e.$route.name],title:"...."},{title:r(()=>[l("h1",{onClick:t[0]||(t[0]=A=>{e.$eventBus.emit("toTop"),n.resetRoute()}),class:"fcom_page_title"},[n.space_profile?(i(),v(y,{key:0,class:"fcom_space_title",to:{name:"space_feeds",params:{space:o.space}}},{default:r(()=>[n.isCustomLockScreen?(i(),v(p,{key:0},{default:r(()=>[a(m)]),_:1})):n.showProfileLogo?(i(),v(h,{key:1,space_profile:n.space_profile},null,8,["space_profile"])):_("",!0),l("span",null,d(n.space_profile.title),1)]),_:1},8,["to"])):_("",!0)])]),actions:r(()=>[n.showSpaceMenu?(i(),v(k,{key:0,space:o.space,space_profile:n.space_profile,onDoSearch:t[1]||(t[1]=A=>{s.search=A}),onRefetch:t[2]||(t[2]=A=>n.getSpaceProfile())},null,8,["space","space_profile"])):_("",!0)]),sub_header:r(()=>{var A,L;return[n.space_profile&&!n.isCustomLockScreen&&((L=(A=n.space_profile)==null?void 0:A.settings)!=null&&L.links.length)?(i(),c("nav",o4,[a(b,{links:n.space_profile.settings.links},null,8,["links"])])):_("",!0)]}),default:r(()=>[n.showSpaceHeader?(i(),v($,{key:0,onRefetch:t[3]||(t[3]=A=>n.getSpaceProfile()),space:o.space,space_profile:n.space_profile},null,8,["space","space_profile"])):_("",!0),a(I,{class:"fcom_resp_container fcom_space_container fcom_main_container"},{default:r(()=>[a(M,{class:"fcom_main"},{default:r(()=>[l("div",{class:R([n.feedCssClasses,"fcom_feed_box"])},[l("div",i4,[n.loading?(i(),c("div",n4,[a(f,{class:"white_loaded",rows:10,animated:!0})])):n.space_profile?(i(),c("div",l4,[n.isCustomLockScreen?(i(),v(w,{key:0,space_profile:n.space_profile,joining:s.joining,onJoin:t[4]||(t[4]=A=>n.processJoin())},null,8,["space_profile","joining"])):_("",!0),n.has_permission?(i(),v(C,{key:1,search:s.search,onRefetch:t[5]||(t[5]=A=>n.getSpaceProfile()),space_profile:n.space_profile,space_slug:o.space},null,8,["search","space_profile","space_slug"])):_("",!0)])):(i(),c("div",a4,[l("h4",null,d(e.$t("Sorry! this community could not be loaded")),1)]))])],2)]),_:1}),n.showSideBar?(i(),v(T,{key:0,class:"fcom_resp_side",width:"306px"},{default:r(()=>[a(P,{has_permission:n.has_permission,space_profile:n.space_profile},null,8,["has_permission","space_profile"])]),_:1})):_("",!0)]),_:1})]),_:1},8,["wrapper_class"])]),_:1},8,["wrapper_class"])}const c4=F(s4,[["render",r4]]),d4={name:"CreateFeed",props:["space_slug","space_profile","space","search"],emits:["refetch"],components:{CreateStatusForm:Pt,Feeds:rt},setup(){const e=je(),t=xe();return{spaceStore:e,uiStore:t}},beforeRouteLeave(e,t,o){if(e.name==="single_feed"||e.name==="space_feed"){let s=0;window.fcomLayoutRef&&window.fcomLayoutRef.wrapRef&&(s=window.fcomLayoutRef.wrapRef.scrollTop),this.uiStore.saveScrollPosition(t.path,s)}else this.uiStore.clearScrollPosition();o()},data(){return{topic_slug:null}},methods:{setTopic(e){if(this.topic_slug=e,e)this.$router.push({query:{topic:e}});else{let t=this.$route.query;delete t.topic,this.$router.push({query:t});return}},watchTopicUrlChanged(e){this.topic_slug==e||!e||(this.topic_slug=e,this.$nextTick(()=>{window.fcomLayoutRef&&window.fcomLayoutRef.scrollTo({top:0,behavior:"smooth"})}))}},computed:{layout_style(){var e,t;return((t=(e=this.space_profile)==null?void 0:e.settings)==null?void 0:t.layout_style)||"timeline"},spaceTopics(){var t,o;const e=this.spaceStore.getSpaceTopics(this.space_slug);return e&&e.length>0?e:qt((t=this.space_profile)==null?void 0:t.topics)?null:((o=this.space_profile)==null?void 0:o.topics)||null}},created(){this.$route.query.topic&&(this.topic_slug=this.$route.query.topic),this.$eventBus.on("topic_changed",this.watchTopicUrlChanged)},beforeUnmount(){this.$eventBus.off("topic_changed",this.watchTopicUrlChanged)}},u4={key:0,class:"fcom_space_topics"},_4={ref:"fcom_topics_filters",class:"fcom_topics_filters"};function m4(e,t,o,u,s,n){var y,k;const m=j,p=fe,h=g("feeds");return i(),c(V,null,[n.spaceTopics?(i(),c("div",u4,[a(p,null,{default:r(()=>[l("div",_4,[a(m,{onClick:t[0]||(t[0]=b=>n.setTopic("")),class:R({fcom_active_topic:!s.topic_slug})},{default:r(()=>[S(d(e.$t("All")),1)]),_:1},8,["class"]),(i(!0),c(V,null,D(n.spaceTopics,b=>(i(),v(m,{key:b.slug,onClick:$=>n.setTopic(b.slug),class:R({fcom_active_topic:b.slug==s.topic_slug})},{default:r(()=>[S(d(b.title),1)]),_:2},1032,["onClick","class"]))),128))],512)]),_:1})])):_("",!0),a(h,{feed_name:"space_feed_"+o.space_slug,space:o.space_slug,topic_slug:s.topic_slug,default_search:o.search,layout_style:n.layout_style,can_change_order:((y=o.space_profile.settings)==null?void 0:y.disable_post_sort_by)!=="yes",default_order_by:((k=o.space_profile.settings)==null?void 0:k.default_post_sort_by)||"",hide_create_form:!o.space_profile.permissions.can_create_post},null,8,["feed_name","space","topic_slug","default_search","layout_style","can_change_order","default_order_by","hide_create_form"])],64)}const h4=F(d4,[["render",m4]]),f4={name:"SpaceHomeRedirect",created(){this.$router.replace({name:"space_feeds",params:{space:this.$route.params.space}})}},p4={name:"InviationForm",emits:["completed"],data(){return{saving:!1,inviatation:{email:"",invitee_name:""}}},props:{space_id:{type:Number,default:null},default_value:{type:Object,default:()=>""}},methods:{sendInvitation(){this.saving=!0,this.$post("invitations",{...this.inviatation,space_id:this.space_id}).then(e=>{this.$notify.success(e.message),this.$emit("completed"),this.inviatation={email:"",invitee_name:""}}).catch(e=>{this.$handleError(e)}).finally(()=>{this.saving=!1})}},mounted(){this.default_value&&(this.inviatation.email=this.default_value)}},g4={class:"fcom_invitation_form",ref:"inviteForm"};function y4(e,t,o,u,s,n){const m=ee,p=ue,h=et,y=tt,k=j,b=_e,$=K("loading");return i(),c("div",g4,[a(b,{onSubmit:t[2]||(t[2]=Z(f=>e.doNothing(),["prevent"])),modelValue:s.inviatation,"onUpdate:modelValue":t[3]||(t[3]=f=>s.inviatation=f),"label-position":"top"},{default:r(()=>[a(y,{gutter:30},{default:r(()=>[a(h,{sm:24,md:12},{default:r(()=>[a(p,{label:e.$t("Invitee email")},{default:r(()=>[a(m,{modelValue:s.inviatation.email,"onUpdate:modelValue":t[0]||(t[0]=f=>s.inviatation.email=f),placeholder:e.$t("Enter invitee email"),autocomplete:"off"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),a(h,{sm:24,md:12},{default:r(()=>[a(p,{label:e.$t("Invitee Name (optional)")},{default:r(()=>[a(m,{modelValue:s.inviatation.invitee_name,"onUpdate:modelValue":t[1]||(t[1]=f=>s.inviatation.invitee_name=f),placeholder:e.$t("Enter invitee Name"),autocomplete:"off"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1}),a(p,null,{default:r(()=>[N((i(),v(k,{disabled:s.saving,class:"fcom_primary_button",onClick:n.sendInvitation},{default:r(()=>[S(d(e.$t("Send Invitation")),1)]),_:1},8,["disabled","onClick"])),[[$,s.saving]])]),_:1})]),_:1},8,["modelValue"])],512)}const to=F(p4,[["render",y4]]),v4={name:"AddMemberForm",components:{InviationForm:to},props:["modelValue","space_profile"],emits:["completed"],data(){return{users:[],loading:!1,form:this.modelValue||{user_id:"",role:"",editing_user:null},adding:!1,invite_search:"",showingForm:"addByUser"}},methods:{fetchUsers(e=""){this.loading=!0,this.$get("spaces/users/search",{context:"add_member",search:e,space_id:this.space_profile.id}).then(t=>{this.users=t.users.data}).catch(t=>{this.$handleError(t)}).finally(()=>{this.loading=!1})},addMember(){if(!this.form.user_id||!this.form.role){this.$notify.error(this.$t("Please select a user and role"));return}this.adding=!0,this.$post("spaces/"+this.space_profile.slug+"/members",{user_id:this.form.user_id,role:this.form.role}).then(e=>{this.$notify.success(e.message),this.$emit("completed"),this.form={user_id:"",role:"",editing_user:null}}).catch(e=>{this.$handleError(e)}).finally(()=>{this.adding=!1})},invitePerson(){const e=this.$refs.invite_member.inputRef.value;if(!e){this.$notify.error(this.$t("Please enter an email address"));return}this.invite_search=e,this.showingForm="addByInvitations"}},mounted(){var e;(e=this.modelValue)!=null&&e.editing_user||this.fetchUsers()}},b4={class:"fcom_select_photo",style:{float:"left"}},k4=["src","alt"],w4={style:{float:"right",color:"#8492a6","font-size":"13px"}},C4={key:1},$4={class:"fcom_spaced_flex"},S4={key:0},V4={key:1},L4={key:1},M4={key:0},P4={key:1},F4=l("p",null,"Member Invitation feature is only available on the Pro version",-1),T4=[F4];function I4(e,t,o,u,s,n){const m=ie,p=j,h=ne,y=ue,k=_e,b=g("InviationForm"),$=K("loading");return s.showingForm=="addByUser"?(i(),v(k,{key:0,onSubmit:t[4]||(t[4]=Z(f=>e.doNothing(),["prevent"])),"label-position":"top",modelValue:s.form,"onUpdate:modelValue":t[5]||(t[5]=f=>s.form=f)},{default:r(()=>[s.form.editing_user?(i(),c("p",C4,d(e.$t("Editing manager role for"))+" "+d(s.form.editing_user.display_name),1)):(i(),v(y,{key:0,label:e.$t("Search for an existing user or Invite by Email")},{default:r(()=>[N((i(),v(h,{ref:"invite_member",class:"rich_select",filterable:"",remote:"","remote-method":n.fetchUsers,placeholder:e.$t("Select User"),modelValue:s.form.user_id,"onUpdate:modelValue":t[1]||(t[1]=f=>s.form.user_id=f)},{empty:r(()=>[l("p",null,d(e.$t("No existing users found based on your search.")),1),a(p,{disabled:s.adding,loading:s.adding,type:"success",onClick:t[0]||(t[0]=f=>n.invitePerson())},{default:r(()=>[S(d(e.$t("Send Email Invitation")),1)]),_:1},8,["disabled","loading"])]),default:r(()=>[(i(!0),c(V,null,D(s.users,f=>(i(),v(m,{class:"fcom_with_photo_option",key:f.ID,label:f.display_name+" ("+(f.user_email||f.ID)+")",value:f.ID},{default:r(()=>[l("span",b4,[l("img",{src:f.photo,alt:f.display_name},null,8,k4),l("span",null,d(f.display_name),1)]),l("span",w4,d(f.user_email||f.ID),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["remote-method","placeholder","modelValue"])),[[$,s.loading]])]),_:1},8,["label"])),a(y,{label:e.$t("Membership Role")},{default:r(()=>[a(h,{placeholder:e.$t("Select Role"),modelValue:s.form.role,"onUpdate:modelValue":t[2]||(t[2]=f=>s.form.role=f)},{default:r(()=>[a(m,{label:e.$t("Member"),value:"member"},null,8,["label"]),a(m,{label:e.$t("Moderator"),value:"moderator"},null,8,["label"]),a(m,{label:e.$t("Admin"),value:"admin"},null,8,["label"])]),_:1},8,["placeholder","modelValue"])]),_:1},8,["label"]),z(e.$slots,"after_form",{},()=>[l("div",$4,[a(p,{class:"fcom_primary_button",loading:s.adding,disabled:s.adding,onClick:t[3]||(t[3]=f=>n.addMember())},{default:r(()=>[s.form.editing_user?(i(),c("span",S4,d(e.$t("Update Role")),1)):(i(),c("span",V4,d(e.$t("Add as %s",s.form.role)),1))]),_:1},8,["loading","disabled"])])])]),_:3},8,["modelValue"])):(i(),c("div",L4,[e.has_pro?(i(),c("div",M4,[a(b,{space_id:o.space_profile.id,default_value:s.invite_search,onCompleted:t[6]||(t[6]=f=>e.$emit("completed"))},null,8,["space_id","default_value"])])):(i(),c("div",P4,T4))]))}const so=F(v4,[["render",I4]]),U4={name:"SpaceMembers",props:["space","space_profile"],components:{Search:Ve,Pagination:ke,FollowAction:Ye,AddMemberForm:so},emits:["refetch"],inheritAttrs:!1,data(){return{members:[],loading:!1,pagination:{page:1,per_page:20,total:0},status:"active",pending_count:0,working:!1,addingMember:!1,editing_member:{user_id:"",role:"member"},search:"",SearchIcon:pt(Ve),permission_failed:!1,memberLayout:this.appVars.features.member_list_layout||"classic"}},methods:{fetch(){this.loading=!0,this.$get("spaces/"+this.space+"/members",{page:this.pagination.page,per_page:this.pagination.per_page,status:this.status,search:this.search}).then(e=>{this.members=e.members.data,this.pagination.total=e.members.total,e.pending_count&&(this.pending_count=e.pending_count),this.pagination.page!=1&&this.$nextTick(()=>{this.$refs.space_members&&this.$refs.space_members.scrollIntoView({behavior:"smooth"})}),e.current_user_follows&&this.setFollowIds(e.current_user_follows)}).catch(e=>{e.permission_failed?this.permission_failed=!0:this.$handleError(e)}).finally(()=>{this.loading=!1})},removeMemberPrompt(e,t){this.$confirm(this.$t("Are you sure you want to remove this member from this community?"),this.$t("Remove Member?"),{confirmButtonText:this.$t("Remove"),cancelButtonText:this.$t("Cancel"),confirmButtonClass:"fcom_primary_button",cancelButtonClass:"fcom_secondary_button",type:"error"}).then(()=>{this.removeMember(e,t)})},removeMember(e,t){this.working=!0,this.$post("spaces/"+this.space+"/members/remove",{user_id:e.user_id}).then(o=>{this.$notify.success(o.message),this.members.splice(t,1),this.members.length||this.fetch()}).catch(o=>{this.$handleError(o)}).finally(()=>{this.working=!1})},approveMember(e,t=null){this.working=!0,this.$post("spaces/"+this.space+"/members",{user_id:e.user_id}).then(o=>{if(this.$notify.success(o.message),t===null){this.fetch();return}this.members.splice(t,1),this.members.length||this.fetch()}).catch(o=>{this.$handleError(o)}).finally(()=>{this.working=!1})},initAddMember(e,t=null){this.editing_member=e?{user_id:e.user_id,role:e.role,editing_user:e.xprofile}:{user_id:"",role:""},e&&this.$refs.edit_member_pop&&this.$refs.edit_member_pop.hide(),this.addingMember=!0},handleSearch(){this.search&&this.search.length<3||this.toSearch()},toSearch(){this.pagination.page=1,this.fetch()}},mounted(){this.$route.query.view_pending&&(this.status="pending"),this.fetch()}},B4={ref:"space_members"},E4={key:0,class:"card_header"},A4={class:"member_status"},D4={class:"add_member"},R4={key:1,style:{"text-align":"center",padding:"20px 20px 40px"},class:"space_members"},H4={class:"permission_failed"},x4=["href"],j4={key:2},O4={style:{"margin-bottom":"20px"},class:"search_member"},N4={class:"card_list"},z4={class:"card_content"},q4={class:"card_avatar"},G4={class:"card_info"},Y4={class:"card_name"},Z4={class:"info_header"},W4={class:"meta_line"},J4={class:"feed_meta_info"},Q4=["title"],K4=["title"],X4=["title"],e5={key:0,class:"meta_line"},t5=l("div",{class:"card_break"},null,-1),s5={class:"card_footer"},o5={class:"card_action"},i5={class:"actions_items"},n5=["onClick"],l5=["onClick"],a5={class:"pagination_wrap"},r5={key:0,class:"loading"},c5={key:1,class:"no_members"},d5={key:0},u5={key:1};function _5(e,t,o,u,s,n){const m=st,p=ge,h=j,y=g("Search"),k=O,b=ee,$=g("UserAvatar"),f=g("UserRouteLink"),w=Oe,C=g("FollowAction"),M=g("MoreFilled"),P=de,T=g("Pagination"),I=q,U=g("add-member-form"),B=$t,A=K("loading");return i(),c(V,null,[l("div",B4,null,512),e.hasSpaceAdminAccess(o.space_profile)?(i(),c("div",E4,[l("div",A4,[s.pending_count?(i(),v(p,{key:0,onChange:n.toSearch,modelValue:s.status,"onUpdate:modelValue":t[0]||(t[0]=L=>s.status=L),class:"status_group"},{default:r(()=>[a(m,{value:"active"},{default:r(()=>[S(d(e.$t("Active")),1)]),_:1}),a(m,{value:"pending"},{default:r(()=>[S(d(e.$t("Pending"))+" ("+d(s.pending_count)+")",1)]),_:1})]),_:1},8,["onChange","modelValue"])):_("",!0)]),l("div",D4,[a(h,{class:"fcom_primary_button",onClick:t[1]||(t[1]=L=>e.$router.push({name:"space_invitations"}))},{default:r(()=>[S(d(e.$t("Invitations")),1)]),_:1})])])):_("",!0),s.permission_failed?(i(),c("div",R4,[l("div",H4,[l("h3",null,d(e.$t("Permission Denied")),1),l("p",null,d(e.$t("You do not have permission to view all members")),1),l("a",{href:e.$getRouteLink("space/:space_slug/home",{space_slug:o.space_profile.slug}),class:"el-button fcom_primary_button"},d(e.$t("Go to Space Home")),9,x4)])])):(i(),c("div",j4,[l("div",O4,[a(b,{clearable:"",onClear:n.toSearch,onKeydown:be(n.toSearch,["enter"]),onInput:n.handleSearch,modelValue:s.search,"onUpdate:modelValue":t[2]||(t[2]=L=>s.search=L),placeholder:e.$t("Search...")},{prefix:r(()=>[a(k,null,{default:r(()=>[a(y)]),_:1})]),_:1},8,["onClear","onKeydown","onInput","modelValue","placeholder"])]),l("div",{class:R(["fcom_dir_layout_"+s.memberLayout,"space_members fcom_dir_layout"])},[N((i(),c("div",N4,[(i(!0),c(V,null,D(s.members,(L,E)=>{var G,se;return N((i(),c("div",{key:L.id,class:"each_card"},[l("div",z4,[l("div",q4,[a($,{xprofile:L.xprofile,is_online:e.isOnline(L.xprofile.last_activity)},null,8,["xprofile","is_online"])]),l("div",G4,[l("div",Y4,[l("div",Z4,[a(f,{xprofile:L.xprofile,show_badge:!0,show_follow:!0},null,8,["xprofile"]),l("div",W4,"@"+d((G=L.xprofile)==null?void 0:G.username),1)]),l("div",J4,[s.status!="pending"&&L.created_at?(i(),c("div",{key:0,title:L.created_at,class:"meta_line"},d(e.$t("Joined %s",e.humanDateDiff(L.created_at))),9,Q4)):L.created_at?(i(),c("div",{key:1,title:L.created_at,class:"meta_line"},d(e.$t("Requested %s",e.humanDateDiff(L.created_at))),9,K4)):_("",!0),L.xprofile.last_activity?(i(),c("div",{key:2,title:L.xprofile.last_activity,class:"meta_line",style:{"margin-left":"5px"}},d(e.$t("Last seen: %s",e.humanDateDiff(L.xprofile.last_activity))),9,X4)):_("",!0)]),(se=L.xprofile)!=null&&se.short_description?(i(),c("div",e5,d(e.getExcerpt(L.xprofile.short_description,120)),1)):_("",!0),L.role!="member"?(i(),v(w,{key:1,type:"success"},{default:r(()=>[S(d(e.$labelize(L.role)),1)]),_:2},1024)):_("",!0)]),s.status=="pending"?(i(),c(V,{key:0},[t5,l("div",s5,[a(h,{class:"fcom_primary_button",onClick:H=>n.approveMember(L,E)},{default:r(()=>[S(d(e.$t("Approve")),1)]),_:2},1032,["onClick"]),a(h,{class:"fcom_secondary_button",onClick:H=>n.removeMember(L,E)},{default:r(()=>[S(d(e.$t("Decline")),1)]),_:2},1032,["onClick"])])],64)):_("",!0)])]),l("div",o5,[a(C,{profile:L.xprofile},null,8,["profile"]),s.status!="pending"&&o.space_profile&&e.hasInPermission("can_remove_member",o.space_profile.permissions)?(i(),v(P,{key:0,placement:"bottom",width:200,trigger:"click",persistent:!1,ref_for:!0,ref:"userPopoverRef_"+L.user_id},{reference:r(()=>[a(h,{"aria-label":e.$t("View actions"),size:"small",text:""},{default:r(()=>[a(k,{class:"fcom_more_icon"},{default:r(()=>[a(M)]),_:1})]),_:1},8,["aria-label"])]),default:r(()=>[l("ul",i5,[l("li",{onClick:H=>n.removeMemberPrompt(L,E)},d(e.$t("Remove Member")),9,n5),l("li",{onClick:H=>n.initAddMember(L,H)},d(e.$t("Change Membership")),9,l5)])]),_:2},1536)):_("",!0)])])),[[A,s.working]])}),128))])),[[A,s.loading]]),l("div",a5,[a(T,{hide_on_single:!0,onFetch:t[3]||(t[3]=L=>n.fetch()),pagination:s.pagination},null,8,["pagination"])]),s.loading&&!s.pagination.total?(i(),c("div",r5,[a(I,{class:"white_loaded",rows:3,animated:!0}),a(I,{style:{"margin-top":"20px"},class:"white_loaded",rows:3,animated:!0})])):!s.loading&&!s.members.length?(i(),c("div",c5,d(e.$t("No %s members found in this community.",s.status)),1)):_("",!0)],2)])),s.addingMember?(i(),v(B,{key:3,modelValue:s.addingMember,"onUpdate:modelValue":t[6]||(t[6]=L=>s.addingMember=L),"close-on-click-modal":!1,"append-to-body":!0,size:e.dialogWidth,direction:"rtl"},{header:r(()=>[s.editing_member.editing_user?(i(),c("h4",d5,d(e.$t("Update Role")),1)):(i(),c("h4",u5,d(e.$t("Add Member")),1))]),default:r(()=>[s.addingMember?(i(),v(U,{key:0,space_profile:o.space_profile,modelValue:s.editing_member,"onUpdate:modelValue":t[4]||(t[4]=L=>s.editing_member=L),onCompleted:t[5]||(t[5]=()=>{n.fetch(),s.addingMember=!1})},null,8,["space_profile","modelValue"])):_("",!0)]),_:1},8,["modelValue","size"])):_("",!0)],64)}const m5=F(U4,[["render",_5]]);const h5={name:"DocumentUploadForm",components:{CreateStatusForm:Pt},props:["space_profile"],emits:["refetch"],data(){return{post:{title:"",content_type:"document",message:"",media_image:"",topic_ids:[],status:"published",document_ids:[]},post_status:"published"}},watch:{"post.content_type"(){this.post.content_type="document"}},methods:{handleFilesChanged(e){this.post.document_ids=e,this.$refs.createStatusForm.feed.document_ids=e},resetForm(){this.post={title:"",content_type:"document",message:"",media_image:"",topic_ids:[],status:"unlisted",document_ids:[]},this.$emit("refetch")}}},f5={class:"fcom_document_upload_form"};function p5(e,t,o,u,s,n){const m=he,p=g("CreateStatusForm");return i(),c("div",f5,[a(p,{ref:"createStatusForm",default_placeholder:e.$t("About these files"),initial_placeholder:e.$t("Upload new"),btn_text:e.$t("Upload Files"),editing_feed:s.post,"default-state":"active",disableUpload:!0,space:o.space_profile.slug,onAdded:n.resetForm},{before_submit_btn:r(()=>[a(m,{onChange:t[0]||(t[0]=h=>{e.$refs.createStatusForm.feed.status=h}),"true-value":"published","false-value":"unlisted",modelValue:s.post_status,"onUpdate:modelValue":t[1]||(t[1]=h=>s.post_status=h)},{default:r(()=>[S(d(e.$t("Publish as a post")),1)]),_:1},8,["modelValue"])]),_:1},8,["default_placeholder","initial_placeholder","btn_text","editing_feed","space","onAdded"])])}const g5=F(h5,[["render",p5]]),y5={name:"DocumentFeedCard",components:{ChatIcon:ze,HeartIcon:qe,DocumentLists:Ge,UserRouteLink:Le},props:["feed"]},v5={class:"fcom_document_feed_card feed"},b5={class:"feed_header"},k5={key:0,class:"feed_user"},w5={class:"feed_user_name"},C5={class:"feed_title"},$5={class:"feed_title_heading"},S5=["href"],V5={class:"feed_meta_info"},L5=["href"],M5=["title"],P5=["href"],F5={style:{"margin-left":"5px","margin-right":"7px"}},T5=["href"],I5={style:{"margin-left":"5px"}},U5={class:"feed_body"};function B5(e,t,o,u,s,n){var k,b,$,f,w;const m=g("ChatIcon"),p=O,h=g("HeartIcon"),y=g("DocumentLists");return i(),c("div",v5,[l("div",b5,[o.feed.xprofile?(i(),c("div",k5,[l("div",w5,[l("div",C5,[l("h2",$5,[l("a",{href:o.feed.permalink},d(o.feed.title||e.$t("Uploaded %s files",((b=(k=o.feed.meta)==null?void 0:k.document_lists)==null?void 0:b.length)||"--")),9,S5)])])]),l("div",V5,[l("a",{onClick:t[0]||(t[0]=(...C)=>e.gotoFeed&&e.gotoFeed(...C)),href:o.feed.permalink,class:"feed_timestamp"},[l("span",{title:o.feed.created_at,style:{padding:"0 7px 0 0"}},d(e.humanDateDiff(o.feed.created_at))+" "+d(e.$t("by %s",($=o.feed.xprofile)==null?void 0:$.display_name)),9,M5)],8,L5),o.feed.comments_count?(i(),c("a",{key:0,onClick:t[1]||(t[1]=(...C)=>e.gotoFeed&&e.gotoFeed(...C)),href:o.feed.permalink,class:"feed_timestamp"},[a(p,{style:{"margin-left":"7px"}},{default:r(()=>[a(m)]),_:1}),l("span",F5,d(o.feed.comments_count),1)],8,P5)):_("",!0),o.feed.reactions_count?(i(),c("a",{key:1,onClick:t[2]||(t[2]=(...C)=>e.gotoFeed&&e.gotoFeed(...C)),href:o.feed.permalink,class:"feed_timestamp"},[a(p,{style:{"margin-left":"7px"}},{default:r(()=>[a(h,{filled:!0})]),_:1}),l("span",I5,d(o.feed.reactions_count),1)],8,T5)):_("",!0)])])):_("",!0)]),l("div",U5,[a(y,{document_lists:(w=(f=o.feed)==null?void 0:f.meta)==null?void 0:w.document_lists},null,8,["document_lists"])])])}const E5=F(y5,[["render",B5]]);const A5={name:"SpaceDocuments",props:["space","space_profile"],components:{FeedListItem:xs,Feed:Ze,DocumentUploadForm:g5,UploadFilled:gt,Search:Ve,Pagination:ke,DocumentFeedCard:E5},emits:["refetch"],inheritAttrs:!1,data(){return{documents:[],loading:!1,pagination:{page:1,per_page:20,total:0},working:!1,search:"",SearchIcon:pt(Ve),permission_failed:!1,show_uploader:!1}},methods:{fetch(e=!1){this.loading=!0,this.$get("documents",{page:this.pagination.page,per_page:this.pagination.per_page,space_id:this.space_profile.id,search:this.search}).then(t=>{e?this.documents=this.documents.concat(t.documents.data):this.documents=t.documents.data,this.pagination.total=t.documents.total,this.pagination.last_page=t.documents.last_page}).catch(t=>{t.permission_failed?this.permission_failed=!0:this.$handleError(t)}).finally(()=>{this.loading=!1})},handleSearch(){this.search&&this.search.length<3||this.toSearch()},toSearch(){this.pagination.page=1,this.fetch()},handleLoadMore(e){var n;if(this.pagination.last_page==this.pagination.page)return;let t=document.querySelector(".all_documents_wrap .feed_outer:last-child");if(!t)return;let o=t.getBoundingClientRect(),u=(n=window.fcomLayoutRef)==null?void 0:n.wrapRef;!u||o.bottom-u.getBoundingClientRect().bottom-o.height>100||this.loading||(this.loading=!0,this.pagination.page++,this.fetch(!0))}},mounted(){this.has_pro?(this.fetch(),document.addEventListener("fcom_layout_scroll",this.handleLoadMore)):this.permission_failed=!0,this.changeTitle(this.$t("Documents and Files in %s",this.space_profile.title))}},D5={ref:"space_docs"},R5={class:"card_header"},H5={class:"member_status"},x5={key:0,class:"add_member"},j5={key:0},O5={key:1,style:{"text-align":"center",padding:"20px 20px 40px"},class:"space_members"},N5={class:"permission_failed"},z5=["href"],q5={key:2},G5={class:"search_member"},Y5={class:""},Z5={class:"card_list"},W5={class:"all_documents_wrap"},J5={key:0,style:{"margin-top":"20px","text-align":"center"}},Q5={key:1,class:"loading"},K5={key:2,class:"no_members"};function X5(e,t,o,u,s,n){var w,C;const m=g("UploadFilled"),p=O,h=j,y=g("document-upload-form"),k=g("Search"),b=ee,$=g("document-feed-card"),f=q;return i(),c(V,null,[l("div",D5,null,512),l("div",R5,[l("div",H5,[l("h3",null,d(e.$t("Documents and Files")),1)]),(C=(w=o.space_profile)==null?void 0:w.permissions)!=null&&C.can_upload_documents?(i(),c("div",x5,[s.show_uploader?(i(),v(h,{key:1,plain:"",onClick:t[1]||(t[1]=M=>s.show_uploader=!1),size:"small"},{default:r(()=>[l("span",null,d(e.$t("Cancel")),1)]),_:1})):(i(),v(h,{key:0,onClick:t[0]||(t[0]=M=>s.show_uploader=!0),class:"fcom_primary_button"},{default:r(()=>[a(p,null,{default:r(()=>[a(m)]),_:1}),l("span",null,d(e.$t("New Documents")),1)]),_:1}))])):_("",!0)]),s.show_uploader?(i(),c("div",j5,[a(y,{onRefetch:t[2]||(t[2]=()=>{n.toSearch(),s.show_uploader=!1}),space_profile:o.space_profile,reload:n.toSearch},null,8,["space_profile","reload"])])):_("",!0),s.permission_failed?(i(),c("div",O5,[l("div",N5,[l("h3",null,d(e.$t("Permission Denied")),1),l("p",null,d(e.$t("You do not have permission to view this page")),1),l("a",{href:e.$getRouteLink("space/:space_slug/home",{space_slug:o.space_profile.slug}),class:"el-button fcom_primary_button"},d(e.$t("Go to Space Home")),9,z5)])])):(i(),c("div",q5,[l("div",G5,[a(b,{clearable:"",onClear:n.toSearch,onKeydown:be(n.toSearch,["enter"]),onInput:n.handleSearch,modelValue:s.search,"onUpdate:modelValue":t[3]||(t[3]=M=>s.search=M),placeholder:e.$t("Search...")},{prefix:r(()=>[a(p,null,{default:r(()=>[a(k)]),_:1})]),_:1},8,["onClear","onKeydown","onInput","modelValue","placeholder"])]),l("div",Y5,[l("div",Z5,[l("div",W5,[(i(!0),c(V,null,D(s.documents,M=>(i(),c("div",{key:M.id,class:"feed_outer"},[a($,{feed:M},null,8,["feed"])]))),128))])]),!s.loading&&s.pagination.last_page!=s.pagination.page?(i(),c("div",J5,[a(h,{class:"fcom_secondary_button",disabled:s.loading,onClick:t[4]||(t[4]=M=>{s.pagination.page++,n.fetch(!0)})},{default:r(()=>[S(d(e.$t("Load more")),1)]),_:1},8,["disabled"])])):_("",!0),s.loading?(i(),c("div",Q5,[a(f,{style:{"margin-top":"20px"},class:"white_loaded",animated:!0,rows:5})])):!s.loading&&!s.documents.length?(i(),c("div",K5,d(e.$t("No documents found in this space based on your search criteria.")),1)):_("",!0)])]))],64)}const e6=F(A5,[["render",X5]]);const t6={name:"PendingInvitations",components:{Pagination:ke},data(){return{loading:!1,loadingMore:!1,invitations:[],status:"all",pagination:{page:1,total:0,per_page:10},is_mod:!1}},props:{space_id:{type:Number,default:null}},computed:{getEmptyText(){return this.has_pro?this.$t("No Pending Invitations Found"):this.$t("This feature is only available in the Pro version of FluentCommunity. Please upgrade")}},methods:{getInvitations(){this.loading=!0,this.$get("invitations",{space_id:this.space_id,page:this.pagination.page,per_page:this.pagination.per_page,status:this.status}).then(e=>{this.invitations=e.invitations.data,this.pagination.total=e.invitations.total,this.is_mod=e.is_mod}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})},handleResend(e){this.loading=!0,this.$post("invitations/"+e.id+"/resend").then(t=>{this.$notify.success(t.message||this.$t("Invitation resent successfully"))}).catch(t=>{this.$handleError(t)}).finally(()=>{this.loading=!1})},handleDelete(e){this.$confirm(this.$t("Are you sure you want to delete this invitation?"),this.$t("Warning"),{confirmButtonText:this.$t("OK"),cancelButtonText:this.$t("Cancel"),confirmButtonClass:"fcom_primary_button",cancelButtonClass:"fcom_secondary_button",type:"warning"}).then(()=>{this.loading=!0,this.$del("invitations/"+e.id).then(t=>{this.getInvitations()}).catch(t=>{this.$handleError(t)}).finally(()=>{this.loading=!1})})}},mounted(){this.has_pro&&this.getInvitations()}},s6={class:"fcom_invitations"},o6={style:{margin:"20px 0"},class:"fcom_spaced_flex"},i6={key:0},n6={key:0,class:"fcom_person_name"},l6={key:1,class:"fcom_person_name"},a6={key:3,style:{margin:"0",padding:"0"}},r6={class:"fcom_person_name"};function c6(e,t,o,u,s,n){const m=ie,p=ne,h=g("CopyDocument"),y=O,k=j,b=yi,$=g("UserRouteLink"),f=vi,w=g("Pagination"),C=K("loading");return i(),c("div",s6,[l("div",o6,[l("h4",null,d(e.$t("Invitations")),1),e.has_pro?(i(),c("div",i6,[a(p,{style:{"min-width":"150px"},onChange:t[0]||(t[0]=M=>{s.pagination.page=1,n.getInvitations()}),modelValue:s.status,"onUpdate:modelValue":t[1]||(t[1]=M=>s.status=M)},{default:r(()=>[(i(),c(V,null,D(["all","pending","accepted","active","expired"],M=>a(m,{key:M,label:e.ucFirst(M),value:M},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])):_("",!0)]),N((i(),v(f,{data:s.invitations,border:"","empty-text":n.getEmptyText,style:{width:"100%","border-radius":"8px"}},{default:r(()=>[a(b,{prop:"message",label:e.$t("Invitee"),"min-width":"180"},{default:r(M=>[M.row.message?(i(),c("span",n6,d(M.row.meta.invitee_name)+" <"+d(M.row.message)+"> ",1)):(i(),c("span",l6,d(M.row.meta.title)+" ("+d(e.$t("Invitation Link"))+") ",1)),M.row.access_url?(i(),v(k,{key:2,type:"info",size:"small",text:"",onClick:P=>e.$toClipboard(M.row.access_url,e.$t("Invitation link has been copied to clipboard"))},{default:r(()=>[a(y,{title:e.$t("Copy Invitation URl")},{default:r(()=>[a(h)]),_:1},8,["title"]),l("span",null,d(e.$t("Copy Link")),1)]),_:2},1032,["onClick"])):_("",!0),M.row.message?_("",!0):(i(),c("p",a6,d(M.row.meta.limit?e.$t("Limit")+": "+M.row.meta.limit:"")+" "+d(parseInt(M.row.reactions_count)>0?" | "+e.$t("Usage")+": "+M.row.reactions_count:"")+" "+d(M.row.meta.expire_date?" | "+e.$t("Expire Date")+": "+e.smartDate(M.row.meta.expire_date):""),1))]),_:1},8,["label"]),s.is_mod?(i(),v(b,{key:0,prop:"user_id",label:e.$t("Invited By"),width:"180"},{default:r(M=>[l("span",r6,[a($,{xprofile:M.row.xprofile},null,8,["xprofile"])])]),_:1},8,["label"])):_("",!0),a(b,{prop:"status",label:e.$t("Status"),width:"120"},{default:r(M=>[l("span",null,d(e.$labelize(M.row.status)),1)]),_:1},8,["label"]),a(b,{label:e.$t("Actions")},{default:r(M=>[M.row.status=="pending"?N((i(),v(k,{key:0,class:"fcom_primary_button",text:"",onClick:P=>n.handleResend(M.row)},{default:r(()=>[S(d(e.$t("Resend")),1)]),_:2},1032,["onClick"])),[[C,s.loading]]):_("",!0),a(k,{onClick:P=>n.handleDelete(M.row),text:"",type:"danger"},{default:r(()=>[S(d(e.$t("Delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data","empty-text"])),[[C,s.loading]]),a(w,{hide_on_single:!1,pagination:s.pagination,onFetch:n.getInvitations},null,8,["pagination","onFetch"])])}const d6=F(t6,[["render",c6]]);const u6={name:"CreateInvitationLink",props:["space_profile"],data(){return{form:{title:"",limit:"",expire_date:""},creating:!1,createdItem:null}},methods:{createLink(){this.has_pro&&(this.creating=!0,this.$post("invitations/link",{space_id:this.space_profile.id,...this.form}).then(e=>{this.$notify.success(e.message),this.createdItem=e.invitation,this.form={title:"",limit:"",expire_date:""}}).catch(e=>{this.$handleError(e)}).finally(()=>{this.creating=!1}))}}},_6={class:"fcom_invitation_link_wrap"},m6={class:"fcom_invite_head"},h6={class:"fcom_invite_body"},f6={key:1},p6={key:1,style:{padding:"20px"}},g6={style:{"font-size":"20px",margin:"20px 0","text-align":"center"}};function y6(e,t,o,u,s,n){const m=ee,p=ue,h=Xe,y=j,k=_e,b=g("CopyDocument"),$=O;return i(),c("div",_6,[l("div",m6,[l("h4",null,d(e.$t("Create an invitation link")),1),l("p",null,d(e.$t("Create a simple link to share with potential members. Anyone with the link can join this space.")),1)]),l("div",h6,[s.createdItem?(i(),c("div",p6,[l("h4",g6,d(e.$t("Please share this url to your audience to join this space")),1),a(m,{modelValue:s.createdItem.access_url,"onUpdate:modelValue":t[6]||(t[6]=f=>s.createdItem.access_url=f),readonly:""},{suffix:r(()=>[a(y,{class:"fcomc_button_primary",onClick:t[5]||(t[5]=f=>e.$toClipboard(s.createdItem.access_url,e.$t("Invitation link has been copied to your clipboard")))},{default:r(()=>[a($,null,{default:r(()=>[a(b)]),_:1}),l("span",null,d(e.$t("Copy")),1)]),_:1})]),_:1},8,["modelValue"])])):(i(),v(k,{key:0,onSubmit:t[3]||(t[3]=Z(f=>e.doNothing(),["prevent"])),modelValue:s.form,"onUpdate:modelValue":t[4]||(t[4]=f=>s.form=f),"label-position":"top"},{default:r(()=>[a(p,{label:e.$t("Invitation Link Title")},{default:r(()=>[a(m,{modelValue:s.form.title,"onUpdate:modelValue":t[0]||(t[0]=f=>s.form.title=f),placeholder:e.$t("Enter a title for the invitation link")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(p,{label:e.$t("Limit the number of uses")},{default:r(()=>[a(m,{type:"number",modelValue:s.form.limit,"onUpdate:modelValue":t[1]||(t[1]=f=>s.form.limit=f),placeholder:e.$t("Leave empty for unlimited uses")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(p,{label:e.$t("Expire Date (Leave empty for no expiration)")},{default:r(()=>[a(h,{style:{"min-width":"300px"},modelValue:s.form.expire_date,"onUpdate:modelValue":t[2]||(t[2]=f=>s.form.expire_date=f),type:"date",placeholder:e.$t("Leave empty for no expiration"),"value-format":"YYYY-MM-DD",format:"YYYY-MM-DD"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(p,null,{default:r(()=>[e.has_pro?(i(),v(y,{key:0,onClick:n.createLink,loading:s.creating,class:"fcom_primary_button"},{default:r(()=>[S(d(e.$t("Create Invitation Link")),1)]),_:1},8,["onClick","loading"])):(i(),c("div",f6,[l("p",null,d(e.$t("This feature is only available in the Pro version of FluentCommunity. Please upgrade")),1)]))]),_:1})]),_:1},8,["modelValue"]))])])}const v6=F(u6,[["render",y6]]),b6={name:"SpaceInviations",components:{CreateInvitationLink:v6,AddMemberForm:so,InviationForm:to,PendingInvitations:d6},props:["space_profile"],data(){return{showInvitations:!0,currentTab:"invitations",defaultEmail:""}},methods:{handleCompleted(){this.showInvitations=!1,this.$nextTick(()=>{this.showInvitations=!0})}}},k6={key:0,class:"card_header"},w6={class:"permission_failed"},C6=["href"],$6={key:1};function S6(e,t,o,u,s,n){const m=g("pending-invitations"),p=wt,h=g("AddMemberForm"),y=g("CreateInvitationLink"),k=Ct;return e.hasSpaceAdminAccess(o.space_profile)?(i(),c("div",$6,[a(k,{modelValue:s.currentTab,"onUpdate:modelValue":t[0]||(t[0]=b=>s.currentTab=b),type:"border-card"},{default:r(()=>[a(p,{name:"invitations",label:e.$t("Invitations")},{default:r(()=>[s.currentTab=="invitations"?(i(),v(m,{key:0,space_id:o.space_profile.id},null,8,["space_id"])):_("",!0)]),_:1},8,["label"]),a(p,{name:"by_user",label:e.$t("New Invite")},{default:r(()=>[s.currentTab=="by_user"?(i(),v(h,{key:0,space_profile:o.space_profile},null,8,["space_profile"])):_("",!0)]),_:1},8,["label"]),a(p,{name:"invitation_links",label:e.$t("New Invitation Link")},{default:r(()=>[s.currentTab=="invitation_links"?(i(),v(y,{key:0,space_profile:o.space_profile},null,8,["space_profile"])):_("",!0)]),_:1},8,["label"])]),_:1},8,["modelValue"])])):(i(),c("div",k6,[l("div",w6,[l("h3",null,d(e.$t("Permission Denied")),1),l("p",null,d(e.$t("You do not have permission to view all members")),1),l("a",{href:e.$getRouteLink("space/:space_slug/home",{space_slug:o.space_profile.slug}),class:"el-button fcom_primary_button"},d(e.$t("Go to Space Home")),9,C6)])]))}const V6=F(b6,[["render",S6]]),L6={name:"GlobIcon"},M6={width:"14",height:"14",viewBox:"0 0 14 14",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},P6=l("path",{d:"M3.1564 3.30236C2.23368 4.26115 1.66634 5.5644 1.66634 7.00016C1.66634 9.9457 4.05415 12.3335 6.99967 12.3335C7.72021 12.3335 8.40741 12.1906 9.03441 11.9316C9.11107 11.4313 8.94287 10.9512 8.87407 10.7832C8.72101 10.4102 8.21574 9.7723 7.37227 8.88736C7.14714 8.6507 7.16161 8.46916 7.24207 7.9297L7.25134 7.86876C7.30601 7.49923 7.39774 7.28076 8.64114 7.08336C9.27281 6.98323 9.43894 7.2357 9.66921 7.5853C9.69467 7.62403 9.72014 7.66203 9.74621 7.7001C9.96494 8.01996 10.127 8.0931 10.3718 8.20443C10.4815 8.25416 10.6183 8.3169 10.8017 8.4211C11.2364 8.6695 11.2364 8.94996 11.2364 9.56496V9.6347C11.2364 9.89576 11.2109 10.125 11.1707 10.3241C11.8982 9.4125 12.333 8.2571 12.333 7.00016C12.333 4.80076 11.0017 2.9123 9.10094 2.09671C8.73214 2.34558 8.22621 2.69834 8.04967 2.94016C7.95941 3.06375 7.83181 3.6946 7.41681 3.74667C7.30807 3.76032 7.16221 3.75076 7.00767 3.74081C6.59334 3.71388 6.02647 3.67754 5.84501 4.17013C5.72981 4.4823 5.70954 5.3298 6.08227 5.7697C6.14194 5.83996 6.15347 5.96996 6.11294 6.11583C6.05967 6.30736 5.95207 6.4239 5.91854 6.44796C5.85427 6.41103 5.72607 6.26223 5.63926 6.16096C5.43003 5.91783 5.16904 5.61505 4.83165 5.52134C4.70897 5.48738 4.57411 5.45928 4.44333 5.43174C4.07727 5.35501 3.66263 5.26772 3.56629 5.06218C3.49595 4.91163 3.49626 4.7043 3.49653 4.48526C3.49653 4.20763 3.49653 3.89369 3.36053 3.58854C3.30798 3.47044 3.2376 3.37647 3.1564 3.30236ZM6.99967 13.6668C3.31777 13.6668 0.333008 10.682 0.333008 7.00016C0.333008 3.31826 3.31777 0.333496 6.99967 0.333496C10.6815 0.333496 13.6663 3.31826 13.6663 7.00016C13.6663 10.682 10.6815 13.6668 6.99967 13.6668Z",fill:"currentColor"},null,-1),F6=[P6];function T6(e,t,o,u,s,n){return i(),c("svg",M6,F6)}const oo=F(L6,[["render",T6]]),I6={name:"GroupIcon"},U6={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},B6=l("path",{d:"M13.8494 12C14.3489 12 14.7462 11.6856 15.103 11.2461C15.8333 10.3463 14.6342 9.62723 14.1769 9.27507C13.712 8.91708 13.1929 8.71428 12.6667 8.66667M12 7.33333C12.9205 7.33333 13.6667 6.58714 13.6667 5.66667C13.6667 4.74619 12.9205 4 12 4",stroke:"currentColor","stroke-linecap":"round"},null,-1),E6=l("path",{d:"M2.15096 12C1.65143 12 1.2541 11.6856 0.897356 11.2461C0.167051 10.3463 1.36611 9.62723 1.82342 9.27507C2.28831 8.91708 2.80738 8.71428 3.33366 8.66667M3.66699 7.33333C2.74652 7.33333 2.00033 6.58714 2.00033 5.66667C2.00033 4.74619 2.74652 4 3.66699 4",stroke:"currentColor","stroke-linecap":"round"},null,-1),A6=l("path",{d:"M5.38953 10.0738C4.70834 10.495 2.92232 11.3551 4.01013 12.4313C4.54151 12.957 5.13334 13.333 5.87741 13.333H10.1232C10.8673 13.333 11.4591 12.957 11.9905 12.4313C13.0783 11.3551 11.2923 10.495 10.6111 10.0738C9.01375 9.08608 6.9869 9.08608 5.38953 10.0738Z",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),D6=l("path",{d:"M10.3337 4.99984C10.3337 6.2885 9.28899 7.33317 8.00033 7.33317C6.71166 7.33317 5.66699 6.2885 5.66699 4.99984C5.66699 3.71117 6.71166 2.6665 8.00033 2.6665C9.28899 2.6665 10.3337 3.71117 10.3337 4.99984Z",stroke:"currentColor"},null,-1),R6=[B6,E6,A6,D6];function H6(e,t,o,u,s,n){return i(),c("svg",U6,R6)}const ts=F(I6,[["render",H6]]),x6={name:"AllCommunities",components:{User:ko,GlobIcon:oo,Layout:ve,AppLayout:we,CreateSpaceForm:It,GroupIcon:ts,Pagination:ke,Search:Ve},setup(){return{spaceStore:je()}},data(){return{communities:[],loading:!0,joining:!1,pagination:{page:1,per_page:24,total:0},search:"",type:"all",sort_by:"alphabetical"}},methods:{getCommunities(){this.loading=!0,this.$get("spaces/discover",{type:this.type,search:this.search,sort_by:this.sort_by,page:this.pagination.page,per_page:this.pagination.per_page}).then(e=>{this.communities=e.spaces.data,this.pagination.total=e.spaces.total,this.loading=!1})},goToSpaceFeeds(e){this.$router.push({name:"space_feeds",params:{space:e}})},getSpaceFeedsRoute(e){return{name:"space_feeds",params:{space:e}}},getExcerpt(e,t=50){if(!e)return"";let o=e.replace(/(<([^>]+)>)/ig,"");return o.length>t&&(o=o.substring(0,t)+"..."),o},async join(e){if(e.privacy!="public"||!this.auth.user_id){this.$router.push({name:"space_feeds",params:{space:e.slug}});return}this.joining=!0;try{await this.spaceStore.joinSpace(e.slug,e),this.$notify.success(this.$t("Successfully joined the space")),this.$eventBus.emit("reloadMenu"),e.user_status={status:"active"},this.$router.push({name:"space_feeds",params:{space:e.slug}})}catch(t){this.$handleError(t)}finally{this.joining=!1}},fireCreateSpace(e=null){this.$eventBus.emit("createSpaceModal",e)},goToSpaceGroups(){window.location.href=this.$getRouteLink("admin/settings/space_groups")},SwitchToSpaceView(e){this.type=e,this.getCommunities()},handleSearch(){this.search&&this.search.length<3||this.toSearch()},toSearch(){this.pagination.page=1,this.getCommunities()},changeSortBy(){this.$storeLocalData("space_sort_by",this.sort_by),this.toSearch()},openCreateSpace(e){e==="yes"&&this.fireCreateSpace()}},created(){this.$eventBus.on("open_create_space_modal",this.openCreateSpace)},mounted(){this.sort_by=this.$getLocalData("space_sort_by","alphabetical"),this.getCommunities(),this.$route.query.create_space=="yes"&&this.fireCreateSpace(),this.changeTitle(this.$t("Spaces"))},beforeUnmount(){this.$eventBus.off("open_create_space_modal",this.openCreateSpace)}},j6={class:"object_menu"},O6={class:"fcom_space_menu_ul"},N6={key:0},z6={key:1},q6={class:"actions_items"},G6={class:"search_member"},Y6={class:"feed_filters"},Z6=l("div",{class:"fcom_feed_divider"},null,-1),W6={id:"feed_short_by",class:"fcom_feed_filter_label"},J6={class:"fcom_communities"},Q6={key:0,class:"fcom_no_items_wrap"},K6={key:1,class:"fcom_box_card_list"},X6={class:"fcom_box_card_avatar"},eC=["src"],tC=["src"],sC=["alt","src"],oC={class:"fcom_box_card_info"},iC={class:"fcom_box_card_name"},nC={key:0},lC={class:"fcom_box_card_details"},aC={class:"details_item"},rC={key:0,class:"details_item"},cC={key:0,class:"fcom_box_card_description"},dC={class:"fcom_box_card_action"},uC=["disabled","onClick"],_C=["onClick"];function mC(e,t,o,u,s,n){const m=j,p=g("MoreFilled"),h=O,y=de,k=g("Search"),b=ee,$=ie,f=ne,w=g("router-link"),C=Oe,M=g("GlobIcon"),P=g("Lock"),T=g("GroupIcon"),I=g("pagination"),U=g("layout"),B=g("app-layout"),A=K("loading");return i(),v(B,{wrapper_class:"fcom_single_layout fcom_max_layout"},{default:r(()=>[a(U,{content_class:"no_bg_layout",title:e.$t("Spaces")+" "+(s.pagination.total?" ("+e.$formatNumber(s.pagination.total)+")":"")},{actions:r(()=>[l("div",j6,[l("ul",O6,[l("li",null,[l("a",{onClick:t[0]||(t[0]=Z(L=>n.SwitchToSpaceView("all"),["prevent"])),class:R(s.type=="all"?"router-link-active router-link-exact-active":""),href:"#"},d(e.$t("All Spaces")),3)]),e.auth.user_id?(i(),c("li",N6,[l("a",{onClick:t[1]||(t[1]=Z(L=>n.SwitchToSpaceView("joined"),["prevent"])),class:R(s.type=="joined"?"router-link-active router-link-exact-active":""),href:"#"},d(e.$t("My Spaces")),3)])):_("",!0),e.isAdmin()?(i(),c("li",z6,[a(m,{onClick:t[2]||(t[2]=L=>n.fireCreateSpace()),class:"fcom_primary_button"},{default:r(()=>[S(d(e.$t("New Space")),1)]),_:1})])):_("",!0)]),e.isAdmin()?(i(),v(y,{key:0,persistent:!1,ref:"space_actions",placement:"bottom",width:200,trigger:"click"},{reference:r(()=>[a(m,{"aria-label":e.$t("View actions"),class:"fcom_dot_menu",size:"small",text:""},{default:r(()=>[a(h,null,{default:r(()=>[a(p)]),_:1})]),_:1},8,["aria-label"])]),default:r(()=>[l("ul",q6,[l("li",{onClick:t[3]||(t[3]=(...L)=>n.goToSpaceGroups&&n.goToSpaceGroups(...L))},d(e.$t("View Space Groups")),1)])]),_:1},512)):_("",!0)])]),default:r(()=>[l("div",G6,[a(b,{clearable:"",onClear:n.toSearch,onKeydown:be(n.toSearch,["enter"]),onInput:n.handleSearch,modelValue:s.search,"onUpdate:modelValue":t[4]||(t[4]=L=>s.search=L),placeholder:e.$t("Search Space...")},{prefix:r(()=>[a(h,null,{default:r(()=>[a(k)]),_:1})]),_:1},8,["onClear","onKeydown","onInput","modelValue","placeholder"])]),l("div",Y6,[Z6,l("span",W6,d(e.$t("Sort by:")),1),a(f,{"aria-label":e.$t("Sort Spaces by"),modelValue:s.sort_by,"onUpdate:modelValue":t[5]||(t[5]=L=>s.sort_by=L),class:"fcom_minimal_select space_sort_select","popper-class":"plain_select",onChange:t[6]||(t[6]=L=>n.changeSortBy())},{default:r(()=>[a($,{value:"alphabetical",label:e.$t("Alphabetical")},null,8,["label"]),a($,{value:"latest",label:e.$t("Latest Spaces")},null,8,["label"]),a($,{value:"oldest",label:e.$t("Oldest Spaces")},null,8,["label"])]),_:1},8,["aria-label","modelValue"])]),N((i(),c("div",J6,[!s.loading&&s.communities.length==0?(i(),c("div",Q6,[s.search?(i(),c(V,{key:0},[l("h3",null,d(e.$t("No spaces found based on your search criteria")),1),l("p",null,d(e.$t("No spaces match your search criteria. Try adjusting your search terms or browse our space catalog.")),1)],64)):(i(),c(V,{key:1},[l("h3",null,d(e.$t("No spaces found")),1),l("p",null,d(e.$t("Please check back later. We are in a process to publish some spaces for you!")),1)],64))])):(i(),c("div",K6,[(i(!0),c(V,null,D(s.communities,L=>(i(),c("div",{role:"region","aria-label":"Space Lists",key:L.id,class:"fcom_each_box_card"},[l("div",X6,[a(w,{"aria-label":"Go to Space",to:n.getSpaceFeedsRoute(L.slug)},{default:r(()=>{var E;return[(E=L.settings)!=null&&E.og_image?(i(),c("img",{key:0,src:L.settings.og_image,alt:""},null,8,eC)):L.cover_photo?(i(),c("img",{key:1,src:L.cover_photo,alt:""},null,8,tC)):(i(),c("img",{key:2,alt:e.$t("Placeholder image"),src:e.appVars.assets_url+"images/space-placeholder.jpg"},null,8,sC))]}),_:2},1032,["to"])]),l("div",oC,[l("div",iC,[a(w,{to:n.getSpaceFeedsRoute(L.slug)},{default:r(()=>[S(d(n.getExcerpt(L.title,24))+" ",1),L.space_pivot?(i(),v(C,{key:0,type:"success"},{default:r(()=>[S(d(e.$labelize(L.space_pivot.role))+" ",1),L.space_pivot.status!="active"?(i(),c("span",nC," ("+d(e.$labelize(L.space_pivot.status))+") ",1)):_("",!0)]),_:2},1024)):_("",!0)]),_:2},1032,["to"])]),l("div",lC,[l("div",aC,[L.privacy==="public"?(i(),v(h,{key:0},{default:r(()=>[a(M)]),_:1})):(i(),v(h,{key:1},{default:r(()=>[a(P)]),_:1})),l("span",null,d(e.$labelize(L.privacy)),1)]),L.members_count?(i(),c("div",rC,[a(h,null,{default:r(()=>[a(T)]),_:1}),l("span",null,d(e.$_n("%s Member","%s Members",e.$formatNumber(L.members_count))),1)])):_("",!0)]),L.description?(i(),c("div",cC,d(n.getExcerpt(L.description,85)),1)):_("",!0),l("div",dC,[L.space_pivot?(i(),c("button",{key:1,class:"fcom_card_button",onClick:E=>n.goToSpaceFeeds(L.slug)},d(e.$t("View Space")),9,_C)):N((i(),c("button",{key:0,class:"fcom_card_button",disabled:s.joining,onClick:E=>n.join(L)},[S(d(e.$t("Join")),1)],8,uC)),[[A,s.joining]])])])]))),128))])),a(I,{hide_on_single:!0,onFetch:n.getCommunities,pagination:s.pagination},null,8,["onFetch","pagination"])])),[[A,s.loading]])]),_:1},8,["title"])]),_:1})}const hC=F(x6,[["render",mC]]),fC={name:"UserBadge",props:["badge","is_preview","profile"],computed:{renderingBadges(){var e;if(!this.appVars.user_badges&&!this.is_preview)return null;if(this.profile){let t=this.profile.badge_slugs;if(t||(t=(e=this.profile.meta)==null?void 0:e.badge_slug,typeof t=="string"&&(t=[t])),!t||t.length==0)return null;let o=[];for(let u=0;u<t.length;u++){let s=this.appVars.user_badges[t[u]];s&&o.push(s)}return o}return[this.badge]}}},pC=["src"],gC={key:1,class:"fcom_emoji"},yC={key:2,class:"fcom_shape"},vC={key:1};function bC(e,t,o,u,s,n){const m=O,p=ks;return n.renderingBadges?(i(!0),c(V,{key:0},D(n.renderingBadges,h=>(i(),c("div",{class:R([{user_icon_only:h.show_label!="yes"},"user_badge"])},[a(p,{content:h.title,placement:"top"},{default:r(()=>[l("div",{style:re({backgroundColor:h.background_color,color:h.color,borderColor:h.color}),class:"user_badge_inner"},[h.config?(i(),c(V,{key:0},[h.config.logo?(i(),c("img",{key:0,alt:"",src:h.config.logo},null,8,pC)):h.config.emoji?(i(),c("span",gC,d(h.config.emoji),1)):h.config.shape_svg?(i(),c("span",yC,[a(m,{innerHTML:h.config.shape_svg},null,8,["innerHTML"])])):_("",!0)],64)):_("",!0),h.show_label=="yes"?(i(),c("span",vC,d(h.title),1)):_("",!0)],4)]),_:2},1032,["content"])],2))),256)):_("",!0)}const io=F(fC,[["render",bC]]),kC={name:"AddNotificationIcon"},wC={viewBox:"0 0 24 24","aria-hidden":"true",color:"currentColor",class:"r-4qtqp9 r-yyyyoo r-dnmrzs r-bnwqim r-lrvibr r-m6rgpd r-z80fyv r-19wmn03"},CC=l("g",null,[l("path",{d:"M22 5v2h-3v3h-2V7h-3V5h3V2h2v3h3zm-.86 13h-4.241c-.464 2.281-2.482 4-4.899 4s-4.435-1.719-4.899-4H2.87L4 9.05C4.51 5.02 7.93 2 12 2v2C8.94 4 6.36 6.27 5.98 9.3L5.13 16h13.73l-.38-3h2.02l.64 5zm-6.323 0H9.183c.412 1.164 1.51 2 2.817 2s2.405-.836 2.817-2z"})],-1),$C=[CC];function SC(e,t,o,u,s,n){return i(),c("svg",wC,$C)}const VC=F(kC,[["render",SC]]),LC={name:"NotificationAddedIcon"},MC={viewBox:"0 0 24 24","aria-hidden":"true",color:"currentColor",class:"r-4qtqp9 r-yyyyoo r-dnmrzs r-bnwqim r-lrvibr r-m6rgpd r-z80fyv r-19wmn03"},PC=l("g",null,[l("path",{d:"M12 2C7.93 2 4.51 5.02 4 9.05L2.87 18H7.1c.46 2.28 2.48 4 4.9 4s4.44-1.72 4.9-4h4.24l-.64-5h-2.02l.38 3H5.13l.85-6.7C6.36 6.27 8.94 4 12 4V2zm0 18c-1.31 0-2.42-.83-2.83-2h5.66c-.41 1.17-1.52 2-2.83 2zm.3-12.29l1.41-1.42 1.76 1.76 4.29-4.72 1.48 1.34-5.7 6.28-3.24-3.24z"})],-1),FC=[PC];function TC(e,t,o,u,s,n){return i(),c("svg",MC,FC)}const IC=F(LC,[["render",TC]]),UC={name:"AddUserForm",components:{SpaceIcon:He,SpaceCourseSelector:Kt},props:["user_profile"],emits:["completed"],data(){return{loading:!0,saving:!1,selectedId:null,userMemberships:[],role:"member",selectedType:"space",selectedSlug:""}},methods:{updateSelectedType(e){this.selectedType=e},updateSelectedSlug(e){this.selectedSlug=e},fetchUserMemberships(){this.loading=!0,this.$get("profile/"+this.user_profile.username+"/memberships").then(e=>{this.userMemberships=e.memberships}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})},addToSpace(){if(this.selectedType==="space"&&!this.role){this.$notify.error(this.$t("Please select a role"));return}this.saving=!0,this.$post("spaces/"+this.selectedSlug+"/members",{user_id:this.user_profile.user_id,role:this.role}).then(e=>{this.$notify.success(e.message),this.selectedId=null,this.role="member",this.$emit("completed")}).catch(e=>{this.$handleError(e)}).finally(()=>{this.saving=!1})},addToCourse(){this.saving=!0,this.$post("admin/courses/"+this.selectedId+"/students",{user_id:this.user_profile.user_id}).then(e=>{this.$notify.success(e.message),this.selectedId=null,this.$emit("completed")}).catch(e=>{this.$handleError(e)}).finally(()=>{this.saving=!1})}},mounted(){this.fetchUserMemberships()}};function BC(e,t,o,u,s,n){const m=ee,p=ue,h=g("SpaceCourseSelector"),y=ie,k=ne,b=j,$=_e,f=K("loading");return i(),v($,{onSubmit:t[4]||(t[4]=Z(w=>e.doNothing(),["prevent"])),"label-position":"top"},{default:r(()=>[a(p,{label:e.$t("User")},{default:r(()=>[a(m,{modelValue:o.user_profile.display_name+" ("+o.user_profile.email+")",disabled:""},null,8,["modelValue"])]),_:1},8,["label"]),a(p,{label:e.$t("Select Space/Course")},{default:r(()=>[N(a(h,{modelValue:s.selectedId,"onUpdate:modelValue":t[0]||(t[0]=w=>s.selectedId=w),memberships:s.userMemberships,placeholder_text:e.$t("Select Space/Course"),onSelectedType:n.updateSelectedType,onSelectedSlug:n.updateSelectedSlug},null,8,["modelValue","memberships","placeholder_text","onSelectedType","onSelectedSlug"]),[[f,s.loading]])]),_:1},8,["label"]),s.selectedType==="space"?(i(),v(p,{key:0,label:e.$t("Membership Role")},{default:r(()=>[a(k,{placeholder:e.$t("Select Role"),modelValue:s.role,"onUpdate:modelValue":t[1]||(t[1]=w=>s.role=w)},{default:r(()=>[a(y,{label:e.$t("Member"),value:"member"},null,8,["label"]),a(y,{label:e.$t("Moderator"),value:"moderator"},null,8,["label"]),a(y,{label:e.$t("Admin"),value:"admin"},null,8,["label"])]),_:1},8,["placeholder","modelValue"])]),_:1},8,["label"])):_("",!0),z(e.$slots,"after_form",{},()=>[a(p,null,{default:r(()=>[s.selectedType==="course"?N((i(),v(b,{key:0,class:"fcom_primary_button",disabled:s.saving||!s.selectedId,onClick:t[2]||(t[2]=w=>n.addToCourse())},{default:r(()=>[S(d(e.$t("Add to Course")),1)]),_:1},8,["disabled"])),[[f,s.saving]]):N((i(),v(b,{key:1,class:"fcom_primary_button",disabled:s.saving||!s.selectedId,onClick:t[3]||(t[3]=w=>n.addToSpace())},{default:r(()=>[S(d(e.$t("Add to Space")),1)]),_:1},8,["disabled"])),[[f,s.saving]])]),_:1})])]),_:3})}const EC=F(UC,[["render",BC]]),AC={name:"ProfileHeader",emits:["refetch"],setup(){return{userStore:Te()}},components:{UserBadge:io,ImageUploader:Re,BookmarkIcon:Rs,FollowAction:Ye,AddNotificationIcon:VC,NotificationAddedIcon:IC,AddUserForm:EC},props:{profile:{required:!1},username:{required:!1},isOwn:{required:!1}},data(){return{updating:!1,isAddUserOpen:!1}},computed:{user_profile(){return this.profile?this.profile:{ID:0,title:".......",slug:"..",cover_photo:""}},isOwnProfile(){return this.auth&&this.user_profile.username==this.auth.username},level(){if(!this.has_leaderboard)return"";const e=Fe(this.user_profile.total_points);return e?e.level:0},getCoverPhotoButtonText(){return this.user_profile.cover_photo?this.$t("Change Cover"):this.$t("Upload Cover")},isOtherProfile(){var o;const e=this.auth.user_id,t=(o=this.profile)==null?void 0:o.user_id;return t&&e&&t!=e},showActions(){var e,t;return((t=(e=this.profile)==null?void 0:e.profile_nav_actions)==null?void 0:t.length)||this.showFollowAction},showFollowAction(){return this.hasFeature("followers_module")&&this.isOtherProfile},showOtherActions(){return this.isOtherProfile&&this.hasPermission("super_admin")},showBlock(){var t,o;if(!((t=this.profile)!=null&&t.user_id)||this.userStore.isBlocked(this.profile.user_id))return!1;const e=(o=this.profile)==null?void 0:o.follow;return this.showFollowAction&&(!e||String(e)!=="0")},isFollowing(){var t,o;if(!((t=this.profile)!=null&&t.user_id))return!1;if(this.userStore.isFollowing(this.profile.user_id))return!0;const e=(o=this.profile)==null?void 0:o.follow;return e!==void 0&&["1","2"].includes(String(e))},isNotificationOn(){var t,o;if(!((t=this.profile)!=null&&t.user_id))return!1;const e=this.userStore.getFollowLevel(this.profile.user_id);return e!==void 0?String(e)==="2":String((o=this.profile)==null?void 0:o.follow)==="2"},getTitle(){return this.isNotificationOn?this.$t("Turn off Email Notification of This User"):this.$t("Turn on Email Notification of This User")}},methods:{handleCoverPhotoUpload(e){this.profile.cover_photo=e,this.updateProfile({cover_photo:e})},handlePhotoUpload(e){this.profile.avatar=e,this.updateProfile({avatar:e})},removeCoverPhoto(){this.profile.cover_photo="",this.updateProfile({cover_photo:""})},confirmAndBlock(){this.$confirm(this.$t("Blocking this user will hide their posts from your feed and prevent them from interacting with you. Are you sure you want to block this user?"),{confirmButtonText:this.$t("Block"),cancelButtonText:this.$t("Cancel"),confirmButtonClass:"fcom_primary_button",cancelButtonClass:"fcom_secondary_button",type:"warning"}).then(()=>{this.blockUser()})},blockUser(){this.updating=!0,this.$post("profile/"+this.profile.username+"/block").then(e=>{var t;this.userStore.setFollows({[(t=this.profile)==null?void 0:t.user_id]:"0"}),this.$notify.success(e.message),this.$emit("refetch")}).catch(e=>{this.$handleError(e)}).finally(()=>{this.updating=!1})},toggleNotification(){var t;const e=this.profile.follow=="2"?"1":"2";(t=this.profile)!=null&&t.user_id&&this.userStore.setFollows({[this.profile.user_id]:e})},async updateProfile(e){if(this.user_profile.username){this.updating=!0;try{await this.userStore.updateProfile(e,this.user_profile.username,this.user_profile.username),this.$notify.success(this.$t("Profile updated successfully")),this.$emit("refetch")}catch(t){this.$handleError(t)}finally{this.updating=!1}}},toggleEmailNotification(){this.updating=!0,this.$post("profile/"+this.profile.username+"/notification").then(e=>{this.$notify.success(e.message),this.toggleNotification()}).catch(e=>{this.$handleError(e)}).finally(()=>{this.updating=!1})},openAddToDrawer(){this.isAddUserOpen=!0},userAdded(){this.isAddUserOpen=!1},handleDrawerClose(e){this.$refs.addUserForm&&(this.$refs.addUserForm.selectedId=null,this.$refs.addUserForm.role="member"),e()}}},DC={ref:"fcom_user_profile",class:"object_header user_header"},RC={key:0,class:"object_media_uploader"},HC={class:"object_info"},xC={class:"object_avatar"},jC=["alt","src"],OC={key:0,class:"object_avatar_uploader"},NC={key:1,style:{position:"absolute",right:"calc(12.5% - 9px)",bottom:"calc(36.5% - 5px)","line-height":"0",background:"rgb(67, 87, 173)",width:"20px",height:"20px","font-size":"12px",display:"flex","align-items":"center","justify-content":"center","border-radius":"50%",color:"#fff",border:"1px solid white"},role:"region","aria-label":"User Level",class:"fcom_user_level_mark"},zC={class:"object_name"},qC={class:"object_meta"},GC={key:0,class:"object_meta follower"},YC={class:"object_menu"},ZC={key:0,class:"fcom_profile_nav"},WC=["href","target"],JC={key:1,class:"fcom_profile_menu_actions"},QC=["target","href"];function KC(e,t,o,u,s,n){var L,E,G,se,H,X,x,Q,ce;const m=j,p=g("image-uploader"),h=g("UploadFilled"),y=O,k=g("verified-sign"),b=g("UserBadge"),$=g("router-link"),f=g("FollowAction"),w=g("NotificationAddedIcon"),C=g("AddNotificationIcon"),M=g("MoreFilled"),P=ot,T=it,I=nt,U=g("add-user-form"),B=$t,A=K("loading");return N((i(),c("div",DC,[l("div",{style:re({backgroundImage:`url('${n.user_profile.cover_photo||""}')`}),class:R(["object_cover",{no_cover:!n.user_profile.cover_photo}])},[n.isOwnProfile?(i(),c("div",RC,[a(p,{additionalData:{resize:!0,max_width:1500},onUploaded:n.handleCoverPhotoUpload},{default:r(()=>[a(m,{title:e.$t("Recommended Size: 1200 x 375px"),size:"small",plain:"",type:"primary"},{default:r(()=>[S(d(n.getCoverPhotoButtonText),1)]),_:1},8,["title"])]),_:1},8,["onUploaded"]),n.user_profile.cover_photo?(i(),v(m,{key:0,style:{"margin-top":"10px"},size:"small",plain:"",type:"danger",onClick:Z(n.removeCoverPhoto,["prevent"])},{default:r(()=>[S(d(e.$t("Remove")),1)]),_:1},8,["onClick"])):_("",!0)])):_("",!0)],6),l("div",HC,[l("div",xC,[l("img",{alt:e.$t("Placeholder Photo"),src:n.user_profile.avatar||e.appVars.assets_url+"/images/placeholder.png"},null,8,jC),n.isOwnProfile?(i(),c("div",OC,[a(p,{additionalData:{resize:!0,max_width:200},button_text:e.$t("Change"),onUploaded:n.handlePhotoUpload},{trigger:r(()=>[a(y,{class:"object_avatar_upload"},{default:r(()=>[a(h)]),_:1})]),_:1},8,["button_text","onUploaded"])])):_("",!0),n.level?(i(),c("div",NC,[l("span",null,d(n.level),1)])):_("",!0)]),l("div",zC,[l("h3",null,[S(d((L=n.user_profile)==null?void 0:L.display_name)+" ",1),(E=n.user_profile)!=null&&E.is_verified?(i(),v(k,{key:0})):_("",!0),a(b,{profile:n.user_profile},null,8,["profile"])]),l("p",qC,"@"+d((G=n.user_profile)==null?void 0:G.username),1),e.hasFeature("followers_module")?(i(),c("div",GC,[((se=n.user_profile)==null?void 0:se.followings_count)!=null?(i(),v($,{key:0,to:{name:"user_followings",params:{username:n.user_profile.username}}},{default:r(()=>[l("span",null,d(n.user_profile.followings_count),1),S(" "+d(e.$t("Following")),1)]),_:1},8,["to"])):_("",!0),((H=n.user_profile)==null?void 0:H.followers_count)!=null?(i(),v($,{key:1,to:{name:"user_followers",params:{username:n.user_profile.username}}},{default:r(()=>[l("span",null,d(n.user_profile.followers_count),1),S(" "+d(e.$t("Followers")),1)]),_:1},8,["to"])):_("",!0)])):_("",!0)])]),l("div",YC,[(x=(X=o.profile)==null?void 0:X.profile_navs)!=null&&x.length?(i(),c("ul",ZC,[(i(!0),c(V,null,D(o.profile.profile_navs,J=>(i(),c("li",{class:R(J.wrapper_class??"")},[J.route?(i(),v($,{key:0,class:R(J.css_class??""),to:J.route},{default:r(()=>[J.svg_icon?(i(),v(y,{key:0,innerHTML:J.svg_icon},null,8,["innerHTML"])):_("",!0),l("span",null,d(J.title),1)]),_:2},1032,["class","to"])):(i(),c("a",{key:1,href:J.url,class:R(J.css_class??""),target:J.is_external?"_blank":"_self"},[J.svg_icon?(i(),v(y,{key:0,innerHTML:J.svg_icon},null,8,["innerHTML"])):_("",!0),l("span",null,d(J.title),1)],10,WC))],2))),256))])):_("",!0),n.showActions?(i(),c("div",JC,[(ce=(Q=o.profile)==null?void 0:Q.profile_nav_actions)!=null&&ce.length?(i(!0),c(V,{key:0},D(o.profile.profile_nav_actions,J=>(i(),c("a",{class:R(J.css_class),target:J.is_external?"_blank":"_self",href:J.url},[J.svg_icon?(i(),v(y,{key:0,innerHTML:J.svg_icon},null,8,["innerHTML"])):_("",!0),l("span",null,d(J.title),1)],10,QC))),256)):_("",!0),n.showFollowAction||n.showOtherActions?(i(),c(V,{key:1},[n.showFollowAction?(i(),c(V,{key:0},[o.profile?(i(),v(f,{key:0,profile:o.profile,onRefetch:t[0]||(t[0]=J=>e.$emit("refetch"))},null,8,["profile"])):_("",!0),n.isFollowing?(i(),v(m,{key:1,class:"fcom_secondary_button icon_button",title:n.getTitle,loading:s.updating,disabled:s.updating,onClick:n.toggleEmailNotification},{default:r(()=>[n.isNotificationOn?(i(),v(y,{key:0},{default:r(()=>[a(w)]),_:1})):(i(),v(y,{key:1},{default:r(()=>[a(C)]),_:1}))]),_:1},8,["title","loading","disabled","onClick"])):_("",!0)],64)):_("",!0),n.showBlock||n.showOtherActions?(i(),v(I,{key:1,"popper-class":"fcom_pop_buttons",trigger:"click",style:{"margin-left":"8px"}},{dropdown:r(()=>[a(T,null,{default:r(()=>[n.showBlock?(i(),v(P,{key:0,onClick:t[1]||(t[1]=J=>n.confirmAndBlock())},{default:r(()=>[a(m,{"aria-label":e.$t("Block User"),class:"fcom_dot_menu edit_action",size:"small",text:"",type:"danger"},{default:r(()=>[S(d(e.$t("Block User")),1)]),_:1},8,["aria-label"])]),_:1})):_("",!0),n.showOtherActions?(i(),v(P,{key:1,onClick:t[2]||(t[2]=J=>n.openAddToDrawer())},{default:r(()=>[a(m,{"aria-label":e.$t("Add User to Space/Course"),class:"fcom_dot_menu edit_action",size:"small",text:"",type:"primary"},{default:r(()=>[S(d(e.$t("Add To Space/Course")),1)]),_:1},8,["aria-label"])]),_:1})):_("",!0)]),_:1})]),default:r(()=>[a(m,{class:"fcom_dot_menu edit_action",size:"small",text:""},{default:r(()=>[a(y,null,{default:r(()=>[a(M)]),_:1})]),_:1})]),_:1})):_("",!0)],64)):_("",!0)])):_("",!0)]),a(B,{modelValue:s.isAddUserOpen,"onUpdate:modelValue":t[3]||(t[3]=J=>s.isAddUserOpen=J),"close-on-click-modal":!0,"before-close":n.handleDrawerClose,"append-to-body":!0,size:e.modalWidth,direction:"rtl"},{header:r(()=>[l("h4",null,d(e.$t("Add User to Space/Course")),1)]),default:r(()=>[a(U,{ref:"addUserForm",onCompleted:n.userAdded,user_profile:n.user_profile},null,8,["onCompleted","user_profile"])]),_:1},8,["modelValue","before-close","size"])])),[[A,s.updating]])}const XC=F(AC,[["render",KC]]),e$={name:"ProfileAbout",components:{SocialLinks:at},props:["profile","isOwn"]},t$={class:"app_side_widget"},s$={class:"widget_header"},o$={key:0,class:"widget_actions"},i$={key:0,class:"widget_body"},n$=["innerHTML"],l$={key:1,style:{"text-align":"center"}},a$=l("hr",null,null,-1),r$=l("hr",null,null,-1),c$=["title"],d$=["title"];function u$(e,t,o,u,s,n){const m=g("EditPen"),p=O,h=j,y=g("SocialLinks"),k=q;return i(),c("div",t$,[l("div",s$,[l("h3",null,d(e.$t("About")),1),o.isOwn?(i(),c("div",o$,[a(h,{"aria-label":"Edit Your Profile",onClick:t[0]||(t[0]=b=>e.$router.push({name:"update_profile",params:{username:o.profile.username}})),text:""},{default:r(()=>[a(p,null,{default:r(()=>[a(m)]),_:1})]),_:1})])):_("",!0)]),o.profile?(i(),c("div",i$,[o.profile.short_description_rendered?(i(),c("div",{key:0,class:"space_description feed_md_content",innerHTML:o.profile.short_description_rendered},null,8,n$)):o.isOwn?(i(),c("div",l$,[a$,a(h,{"aria-label":"Add your profile description",onClick:t[1]||(t[1]=b=>e.$router.push({name:"update_profile",params:{username:o.profile.username}})),type:"info"},{default:r(()=>[a(p,null,{default:r(()=>[a(m)]),_:1}),l("span",null,d(e.$t("Add your profile description")),1)]),_:1})])):_("",!0),r$,l("div",{title:o.profile.created_at,class:"meta_line"},d(e.$t("Joined: %s",e.humanDateDiff(o.profile.created_at))),9,c$),o.profile.last_activity?(i(),c("div",{key:2,title:o.profile.last_activity,class:"meta_line"},d(e.$t("Last seen: %s",e.humanDateDiff(o.profile.last_activity))),9,d$)):_("",!0),a(y,{xprofile:o.profile,isOwn:o.isOwn},null,8,["xprofile","isOwn"])])):(i(),v(k,{key:1,animated:!0}))])}const no=F(e$,[["render",u$]]);const _$={name:"FeedProfile",props:["username"],components:{SpaceMenu:Qs,Layout:ve,AppLayout:we,UserHeader:XC,ProfileAbout:no,RecentActivities:Ut},setup(){return{userStore:Te()}},data(){return{defaultRoute:this.appVars.default_profile_tab,notFound:!1}},computed:{profile(){return this.userStore.getProfile(this.username)},loading(){return this.userStore.isLoading(this.username)},isOwn(){return this.profile&&this.profile.user_id==this.auth.user_id},showWidget(){var o;const{disable_sidebar:e}=this.$route.meta||{},t=((o=this.profile)==null?void 0:o.is_restricted)??!1;return!e&&!this.notFound&&!t}},watch:{username(){this.notFound=!1,this.getProfile()}},methods:{async getProfile(e=!1){this.notFound=!1;try{const t=await this.userStore.fetchProfile(this.username,e);this.changeTitle(t==null?void 0:t.display_name),(t==null?void 0:t.user_id)==this.auth.user_id&&(this.auth.compilation_score=t.compilation_score)}catch(t){if(this.username==="__me__"&&this.auth.username){let o=this.$route.params;o.username=this.auth.username,this.$router.push({name:this.$route.name,params:o,query:{signed:Date.now()}});return}t.xhr_status===404?(this.notFound=!0,this.changeTitle(this.$t("Profile Not Found"))):this.$handleError(t)}},approveUser(){this.loading=!0,this.$patch("members/"+this.profile.user_id,{status:"active"}).then(e=>{this.$notify.success(e.message),this.profile.status="active",this.getProfile(!0)}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})}},mounted(){if(this.username=="__me__"&&this.auth.username){let o=this.$route.params;o.username=this.auth.username,this.$router.push({name:this.$route.name,params:o,query:{signed:Date.now()}});return}this.getProfile();const t={about:"user_profile",posts:"user_profile_feeds",spaces:"user_spaces",comments:"user_comments"}[this.defaultRoute||""];t&&this.$route.name==="user_profile"&&t!==this.$route.name&&this.$router.replace({name:t,params:{username:this.username}})}},m$=e=>(ht("data-v-056b8554"),e=e(),ft(),e),h$={key:0},f$={key:1},p$=m$(()=>l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[l("path",{fill:"currentColor",d:"M512 128v64H256a64 64 0 0 0-64 64v512a64 64 0 0 0 64 64h512a64 64 0 0 0 64-64V512h64v256a128 128 0 0 1-128 128H256a128 128 0 0 1-128-128V256a128 128 0 0 1 128-128z"}),l("path",{fill:"currentColor",d:"M768 384a128 128 0 1 0 0-256 128 128 0 0 0 0 256m0 64a192 192 0 1 1 0-384 192 192 0 0 1 0 384"})],-1)),g$={class:"edit_profile"},y$={class:"fcom_profile_box"},v$={key:0,class:"fcom_404_container"},b$={class:"fcom_404_content"},k$={key:1,class:"profile_holder"},w$={key:2},C$={class:"fcom_main_side_wrap"},$$={class:"widget_recent_activities"};function S$(e,t,o,u,s,n){const m=g("router-link"),p=Nt,h=zt,y=j,k=O,b=g("EditPen"),$=g("user-header"),f=bi,w=g("router-view"),C=q,M=Ce,P=g("ProfileAbout"),T=g("RecentActivities"),I=Ne,U=De,B=g("layout"),A=g("app-layout");return i(),v(A,{wrapper_class:"fcom_single_layout fcom_member_profile fcom_max_layout"},{default:r(()=>[a(B,{wrapper_class:"no_bg_layout",title:"...."},{title:r(()=>[a(h,null,{default:r(()=>[a(p,null,{default:r(()=>[a(m,{to:{name:"all_members"}},{default:r(()=>[S(d(e.$t("Members")),1)]),_:1})]),_:1}),n.profile?(i(),v(p,{key:0},{default:r(()=>[n.isOwn?(i(),c("span",h$,d(e.$t("My Profile")),1)):(i(),c("span",f$,d(n.profile.display_name),1))]),_:1})):_("",!0)]),_:1})]),actions:r(()=>[n.profile&&e.hasPermission("super_admin")&&n.profile.status!="active"?(i(),c(V,{key:0},[n.profile.status?(i(),c(V,{key:0},[l("span",null,d(e.$labelize(n.profile.status)),1),a(y,{type:"success",onClick:t[0]||(t[0]=L=>e.$confirm(e.$t("Are you sure you want to approve this user?"),e.$t("Warning"),{type:"warning"}).then(()=>{n.approveUser()}))},{default:r(()=>[S(d(e.$t("Approve Account")),1)]),_:1})],64)):(i(),v(y,{key:1,disabled:!0},{default:r(()=>[S(d(e.$t("Self Deactivated Account")),1)]),_:1}))],64)):_("",!0),n.profile&&(n.isOwn||e.hasPermission("super_admin"))?(i(),c(V,{key:1},[a(m,{to:{name:"user_notification_settings",params:{username:n.profile.username}},class:"el-button el-button--text fcom_secondary_button"},{default:r(()=>[a(k,null,{default:r(()=>[p$]),_:1}),l("span",null,d(e.$t("Notification Settings")),1)]),_:1},8,["to"]),e.$route.name!=="update_profile"?(i(),v(y,{key:0,onClick:t[1]||(t[1]=L=>e.$router.push({name:"update_profile",params:{username:n.profile.username}})),class:"fcom_primary_button edit_profile_button"},{default:r(()=>[a(k,null,{default:r(()=>[a(b)]),_:1}),l("span",g$,d(e.$t("Edit Profile")),1)]),_:1})):_("",!0)],64)):_("",!0)]),default:r(()=>[s.notFound?_("",!0):(i(),v($,{key:0,username:o.username,isOwn:n.isOwn,profile:n.profile,onRefetch:n.getProfile},null,8,["username","isOwn","profile","onRefetch"])),a(U,{class:"fcom_resp_container fcom_space_container fcom_main_container"},{default:r(()=>[a(M,{class:"fcom_main"},{default:r(()=>[l("div",y$,[s.notFound?(i(),c("div",v$,[l("div",b$,[a(f,{icon:"error",title:e.$t("Profile Not Found")},{"sub-title":r(()=>[l("p",null,d(e.$t("The user profile you are looking for does not exist or has been removed.")),1)]),extra:r(()=>[e.auth.user_id?(i(),v(y,{key:0,onClick:t[2]||(t[2]=L=>e.$router.push({name:"all_members"})),class:"el-button fcom_primary_button"},{default:r(()=>[S(d(e.$t("Browse Members")),1)]),_:1})):_("",!0),a(y,{onClick:t[3]||(t[3]=L=>e.$router.push({name:"all_feeds"})),class:"el-button fcom_secondary_button"},{default:r(()=>[S(d(e.$t("Go to Home")),1)]),_:1})]),_:1},8,["title"])])])):n.profile?(i(),c("div",k$,[a(w,{isOwn:n.isOwn,username:o.username,profile:n.profile,onRefetch:n.getProfile},null,8,["isOwn","username","profile","onRefetch"])])):n.loading?(i(),c("div",w$,[a(C,{rows:10,animated:!0})])):_("",!0)])]),_:1}),n.showWidget?(i(),v(I,{key:0,class:"fcom_resp_side",width:"306px"},{default:r(()=>[l("div",C$,[l("div",$$,[e.$route.name!=="user_profile"?(i(),v(P,{key:0,isOwn:n.isOwn,profile:n.profile},null,8,["isOwn","profile"])):n.profile?(i(),v(T,{key:1,widget_title:e.$t("Recent Activities"),context:{user_id:n.profile.user_id}},null,8,["widget_title","context"])):_("",!0)])])]),_:1})):_("",!0)]),_:1})]),_:1})]),_:1})}const V$=F(_$,[["render",S$],["__scopeId","data-v-056b8554"]]),L$={name:"LockedProfile"},M$={class:"space_lock_box"},P$={class:"lock_header"},F$={class:"lock_desc"},T$=["href"];function I$(e,t,o,u,s,n){const m=g("Lock"),p=O;return i(),c("div",M$,[a(p,null,{default:r(()=>[a(m)]),_:1}),l("h3",P$,d(e.$t("This profile is private")),1),l("p",F$,d(e.$t("You do not have permission to view this profile's content.")),1),!e.auth.user_id&&e.appVars.allow_signup?(i(),c("a",{key:0,href:e.getCurrentAuthUrl(),class:"el-button fcom_primary_button"},d(e.$t("Login / Signup")),9,T$)):_("",!0)])}const Et=F(L$,[["render",I$]]),U$={name:"ProfileFeeds",components:{AllFeeds:rt,ErrorIcon:Ts,LockedProfile:Et},props:["profile","isOwn","username"],emits:["refetch"],setup(){return{uiStore:xe()}},beforeRouteLeave(e,t,o){if(e.name==="single_feed"||e.name==="space_feed"){let s=0;window.fcomLayoutRef&&window.fcomLayoutRef.wrapRef&&(s=window.fcomLayoutRef.wrapRef.scrollTop),this.uiStore.saveScrollPosition(t.path,s)}else this.uiStore.clearScrollPosition();o()},methods:{openScheduledPosts(){this.$router.push({name:"user_scheduled_posts"})}}},B$={key:0,class:"fcom_feed_report_wrap"},E$={class:"fcom_feed_report_content"},A$={class:"fcom_feed_report_action"};function D$(e,t,o,u,s,n){const m=g("LockedProfile"),p=g("ErrorIcon"),h=j,y=g("all-feeds");return o.profile.is_restricted?(i(),v(m,{key:0})):(i(),c(V,{key:1},[o.profile.scheduled_posts_count?(i(),c("div",B$,[l("div",E$,[a(p),l("span",null,d(e.$t("You currently have %s scheduled posts to be published",o.profile.scheduled_posts_count)),1)]),l("div",A$,[a(h,{onClick:t[0]||(t[0]=k=>n.openScheduledPosts())},{default:r(()=>[S(d(e.$t("View Posts")),1)]),_:1})])])):_("",!0),a(y,{feed_name:"profile_feed",require_space_selection:e.appVars.features.disable_global_posts,user_id:o.profile.user_id,hide_create_form:o.profile.user_id!=e.auth.user_id},null,8,["require_space_selection","user_id","hide_create_form"])],64))}const R$=F(U$,[["render",D$]]),H$={name:"ScheduledPosts",components:{Feed:Ze,Pagination:ke,EditFeed:Wt,AlarmClock:wo},props:["profile","isOwn","username"],emits:["refetch"],data(){return{loading:!1,saving:!1,scheduleModalVisible:!1,popoverVisible:null,scheduleForm:this.initScheduleForm(),feeds:[],isEdit:!1,editingFeed:null,pagination:{page:1,per_page:10,total:0,last_page:0}}},computed:{isPostCount(){return this.profile.scheduled_posts_count},isPopoverVisible(){return e=>this.popoverVisible===e.id},isDateDisabled(){return e=>e<new Date().setHours(0,0,0,0)},getStartTime(){if(!this.scheduleForm.date||!this.isToday(this.scheduleForm.date))return"00:00";const t=this.dayjs().add(30,"minute");if(!this.isToday(t.toDate()))return"23:50";const o=t.format("HH");let u=parseInt(t.format("mm"),10);return u=Math.ceil(u/10)*10,u===60?this.dayjs(t).add(1,"hour").format("HH")+":00":o+":"+(u<10?"0":"")+u}},methods:{initScheduleForm(){return{id:null,date:"",time:""}},getScheduledTime(e){return this.formattedDate(e)+" at "+this.formattedTime(e)},getSpaceRoute(e){return{name:"space_feeds",params:{space:e}}},cancelReschedule(){this.scheduleModalVisible=!1},initReschedule(e){this.scheduleModalVisible=!0,this.scheduleForm.id=e.id,this.scheduleForm.date=this.dayjs(e.scheduled_at).format("YYYY-MM-DD"),this.scheduleForm.time=this.dayjs(e.scheduled_at).format("HH:mm")},togglePopover(e){this.popoverVisible===e.id?this.popoverVisible=null:this.popoverVisible=e.id},hidePopover(e){this.popoverVisible===e.id&&(this.popoverVisible=null)},updateFeed(e){const t=this.feeds.findIndex(o=>o.id===e.id);t!==-1&&(this.feeds[t]=e),this.editingFeed=null},removeFeed(e){this.feeds=this.feeds.filter(t=>t.id!==e)},editItem(e){this.popoverVisible=!1,this.editingFeed=e,this.isEdit=!0},deleteItem(e){this.popoverVisible=!1,this.$confirm(this.$t("Are you sure you want to delete this feed?"),this.$t("Warning"),{confirmButtonText:this.$t("Delete"),cancelButtonText:this.$t("Cancel"),confirmButtonClass:"fcom_primary_button",cancelButtonClass:"fcom_secondary_button",type:"warning"}).then(()=>{this.saving=!0,this.$del("feeds/"+e.id).then(t=>{this.removeFeed(e.id),this.$notify.success(this.$t("Feed deleted successfully"))}).catch(t=>{this.$handleError(t)}).finally(()=>{this.saving=!1})})},copyFeedLink(e){this.popoverVisible=!1,this.$toClipboard(e.permalink)},publishNow(e){this.saving=!0,this.$post("scheduled-posts/publish/"+e.id).then(t=>{this.removeFeed(e.id),this.$notify.success(t.message)}).catch(t=>{this.$handleError(t)}).finally(()=>{this.saving=!1})},reschedulePost(){this.saving=!0;const e=`${this.scheduleForm.date} ${this.scheduleForm.time}:00`;this.$put("scheduled-posts/"+this.scheduleForm.id,{scheduled_at:e}).then(t=>{this.scheduleModalVisible=!1,this.scheduleForm=this.initScheduleForm(),this.updateFeed(t.feed),this.$notify.success(t.message)}).catch(t=>{this.$handleError(t)}).finally(()=>{this.saving=!1})},fetchFeeds(){this.loading=!0,this.$get("scheduled-posts",{page:this.pagination.page,per_page:this.pagination.per_page,user_id:this.profile.user_id}).then(e=>{this.feeds=e.feeds.data,this.pagination.total=e.feeds.total,this.pagination.last_page=e.feeds.last_page}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})}},mounted(){this.changeTitle(this.$t("Scheduled Posts")),(this.isAdmin()||this.auth.user_id==this.profile.user_id)&&this.fetchFeeds()}},x$={class:"scheduled_posts_header"},j$={class:"fcom_scheduled_posts_title"},O$={key:0},N$={key:1},z$={key:1,class:"fcom_feed_style_timeline fcom_scheduled_posts"},q$={class:"all_feeds_holder"},G$={class:"actions_items"},Y$=["onClick"],Z$=["onClick"],W$=["onClick"],J$={class:"feed_user"},Q$={class:"feed_user_name"},K$={class:"feed_meta_info"},X$=["title","href"],e7={key:0},t7={class:"post_actions"},s7={key:2,class:"feed_outer"},o7={class:"feed"},i7={style:{"text-align":"center"},class:"feed_body not_found"},n7={class:"dialog_header"},l7={class:"dialog_left schedule_header_left"},a7={class:"dialog_body"},r7={class:"dialog_footer"};function c7(e,t,o,u,s,n){const m=g("AlarmClock"),p=O,h=q,y=g("MoreFilled"),k=j,b=de,$=g("UserAvatar"),f=g("UserRouteLink"),w=g("router-link"),C=g("feed"),M=g("edit-feed"),P=Xe,T=ue,I=fs,U=_e,B=ye,A=g("pagination");return i(),c(V,null,[l("div",x$,[a(p,null,{default:r(()=>[a(m)]),_:1}),l("div",j$,[l("h3",null,d(e.$t("Scheduled Posts")),1),n.isPostCount?(i(),c("p",O$,d(e.$t("You currently have %s scheduled posts to be published",o.profile.scheduled_posts_count)),1)):(i(),c("p",N$,d(e.$t("You have no scheduled posts to be published")),1))])]),s.loading?(i(),v(h,{key:0,rows:5,animated:!0})):s.feeds.length?(i(),c("div",z$,[l("div",q$,[(i(!0),c(V,null,D(s.feeds,L=>(i(),c("div",{key:L.id,class:"feed_outer"},[a(C,{feed:L,layout_style:"timeline",hide_create_form:!0,show_footer:!1,show_actions:!1},{after_feed_actions:r(()=>[a(b,{persistent:!1,ref_for:!0,ref:"actionsPopover",placement:"bottom",width:200,trigger:"click",visible:n.isPopoverVisible(L),onHide:E=>n.hidePopover(L)},{reference:r(()=>[a(k,{"aria-label":e.$t("View Post actions"),class:"fcom_dot_menu",size:"small",text:"",onClick:E=>n.togglePopover(L)},{default:r(()=>[a(p,null,{default:r(()=>[a(y)]),_:1})]),_:2},1032,["aria-label","onClick"])]),default:r(()=>[l("ul",G$,[l("li",{onClick:E=>n.copyFeedLink(L)},d(e.$t("Copy Link")),9,Y$),e.canEditFeed(L)?(i(),c("li",{key:0,onClick:E=>n.editItem(L)},d(e.$t("Edit")),9,Z$)):_("",!0),e.canDeleteFeed(L)?(i(),c("li",{key:1,onClick:E=>n.deleteItem(L)},d(e.$t("Delete")),9,W$)):_("",!0)])]),_:2},1032,["visible","onHide"])]),after_feed_header:r(()=>[l("div",J$,[a($,{with_level:!1,xprofile:o.profile},null,8,["xprofile"]),l("div",null,[l("div",Q$,[a(f,{show_badge:!0,xprofile:o.profile},null,8,["xprofile"])]),l("div",K$,[l("a",{title:L.created_at,onClick:t[0]||(t[0]=(...E)=>e.gotoFeed&&e.gotoFeed(...E)),href:L.permalink,class:"feed_timestamp"},d(n.getScheduledTime(L.scheduled_at)),9,X$),L.space?(i(),c("span",e7,[a(w,{to:n.getSpaceRoute(L.space.slug),class:"feed_timestamp"},{default:r(()=>[S(d(e.$t("Posted in %s",e.getExcerpt(L.space.title,30))),1)]),_:2},1032,["to"])])):_("",!0)])])])]),after_feed_footer:r(()=>[l("div",t7,[a(k,{class:"fcom_secondary_button",onClick:E=>n.initReschedule(L),disabled:s.saving},{default:r(()=>[S(d(e.$t("Reschedule Post")),1)]),_:2},1032,["onClick","disabled"]),a(k,{class:"fcom_secondary_button",onClick:E=>n.publishNow(L),disabled:s.saving},{default:r(()=>[S(d(e.$t("Publish Now")),1)]),_:2},1032,["onClick","disabled"])])]),_:2},1032,["feed"])]))),128)),s.isEdit&&s.editingFeed?(i(),v(M,{key:0,feedSlug:s.editingFeed.slug,dialogVisible:s.isEdit,onUpdated:n.updateFeed,hide_create_form:!1,onClose:t[1]||(t[1]=L=>s.isEdit=!1)},null,8,["feedSlug","dialogVisible","onUpdated"])):_("",!0)])])):(i(),c("div",s7,[l("div",o7,[l("div",i7,[l("p",null,d(e.$t("No scheduled posts found!")),1)])])])),a(B,{modelValue:s.scheduleModalVisible,"onUpdate:modelValue":t[4]||(t[4]=L=>s.scheduleModalVisible=L),width:e.modalWidth,"modal-class":"fcom_common_dialog","append-to-body":!0,"close-on-click-modal":!1,onClose:n.cancelReschedule},{header:r(()=>[l("div",n7,[l("div",l7,[l("h4",null,d(e.$t("Reschedule Post")),1),l("p",null,d(e.$t("Choose a date and time in the future when you want your post to be published")),1)])])]),footer:r(()=>[l("div",r7,[a(k,{class:"fcom_secondary_button",disabled:s.saving,onClick:n.cancelReschedule},{default:r(()=>[S(d(e.$t("Cancel")),1)]),_:1},8,["disabled","onClick"]),a(k,{class:"fcom_primary_button",disabled:s.saving,onClick:n.reschedulePost},{default:r(()=>[S(d(e.$t("Reschedule")),1)]),_:1},8,["disabled","onClick"])])]),default:r(()=>[l("div",a7,[a(U,{"label-position":"top",class:"fcom_schedule_form"},{default:r(()=>[a(T,{label:e.$t("Date")},{default:r(()=>[a(P,{modelValue:s.scheduleForm.date,"onUpdate:modelValue":t[2]||(t[2]=L=>s.scheduleForm.date=L),type:"date","value-format":"YYYY-MM-DD",format:"YYYY-MM-DD",placeholder:e.$t("Select Date"),"disabled-date":n.isDateDisabled},null,8,["modelValue","placeholder","disabled-date"])]),_:1},8,["label"]),a(T,{label:e.$t("Time")},{default:r(()=>[a(I,{modelValue:s.scheduleForm.time,"onUpdate:modelValue":t[3]||(t[3]=L=>s.scheduleForm.time=L),disabled:!s.scheduleForm.date,style:{width:"210px"},step:"00:10",start:n.getStartTime,end:"23:59",placeholder:e.$t("Select Time")},null,8,["modelValue","disabled","start","placeholder"])]),_:1},8,["label"])]),_:1})])]),_:1},8,["modelValue","width","onClose"]),a(A,{pagination:s.pagination,onFetch:n.fetchFeeds},null,8,["pagination","onFetch"])],64)}const d7=F(H$,[["render",c7]]),u7={name:"UserSpaces",props:["profile"],components:{Calendar:Co,Baseball:$o,GroupIcon:ts,GlobIcon:oo,LockedProfile:Et},data(){return{communities:[],loading:!1}},methods:{getBtnLevel(e){return e=="course"?this.$t("View Course"):this.$t("View Space")},goToSpaceFeeds(e){this.$router.push({name:"space_feeds",params:{space:e}})},getExcerpt(e,t){return e.length>t?e.substring(0,t)+"...":e},removeMembership(e){this.$confirm(this.$t("Are you sure you want to remove this space?"),this.$t("Remove Space")).then(()=>{this.$post("spaces/"+e+"/members/remove",{user_id:this.profile.user_id}).then(()=>{this.fetch()}).catch(t=>{this.$handleError(t)})})},fetch(){this.loading=!0,this.$get("profile/"+this.profile.username+"/spaces").then(e=>{this.communities=e.spaces}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})}},mounted(){!this.profile.is_restricted&&this.profile.canViewUserSpaces&&this.fetch()}},_7={key:1,class:"user_spaces"},m7={class:"fcom_box_card_list"},h7=["onClick"],f7=["src"],p7=["src"],g7={key:2,class:"fcom_no_image"},y7={class:"fcom_box_card_info"},v7={class:"fcom_box_card_name"},b7={class:"fcom_box_card_details"},k7={class:"details_item"},w7={key:0,class:"details_item"},C7={class:"fcom_box_card_action"},$7=["onClick"],S7={key:0,class:"loading"},V7={key:1},L7={class:"no_members"},M7={key:2,class:"no_members"};function P7(e,t,o,u,s,n){const m=g("LockedProfile"),p=g("router-link"),h=g("MoreFilled"),y=O,k=j,b=ot,$=it,f=nt,w=g("GlobIcon"),C=g("Lock"),M=g("GroupIcon"),P=q;return o.profile.is_restricted?(i(),v(m,{key:0})):(i(),c("div",_7,[l("div",m7,[(i(!0),c(V,null,D(s.communities,T=>{var I;return i(),c("div",{key:T.id,class:"fcom_each_box_card"},[l("div",{class:"fcom_box_card_avatar",onClick:U=>n.goToSpaceFeeds(T.slug)},[(I=T.settings)!=null&&I.og_image?(i(),c("img",{key:0,src:T.settings.og_image,alt:""},null,8,f7)):T.cover_photo?(i(),c("img",{key:1,src:T.cover_photo,alt:""},null,8,p7)):(i(),c("div",g7))],8,h7),l("div",y7,[l("div",v7,[a(p,{class:"user_route",to:{name:"space_feeds",params:{space:T.slug}}},{default:r(()=>[S(d(n.getExcerpt(T.title,30)),1)]),_:2},1032,["to"]),e.isAdmin()?(i(),v(f,{key:0,trigger:"click"},{dropdown:r(()=>[a($,null,{default:r(()=>[a(b,{onClick:U=>n.removeMembership(T.slug)},{default:r(()=>[S(d(e.$t("Remove from space")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),default:r(()=>[a(k,{"aria-label":e.$t("View actions"),class:"fcom_dot_menu",size:"small",text:""},{default:r(()=>[a(y,null,{default:r(()=>[a(h)]),_:1})]),_:1},8,["aria-label"])]),_:2},1024)):_("",!0)]),l("div",b7,[l("div",k7,[T.privacy==="public"?(i(),v(y,{key:0},{default:r(()=>[a(w)]),_:1})):(i(),v(y,{key:1},{default:r(()=>[a(C)]),_:1})),l("span",null,d(T.privacy==="public"?e.$t("Public"):e.$t("Private")),1)]),T.members_count?(i(),c("div",w7,[a(y,null,{default:r(()=>[a(M)]),_:1}),l("span",null,d(e.$_n("%s Member","%s Members",e.$formatNumber(T.members_count))),1)])):_("",!0)]),l("div",C7,[l("button",{class:"fcom_card_button",onClick:U=>n.goToSpaceFeeds(T.slug)},d(n.getBtnLevel(T.type)),9,$7)])])])}),128))]),s.loading?(i(),c("div",S7,[a(P,{class:"white_loaded",rows:3,animated:!0}),a(P,{style:{"margin-top":"20px"},class:"white_loaded",rows:3,animated:!0})])):o.profile.canViewUserSpaces?!s.loading&&!s.communities.length?(i(),c("div",M7,d(e.$t("No Spaces found.")),1)):_("",!0):(i(),c("div",V7,[l("div",L7,d(e.$t("Sorry, you do not have permission to view this page")),1)]))]))}const F7=F(u7,[["render",P7]]),T7={name:"AccountDeactivation",props:["profile"],data(){return{selection:"init",working:!1}},methods:{deactivateAccount(){this.working=!0,this.$put("profile/"+this.profile.username,{data:{status:"deactivated"}}).then(e=>{this.$notify.success(e.message),window.location.reload(!0)}).catch(e=>{this.$handleError(e)}).finally(()=>{this.working=!1})}}},I7={style:{"margin-top":"30px"},class:"fcom_account_deactivation about_wrap"},U7={class:"about_header"},B7={style:{"margin-top":"10px"},class:"about_body"},E7={style:{"margin-top":"20px"}};function A7(e,t,o,u,s,n){const m=j;return i(),c("div",I7,[l("div",U7,[l("h3",null,d(e.$t("Account Deactivation")),1)]),l("div",B7,[s.selection=="init"?(i(),c(V,{key:0},[l("p",null,d(e.$t("If you no longer wish to keep your community account, click button below to deactivate your account.")),1),a(m,{onClick:t[0]||(t[0]=p=>s.selection="deactivate"),class:"fcom_secondary_button",style:{"margin-top":"20px"}},{default:r(()=>[S(d(e.$t("Continue to Deactivate Account")),1)]),_:1})],64)):s.selection=="deactivate"?(i(),c(V,{key:1},[l("h4",null,d(e.$t("This will deactivate your account")),1),l("p",null,d(e.$t("Deactivating your account will make your content and profile invisible to others. You will also lose access to the community until you reactivate your account.")),1),l("div",E7,[a(m,{onClick:t[1]||(t[1]=p=>s.selection="init"),class:"fcom_secondary_button"},{default:r(()=>[S(d(e.$t("Go Back")),1)]),_:1}),a(m,{onClick:t[2]||(t[2]=p=>n.deactivateAccount()),type:"danger"},{default:r(()=>[S(d(e.$t("Confirm Account Deactivation")),1)]),_:1})])],64)):_("",!0)])])}const D7=F(T7,[["render",A7]]),R7={name:"UserProfileUpdate",props:["isOwn","profile","username"],emits:["refetch"],components:{SlugInput:Tt,MarkdownEditor:St,AccountDeactivation:D7},setup(){const e=Te(),t=oe();return{userStore:e,cacheStore:t}},data(){return{updating:!1,loading:!1,notification_settings:{email_on_comment:!1},profileData:{},fcom_is_dirty:!1}},watch:{profile:{handler(e){e&&(this.profileData={username:e.username,display_name:e.display_name,first_name:e.first_name,last_name:e.last_name,email:e.email,website:e.website,short_description:e.short_description,user_id:e.user_id,is_verified:e.is_verified,social_links:e.social_links||{},badge_slugs:e.badge_slugs,status:e.status})},immediate:!0}},methods:{async updateProfile(){this.updating=!0;try{const e=await this.$post(`profile/${this.username}`,{data:this.profileData});if(e.redirect_url){window.location.href=e.redirect_url;return}const t=e.profile;this.username!==t.username&&(delete this.userStore.profilesByUsername[this.username],this.cacheStore.invalidate(`user-profile:${this.username}`)),this.userStore.profilesByUsername[t.username]=t,this.cacheStore.invalidate(`user-profile:${t.username}`),this.fcom_is_dirty=!1,this.$notify.success(this.$t("Profile updated successfully")),t.user_id==this.auth.user_id&&(this.auth.compilation_score=t.compilation_score),this.username!==t.username&&this.$router.push({name:"update_profile",params:{username:t.username}}),this.$emit("refetch")}catch(e){this.$handleError(e)}finally{this.updating=!1}},isEmpty:qt},async mounted(){await this.userStore.fetchProfile(this.username,!0),this.$nextTick(()=>{const e=document.querySelector(".object_info");e&&window.scrollTo({top:e.offsetTop-100,behavior:"smooth"})})}},H7={key:0,class:"fcom_sub_group"},x7={class:"fcom_sub_group_header"},j7={class:"fcom_sub_group_content"},O7={key:1,style:{"margin-bottom":"20px"}},N7={key:0,class:"fcom_sub_group"},z7={class:"fcom_sub_group_header"},q7={key:1},G7={style:{color:"var(--el-color-danger, red)"},class:"help_msg"},Y7={key:2,class:"help_msg"},Z7={class:"fcom_sub_group"},W7={class:"fcom_fixed_bottom_overlay"};function J7(e,t,o,u,s,n){const m=ee,p=ue,h=et,y=tt,k=g("markdown-editor"),b=O,$=he,f=g("UserBadge"),w=ie,C=ne,M=Ue,P=ge,T=g("slug-input"),I=j,U=_e,B=g("account-deactivation"),A=K("loading");return i(),c(V,null,[l("div",{class:R([{fcom_is_dirty:s.fcom_is_dirty},"fcom_update_profile"])},[a(U,{onSubmit:t[9]||(t[9]=Z(L=>e.doNothing(),["prevent"])),onInput:t[10]||(t[10]=L=>s.fcom_is_dirty=!0),"label-position":"top",modelValue:s.profileData,"onUpdate:modelValue":t[11]||(t[11]=L=>s.profileData=L)},{default:r(()=>[a(y,{gutter:30},{default:r(()=>[a(h,{xs:24,md:12},{default:r(()=>[a(p,{label:e.$t("First Name")},{default:r(()=>[a(m,{modelValue:s.profileData.first_name,"onUpdate:modelValue":t[0]||(t[0]=L=>s.profileData.first_name=L)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),a(h,{xs:24,md:12},{default:r(()=>[a(p,{label:e.$t("Last Name")},{default:r(()=>[a(m,{modelValue:s.profileData.last_name,"onUpdate:modelValue":t[1]||(t[1]=L=>s.profileData.last_name=L)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),a(y,{gutter:30},{default:r(()=>[a(h,{xs:24,md:12},{default:r(()=>[a(p,{label:e.$t("Email")},{default:r(()=>[a(m,{disabled:!o.profile.can_change_email,modelValue:s.profileData.email,"onUpdate:modelValue":t[2]||(t[2]=L=>s.profileData.email=L)},null,8,["disabled","modelValue"])]),_:1},8,["label"])]),_:1}),a(h,{xs:24,md:12},{default:r(()=>[a(p,{label:e.$t("Website URL")},{default:r(()=>[a(m,{type:"url",modelValue:s.profileData.website,"onUpdate:modelValue":t[3]||(t[3]=L=>s.profileData.website=L)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),a(p,{class:"fcom_editor_input_wrap",label:e.$t("Short Bio")},{default:r(()=>[a(k,{disable_mention:!0,disable_media:!0,modelValue:s.profileData.short_description,"onUpdate:modelValue":t[4]||(t[4]=L=>s.profileData.short_description=L)},null,8,["modelValue"])]),_:1},8,["label"]),n.isEmpty(e.appVars.socialLinkProviders)?_("",!0):(i(),c("div",H7,[l("div",x7,[l("h5",null,d(e.$t("Social Links")),1),l("p",null,d(e.$t("Add your social media profile link.")),1)]),l("div",j7,[(i(!0),c(V,null,D(e.appVars.socialLinkProviders,(L,E)=>(i(),v(p,{key:E,label:L.title},{default:r(()=>[a(m,{placeholder:L.placeholder,modelValue:s.profileData.social_links[E],"onUpdate:modelValue":G=>s.profileData.social_links[E]=G},{prepend:r(()=>[a(b,{style:{"margin-right":"10px"},innerHTML:L.icon_svg},null,8,["innerHTML"]),l("span",null,d(L.domain),1)]),_:2},1032,["placeholder","modelValue","onUpdate:modelValue"])]),_:2},1032,["label"]))),128))])])),o.profile.can_change_username?(i(),c("div",O7,[e.hasPermission("super_admin")?(i(),c("div",N7,[l("div",z7,[l("h5",null,d(e.$t("Admin Actions")),1),l("p",null,d(e.$t("Admin tools for account verification and status management.")),1)]),a(p,{label:e.$t("Account Verification"),class:"checkbox_label"},{default:r(()=>[a($,{"true-value":1,"false-value":0,modelValue:s.profileData.is_verified,"onUpdate:modelValue":t[5]||(t[5]=L=>s.profileData.is_verified=L),class:"fcom_checkbox"},{default:r(()=>[S(d(e.$t("Mark this account as verified")),1)]),_:1},8,["modelValue"])]),_:1},8,["label"]),e.appVars.user_badges?(i(),v(p,{key:0,label:e.$t("Profile Badges")},{default:r(()=>[a(C,{clearable:"",multiple:!0,modelValue:s.profileData.badge_slugs,"onUpdate:modelValue":t[6]||(t[6]=L=>s.profileData.badge_slugs=L),placeholder:e.$t("User Profile Badge")},{default:r(()=>[(i(!0),c(V,null,D(e.appVars.user_badges,L=>(i(),v(w,{key:L.slug,label:L.title,value:L.slug},{default:r(()=>[a(f,{badge:L,is_preview:!0},null,8,["badge"])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):_("",!0),a(p,{label:e.$t("Access Status")},{default:r(()=>[a(P,{modelValue:s.profileData.status,"onUpdate:modelValue":t[7]||(t[7]=L=>s.profileData.status=L),class:"fcom_radio_group"},{default:r(()=>[a(M,{value:"active"},{default:r(()=>[S(d(e.$t("Active")),1)]),_:1}),a(M,{value:"pending"},{default:r(()=>[S(d(e.$t("Pending")),1)]),_:1}),a(M,{value:"blocked"},{default:r(()=>[S(d(e.$t("Blocked")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),s.profileData.status?s.profileData.status!="active"?(i(),c("div",Y7,[l("p",null,d(e.$t("The user cannot access the portal.")),1)])):_("",!0):(i(),c("div",q7,[l("p",G7,d(e.$t("This user deactivated his/her account from the self managed profile section. if you want to reactivate the account, please select an updated status.")),1)]))])):_("",!0),l("div",Z7,[a(p,{label:e.$t("Community Account Username")},{default:r(()=>[a(T,{is_inital_inactive:!0,modelValue:s.profileData.username,"onUpdate:modelValue":t[8]||(t[8]=L=>s.profileData.username=L),prefix:"@","pop-message":e.$t("Are you sure you want to change username?"),edit_notice:e.$t("Please choose a username matching with your first/last name or full name"),placeholder:e.$t("Username")},null,8,["modelValue","pop-message","edit_notice","placeholder"])]),_:1},8,["label"])])])):_("",!0),a(p,null,{default:r(()=>[l("div",W7,[N((i(),v(I,{class:"fcom_primary_button",onClick:n.updateProfile,disabled:s.updating},{default:r(()=>[S(d(e.$t("Save Changes")),1)]),_:1},8,["onClick","disabled"])),[[A,s.updating]])])]),_:1})]),_:1},8,["modelValue"])],2),e.hasFeature("can_deactivate_account")&&o.profile.username==e.appVars.auth.username?(i(),v(B,{key:0,profile:o.profile},null,8,["profile"])):_("",!0)],64)}const Q7=F(R7,[["render",J7]]),K7={name:"UserAbout",props:["profile","isOwn"],components:{Timer:_s,SocialLinks:at,CalendarIcon:As,LockedProfile:Et},computed:{hasSocialLinks(){return this.socialLinks.length>0},socialLinks(){var u,s;let e=(u=this.profile)==null?void 0:u.social_links;e||(e=(s=this.profile.meta)==null?void 0:s.social_links);const t=[];if(this.profile.website&&t.push({title:this.$t("Website"),icon:'<svg viewBox="0 0 40 20" fill="currentColor"><path d="M3.8 10C3.8 6.58 6.58 3.8 10 3.8H18V0H10C4.48 0 0 4.48 0 10C0 15.52 4.48 20 10 20H18V16.2H10C6.58 16.2 3.8 13.42 3.8 10ZM12 12H28V8H12V12ZM30 0H22V3.8H30C33.42 3.8 36.2 6.58 36.2 10C36.2 13.42 33.42 16.2 30 16.2H22V20H30C35.52 20 40 15.52 40 10C40 4.48 35.52 0 30 0Z"></path></svg>',text:this.profile.website,url:this.profile.website}),!e)return t;const o=this.appVars.socialLinkProviders;return Object.entries(o).forEach(([n,m])=>{e[n]&&t.push({title:m.title,icon:m.icon_svg,text:e[n],url:m.domain+e[n]})}),t}},methods:{goToUpdateProfile(){this.$router.push({name:"update_profile",params:{username:this.profile.username}})}}},X7={key:1,class:"about_wrap"},e9={class:"about_header"},t9={key:0,class:"about_body"},s9=["innerHTML"],o9={key:1},i9={class:"about_items"},n9=["title"],l9=["title"],a9={key:2,class:"about_items"},r9={key:0,class:"items_title"},c9=["href","title"];function d9(e,t,o,u,s,n){const m=g("LockedProfile"),p=g("EditPen"),h=O,y=j,k=g("CalendarIcon"),b=g("Timer"),$=q;return o.profile.is_restricted?(i(),v(m,{key:0})):(i(),c("div",X7,[l("div",e9,[l("h3",null,d(e.$t("About")),1),o.isOwn?(i(),v(y,{key:0,"aria-label":"Edit your profile description",onClick:n.goToUpdateProfile,text:""},{default:r(()=>[a(h,null,{default:r(()=>[a(p)]),_:1})]),_:1},8,["onClick"])):_("",!0)]),o.profile?(i(),c("div",t9,[o.profile.short_description_rendered?(i(),c("div",{key:0,class:"about_description feed_texts feed_md_content",innerHTML:o.profile.short_description_rendered},null,8,s9)):o.isOwn?(i(),c("div",o9,[a(y,{class:"fcom_plain_button",onClick:t[0]||(t[0]=f=>e.$router.push({name:"update_profile",params:{username:o.profile.username}}))},{default:r(()=>[l("span",null,d("+ "+e.$t("Add your profile description")),1)]),_:1})])):_("",!0),l("div",i9,[o.profile.created_at?(i(),c("div",{key:0,title:o.profile.created_at,class:"about_item"},[a(h,null,{default:r(()=>[a(k)]),_:1}),l("span",null,d(e.$t("Joined %s",e.humanDateDiff(o.profile.created_at))),1)],8,n9)):_("",!0),o.profile.last_activity?(i(),c("div",{key:1,title:o.profile.last_activity,class:"about_item"},[a(h,null,{default:r(()=>[a(b)]),_:1}),S(" "+d(e.$t("Last seen: %s",e.humanDateDiff(o.profile.last_activity))),1)],8,l9)):_("",!0)]),n.hasSocialLinks||o.isOwn?(i(),c("div",a9,[n.hasSocialLinks?(i(),c("div",r9,d(e.$t("Social Links")),1)):_("",!0),(i(!0),c(V,null,D(n.socialLinks,f=>(i(),c("a",{target:"_blank",href:f.url,key:f.title,title:f.title,class:"about_item"},[a(h,{innerHTML:f.icon},null,8,["innerHTML"]),S(" "+d(f.text),1)],8,c9))),128)),o.isOwn&&!n.hasSocialLinks?(i(),v(y,{key:1,class:"fcom_plain_button",onClick:n.goToUpdateProfile},{default:r(()=>[l("span",null,d("+ "+e.$t("Add social links")),1)]),_:1},8,["onClick"])):_("",!0)])):_("",!0)])):(i(),v($,{key:1,animated:!0}))]))}const u9=F(K7,[["render",d9]]),_9={name:"UserComments",props:["profile","username","isOwn"],emits:["refetch"],components:{Pagination:ke,Check:ms,ImageIcon:Yt,FeedMdContent:Mt,LockedProfile:Et},data(){return{comments:[],loading:!0,pagination:{page:1,per_page:10,total:0},working:!1,replyingComemnt:null,isReplying:!1}},methods:{fetchComments(){this.loading=!0,this.$get("profile/"+this.username+"/comments",{page:this.pagination.page,per_page:this.pagination.per_page}).then(e=>{this.comments=e.comments.data,this.pagination.total=e.comments.total,window.scrollTo(0,0)}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})},deleteComment(e,t){this.$confirm(this.$t("Are you sure you want to delete this comment and associated data?"),"Warning",{confirmButtonText:this.$t("Delete"),cancelButtonText:this.$t("Cancel"),confirmButtonClass:"fcom_primary_button",cancelButtonClass:"fcom_secondary_button",type:"warning"}).then(()=>{this.working=!0,this.$del("feeds/"+e.post_id+"/comments/"+e.id).then(o=>{this.comments.splice(t,1),this.$notify.success(o.message)}).catch(o=>{this.$handleError(o)}).finally(()=>{this.working=!1})})},initCommentReply(e){this.replyingComemnt=e,this.$nextTick(()=>{this.isReplying=!0})},limitCharacters(e,t){return e.slice(0,t)+(e.length>t?"...":"")},getPostRoute(e){var o;let t=(o=e.post)==null?void 0:o.type;return!t||!e.post?{name:"all_feeds"}:t=="text"||t=="article"?{name:"single_feed",params:{feed_slug:e.post.slug},query:{comment_id:e.id}}:t=="course_lesson"&&e.post.space?{name:"view_lesson",params:{course_slug:e.post.space.slug,lesson_slug:e.post.slug},query:{comment_id:e.id}}:{name:"all_feeds",query:{comment_id:e.id,post_id:e.post.id}}},getPostExcerpt(e){let t=e.type;t=="text"&&(t="");let o="";return e.title?o=e.title:o=this.getExcerpt(e.message,50),o+(t?" ("+t+")":"")}},mounted(){this.profile.is_restricted||this.fetchComments()}},m9={key:1,class:"white_loaded"},h9={class:"course_comments feed_comments user_comments"},f9=l("span",{class:"comment_icon"},null,-1),p9={class:"comment_text_head"},g9=["title"],y9={class:"comment_action"},v9={class:"comment_text_head_post"},b9={class:"comment_text"},k9={key:1,class:"comment_text_body feed_md_content media_only_content"},w9={key:0};function C9(e,t,o,u,s,n){const m=g("LockedProfile"),p=q,h=g("Delete"),y=O,k=j,b=g("router-link"),$=g("FeedMdContent"),f=g("ImageIcon"),w=g("pagination");return o.profile.is_restricted?(i(),v(m,{key:0})):s.loading?(i(),c("div",m9,[a(p,{row:5})])):(i(),c(V,{key:2},[l("div",h9,[(i(!0),c(V,null,D(s.comments,(C,M)=>(i(),c("div",{key:C.id,class:"fcom_course_comment each_comment"},[f9,l("div",p9,[l("div",{title:C.created_at,class:"comment_text_head_time"},d(e.humanDateDiff(C.created_at)),9,g9),l("div",y9,[o.isOwn?(i(),v(k,{key:0,class:"fcom_plain_button",onClick:P=>n.deleteComment(C,M)},{default:r(()=>[a(y,null,{default:r(()=>[a(h)]),_:1})]),_:2},1032,["onClick"])):_("",!0)])]),l("div",v9,[a(b,{class:"post_link",to:n.getPostRoute(C)},{default:r(()=>[S(d(n.getPostExcerpt(C.post)),1)]),_:2},1032,["to"])]),l("div",b9,[C.message_rendered?(i(),v($,{key:0,class_name:"comment_text_body",content:C.message_rendered},null,8,["content"])):(i(),c("div",k9,[a(f,{class:"fcom_status_img_icon"})]))])]))),128)),s.pagination.total?_("",!0):(i(),c("div",w9,[l("h5",null,d(e.$t("%s did not add any comment to any posts yet",o.profile.display_name)),1)]))]),a(w,{pagination:s.pagination,onFetch:n.fetchComments},null,8,["pagination","onFetch"])],64))}const $9=F(_9,[["render",C9]]);const S9={name:"NotificationPref",components:{NotificationOnboard:Ns,Notification:So},props:["username"],data(){return{pref:{},spaceGroups:[],is_custom:!1,loading:!1,error:"",saving:!1,digestEmailDay:"",initialState:null,default_messaging_email_frequency:""}},computed:{fcom_is_dirty(){return this.initialState?JSON.stringify(this.pref)+JSON.stringify(this.spaceGroups)!=this.initialState:!1}},methods:{getPrefs(){this.loading=!0,this.$get(`profile/${this.username}/notification-preferences`).then(e=>{this.pref=e.user_globals,this.spaceGroups=e.spaceGroups,this.digestEmailDay=e.digestEmailDay,this.default_messaging_email_frequency=e.default_messaging_email_frequency,this.initialState=JSON.stringify(this.pref)+JSON.stringify(this.spaceGroups)}).catch(e=>{this.error=e==null?void 0:e.message,this.$handleError(e)}).finally(()=>{this.loading=!1})},saveSettings(){this.saving=!0;let e={};this.spaceGroups.forEach(t=>{t.spaces.forEach(o=>{e[o.id]=o.pref})}),this.$post(`profile/${this.username}/notification-preferences`,{user_globals:this.pref,space_prefs:e}).then(t=>{this.$notify.success(t.message),this.initialState=JSON.stringify(this.pref)+JSON.stringify(this.spaceGroups)}).catch(t=>{this.$handleError(t)}).finally(()=>{this.saving=!1})}},mounted(){(this.auth.user_id||this.hasPermission("super_admin"))&&this.getPrefs()}},V9={class:"fcom_notification_config"},L9={key:0},M9=["innerHTML"],P9={key:1,class:"white_loaded"},F9={class:"fcom_notification_card"},T9={class:"fcom_notification_card__header"},I9={class:"fcom_notification_card__title"},U9={class:"fcom_notification_card__body"},B9={class:"fcom_input_wrap"},E9={key:0},A9={key:1,class:"fcom_not_enabled"},D9={class:"fcom_input_wrap"},R9={key:0},H9={key:1,class:"fcom_not_enabled"},x9={class:"fcom_input_wrap"},j9={key:0},O9={key:1,class:"fcom_not_enabled"},N9={class:"fcom_input_wrap"},z9={key:0},q9={key:1,class:"fcom_not_enabled"},G9={key:0,class:"fcom_input_wrap"},Y9={style:{"font-weight":"500","font-size":"16px",margin:"10px 0 5px 0"}},Z9={key:0,class:"fcom_not_enabled"},W9={key:1,class:"fcom_not_enabled"},J9={key:2,class:"fcom_not_enabled"},Q9={class:"fcom_notification_card"},K9={class:"fcom_notification_card__header"},X9=l("svg",{version:"1.1",viewBox:"0 0 128 128","xml:space":"preserve"},[l("g",null,[l("path",{d:"M64,42c-13.2,0-24,10.8-24,24s10.8,24,24,24s24-10.8,24-24S77.2,42,64,42z M64,82c-8.8,0-16-7.2-16-16s7.2-16,16-16   s16,7.2,16,16S72.8,82,64,82z"}),l("path",{d:"M64,100.8c-14.9,0-29.2,6.2-39.4,17.1l-2.7,2.9l5.8,5.5l2.7-2.9c8.8-9.4,20.7-14.6,33.6-14.6s24.8,5.2,33.6,14.6l2.7,2.9   l5.8-5.5l-2.7-2.9C93.2,107.1,78.9,100.8,64,100.8z"}),l("path",{d:"M97,47.9v8c9.4,0,18.1,3.8,24.6,10.7l5.8-5.5C119.6,52.7,108.5,47.9,97,47.9z"}),l("path",{d:"M116.1,20c0-10.5-8.6-19.1-19.1-19.1S77.9,9.5,77.9,20S86.5,39.1,97,39.1S116.1,30.5,116.1,20z M85.9,20   c0-6.1,5-11.1,11.1-11.1s11.1,5,11.1,11.1s-5,11.1-11.1,11.1S85.9,26.1,85.9,20z"}),l("path",{d:"M31,47.9c-11.5,0-22.6,4.8-30.4,13.2l5.8,5.5c6.4-6.9,15.2-10.7,24.6-10.7V47.9z"}),l("path",{d:"M50.1,20C50.1,9.5,41.5,0.9,31,0.9S11.9,9.5,11.9,20S20.5,39.1,31,39.1S50.1,30.5,50.1,20z M31,31.1   c-6.1,0-11.1-5-11.1-11.1S24.9,8.9,31,8.9s11.1,5,11.1,11.1S37.1,31.1,31,31.1z"})])],-1),eS={class:"fcom_notification_card__title"},tS={class:"fcom_card_sections fcom_course_type_structured"},sS={class:"fcom_section_labels"},oS={class:"fcom_lebel fcom_label_lesson"},iS={style:{"text-align":"right"},class:"fcom_lebel fcom_label_actions"},nS={class:"fcom_section_primary"},lS={class:"fcom_section_primary_item"},aS={class:"fcom_section_primary_item_title"},rS={class:"fcom_section_items"},cS={class:"fcom_section_item"},dS={class:"fcom_section_item_title"},uS=["innerHTML"],_S=["innerHTML"],mS={key:2,class:"fcom_no_avatar"},hS={class:"fcom_section_item_actions"},fS={key:1,class:"fcom_section_labels"},pS={class:"fcom_notification_card fcom_fixed_bottom_overlay"},gS={key:3},yS={key:0},vS=["href"];function bS(e,t,o,u,s,n){const m=q,p=g("NotificationOnboard"),h=g("Notification"),y=O,k=he,b=Ue,$=ge,f=ie,w=ne,C=j;return i(),c("div",V9,[s.error?(i(),c("div",L9,[l("p",{innerHTML:s.error},null,8,M9)])):s.loading?(i(),c("div",P9,[a(m,{rows:10,animated:!0})])):e.auth.user_id||e.hasPermission("super_admin")&&s.pref?(i(),c("div",{key:2,class:R([{fcom_is_dirty:n.fcom_is_dirty},"fcom_notification_config_body"])},[a(p),l("div",F9,[l("div",T9,[a(y,{style:{"font-size":"30px"}},{default:r(()=>[a(h)]),_:1}),l("div",I9,[l("h3",null,d(e.$t("Global Email Notifications")),1),l("p",null,d(e.$t("These settings will be applied across all spaces you're a member of.")),1)])]),l("div",U9,[l("div",B9,[a(k,{"true-value":"yes","false-value":"no",modelValue:s.pref.com_my_post_mail,"onUpdate:modelValue":t[0]||(t[0]=M=>s.pref.com_my_post_mail=M),class:"fcom_checkbox"},{default:r(()=>[S(d(e.$t("Email me when someone comments on my post")),1)]),_:1},8,["modelValue"]),s.pref.com_my_post_mail=="yes"?(i(),c("p",E9,d(e.$t("You will receive an email when someone leaves a comment on your post.")),1)):(i(),c("p",A9,d(e.$t("No email will be sent for comments on your post.")),1))]),l("div",D9,[a(k,{"true-value":"yes","false-value":"no",modelValue:s.pref.reply_my_com_mail,"onUpdate:modelValue":t[1]||(t[1]=M=>s.pref.reply_my_com_mail=M),class:"fcom_checkbox"},{default:r(()=>[S(d(e.$t("Email me when someone replies to my comments")),1)]),_:1},8,["modelValue"]),s.pref.reply_my_com_mail=="yes"?(i(),c("p",R9,d(e.$t("You will receive an email when someone replies to your comments.")),1)):(i(),c("p",H9,d(e.$t("No email will be sent when someone replies to your comments.")),1))]),l("div",x9,[a(k,{"true-value":"yes","false-value":"no",modelValue:s.pref.mention_mail,"onUpdate:modelValue":t[2]||(t[2]=M=>s.pref.mention_mail=M),class:"fcom_checkbox"},{default:r(()=>[S(d(e.$t("Email me when someone mentions me in a post or comment")),1)]),_:1},8,["modelValue"]),s.pref.mention_mail=="yes"?(i(),c("p",j9,d(e.$t("You will receive an email when someone mentions you in a comment or post.")),1)):(i(),c("p",O9,d(e.$t("No emails will be sent when someone mentions you.")),1))]),l("div",N9,[a(k,{"true-value":"yes","false-value":"no",modelValue:s.pref.digest_mail,"onUpdate:modelValue":t[3]||(t[3]=M=>s.pref.digest_mail=M),class:"fcom_checkbox"},{default:r(()=>[S(d(e.$t("Weekly digest on %s",s.digestEmailDay)),1)]),_:1},8,["modelValue"]),s.pref.digest_mail=="yes"?(i(),c("p",z9,d(e.$t("You will get a digest email with curated activities in the community")),1)):(i(),c("p",q9,d(e.$t("No digest email will be sent.")),1))]),e.appVars.has_chat&&s.default_messaging_email_frequency!="no"?(i(),c("div",G9,[l("p",Y9,d(e.$t("Email sending frequency for one-to-one messages")),1),a($,{modelValue:s.pref.message_email_frequency,"onUpdate:modelValue":t[4]||(t[4]=M=>s.pref.message_email_frequency=M),class:"fcom_radio_group"},{default:r(()=>[s.default_messaging_email_frequency!=="disabled"?(i(),v(b,{key:0,value:"default",label:e.$t("Community Default")},null,8,["label"])):_("",!0),a(b,{value:"hourly",label:e.$t("Hourly")},null,8,["label"]),a(b,{value:"daily",label:e.$t("Daily")},null,8,["label"]),a(b,{value:"weekly",label:e.$t("Weekly")},null,8,["label"]),a(b,{value:"disabled",label:e.$t("Disable")},null,8,["label"])]),_:1},8,["modelValue"]),s.pref.message_email_frequency=="disabled"?(i(),c("p",Z9,d(e.$t("You will not get any email on new messages from any members")),1)):s.pref.message_email_frequency=="default"?(i(),c("p",W9,[s.default_messaging_email_frequency=="disabled"?(i(),c(V,{key:0},[S(d(e.$t("Email notification is disabled for one-to-one messages as per global community settings.")),1)],64)):(i(),c(V,{key:1},[S(d(e.$t("You will get email notifications on new messages from your last notification. Frequency: %s",e.$labelize(s.default_messaging_email_frequency))),1)],64))])):(i(),c("p",J9,d(e.$t("You will get email notifications on new messages from your last notification. Frequency: %s",e.$labelize(s.pref.message_email_frequency))),1))])):_("",!0)])]),l("div",Q9,[l("div",K9,[a(y,{style:{"font-size":"30px"}},{default:r(()=>[X9]),_:1}),l("div",eS,[l("h3",null,d(e.$t("New Posts Notifications")),1),l("p",null,d(e.$t("Subscribe to new posts notifications by space")),1)])]),l("div",tS,[s.spaceGroups.length>0?(i(),c(V,{key:0},[l("div",sS,[l("div",oS,d(e.$t("Space")),1),l("div",iS,d(e.$t("Notification")),1)]),(i(!0),c(V,null,D(s.spaceGroups,M=>(i(),c("div",{key:M.id},[l("div",nS,[l("div",lS,[l("div",aS,[l("h4",null,d(M.title),1)])])]),l("div",rS,[(i(!0),c(V,null,D(M.spaces,P=>(i(),c("div",cS,[l("div",dS,[P.icon?(i(),v(y,{key:0},{default:r(()=>[l("span",{innerHTML:P.icon},null,8,uS)]),_:2},1024)):P.shape_svg?(i(),c("span",{key:1,innerHTML:P.shape_svg},null,8,_S)):(i(),c("span",mS)),l("span",null,d(P.title),1)]),l("div",hS,[a(w,{size:"small",placeholder:e.$t("Email Disabled"),style:{width:"100%","max-width":"200px"},modelValue:P.pref,"onUpdate:modelValue":T=>P.pref=T},{default:r(()=>[a(f,{label:e.$t("Email Disabled"),value:""},null,8,["label"]),a(f,{label:e.$t("Notify only for Admin Posts"),value:"admin_only_posts"},null,8,["label"]),a(f,{label:e.$t("Notify for all posts"),value:"all_member_posts"},null,8,["label"])]),_:2},1032,["placeholder","modelValue","onUpdate:modelValue"])])]))),256))])]))),128))],64)):(i(),c("div",fS,[l("h4",null,d(e.$t("No spaces found")),1)]))])]),l("div",pS,[a(C,{onClick:n.saveSettings,disabled:s.saving,loading:s.saving,class:"fcom_primary_button"},{default:r(()=>[S(d(e.$t("Save Changes")),1)]),_:1},8,["onClick","disabled","loading"])])],2)):(i(),c("div",gS,[l("h3",null,d(e.$t("Sorry you do not have permission to access this.")),1),e.auth.user_id?_("",!0):(i(),c("div",yS,[l("p",null,d(e.$t("Please login to access this page.")),1),l("a",{href:e.appVars.auth_url,class:"el-button fcom_primary_button link_button"},d(e.$t("Login")),9,vS)]))]))])}const kS=F(S9,[["render",bS]]),wS={name:"UserNotificationSettings",props:["username"],components:{NotificationPrefForm:kS},mounted(){this.$nextTick(()=>{const e=document.querySelector(".object_info");e&&window.scrollTo({top:e.offsetTop-100,behavior:"smooth"})})}},CS={class:"fcom_routed_notification_settings"};function $S(e,t,o,u,s,n){const m=g("notification-pref-form");return i(),c("div",CS,[a(m,{username:o.username},null,8,["username"])])}const SS=F(wS,[["render",$S]]),VS={name:"UserFollowers",components:{Pagination:ke,FollowAction:Ye},props:["isOwn","profile"],emits:["refetch"],data(){return{loading:!1,follows:[],pagination:{page:1,per_page:20,total:0}}},watch:{profile(e){this.fetchFollowers()}},computed:{showPagination(){return this.pagination.total>this.pagination.per_page},getFollowBtnText(){return this.profile.username==this.auth.username?this.$t("Follow Back"):this.$t("Follow")}},methods:{fetchFollowers(){this.loading=!0,this.$get("profile/"+this.profile.username+"/followers",{per_page:this.pagination.per_page,page:this.pagination.page}).then(e=>{this.follows=e.followers.data,this.pagination.total=e.followers.total}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})}},mounted(){this.fetchFollowers(),this.changeTitle(this.$t("Followers"))}},LS={class:"fcom_dir_layout_classic space_members fcom_dir_layout"},MS={key:0,class:"loading"},PS={key:1,class:"no_follow"},FS={key:2,class:"card_list"},TS={role:"region","aria-label":"User Info",class:"card_content"},IS={class:"card_avatar"},US={class:"card_info"},BS={class:"info_header"},ES={class:"meta_line"},AS={class:"feed_meta_info"},DS=["title"],RS=["title"],HS={key:0,class:"card_description"},xS={class:"card_action"},jS={key:3,role:"region","aria-label":"Pagination",class:"pagination_wrap"};function OS(e,t,o,u,s,n){const m=q,p=g("UserAvatar"),h=g("UserRouteLink"),y=g("FollowAction"),k=g("Pagination");return i(),c("div",LS,[s.loading?(i(),c("div",MS,[a(m,{class:"white_loaded",rows:3,animated:!0})])):!s.loading&&!s.follows.length?(i(),c("div",PS,d(e.$t("No one is following this account yet. Posting and interacting with others helps boost followers!")),1)):(i(),c("div",FS,[(i(!0),c(V,null,D(s.follows,b=>{var $,f,w,C,M,P,T;return i(),c("div",{key:b.followed_id,class:"each_card"},[l("div",TS,[l("div",IS,[a(p,{is_online:e.isOnline(($=b.follower)==null?void 0:$.last_activity),xprofile:b.follower},null,8,["is_online","xprofile"])]),l("div",US,[l("div",BS,[a(h,{show_pop:!0,show_badge:!0,xprofile:b.follower,show_follow:!0},null,8,["xprofile"]),l("div",ES,"@"+d((f=b.follower)==null?void 0:f.username),1)]),l("div",AS,[(w=b.follower)!=null&&w.created_at?(i(),c("div",{key:0,title:(C=b.follower)==null?void 0:C.created_at,class:"meta_line"},d(e.$t("Joined %s",e.humanDateDiff(b.follower.created_at))),9,DS)):_("",!0),(M=b.follower)!=null&&M.last_activity?(i(),c("div",{key:1,title:(P=b.follower)==null?void 0:P.last_activity,class:"meta_line",style:{"margin-left":"5px"}},d(e.$t("Last seen: %s",e.humanDateDiff(b.follower.last_activity))),9,RS)):_("",!0)]),(T=b.follower)!=null&&T.short_description?(i(),c("div",HS,d(e.getExcerpt(b.follower.short_description,120)),1)):_("",!0)])]),l("div",xS,[a(y,{profile:b.follower,followButtonText:n.getFollowBtnText,onRefetch:t[0]||(t[0]=I=>e.$emit("refetch"))},null,8,["profile","followButtonText"])])])}),128))])),n.showPagination?(i(),c("div",jS,[a(k,{hide_on_single:!0,onFetch:t[1]||(t[1]=b=>n.fetchFollowers()),pagination:s.pagination},null,8,["pagination"])])):_("",!0)])}const NS=F(VS,[["render",OS]]),zS={name:"UserFollowings",props:["isOwn","profile"],emits:["refetch"],components:{Pagination:ke,FollowAction:Ye},data(){return{loading:!1,follows:[],pagination:{page:1,per_page:20,total:0}}},computed:{showPagination(){return this.pagination.total>this.pagination.per_page}},methods:{fetchFollowings(){this.loading=!0,this.$get("profile/"+this.profile.username+"/followings",{per_page:this.pagination.per_page,page:this.pagination.page}).then(e=>{this.follows=e.followings.data,this.pagination.total=e.followings.total}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})}},mounted(){this.fetchFollowings(),this.changeTitle(this.$t("Followings"))}},qS={class:"fcom_dir_layout_classic space_members fcom_dir_layout"},GS={key:0,class:"loading"},YS={key:1,class:"no_follow"},ZS={key:2,class:"card_list"},WS={role:"region","aria-label":"User Info",class:"card_content"},JS={class:"card_avatar"},QS={class:"card_info"},KS={class:"info_header"},XS={class:"meta_line"},eV={class:"feed_meta_info"},tV=["title"],sV=["title"],oV={key:0,class:"card_description"},iV={class:"card_action"},nV={key:3,role:"region","aria-label":"Pagination",class:"pagination_wrap"};function lV(e,t,o,u,s,n){const m=q,p=g("UserAvatar"),h=g("UserRouteLink"),y=g("FollowAction"),k=g("Pagination");return i(),c("div",qS,[s.loading?(i(),c("div",GS,[a(m,{class:"white_loaded",rows:3,animated:!0})])):!s.loading&&!s.follows.length?(i(),c("div",YS,[o.isOwn?(i(),c(V,{key:0},[S(d(e.$t("You aren't following anyone yet. Start following other members to connect and keep up with their activity!")),1)],64)):(i(),c(V,{key:1},[S(d(e.$t("This user isn't following anyone yet. Once they follow accounts, they'll show up here.")),1)],64))])):(i(),c("div",ZS,[(i(!0),c(V,null,D(s.follows,b=>{var $,f,w,C,M,P,T;return i(),c("div",{key:b.followed_id,class:"each_card"},[l("div",WS,[l("div",JS,[a(p,{is_online:e.isOnline(($=b.followed)==null?void 0:$.last_activity),xprofile:b.followed},null,8,["is_online","xprofile"])]),l("div",QS,[l("div",KS,[a(h,{show_pop:!0,show_badge:!0,xprofile:b.followed,show_follow:!0},null,8,["xprofile"]),l("div",XS,"@"+d((f=b.followed)==null?void 0:f.username),1)]),l("div",eV,[(w=b.followed)!=null&&w.created_at?(i(),c("div",{key:0,title:(C=b.followed)==null?void 0:C.created_at,class:"meta_line"},d(e.$t("Joined %s",e.humanDateDiff(b.followed.created_at))),9,tV)):_("",!0),(M=b.followed)!=null&&M.last_activity?(i(),c("div",{key:1,title:(P=b.followed)==null?void 0:P.last_activity,class:"meta_line",style:{"margin-left":"5px"}},d(e.$t("Last seen: %s",e.humanDateDiff(b.followed.last_activity))),9,sV)):_("",!0)]),(T=b.followed)!=null&&T.short_description?(i(),c("div",oV,d(e.getExcerpt(b.followed.short_description,120)),1)):_("",!0)])]),l("div",iV,[a(y,{profile:b.followed,onRefetch:t[0]||(t[0]=I=>e.$emit("refetch"))},null,8,["profile"])])])}),128))])),n.showPagination?(i(),c("div",nV,[a(k,{hide_on_single:!0,onFetch:t[1]||(t[1]=b=>n.fetchFollowings()),pagination:s.pagination},null,8,["pagination"])])):_("",!0)])}const aV=F(zS,[["render",lV]]),rV={props:["profile","username","isOwn"],emits:["refetch"],data(){return{currentRoute:this.$route.name}},watch:{$route(e,t){this.currentRoute=e.name}},methods:{isActive(e){return this.currentRoute==e},switchRoute(e){this.currentRoute=e,this.$router.push({name:e,params:{username:this.username}})}}},cV={class:"follow_header"},dV={class:"fcom_filter_menu"},uV={class:"fcom_filter_menu_ul"},_V={key:0},mV={key:1},hV={class:"follow_body"};function fV(e,t,o,u,s,n){var p,h;const m=g("router-view");return i(),c(V,null,[l("div",cV,[l("div",dV,[l("ul",uV,[((p=o.profile)==null?void 0:p.followings_count)!=null?(i(),c("li",_V,[l("a",{href:"#",onClick:t[0]||(t[0]=Z(y=>n.switchRoute("user_followings"),["prevent"])),class:R({"router-link-exact-active":n.isActive("user_followings")})},d(e.$t("Following")),3)])):_("",!0),((h=o.profile)==null?void 0:h.followers_count)!=null?(i(),c("li",mV,[l("a",{href:"#",onClick:t[1]||(t[1]=Z(y=>n.switchRoute("user_followers"),["prevent"])),class:R({"router-link-exact-active":n.isActive("user_followers")})},d(e.$t("Followers")),3)])):_("",!0)])])]),l("div",hV,[a(m,{isOwn:o.isOwn,profile:o.profile,onRefetch:t[2]||(t[2]=y=>e.$emit("refetch"))},null,8,["isOwn","profile"])])],64)}const pV=F(rV,[["render",fV]]),gV={name:"MemberAction",props:["member","openedMemberId"],data(){return{status:this.member.status,working:!1,isOpened:!1}},watch:{openedMemberId(e){this.isOpened=e===this.member.user_id}},methods:{changeMemberStatus(){this.working=!0,this.$patch("members/"+this.member.user_id,{status:this.status}).then(e=>{this.member.status=this.status,this.$notify.success(e.message)}).catch(e=>{this.$handleError(e)}).finally(()=>{this.working=!1,this.isOpened=!1})},togglePopover(){this.$emit("togglePopover")}}};function yV(e,t,o,u,s,n){const m=g("MoreFilled"),p=O,h=j,y=st,k=ge,b=ue,$=_e,f=de,w=K("loading");return i(),v(f,{persistent:!1,placement:"bottom",width:270,visible:s.isOpened,onHide:t[2]||(t[2]=C=>s.isOpened=!1)},{reference:r(()=>[a(h,{"aria-label":e.$t("View actions"),onClick:n.togglePopover,size:"small",text:""},{default:r(()=>[a(p,{class:"fcom_more_icon"},{default:r(()=>[a(m)]),_:1})]),_:1},8,["aria-label","onClick"])]),default:r(()=>[a($,{onSubmit:t[1]||(t[1]=Z(C=>e.doNothing(),["prevent"])),"label-position":"top"},{default:r(()=>[a(b,{label:e.$t("Status")},{default:r(()=>[a(k,{modelValue:s.status,"onUpdate:modelValue":t[0]||(t[0]=C=>s.status=C)},{default:r(()=>[a(y,{label:e.$t("Active"),value:"active"},null,8,["label"]),a(y,{label:e.$t("Pending"),value:"pending"},null,8,["label"]),a(y,{label:e.$t("Blocked"),value:"blocked"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(b,null,{default:r(()=>[N((i(),v(h,{disabled:s.working,onClick:n.changeMemberStatus,class:"fcom_primary_button"},{default:r(()=>[S(d(e.$t("Update Status")),1)]),_:1},8,["disabled","onClick"])),[[w,s.working]])]),_:1})]),_:1})]),_:1},8,["visible"])}const vV=F(gV,[["render",yV]]),bV={name:"AllMembers",components:{SocialLinks:at,Layout:ve,AppLayout:we,Pagination:ke,MemberAction:vV,FollowAction:Ye},data(){return{loading:!1,members:[],pagination:{page:1,per_page:24,total:0},permission_failed:!1,search:"",status:"active",sort_by:"last_activity",working:!1,openedMemberId:null,memberLayout:this.appVars.features.member_list_layout||"classic"}},methods:{fetch(){this.loading=!0,this.$get("members",{per_page:this.pagination.per_page,page:this.pagination.page,search:this.search,status:this.status,sort_by:this.sort_by}).then(e=>{window.scrollTo({top:0,behavior:"smooth"}),this.members=e.members.data,this.pagination.total=e.members.total,e.current_user_follows&&this.setFollowIds(e.current_user_follows)}).catch(e=>{e.permission_failed?this.permission_failed=!0:this.$handleError(e)}).finally(()=>{this.loading=!1})},changeMemberStatus(e,t){this.working=!0,this.$patch("members/"+e.user_id,{status:t}).then(o=>{this.$notify.success(o.message),e.status=t}).catch(o=>{this.$handleError(o)}).finally(()=>{this.working=!1})},handleSearch(){this.search&&this.search.length<3||this.toSearch()},toSearch(){this.pagination.page=1,this.fetch()},handleTogglePopover(e){this.openedMemberId=this.openedMemberId===e?null:e}},mounted(){this.$route.query.inactives&&(this.status="in_active"),this.fetch(),this.changeTitle(this.$t("All Members"))}},kV={key:0,class:"card_header"},wV={role:"region","aria-label":"Member Navigation",class:"member_status"};const CV={key:1,style:{"text-align":"center",padding:"20px 20px 40px"},class:"space_members"},$V={class:"permission_failed"},SV=["href"],VV={class:"search_member"},LV={class:"feed_filters"},MV=l("div",{class:"fcom_feed_divider"},null,-1),PV={id:"feed_short_by",class:"fcom_feed_filter_label"},FV={key:0,class:"loading"},TV={key:1,class:"no_members"},IV={key:2,class:"card_list"},UV={role:"region","aria-label":"User Info",class:"card_content"},BV={class:"card_avatar"},EV={class:"card_info"},AV={class:"info_header"},DV={class:"meta_line"},RV={class:"feed_meta_info"},HV=["title"],xV=["title"],jV={class:"card_description"},OV={key:0,class:"card_footer"},NV={style:{color:"red",display:"flex",gap:"10px"},class:"meta_line"},zV={class:"card_action"},qV={key:3,role:"region","aria-label":"Pagination",class:"pagination_wrap"};function GV(e,t,o,u,s,n){const m=st,p=ge,h=j,y=g("Search"),k=O,b=ee,$=ie,f=ne,w=q,C=g("UserAvatar"),M=g("UserRouteLink"),P=g("SocialLinks"),T=g("FollowAction"),I=g("MemberAction"),U=g("Pagination"),B=g("layout"),A=g("app-layout");return i(),v(A,{wrapper_class:"fcom_single_layout fcom_max_layout"},{default:r(()=>[a(B,{use_scroll:!0,class:"no_bg_layout",title:e.$t("All Members")+" "+(s.pagination.total?" ("+e.$formatNumber(s.pagination.total)+")":"")},{default:r(()=>[e.isAdmin()?(i(),c("div",kV,[l("div",wV,[a(p,{onChange:n.toSearch,modelValue:s.status,"onUpdate:modelValue":t[0]||(t[0]=L=>s.status=L),class:"status_group"},{default:r(()=>[a(m,{value:"active"},{default:r(()=>[S(d(e.$t("Active")),1)]),_:1}),a(m,{value:"in_active"},{default:r(()=>[S(d(e.$t("Blocked")),1)]),_:1}),e.hasFeature("can_deactivate_account")?(i(),v(m,{key:0,value:"deactivated"},{default:r(()=>[S(d(e.$t("Deactivated (self)")),1)]),_:1})):_("",!0)]),_:1},8,["onChange","modelValue"])]),_("",!0)])):_("",!0),s.permission_failed?(i(),c("div",CV,[l("div",$V,[l("h3",null,d(e.$t("Permission Denied")),1),l("p",null,d(e.$t("You do not have permission to view all members")),1),l("a",{href:e.$getRouteLink("/"),class:"el-button fcom_primary_button"},d(e.$t("Go To All Feeds")),9,SV)])])):(i(),c(V,{key:2},[l("div",VV,[a(b,{clearable:"",onClear:n.toSearch,onKeydown:be(n.toSearch,["enter"]),onInput:n.handleSearch,modelValue:s.search,"onUpdate:modelValue":t[2]||(t[2]=L=>s.search=L),placeholder:e.$t("Search Members...")},{prefix:r(()=>[a(k,null,{default:r(()=>[a(y)]),_:1})]),_:1},8,["onClear","onKeydown","onInput","modelValue","placeholder"])]),l("div",LV,[MV,l("span",PV,d(e.$t("Sort by:")),1),a(f,{"aria-label":e.$t("Sort members by"),modelValue:s.sort_by,"onUpdate:modelValue":t[3]||(t[3]=L=>s.sort_by=L),class:"fcom_minimal_select","popper-class":"plain_select",placeholder:e.$t("Latest Posts"),onChange:t[4]||(t[4]=L=>n.fetch())},{default:r(()=>[a($,{value:"last_activity",label:e.$t("Last Activity")},null,8,["label"]),a($,{value:"display_name",label:e.$t("Display Name")},null,8,["label"]),a($,{value:"created_at",label:e.$t("Joining Date")},null,8,["label"])]),_:1},8,["aria-label","modelValue","placeholder"])]),l("div",{class:R(["fcom_dir_layout_"+s.memberLayout,"space_members fcom_dir_layout"])},[s.loading?(i(),c("div",FV,[a(w,{class:"white_loaded",rows:3,animated:!0})])):!s.loading&&!s.members.length?(i(),c("div",TV,d(e.$t("No members found")),1)):(i(),c("div",IV,[(i(!0),c(V,null,D(s.members,(L,E)=>(i(),c("div",{key:L.user_id,class:"each_card"},[l("div",UV,[l("div",BV,[a(C,{is_online:e.isOnline(L.last_activity),xprofile:L},null,8,["is_online","xprofile"])]),l("div",EV,[l("div",AV,[a(M,{show_pop:!0,show_badge:!0,xprofile:L,show_follow:!0},null,8,["xprofile"]),l("div",DV,"@"+d(L.username),1)]),l("div",RV,[L.created_at?(i(),c("div",{key:0,title:L.created_at,class:"meta_line"},d(e.$t("Joined %s",e.humanDateDiff(L.created_at))),9,HV)):_("",!0),L.last_activity?(i(),c("div",{key:1,title:L.last_activity,class:"meta_line",style:{"margin-left":"5px"}},d(e.$t("Last seen: %s",e.humanDateDiff(L.last_activity))),9,xV)):_("",!0)]),l("div",jV,d(e.getExcerpt(L.short_description,120)),1),a(P,{style:{"justify-content":"left"},xprofile:L,isOwn:!1},null,8,["xprofile"]),L.status!="active"?(i(),c("div",OV,[l("div",NV,[L.status?(i(),c(V,{key:0},[l("span",null,d(e.$t("Status:"))+" "+d(e.$labelize(L.status)),1),a(h,{onClick:G=>n.changeMemberStatus(L,"active"),type:"danger"},{default:r(()=>[S(d(e.$t("Approve Access")),1)]),_:2},1032,["onClick"])],64)):(i(),c(V,{key:1},[l("span",null,d(e.$t("Status:"))+" "+d(e.$t("Self Deactivated")),1),a(h,{onClick:G=>n.changeMemberStatus(L,"active"),type:"danger"},{default:r(()=>[S(d(e.$t("Reactivate")),1)]),_:2},1032,["onClick"])],64))])])):_("",!0)])]),l("div",zV,[a(T,{profile:L},null,8,["profile"]),e.isAdmin()?(i(),v(I,{key:0,member:L,openedMemberId:s.openedMemberId,onTogglePopover:G=>n.handleTogglePopover(L.user_id)},null,8,["member","openedMemberId","onTogglePopover"])):_("",!0)])]))),128))])),s.pagination.total?(i(),c("div",qV,[a(U,{hide_on_single:!0,onFetch:t[5]||(t[5]=L=>n.fetch()),pagination:s.pagination},null,8,["pagination"])])):_("",!0)],2)],64))]),_:1},8,["title"])]),_:1})}const YV=F(bV,[["render",GV]]),ZV={name:"Notifications",components:{AppLayout:we,Layout:ve,NotificationsBlock:$s,Pagination:ke},setup(){return{notificationStore:Gt()}},data(){return{status:"all",loading:!1,notifications:[],pagination:{page:1,per_page:20,total:0},working:!1,notification_type:"all"}},methods:{switchType(e){this.notification_type=e,this.fetch()},fetch(){this.loading=!0,this.$get("notifications",{per_page:this.pagination.per_page,page:this.pagination.page,status:this.status,notification_type:this.notification_type}).then(e=>{this.notifications=e.notifications.data,this.pagination.total=e.notifications.total}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1,window.scrollTo(0,0)})},async markAllRead(){this.working=!0;try{await this.notificationStore.markAllAsRead(),this.$notify.success(this.$t("All notifications marked as read")),this.fetch()}catch(e){this.$handleError(e)}finally{this.working=!1}}},mounted(){this.fetch(),this.changeTitle(this.$t("All Notifications")),window.scrollTo(0,0)}},WV={class:"fcom_filter_menu"},JV={class:"fcom_filter_menu_ul fcom_notification_types"},QV={style:{"border-top-left-radius":"0","border-top-right-radius":"0"},class:"space_members"},KV={key:0,class:"notifications notifications_wrap"},XV={class:"pagination_wrap"},eL={key:1,style:{"margin-top":"15px"}},tL={key:2};function sL(e,t,o,u,s,n){const m=j,p=vs,h=g("notifications-block"),y=g("Pagination"),k=q,b=g("layout"),$=g("app-layout"),f=K("loading");return i(),v($,{wrapper_class:"fcom_single_layout"},{default:r(()=>[a(b,{content_class:"no_bg_layout notification_layout",title:e.$t("Notifications")},{actions:r(()=>[a(m,{class:"fcom_primary_button",disabled:s.working,onClick:t[0]||(t[0]=w=>n.markAllRead())},{default:r(()=>[S(d(e.$t("Mark all as read")),1)]),_:1},8,["disabled"])]),default:r(()=>[l("div",WV,[l("ul",JV,[l("li",null,[l("a",{onClick:t[1]||(t[1]=Z(w=>n.switchType("all"),["prevent"])),class:R({"router-link-exact-active":s.notification_type=="all"}),href:"#"},d(e.$t("All")),3)]),l("li",null,[l("a",{onClick:t[2]||(t[2]=Z(w=>n.switchType("mentioned"),["prevent"])),class:R({"router-link-exact-active":s.notification_type=="mentioned"}),href:"#"},d(e.$t("Mentions")),3)]),l("li",null,[l("a",{onClick:t[3]||(t[3]=Z(w=>n.switchType("following"),["prevent"])),class:R({"router-link-exact-active":s.notification_type=="following"}),href:"#"},d(e.$t("Following")),3)])]),a(p,{onChange:t[4]||(t[4]=w=>n.fetch()),style:{"--el-switch-on-color":"#2271b1"},"active-value":"unread","inactive-value":"all","active-text":e.$t("Unread only"),modelValue:s.status,"onUpdate:modelValue":t[5]||(t[5]=w=>s.status=w),class:"fcom_switch"},null,8,["active-text","modelValue"])]),l("div",QV,[s.notifications.length?N((i(),c("div",KV,[a(h,{notifications:s.notifications},null,8,["notifications"]),l("div",XV,[a(y,{hide_on_single:!0,onFetch:t[6]||(t[6]=w=>n.fetch()),pagination:s.pagination},null,8,["pagination"])])])),[[f,s.loading]]):s.loading?(i(),c("div",tL,[a(k,{animated:!0,rows:5})])):(i(),c("div",eL,[l("p",null,d(e.$t("No notifications found")),1)]))])]),_:1},8,["title"])]),_:1})}const oL=F(ZV,[["render",sL]]),iL={name:"Bookmarks",components:{Feeds:rt,AppLayout:we,Layout:ve},data(){return{search:""}},methods:{handleSearch(){this.search&&this.search.length<3||this.$router.replace({query:{...this.$route.query,search:this.search}})}},computed:{feed_base_url(){return"feeds/bookmarks"}},mounted(){this.changeTitle(this.$t("Your Bookmarks"))}},nL={style:{"margin-bottom":"16px"}},lL={class:"search_member"},aL={key:1};function rL(e,t,o,u,s,n){const m=g("Search"),p=O,h=ee,y=g("feeds"),k=g("layout"),b=g("app-layout");return i(),v(b,{wrapper_class:"fcom_single_layout fcom_compact_layout"},{default:r(()=>[a(k,{wrapper_class:"no_bg_layout",title:e.$t("Your Bookmarks")},{default:r(()=>[l("h4",nL,d(e.$t("Your saved posts")),1),l("div",lL,[a(h,{clearable:"",onClear:n.handleSearch,onKeydown:be(n.handleSearch,["enter"]),onInput:n.handleSearch,modelValue:s.search,"onUpdate:modelValue":t[0]||(t[0]=$=>s.search=$),placeholder:e.$t("Search Posts...")},{prefix:r(()=>[a(p,null,{default:r(()=>[a(m)]),_:1})]),_:1},8,["onClear","onKeydown","onInput","modelValue","placeholder"])]),e.appVars.auth.user_id?(i(),v(y,{key:0,feed_base_url:n.feed_base_url,hide_create_form:!0,space:"",feed_name:"all_feeds",layout_style:e.appVars.features.default_feed_layout,default_order_by:e.appVars.features.default_feed_sort_by||"",can_change_order:e.appVars.features.disable_feed_sort_by!=="yes"},null,8,["feed_base_url","layout_style","default_order_by","can_change_order"])):(i(),c("div",aL,[l("p",null,d(e.$t("Please login to view your bookmarks")),1)]))]),_:1},8,["title"])]),_:1})}const cL=F(iL,[["render",rL]]);const dL={name:"AllCourses",components:{AppLayout:we,Layout:ve,GroupIcon:ts,Pagination:ke,Search:Ve},data(){return{courses:[],loading:!0,pagination:{page:1,per_page:24,total:0},type:"all",newCourseModal:!1,is_admin:!1,courseCategories:null,topic_slug:null,search:"",sort_by:"alphabetical"}},methods:{fetchCourses(){this.loading=!0,this.$get("courses",{type:this.type,search:this.search,sort_by:this.sort_by,topic_slug:this.topic_slug,page:this.pagination.page,per_page:this.pagination.per_page,with_categories:!this.courseCategories}).then(e=>{this.courses=e.courses.data,this.is_admin=e.is_admin,this.pagination.total=e.courses.total,e.course_categories&&e.course_categories.length&&(this.courseCategories=e.course_categories)}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})},setTopic(e){this.topic_slug=e;let t=JSON.parse(JSON.stringify(this.$route.query));e?(t.topic=e,this.$router.push({query:t})):(delete t.topic,this.$router.push({query:t})),this.fetchCourses()},SwitchToCourseView(e){this.type=e,this.$router.push({name:"courses",query:{type:e}}),this.fetchCourses()},getExcerpt(e){if(!e)return"";let t=e.replace(/(<([^>]+)>)/ig,"");return t.length>200&&(t=t.substring(0,200)+"..."),t},emitCreateCourse(){this.$eventBus.emit("createSpaceModal",{course_config:!0})},handleSearch(){this.search&&this.search.length<3||this.toSearch()},toSearch(){this.pagination.page=1,this.fetchCourses()},changeSortBy(){this.$storeLocalData("course_sort_by",this.sort_by),this.toSearch()},watchTopicUrlChanged(e){this.setTopic(e),this.$nextTick(()=>{window.fcomLayoutRef&&window.fcomLayoutRef.scrollTo({top:0,behavior:"smooth"})})}},created(){this.$eventBus.on("topic_changed",this.watchTopicUrlChanged)},mounted(){this.$route.query.type&&(this.type=this.$route.query.type),this.$route.query.topic&&(this.topic_slug=this.$route.query.topic),this.sort_by=this.$getLocalData("course_sort_by","alphabetical"),this.fetchCourses(),this.changeTitle(this.$t("Courses"))},beforeUnmount(){this.$eventBus.off("topic_changed",this.watchTopicUrlChanged)}},lo=e=>(ht("data-v-9097c368"),e=e(),ft(),e),uL={class:"object_menu"},_L={class:"fcom_space_menu_ul"},mL={key:0},hL={key:1},fL={key:0,class:"fcom_space_topics"},pL={class:"fcom_topics_filters"},gL={class:"search_member"},yL={class:"feed_filters"},vL=lo(()=>l("div",{class:"fcom_feed_divider"},null,-1)),bL={id:"feed_short_by",class:"fcom_feed_filter_label"},kL={class:"fcom_courses"},wL={key:0,class:"fcom_no_items_wrap"},CL={key:2},$L=["href"],SL={class:"fcom_box_card_list"},VL=["onClick"],LL=["src"],ML={key:1,class:"fcom_no_image"},PL={class:"fcom_box_card_info"},FL={class:"fcom_box_card_name"},TL={class:"fcom_box_card_details"},IL={class:"inline_details"},UL=lo(()=>l("span",{class:"fcom_inline_separator"},null,-1)),BL={key:0,class:"inline_details"},EL={key:0,class:"fcom_box_card_description"},AL={class:"fcom_box_card_action"},DL=["onClick"],RL=["onClick"];function HL(e,t,o,u,s,n){const m=j,p=fe,h=g("Search"),y=O,k=ee,b=ie,$=ne,f=Oe,w=g("router-link"),C=g("GroupIcon"),M=g("pagination"),P=g("layout"),T=g("app-layout"),I=K("loading");return i(),v(T,{wrapper_class:"fcom_single_layout fcom_max_layout"},{default:r(()=>[a(P,{wrapper_class:"no_bg_layout",title:e.$t("Courses")+" "+(s.pagination.total?" ("+e.$formatNumber(s.pagination.total)+")":"")},{actions:r(()=>[l("div",uL,[l("ul",_L,[l("li",null,[l("a",{onClick:t[0]||(t[0]=Z(U=>n.SwitchToCourseView("all"),["prevent"])),class:R(s.type=="all"?"router-link-active router-link-exact-active":""),href:"#"},d(e.$t("All Courses")),3)]),e.auth.user_id?(i(),c("li",mL,[l("a",{onClick:t[1]||(t[1]=Z(U=>n.SwitchToCourseView("enrolled"),["prevent"])),class:R(s.type=="enrolled"?"router-link-active router-link-exact-active":""),href:"#"},d(e.$t("My Courses")),3)])):_("",!0),e.hasCourseCreatorAccess()?(i(),c("li",hL,[a(m,{onClick:t[2]||(t[2]=U=>n.emitCreateCourse()),class:"fcom_primary_button"},{default:r(()=>[S(d(e.$t("New Course")),1)]),_:1})])):_("",!0)])])]),default:r(()=>[s.courseCategories&&s.courseCategories.length?(i(),c("div",fL,[a(p,null,{default:r(()=>[l("div",pL,[a(m,{onClick:t[3]||(t[3]=U=>n.setTopic("")),class:R({fcom_active_topic:!s.topic_slug})},{default:r(()=>[S(d(e.$t("All")),1)]),_:1},8,["class"]),(i(!0),c(V,null,D(s.courseCategories,U=>(i(),v(m,{key:U.slug,onClick:B=>n.setTopic(U.slug),class:R({fcom_active_topic:U.slug==s.topic_slug})},{default:r(()=>[S(d(U.title),1)]),_:2},1032,["onClick","class"]))),128))])]),_:1})])):_("",!0),l("div",gL,[a(k,{clearable:"",onClear:n.toSearch,onKeydown:be(n.toSearch,["enter"]),onInput:n.handleSearch,modelValue:s.search,"onUpdate:modelValue":t[4]||(t[4]=U=>s.search=U),placeholder:e.$t("Search Courses...")},{prefix:r(()=>[a(y,null,{default:r(()=>[a(h)]),_:1})]),_:1},8,["onClear","onKeydown","onInput","modelValue","placeholder"])]),l("div",yL,[vL,l("span",bL,d(e.$t("Sort by:")),1),a($,{"aria-label":e.$t("Sort Courses by"),modelValue:s.sort_by,"onUpdate:modelValue":t[5]||(t[5]=U=>s.sort_by=U),class:"fcom_minimal_select space_sort_select","popper-class":"plain_select",onChange:t[6]||(t[6]=U=>n.changeSortBy())},{default:r(()=>[a(b,{value:"alphabetical",label:e.$t("Alphabetical")},null,8,["label"]),a(b,{value:"latest",label:e.$t("Latest Courses")},null,8,["label"]),a(b,{value:"oldest",label:e.$t("Oldest Courses")},null,8,["label"])]),_:1},8,["aria-label","modelValue"])]),N((i(),c("div",kL,[!s.loading&&!s.courses.length?(i(),c("div",wL,[s.topic_slug?(i(),c(V,{key:0},[l("h3",null,d(e.$t("No courses found in this topic")),1),l("p",null,d(e.$t("No courses found based on your search criteria")),1)],64)):s.type=="all"?(i(),c(V,{key:1},[s.search?(i(),c(V,{key:0},[l("h3",null,d(e.$t("No courses found based on your search criteria")),1),l("p",null,d(e.$t("No courses match your search criteria. Try adjusting your search terms or browse our course catalog.")),1)],64)):e.isAdmin()?(i(),c(V,{key:1},[l("h3",null,d(e.$t("Create your first course")),1),l("p",null,d(e.$t("Deliver engaging & high-perfromance learning experiences in your community.")),1),a(m,{onClick:t[7]||(t[7]=U=>n.emitCreateCourse()),class:"fcom_primary_button"},{default:r(()=>[S(d(e.$t("Create a Course")),1)]),_:1})],64)):(i(),c("div",CL,[l("h3",null,d(e.$t("No published courses found")),1),l("p",null,d(e.$t("Please check back later. We are in a process to publish some courses for you!")),1)]))],64)):(i(),c(V,{key:2},[s.search?(i(),c(V,{key:0},[l("h3",null,d(e.$t("No courses found based on your search criteria")),1),l("p",null,d(e.$t("No courses match your search criteria. Try adjusting your search terms or browse our course catalog.")),1)],64)):e.auth.user_id?(i(),c(V,{key:2},[l("h3",null,d(e.$t("Your enrolled courses will be shown here")),1),l("p",null,d(e.$t("Once you enroll some courses, those will be shown here")),1),l("a",{onClick:t[8]||(t[8]=Z(U=>n.SwitchToCourseView("all"),["prevent"])),class:"el-button fcom_primary_button",href:"#"},d(e.$t("View all courses")),1)],64)):(i(),c(V,{key:1},[l("h3",null,d(e.$t("Login to see your courses")),1),l("p",null,d(e.$t("Once you login, your enrolled courses will be shown here.")),1),l("a",{href:e.getCurrentAuthUrl(),class:"el-button fcom_primary_button"},d(e.$t("Login")),9,$L)],64))],64))])):_("",!0),l("div",SL,[(i(!0),c(V,null,D(s.courses,U=>(i(),c("div",{key:U.id,class:"fcom_each_box_card"},[l("div",{class:"fcom_box_card_avatar",onClick:B=>e.$router.push({name:"view_course",params:{course_slug:U.slug}})},[U.cover_photo?(i(),c("img",{key:0,src:U.cover_photo,alt:""},null,8,LL)):(i(),c("div",ML))],8,VL),l("div",PL,[l("div",FL,[a(w,{class:"course_route",to:{name:"view_course",params:{course_slug:U.slug}}},{default:r(()=>[S(d(U.title)+" ",1),U.status=="draft"?(i(),v(f,{key:0,type:"info"},{default:r(()=>[S(d(U.status),1)]),_:2},1024)):_("",!0)]),_:2},1032,["to"])]),l("div",TL,[l("div",IL,[l("span",null,d(e.$_n("%d Section","%d Sections",U.sectionsCount)),1),UL,l("span",null,d(e.$_n("%d Lesson","%d Lessons",U.lessonsCount)),1)]),U.studentsCount?(i(),c("div",BL,[a(y,null,{default:r(()=>[a(C)]),_:1}),S(" "+d(e.$_n("%s student","%s students",e.$formatNumber(U.studentsCount))),1)])):_("",!0)]),U.description?(i(),c("div",EL,d(n.getExcerpt(U.description)),1)):_("",!0),l("div",AL,[U.isEnrolled?(i(),c("button",{key:0,class:"fcom_card_button",onClick:B=>e.$router.push({name:"view_course",params:{course_slug:U.slug}})},d(e.$t("%s Completed",U.progress+"%")),9,DL)):(i(),c("button",{key:1,class:"fcom_card_button",onClick:B=>e.$router.push({name:"view_course",params:{course_slug:U.slug}})},d(e.$t("View Course")),9,RL))])])]))),128))]),a(M,{hide_on_single:!0,onFetch:n.fetchCourses,pagination:s.pagination},null,8,["onFetch","pagination"])])),[[I,s.loading]])]),_:1},8,["title"])]),_:1})}const xL=F(dL,[["render",HL],["__scopeId","data-v-9097c368"]]),jL={name:"ViewCoursesRoute",components:{Layout:ve,AppLayout:we},props:["course_slug"],data(){return{course:{},sections:[],track:{},loading:!1,currentLessonIndex:null,currentLesson:null}},watch:{course_slug(){this.fetchCourse()}},computed:{allLessons(){let e=[];return Ee(this.sections,t=>{Ee(t.lessons,o=>{e.push(o)})}),e},lessonsCount(){return this.allLessons.length}},methods:{fetchCourse(){this.loading=!0,this.$get("courses/"+this.course_slug+"/by-slug",{intended_lesson_slug:this.$route.params.lesson_slug||null}).then(e=>{this.sections=e.sections,this.track=e.track,this.$route.params.lesson_slug&&this.goToLesson(this.$route.params.lesson_slug,!0),this.course=e.course,this.changeTitle(this.course.title)}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})},handleNextLesson(){let e=null;if(this.currentLessonIndex===null){if(Ee(this.allLessons,(t,o)=>{if(!this.track.completed_lessons.includes(t.id.toString()))return e=t,!1}),!e)if(this.allLessons.length)e=this.allLessons[0];else return this.$notify.error(this.$t("Sorry, no lesson found")),!1}else Ee(this.allLessons,(t,o)=>{if(o>this.currentLessonIndex)return e=t,!1});e&&this.goToLesson(e.slug)},setPrevLesson(){let e=this.currentLessonIndex-1;if(e<0||!this.allLessons[e])return this.$notify.error(this.$t("Sorry, no lesson found")),!1;let t=this.allLessons[e];t&&this.goToLesson(t.slug)},goToLesson(e,t=!1){let o=null,u=null;Ee(this.allLessons,(s,n)=>{if(s.slug==e)return o=s,u=n,!1}),o&&(this.loading=!0,this.currentLesson=null,this.currentLessonIndex=null,this.$nextTick(()=>{this.currentLessonIndex=u,this.currentLesson=o,this.currentLesson.lazy_load&&this.currentLesson.can_view&&(this.currentLesson.content_loading=!0,this.fetchLesson(o.slug,s=>{s.slug==this.currentLesson.slug&&(this.currentLesson.content=s.content,this.currentLesson.content_loading=!1)})),this.changeTitle(this.currentLesson.title),this.$router.push({name:"view_lesson",params:{lesson_slug:o.slug},query:t?this.$route.query:{}}),this.loading=!1}))},fetchLesson(e,t=null){this.$get("courses/"+this.course.slug+"/lessons/"+e+"/by-slug").then(o=>{t&&t(o.lesson)}).catch(o=>{this.$handleError(o),t&&t({slug:e,content:"<p>"+this.$t("Sorry, the lesson content could not be loaded.")+"</p>"})})}},created(){this.fetchCourse()}},OL={key:0},NL={style:{padding:"20px"},class:"fcom_course_sections fcom_white_loaded"},zL={key:1},qL={key:2};function GL(e,t,o,u,s,n){const m=Nt,p=zt,h=q,y=g("layout"),k=g("app-layout"),b=g("router-view");return s.loading?(i(),c("div",OL,[a(k,{wrapper_class:"fcom_single_layout fcom_max_layout"},{default:r(()=>[a(y,{title:"...."},{title:r(()=>[a(p,{"separator-class":"el-icon-arrow-right"},{default:r(()=>[a(m,{to:{name:"courses"}},{default:r(()=>[S(d(e.$t("Courses")),1)]),_:1}),a(m,null,{default:r(()=>[S("....")]),_:1})]),_:1})]),default:r(()=>[l("div",NL,[a(h,{rows:10,animated:!0})])]),_:1})]),_:1})])):s.course.id?(i(),c("div",zL,[a(b,{track:s.track,course:s.course,sections:s.sections,lessonsCount:n.lessonsCount,currentLesson:s.currentLesson,currentLessonIndex:s.currentLessonIndex,onSetNextLesson:n.handleNextLesson,onSetPrevLesson:n.setPrevLesson,onGoToLesson:n.goToLesson,onReload:n.fetchCourse,onUpdateTrack:t[0]||(t[0]=$=>{s.track=$})},null,8,["track","course","sections","lessonsCount","currentLesson","currentLessonIndex","onSetNextLesson","onSetPrevLesson","onGoToLesson","onReload"])])):(i(),c("div",qL,[l("h3",null,d(e.$t("Sorry, the course could not be loaded.")),1)]))}const YL=F(jL,[["render",GL]]),ZL={name:"LockIcon",props:{fill:{type:String,default:"currentColor"}}},WL={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},JL=l("path",{d:"M10 13.7497V12.083",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round"},null,-1),QL=l("path",{d:"M3.55618 15.704C3.74358 17.0958 4.89645 18.1863 6.29939 18.2508C7.4799 18.305 8.67909 18.3333 9.99967 18.3333C11.3203 18.3333 12.5194 18.305 13.7 18.2508C15.1029 18.1863 16.2558 17.0958 16.4432 15.704C16.5655 14.7956 16.6663 13.8647 16.6663 12.9167C16.6663 11.9686 16.5655 11.0378 16.4432 10.1294C16.2558 8.73752 15.1029 7.64707 13.7 7.58258C12.5194 7.52831 11.3203 7.5 9.99967 7.5C8.67909 7.5 7.4799 7.52831 6.29939 7.58258C4.89645 7.64707 3.74358 8.73752 3.55618 10.1294C3.43388 11.0378 3.33301 11.9686 3.33301 12.9167C3.33301 13.8647 3.43388 14.7956 3.55618 15.704Z",stroke:"currentColor","stroke-width":"1.5"},null,-1),KL=l("path",{d:"M6.25 7.50033V5.41699C6.25 3.34592 7.92893 1.66699 10 1.66699C12.0711 1.66699 13.75 3.34592 13.75 5.41699V7.50033",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),XL=[JL,QL,KL];function eM(e,t,o,u,s,n){return i(),c("svg",WL,XL)}const tM=F(ZL,[["render",eM]]),sM={name:"LockscreenView",components:{CustomLockscreenView:Xs,DefaultLockscreenPaywall:eo},props:["space_profile","sections"],emits:["join"],data(){return{isRedirecting:!1}},created(){var e,t,o,u;((t=(e=this.space_profile)==null?void 0:e.settings)==null?void 0:t.custom_lock_screen)=="redirect"&&((u=(o=this.space_profile)==null?void 0:o.settings)!=null&&u.onboard_redirect_url)&&(this.isRedirecting=!0,window.location.href=this.space_profile.settings.onboard_redirect_url)}},oM={key:0,style:{"text-align":"center",margin:"50px 0"}},iM={class:"space_lock_box space_default_lock_box"},nM={class:"lock_desc"},lM=["href"],aM={key:1,class:"space_lock_box"},rM={key:2,class:"space_lock_box"},cM=["href"];function dM(e,t,o,u,s,n){var k;const m=g("Lock"),p=O,h=g("default-lockscreen-paywall"),y=g("custom-lockscreen-view");return s.isRedirecting?(i(),c("h3",oM,d(e.$t("Please wait....")),1)):(i(),c(V,{key:1},[o.space_profile.lockscreen_config?(i(),c(V,{key:0},[o.space_profile.lockscreen_config.showCustom?(i(),v(y,{key:1,sections:o.sections,profile:o.space_profile},null,8,["sections","profile"])):(i(),c(V,{key:0},[l("div",iM,[a(p,null,{default:r(()=>[a(m)]),_:1}),l("h4",null,d(e.$t("This is a private course")),1),l("p",nM,d(e.$t("Members have to be invited to this course.")),1),e.auth.user_id?_("",!0):(i(),c("a",{key:0,href:e.getCurrentAuthUrl(),class:"fcom_btn el-button el-button--primary"},d(e.$t("Login or Signup")),9,lM))]),o.space_profile.lockscreen_config.showPaywalls?(i(),v(h,{key:0,space_id:(k=o.space_profile)==null?void 0:k.id},null,8,["space_id"])):_("",!0)],64))],64)):o.space_profile.permissions.is_pending?(i(),c("div",aM,[a(p,null,{default:r(()=>[a(m)]),_:1}),l("h4",null,d(e.$t("Your request to join this course is pending")),1)])):e.auth.user_id?_("",!0):(i(),c("div",rM,[a(p,null,{default:r(()=>[a(m)]),_:1}),l("h4",null,d(e.$t("Please login/signup to enroll this course")),1),l("a",{href:e.getCurrentAuthUrl(),class:"fcom_btn el-button el-button--primary"},d(e.appVars.allow_signup?e.$t("Login / Signup"):e.$t("Login")),9,cM)]))],64))}const uM=F(sM,[["render",dM]]),_M={name:"CollapseIcon"},mM={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},hM=l("path",{d:"M16 4V13H18.25L15.25 16.75L12.25 13H14.5V4H16ZM10 14.5V16H3.25V14.5H10ZM11.5 9.25V10.75H3.25V9.25H11.5ZM11.5 4V5.5H3.25V4H11.5Z",fill:"currentColor"},null,-1),fM=[hM];function pM(e,t,o,u,s,n){return i(),c("svg",mM,fM)}const gM=F(_M,[["render",pM]]),yM={name:"ViewCourse",components:{VideoPlay:Vo,RenderSpaceLinks:Xt,LockScreenView:uM,AppLayout:we,Layout:ve,CircleIcon:es,LockIcon:tM,SocialLinks:at,PlayIcon:Ys,LessonIcon:Gs,PlayPlaceholderIcon:Zs,CollapseIcon:gM},props:["course","sections","track","lessonsCount"],$emit:["setNextLesson","goToLesson","reload"],data(){return{enrolling:!1}},computed:{sectionsCount(){return this.sections.reduce((e,t)=>e+(t.lessons.length?1:0),0)},isCustomLockScreen(){var e,t;return((t=(e=this.course)==null?void 0:e.settings)==null?void 0:t.custom_lock_screen)==="yes"},showCourseSections(){return this.track.isEnrolled||this.hasCourseCreatorAccess()||!this.course.lockscreen_config},isModernLayout(){var e,t;return this.has_pro&&((t=(e=this.course)==null?void 0:e.settings)==null?void 0:t.course_layout)==="modern"},lessonDuration(){return e=>{const t=e.lessons.reduce((o,u)=>o+(u.meta.video_length||0),0);return this.formatSeconds(t)||null}},isCollapsed(){return this.sections.some(e=>e.is_closed)},showSidebar(){return!this.isMobile&&(this.track.isEnrolled||this.course.creator)}},methods:{toggleAllSections(){const e=this.isCollapsed;this.sections.forEach(t=>{t.is_closed=!e})},isEnabledMedia(e){var t;return((t=e.meta)==null?void 0:t.enable_media)=="yes"},showPlayIcon(e){return this.hasMediaVideo(e)&&(this.hasMediaImage(e)||e.featured_image)},hasMediaVideo(e){var o;const t=(o=e.meta)==null?void 0:o.media;return this.isEnabledMedia(e)&&(t==null?void 0:t.content_type)=="video"&&(t==null?void 0:t.html)},hasMediaImage(e){var t,o;return this.isEnabledMedia(e)&&((o=(t=e.meta)==null?void 0:t.media)==null?void 0:o.image)},isLockLesson(e,t){return(e.is_locked||!this.track.isEnrolled)&&!t.can_view},editLessonLink(){return this.$getRouteLink("admin/manage-courses/edit/:course_id/lessons",{course_id:this.course.id})},enroll(){this.enrolling=!0,this.$post("courses/"+this.course.id+"/enroll").then(e=>{this.$emit("reload"),this.$notify.success(e.message)}).catch(e=>{this.$handleError(e)}).finally(()=>{this.enrolling=!1})},continueCourse(){this.$emit("setNextLesson")},maybeGotoLesson(e,t,o){if(e.can_view){this.$emit("goToLesson",e.slug);return}if(!t.isEnrolled||o.is_locked){o.unlock_date?this.$notify.info({message:this.$t("This lesson will be unlocked on %s",o.unlock_date),type:"info"}):t.isEnrolled||this.$notify.info({message:this.$t("You need to enroll in this course to access this lesson"),type:"info"});return}this.$emit("goToLesson",e.slug)},formatSeconds(e){if(e<1)return null;let t=Math.floor(e/3600),o=Math.floor(e%3600/60),u=e%60,s="";return t>0&&(s+=`${t}h `),o>0&&(s+=`${o}m `),u>0&&(s+=`${u}s`),s.trim()||null}},mounted(){this.appVars.course_sections_collapsed=="yes"&&this.toggleAllSections()}},vM=["href"],bM={class:"fcom_course_actions"},kM=["href"],wM={key:0,class:"fcom_sub_header"},CM={key:0,class:"fcom_notice"},$M={class:"fcom_feed_box course_box"},SM={class:"fcom_course_sections"},VM={class:"fcom_course_intro"},LM={class:"fcom_course_labels"},MM={class:"fcom_course_info"},PM=l("span",null," ‚Ä¢ ",-1),FM=["innerHTML"],TM={class:"fcom_card_sections"},IM={class:"fcom_section_items"},UM=["onClick"],BM={class:"fcom_section_primary_item_title"},EM={class:"title_line_container"},AM={class:"title_line"},DM={key:0,class:"section_lock_badge"},RM={class:"fcom_meta_text"},HM={key:0,class:"fcom_meta_text"},xM={class:"fcom_section_primary_item_actions"},jM=["onClick"],OM={class:"fcom_heading_item clickable"},NM={class:"lesson_feature_media"},zM=["src","alt"],qM=["src","alt"],GM={class:"lesson_title"},YM=["innerHTML"],ZM={class:"lesson_duration"},WM={key:0},JM={key:1},QM=["innerHTML"],KM={key:0,class:"fcom_section_item_actions"},XM={class:"fcom_meta_text"},eP={class:"fcom_main_side_wrap"},tP={class:"fcom_side_box"},sP={key:0,class:"app_side_widget course_widget"},oP={class:"widget_header"},iP={class:"widget_body"},nP={class:"progress_label"},lP={key:0,style:{margin:"20px 0"}},aP={key:1,class:"app_side_widget course_widget"},rP={class:"widget_header"},cP={class:"widget_body"},dP={class:"creator_details"},uP={class:"creator_details_item"},_P={class:"creator_details_info"},mP={class:"info_text"},hP={class:"details_name"},fP={class:"details_meta"},pP={class:"fcom_meta_text"},gP={key:0,class:"fcom_meta_text"},yP=["innerHTML"],vP={key:2};function bP(e,t,o,u,s,n){const m=Nt,p=zt,h=j,y=g("render-space-links"),k=g("CollapseIcon"),b=g("Lock"),$=O,f=g("ArrowRight"),w=g("ArrowDown"),C=g("SuccessFilled"),M=g("LockIcon"),P=g("CircleIcon"),T=g("PlayPlaceholderIcon"),I=g("LessonIcon"),U=g("PlayIcon"),B=g("VideoPlay"),A=Ce,L=ws,E=g("UserAvatar"),G=g("UserRouteLink"),se=g("SocialLinks"),H=Ne,X=De,x=g("LockScreenView"),Q=g("layout"),ce=g("app-layout"),J=K("loading");return i(),v(ce,{wrapper_class:"fcom_single_layout fcom_max_layout fcom_course_view_layout"},{default:r(()=>[a(Q,{wrapper_class:["no_bg_layout",{custom_lockscreen:!n.showCourseSections}],title:e.$t("Courses")},{title:r(()=>[a(p,{"separator-class":"el-icon-arrow-right"},{default:r(()=>[a(m,{to:{name:"courses"}},{default:r(()=>[S(d(e.$t("Courses")),1)]),_:1}),a(m,null,{default:r(()=>[S(d(o.course.title)+" ",1),e.hasCourseCreatorAccess()?(i(),c("a",{key:0,class:"fcom_edit_course fcom_secondary_button",style:{cursor:"pointer"},href:n.editLessonLink()},d(e.$t("Edit Lessons")),9,vM)):_("",!0)]),_:1})]),_:1})]),actions:r(()=>[l("div",bM,[e.auth.user_id?!o.track.isEnrolled&&o.course.id?N((i(),v(h,{key:1,disabled:s.enrolling,onClick:n.enroll,class:"fcom_primary_button"},{default:r(()=>[S(d(e.$t("Enroll in this course")),1)]),_:1},8,["disabled","onClick"])),[[J,s.enrolling]]):o.track.progress!=100?(i(),v(h,{key:2,class:"fcom_primary_button",onClick:n.continueCourse},{default:r(()=>[S(d(e.$t("Continue Course")),1)]),_:1},8,["onClick"])):_("",!0):(i(),c(V,{key:0},[n.isCustomLockScreen?_("",!0):(i(),c("a",{key:0,href:e.getCurrentAuthUrl(),class:"fcom_btn el-button el-button--primary fcom_primary_button"},d(e.$t("Login to enroll this course")),9,kM))],64))])]),sub_header:r(()=>{var ae,W;return[o.course&&n.showCourseSections&&((W=(ae=o.course)==null?void 0:ae.settings)!=null&&W.links.length)?(i(),c("div",wM,[a(y,{links:o.course.settings.links},null,8,["links"])])):_("",!0)]}),default:r(()=>[o.course.status==="draft"?(i(),c("div",CM,[l("p",null,d(e.$t("This course is in Draft status and only visible to Admin / Moderators")),1)])):_("",!0),n.showCourseSections?(i(),v(X,{key:1,class:"fcom_resp_container fcom_space_container fcom_main_container"},{default:r(()=>[a(A,{class:"fcom_main"},{default:r(()=>{var ae;return[l("div",$M,[l("div",SM,[l("div",VM,[l("div",LM,[l("h3",null,d(o.course.title),1),l("p",MM,[S(d(e.$_n("%s Topic","%s Topics",n.sectionsCount))+" ",1),PM,S(" "+d(e.$_n("%s Lesson","%s Lessons",o.lessonsCount)),1)])])]),(ae=o.course.settings)!=null&&ae.course_details_rendered?(i(),c("div",{key:0,class:"fcom_course_details feed_md_content",innerHTML:o.course.settings.course_details_rendered},null,8,FM)):_("",!0),l("div",{class:R(["course_contents_header",{is_collapsed:n.isCollapsed}])},[l("h4",null,d(e.$t("Course Contents")),1),n.sectionsCount>1?(i(),v(k,{key:0,class:"collapse_icon clickable",onClick:n.toggleAllSections},null,8,["onClick"])):_("",!0)],2),l("div",TM,[l("div",IM,[(i(!0),c(V,null,D(o.sections,W=>(i(),c("div",{key:W.id,class:"fcom_section_primary"},[l("div",{onClick:te=>W.is_closed=!W.is_closed,class:R(["clickable fcom_section_primary_item",{is_closed:W.is_closed}])},[l("div",BM,[l("div",EM,[l("div",AM,[l("h4",null,d(W.title),1),W.unlock_date?(i(),c("span",DM,[W.is_locked?(i(),v($,{key:0},{default:r(()=>[a(b)]),_:1})):_("",!0),l("span",null," ("+d(e.$t("will unlock at %s",e.smartDate(W.unlock_date,!0,!0)))+") ",1)])):_("",!0)]),l("span",RM,d(e.$_n("%s lesson","%s lessons",W.lessons.length)),1),n.lessonDuration(W)?(i(),c("span",HM," ‚Ä¢ "+d(n.lessonDuration(W)),1)):_("",!0)])]),l("div",xM,[a($,null,{default:r(()=>[W.is_closed?(i(),v(f,{key:0,class:"fcom_arrow_icon"})):(i(),v(w,{key:1}))]),_:2},1024)])],10,UM),W.is_closed?_("",!0):(i(!0),c(V,{key:0},D(W.lessons,te=>(i(),c("div",{key:te.id,class:R(["fcom_section_item",{is_locked:n.isLockLesson(W,te)}])},[l("div",{onClick:ct=>n.maybeGotoLesson(te,o.track,W),class:"fcom_section_item_title"},[l("p",OM,[o.track.completed_lessons.includes(te.id.toString())?(i(),v($,{key:0,style:{color:"#008a2e"}},{default:r(()=>[a(C)]),_:1})):n.isLockLesson(W,te)?(i(),v($,{key:1},{default:r(()=>[a(M)]),_:1})):(i(),v($,{key:2},{default:r(()=>[a(P)]),_:1})),n.isModernLayout?(i(),c(V,{key:3},[l("span",NM,[te.featured_image?(i(),c("img",{key:0,src:te.featured_image,alt:te.title},null,8,zM)):n.hasMediaImage(te)?(i(),c("img",{key:1,src:te.meta.media.image,alt:te.title},null,8,qM)):n.hasMediaVideo(te)?(i(),v(T,{key:2})):(i(),v(I,{key:3})),n.showPlayIcon(te)?(i(),v(U,{key:4,class:"play_icon"})):_("",!0)]),l("span",GM,[l("span",{innerHTML:te.title},null,8,YM),l("span",ZM,[te.meta.video_length?(i(),c("span",WM,d(n.formatSeconds(te.meta.video_length)),1)):(i(),c("span",JM,d("---")))])])],64)):(i(),c("span",{key:4,innerHTML:te.title},null,8,QM))])],8,jM),!n.isModernLayout&&te.meta.enable_media=="yes"&&te.meta.video_length?(i(),c("div",KM,[l("span",XM,[te.meta.video_length?(i(),v(h,{key:0,onClick:ct=>n.maybeGotoLesson(te,o.track,W),text:""},{default:r(()=>[a($,null,{default:r(()=>[a(B)]),_:1}),l("span",null,d(n.formatSeconds(te.meta.video_length)),1)]),_:2},1032,["onClick"])):_("",!0)])])):_("",!0)],2))),128))]))),128))])])])])]}),_:1}),n.showSidebar?(i(),v(H,{key:0,class:"fcom_resp_side",width:"306px"},{default:r(()=>[l("div",eP,[l("div",tP,[o.track.isEnrolled?(i(),c("div",sP,[l("div",oP,[l("h3",null,d(e.$t("Course progress")),1)]),l("div",iP,[l("div",nP,[l("p",null,d(e.$t("Completed %1$s of %2$s",o.track.completed_lessons.length,o.lessonsCount)),1),l("span",null,d(parseInt(o.track.progress))+"%",1)]),a(L,{class:"fcom_progress","stroke-width":10,percentage:parseInt(o.track.progress),"show-text":!1},null,8,["percentage"]),o.track.progress==100?(i(),c("div",lP,[l("h5",null,d(e.$t("Congratulations! Course completed! üéâ")),1)])):_("",!0)])])):_("",!0),o.course.creator?(i(),c("div",aP,[l("div",rP,[l("h3",null,d(e.$t("Course Instructor")),1)]),l("div",cP,[l("div",dP,[l("div",uP,[l("div",_P,[a(E,{with_level:!1,xprofile:o.course.creator},null,8,["xprofile"]),l("div",mP,[l("div",hP,[a(G,{show_badge:!0,xprofile:o.course.creator},null,8,["xprofile"])]),l("div",fP,[l("span",pP,d(e.$_n("%d Course","%d Courses",o.course.creator.total_courses)),1),o.course.creator.total_students?(i(),c("span",gP," ‚Ä¢ "+d(e.$_n("%d Student","%d Students",o.course.creator.total_students)),1)):_("",!0)])])]),o.course.creator.short_description_rendered?(i(),c("div",{key:0,class:"creator_details_description feed_md_content",innerHTML:o.course.creator.short_description_rendered},null,8,yP)):_("",!0)]),a(se,{xprofile:o.course.creator},null,8,["xprofile"])])])])):_("",!0)])])]),_:1})):_("",!0)]),_:1})):_("",!0),n.showCourseSections?_("",!0):(i(),c("div",vP,[a(x,{space_profile:o.course,sections:o.sections},null,8,["space_profile","sections"])]))]),_:1},8,["wrapper_class","title"])]),_:1})}const kP=F(yM,[["render",bP]]),wP={name:"CommentBox",components:{FeedComments:Es,FeedTextComposer:lt},props:{feed:{type:Object,required:!0},showAll:{type:Boolean,default:!0},checkPermission:{type:Boolean,default:!0},is_single:{type:Boolean,default:!0},show_comment_form:{type:Boolean,default:!0}},data(){return{show_all_comments:this.showAll,commenting:!1,comment:{message:"",media_images:[]},saving:!1,showCommentBox:!0,sortBy:"oldest"}},methods:{postComment(){this.comment.message&&(this.saving=!0,this.$post("feeds/"+this.feed.id+"/comments",{comment:this.comment.message,media_images:this.comment.media_images,meta:this.comment.meta}).then(e=>{this.feed.comments||(this.feed.comments=[]),this.feed.comments.unshift(e.comment),this.$emit("commented",e.comment),this.feed.comments_count=parseInt(this.feed.comments_count)+1,this.commenting=!1,this.comment=null,this.showCommentBox=!1,this.$nextTick(()=>{this.comment={message:"",media_image:""}}),this.showCommentBox=!0}).catch(e=>{this.$handleError(e)}).finally(()=>{this.saving=!1}))},showCommentForm(){this.show_all_comments=!0,this.commenting=!0,this.$nextTick(()=>{this.$refs.commentInput&&this.$refs.commentInput.focus()})},showAllComments(){this.show_all_comments=!0,this.commenting=!0},getSpaceId(){var e,t;return((e=this.feed)==null?void 0:e.course_id)||((t=this.feed)==null?void 0:t.space_id)},changeCommentsSortBy(){this.$storeLocalData("comments_sort_by",this.sortBy)}},mounted(){let e=this.feed.default_comment_sort_by||"oldest";this.sortBy=this.$getLocalData("comments_sort_by",e)}},CP=["id"],$P={key:0,class:"feed_commenting"},SP={class:"person_avatar"},VP=["src"],LP={key:0,class:"feed_comment_input"},MP={key:1,class:""},PP={style:{padding:"0",margin:"0","text-align":"center"}},FP={key:0,class:"fcom_comment_sorting"};function TP(e,t,o,u,s,n){const m=j,p=g("feed-text-composer"),h=g("router-link"),y=ie,k=ne,b=g("feed-comments");return i(),c("div",{class:R(["fcom_comment_box","fcom_comment_box_"+o.feed.type])},[z(e.$slots,"before_comment_box"),(s.commenting||o.is_single)&&o.show_comment_form?(i(),c("div",{key:0,id:"feed_comment_form_"+o.feed.id,class:"feed_comment"},[!o.checkPermission||e.hasCommentPermission(o.feed)?(i(),c(V,{key:0},[s.comment?(i(),c("div",$P,[l("div",SP,[l("img",{alt:"",src:e.auth.avatar},null,8,VP)]),s.showCommentBox?(i(),c("div",LP,[a(p,{context:"comment",mentionQuery:{space_id:n.getSpaceId()},autofocus_changed:s.commenting,autofocus:s.commenting,disabled:s.saving,placeholder:e.$t("Write a comment"),content:s.comment},{default:r(()=>[a(m,{loading:s.saving,disabled:s.saving,class:"fcom_primary_button",size:"small",onClick:t[0]||(t[0]=$=>n.postComment())},{default:r(()=>[S(d(e.$t("Post Comment")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["mentionQuery","autofocus_changed","autofocus","disabled","placeholder","content"])])):_("",!0)])):_("",!0)],64)):(i(),c("div",MP,[l("p",PP,[S(d(e.$t("Please join the Space to post a comment."))+" ",1),o.feed.space?(i(),v(h,{key:0,to:{name:"space_feeds",params:{space:o.feed.space.slug}}},{default:r(()=>[S(d(e.$t("Go to community")),1)]),_:1},8,["to"])):_("",!0)])]))],8,CP)):_("",!0),a(b,{sortBy:s.sortBy,checkPermission:o.checkPermission,onForceShowAll:n.showAllComments,show_all:s.show_all_comments,feed:o.feed},{before_comments_start:r(()=>[o.feed.comments_count>=2?(i(),c("div",FP,[a(k,{"aria-label":e.$t("Sort comments by"),onChange:t[1]||(t[1]=$=>n.changeCommentsSortBy()),modelValue:s.sortBy,"onUpdate:modelValue":t[2]||(t[2]=$=>s.sortBy=$),class:"fcom_off_color fcom_minimal_select","popper-class":"plain_select",placeholder:e.$t("Sort by")},{default:r(()=>[a(y,{value:"oldest",label:e.$t("Earliest")},null,8,["label"]),a(y,{value:"latest",label:e.$t("Latest")},null,8,["label"]),a(y,{value:"popular",label:e.$t("Popular")},null,8,["label"]),a(y,{value:"most_replied",label:e.$t("Most Replied")},null,8,["label"])]),_:1},8,["aria-label","modelValue","placeholder"])])):_("",!0)]),_:1},8,["sortBy","checkPermission","onForceShowAll","show_all","feed"]),z(e.$slots,"after_comment_box")],2)}const IP=F(wP,[["render",TP]]),UP={name:"ExitFullScreen"},BP={viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},EP=l("path",{d:"M5.5 0a.5.5 0 0 1 .5.5v4A1.5 1.5 0 0 1 4.5 6h-4a.5.5 0 0 1 0-1h4a.5.5 0 0 0 .5-.5v-4a.5.5 0 0 1 .5-.5zm5 0a.5.5 0 0 1 .5.5v4a.5.5 0 0 0 .5.5h4a.5.5 0 0 1 0 1h-4A1.5 1.5 0 0 1 10 4.5v-4a.5.5 0 0 1 .5-.5zM0 10.5a.5.5 0 0 1 .5-.5h4A1.5 1.5 0 0 1 6 11.5v4a.5.5 0 0 1-1 0v-4a.5.5 0 0 0-.5-.5h-4a.5.5 0 0 1-.5-.5zm10 1a1.5 1.5 0 0 1 1.5-1.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 0-.5.5v4a.5.5 0 0 1-1 0v-4z"},null,-1),AP=[EP];function DP(e,t,o,u,s,n){return i(),c("svg",BP,AP)}const RP=F(UP,[["render",DP]]),HP={name:"QuizView",props:{lesson:{type:Object,required:!0},isEnrolled:{type:Boolean,required:!0},questions:{type:Array,required:!0}},components:{Check:ms},data(){return{userResult:{},answers:this.initAnswers(),isNew:!1,submitting:!1,loading:!1}},computed:{alreadyAttempted(){var e;return(e=this.userResult)==null?void 0:e.id},isAllAnswersSelected(){return this.questions.every(e=>this.isSingleChoice(e)?this.answers[e.slug]!==null:this.answers[e.slug]&&this.answers[e.slug].length>0)},quizSettings(){return this.lesson.meta},showResult(){var e;return this.quizSettings.hide_result=="no"&&((e=this.userResult)==null?void 0:e.id)},isPassed(){var e;return((e=this.userResult)==null?void 0:e.status)==="passed"}},methods:{initAnswers(){return this.questions.reduce((e,t)=>(e[t.slug]=[],t.type=="single_choice"&&(e[t.slug]=null),e),{})},syncAnswers(){var t;const e=((t=this.userResult)==null?void 0:t.message)||[];this.answers=this.initAnswers(),e&&Mi.each(e,(o,u)=>{this.answers[u]=o.user_answer})},retakeQuiz(){this.answers=this.initAnswers(),this.userResult={},this.submitting=!1,this.loading=!1,this.isNew=!0},showQuestion(e){var o;if(!this.alreadyAttempted)return!0;const t=((o=this.userResult)==null?void 0:o.message)||[];return!!(this.isNew||t[e.slug])},isSingleChoice(e){return e.type=="single_choice"},isMultipleChoice(e){return e.type=="multiple_choice"},showQuestionImage(e){return e.image_enabled&&e.image_url},isQuestionCorrect(e){var t,o;return(o=(t=this.userResult)==null?void 0:t.message[e.slug])==null?void 0:o.is_correct},isOptionSelected(e,t){return this.isSingleChoice(e)?this.answers[e.slug]===t.label:(this.answers[e.slug]||[]).includes(t.label)},handleOptionChange(e,t){if(this.isSingleChoice(e)&&(this.answers[e.slug]===t.label?this.answers[e.slug]=null:this.answers[e.slug]=t.label),this.isMultipleChoice(e)){const o=this.answers[e.slug]||[];o.indexOf(t.label)>-1?this.answers[e.slug]=o.filter(s=>s!==t.label):this.answers[e.slug]=[...o,t.label]}},fetchAnswers(){this.loading=!0,this.$get("courses/"+this.lesson.course_id+"/lessons/"+this.lesson.id+"/quiz/result").then(e=>{this.userResult=e.result||{},this.syncAnswers()}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})},submitQuiz(){this.has_pro&&(this.submitting=!0,this.$post("courses/"+this.lesson.course_id+"/lessons/"+this.lesson.id+"/quiz/submit",{course_id:this.lesson.course_id,lesson_id:this.lesson.id,answers:this.answers}).then(e=>{this.$notify.success(e.message),this.userResult=e.result,this.syncAnswers()}).catch(e=>{this.$handleError(e)}).finally(()=>{this.submitting=!1}))}},mounted(){this.isEnrolled&&this.has_pro&&this.fetchAnswers()}},xP={key:0,class:"fcom_questions_wrap"},jP={key:0,class:"fcom_quiz_result"},OP={class:"result_status"},NP={key:0,class:"result_status_text"},zP={key:0},qP={key:1},GP={class:"result_score"},YP={class:"score_part"},ZP={class:"part_label"},WP={class:"part_value"},JP={class:"score_part"},QP={class:"part_label"},KP={class:"part_value"},XP={key:0,class:"fcom_question"},eF={key:0,class:"fcom_question_image"},tF={class:"fcom_question_header"},sF=["innerHTML"],oF={class:"fcom_question_body"},iF={key:0,class:"correct_text"},nF={key:1,class:"correct_text"},lF={class:"fcom_question_options"},aF={key:1,class:"question_help_text"},rF={key:2,class:"fcom_quiz_footer"},cF={key:0};function dF(e,t,o,u,s,n){var f,w;const m=j,p=Pe,h=g("Check"),y=O,k=g("Close"),b=he,$=q;return i(),c(V,null,[s.loading?(i(),v($,{key:1,rows:5,animated:""})):(i(),c("div",xP,[n.alreadyAttempted?(i(),c("div",jP,[l("div",OP,[["passed","failed"].includes(s.userResult.status)?(i(),c("div",NP,[l("p",null,[n.isPassed?(i(),c("span",zP,"üéâ ")):(i(),c("span",qP,"üòû ")),l("span",null,d(e.$t("You")),1),l("span",{style:re({color:n.isPassed?"green":"red"})},d(n.isPassed?" "+e.$t("passed")+" ":" "+e.$t("failed")+" "),5),l("span",null,d(e.$t("the quiz.")),1)]),l("p",null,d(n.isPassed?e.$t("Great job!"):e.$t("Try again!")),1)])):(i(),c(V,{key:1},[l("p",null,d(e.$t("We have saved your quiz results.")),1),l("p",null,d(e.$t("Please await the grading.")),1)],64)),a(m,{class:"fcom_secondary_button",onClick:n.retakeQuiz},{default:r(()=>[S(d(e.$t("Retake Quiz")),1)]),_:1},8,["onClick"])]),l("div",GP,[l("div",YP,[l("span",ZP,d(e.$t("Score")),1),l("span",WP,d(s.userResult.score)+"%",1)]),l("div",JP,[l("span",QP,d(e.$t("Correct Answers")),1),l("span",KP,d(((f=s.userResult.meta)==null?void 0:f.correct_answers)+" / "+((w=s.userResult.meta)==null?void 0:w.total_questions)),1)])])])):_("",!0),(i(!0),c(V,null,D(o.questions,C=>(i(),c(V,{key:C.slug},[n.showQuestion(C)?(i(),c("div",XP,[n.showQuestionImage(C)?(i(),c("div",eF,[a(p,{src:C.image_url},null,8,["src"])])):_("",!0),l("div",tF,[l("div",{innerHTML:C.label_rendered,class:"fcom_question_label"},null,8,sF)]),l("div",oF,[n.showResult?(i(),c("div",{key:0,class:R(["fcom_is_correct",n.isQuestionCorrect(C)?"correct":"incorrect"])},[n.isQuestionCorrect(C)?(i(),c("p",iF,[a(y,null,{default:r(()=>[a(h)]),_:1}),S(" "+d(e.$t("Correct")),1)])):(i(),c("p",nF,[a(y,null,{default:r(()=>[a(k)]),_:1}),S(" "+d(e.$t("Incorrect")),1)]))],2)):_("",!0),l("div",lF,[(i(!0),c(V,null,D(C.options,M=>(i(),c("div",{key:M.label,class:"fcom_question_option"},[a(b,{class:R({single_choice:n.isSingleChoice(C)}),"model-value":n.isOptionSelected(C,M),onChange:P=>n.handleOptionChange(C,M)},{default:r(()=>[S(d(M.label),1)]),_:2},1032,["class","model-value","onChange"])]))),128))]),C.help_text?(i(),c("div",aF,d(C.help_text),1)):_("",!0)])])):_("",!0)],64))),128))])),!s.loading&&!n.alreadyAttempted?(i(),c("div",rF,[l("p",null,d(e.$t("Answer all questions to submit")),1),a(m,{class:"fcom_primary_button",onClick:n.submitQuiz,loading:s.submitting,disabled:s.submitting||!n.isAllAnswersSelected},{default:r(()=>[S(d(e.$t("Submit Quiz"))+" ",1),e.has_pro?_("",!0):(i(),c("span",cF,"¬†("+d(e.$t("Pro Required"))+")",1))]),_:1},8,["onClick","loading","disabled"])])):_("",!0)],64)}const uF=F(HP,[["render",dF]]),_F={name:"ViewLesson",emits:["reload"],components:{PaperClipIcon:Fs,DocumentLists:Ge,CircleIcon:es,AppLayout:we,Layout:ve,MediaPreview:Be,CommentBox:IP,ChatIcon:ze,ExitFullScreen:RP,QuizView:uF},props:["course","sections","track","currentLesson","lessonsCount","lesson_slug","currentLessonIndex","lessonsCount"],emits:["setNextLesson","setPrevLesson","goToLesson","reload"],data(){return{completing:!1,isFullScreen:!1,sm_side_show:!1,isTransiting:!1,enrolling:!1,lightboxImages:[],_lightboxHandler:null}},watch:{currentLessonIndex(){this.sm_side_show=!1},lesson_slug(){this.currentLesson.slug&&this.currentLesson.slug!=this.lesson_slug&&this.gotoLesson({slug:this.lesson_slug})},"currentLesson.content":{handler(e){e&&this.$nextTick(()=>{var t;e.includes("<media-player")&&e.includes("fluent-player")&&document.dispatchEvent(new CustomEvent("FComMediaReady",{detail:{media:((t=this.currentLesson.meta)==null?void 0:t.media)||{},feed:this.currentLesson}})),this.setupLightboxImages()})},immediate:!0}},computed:{isCompleted(){return this.track.completed_lessons.includes(this.currentLesson.id.toString())},isQuizContent(){return this.currentLesson.content_type=="quiz"},commentsEnabled(){return this.course.settings.disable_comments!="yes"&&this.currentLesson.can_view&&this.currentLesson.meta.enable_comments==="yes"},containerHeight(){if(!this.isFullScreen){const e=document.querySelector(".fcom_mobile_menu");return`calc(100dvh - (var(--fcom-header-height, 0px) + ${e?e.offsetHeight:0}px))`}return"100dvh !important"},hasDocuments(){return this.currentLesson.meta.document_lists&&this.currentLesson.meta.document_lists.length>0},showMediaPreview(){var e,t,o,u,s,n;return((o=(t=(e=this.currentLesson)==null?void 0:e.meta)==null?void 0:t.media)==null?void 0:o.url)||((n=(s=(u=this.currentLesson)==null?void 0:u.meta)==null?void 0:s.media)==null?void 0:n.html)}},methods:{markAsComplete(){this.completing=!0;let e=this.isCompleted?"incomplete":"completed";this.$put("courses/"+this.course.id+"/lessons/"+this.currentLesson.id+"/completion",{state:e}).then(t=>{this.track.completed_lessons=t.track.completed_lessons,this.$emit("updateTrack",t.track),e=="completed"&&this.$emit("setNextLesson")}).catch(t=>{this.$handleError(t)}).finally(()=>{this.completing=!1})},toggleFullScreen(){this.isFullScreen=!this.isFullScreen,this.$storeLocalData("lesson_fs",this.isFullScreen?"yes":"no")},scrollToComments(){this.$refs.lesson_scroller&&this.$refs.lesson_scroller.scrollTo({top:this.$refs.fcom_course_comments.offsetTop-100})},enroll(){this.enrolling=!0,this.$post("courses/"+this.course.id+"/enroll").then(e=>{this.$emit("reload"),this.$notify.success(e.message)}).catch(e=>{this.$handleError(e)}).finally(()=>{this.enrolling=!1})},scrollToDocuments(){this.$refs.lesson_scroller&&this.$refs.lesson_scroller.scrollTo({top:this.$refs.fcom_course_documents.offsetTop-100})},gotoLesson(e){this.$emit("goToLesson",e.slug)},setupLightboxImages(){const e=this.$refs.lessonContent;if(!e)return;const t=e.querySelectorAll(".wp-lightbox-container img");if(!t.length)return;const o=Array.from(t).map(u=>u.src).filter(Boolean);o.length&&(this._lightboxHandler&&e.removeEventListener("click",this._lightboxHandler),this._lightboxHandler=u=>{u.target.closest(".wp-lightbox-container")&&(u.preventDefault(),u.stopPropagation(),this.lightboxImages=o)},e.addEventListener("click",this._lightboxHandler))},setSidebarScroll(){let e=document.getElementById("fcom_lesson_title_"+this.currentLesson.id),t=this.$refs.lesson_index_sidebar.wrapRef;const o=e.getBoundingClientRect(),u=t.getBoundingClientRect();o.top>=u.top&&o.bottom<=u.bottom&&o.left>=u.left&&o.right<=u.right||e.scrollIntoView({behavior:"instant",block:"center"})}},mounted(){this.isFullScreen=this.$getLocalData("lesson_fs",this.appVars.course_lesson_fullscreen)=="yes",window.scrollTo(0,0),this.$refs.lesson_scroller&&this.$refs.lesson_scroller.setScrollTop(0),this.$route.query.comment_id&&setTimeout(()=>{let t=document.getElementById("comment_"+this.$route.query.comment_id);t&&(this.$refs.lesson_scroller&&this.$refs.lesson_scroller.setScrollTop(t.offsetTop),t.classList.add("fcom_highlight_comment"))},500),document.body.classList.add("fcom-no-scroll"),this.setSidebarScroll();const e=document.getElementById("fcom_lesson_inline_css");if(e&&e.remove(),this.currentLesson.inline_css){const t=document.createElement("style");t.type="text/css",t.id="fcom_lesson_inline_css",t.appendChild(document.createTextNode(this.currentLesson.inline_css)),document.head.appendChild(t)}},beforeUnmount(){document.body.classList.remove("fcom-no-scroll"),this._lightboxHandler&&this.$refs.lessonContent&&this.$refs.lessonContent.removeEventListener("click",this._lightboxHandler)}},mF={key:0},hF={class:"fcom_back_space"},fF={class:"fcom_lesson_details",style:{padding:"2rem"}},pF={class:"fcom_back_space"},gF={class:"fcom_lesson_name"},yF={class:"fcom_lesson_nav"},vF={key:1},bF=["href"],kF={class:"fcom_lesson_details"},wF={class:"fcom_lesson_header"},CF={class:"fcom_lesson_title"},$F={class:"fcom_lesson_number"},SF=["href"],VF=["innerHTML"],LF={class:"fcom_lesson_nav"},MF=["innerHTML"],PF={class:"fcom_lesson_body feed_texts"},FF={key:0,class:"fcom_lesson_content"},TF=["innerHTML"],IF={key:0,class:"fcom_lesson_quiz"},UF={key:1,ref:"fcom_course_documents",class:"fcom_lesson_documents"},BF={class:"fcom_lesson_documents_header"},EF={key:0,class:"fcom_lesson_documents_list"},AF={key:0,ref:"fcom_course_comments",class:"fcom_lesson_comments"},DF={class:"fcom_lesson_comment_box"},RF={style:{"text-align":"center",padding:"20px","margin-top":"30px","border-radius":"8px","background-color":"var(--fcom-primary-bg, white)"}},HF={style:{padding:"0",margin:"0 0 20px"}},xF=["href"],jF={class:"fcom_section_sidebar_title"},OF={class:"fcom_section_items"},NF={class:"fcom_section_primary_item"},zF={class:"fcom_section_primary_item_title"},qF=["id","onClick"],GF={class:"fcom_heading_item clickable"},YF=["innerHTML"],ZF={key:0,class:"fcom_section_footer course_progress_footer_wrap"},WF={class:"fcom_course_progress_footer"};function JF(e,t,o,u,s,n){const m=q,p=g("ArrowLeft"),h=O,y=g("FullScreen"),k=g("ExitFullScreen"),b=j,$=g("ChatIcon"),f=g("PaperClipIcon"),w=g("ArrowRight"),C=g("Operation"),M=g("media-preview"),P=g("QuizView"),T=g("DocumentLists"),I=g("CommentBox"),U=fe,B=Ce,A=g("ArrowDown"),L=g("SuccessFilled"),E=g("Lock"),G=g("CircleIcon"),se=ws,H=Ne,X=hs,x=De,Q=g("layout"),ce=g("app-layout"),J=K("loading");return i(),v(ce,{class:R({fcom_full_screen:s.isFullScreen,fcom_show_right_aside:s.sm_side_show}),wrapper_class:"fcom_single_layout fcom_full_layout"},{default:r(()=>[o.course&&o.currentLesson?(i(),v(Q,{key:0,wrapper_class:"no_bg_layout"},{default:r(()=>[a(x,{class:"fcom_lesson_container fcom_resp_container"},{default:r(()=>[a(B,{style:re({height:n.containerHeight}),class:"fcom_lesson_wrap"},{default:r(()=>[s.isTransiting?(i(),c("div",mF,[N((i(),c("div",hF,[S(" ...... ")])),[[J,!0]]),l("div",fF,[a(m,{rows:10,animated:!0})])])):(i(),v(U,{key:1,ref:"lesson_scroller"},{default:r(()=>{var ae;return[l("div",pF,[l("div",{class:"clickable fcom_go_back",onClick:t[0]||(t[0]=W=>e.$router.push({name:"view_course"}))},[a(h,{class:"fcom_arrow_icon"},{default:r(()=>[a(p)]),_:1}),l("span",gF,d(o.course.title),1)]),l("div",yF,[a(b,{title:s.isFullScreen?e.$t("Exit Full Screen"):e.$t("Go Full Screen"),onClick:n.toggleFullScreen,size:"small",text:""},{default:r(()=>[a(h,null,{default:r(()=>[s.isFullScreen?(i(),v(k,{key:1})):(i(),v(y,{key:0}))]),_:1})]),_:1},8,["title","onClick"]),o.currentLesson.can_view?(i(),c(V,{key:0},[n.commentsEnabled?(i(),v(b,{key:0,onClick:n.scrollToComments,bg:"",size:"small",text:""},{default:r(()=>[a(h,null,{default:r(()=>[a($)]),_:1})]),_:1},8,["onClick"])):_("",!0),n.hasDocuments?(i(),v(b,{key:1,onClick:n.scrollToDocuments,bg:"",size:"small",text:""},{default:r(()=>[a(h,null,{default:r(()=>[a(f)]),_:1})]),_:1},8,["onClick"])):_("",!0),o.track.isEnrolled?(i(),v(b,{key:2,class:R(n.isCompleted?"":"fcom_primary_button"),style:{"margin-left":"15px"},type:"info",onClick:n.markAsComplete,size:"small"},{default:r(()=>[n.isCompleted?(i(),c("span",vF,d(e.$t("Completed")),1)):(i(),c(V,{key:0},[l("span",null,d(e.$t("Complete Lesson")),1),a(h,{class:"fcom_arrow_icon"},{default:r(()=>[a(w)]),_:1})],64))]),_:1},8,["class","onClick"])):e.auth.user_id?!o.track.isEnrolled&&o.course.id?N((i(),v(b,{key:4,disabled:s.enrolling,onClick:n.enroll,class:"fcom_primary_button"},{default:r(()=>[S(d(e.$t("Enroll in this course")),1)]),_:1},8,["disabled","onClick"])),[[J,s.enrolling]]):_("",!0):(i(),c("a",{key:3,href:e.getCurrentAuthUrl(),class:"fcom_btn el-button el-button--primary fcom_primary_button"},d(e.$t("Login to enroll this course")),9,bF))],64)):_("",!0),a(b,{style:{"margin-left":"15px"},size:"small",text:"",class:"fcom_sm_only",onClick:t[1]||(t[1]=W=>s.sm_side_show=!s.sm_side_show)},{default:r(()=>[a(h,null,{default:r(()=>[a(C)]),_:1})]),_:1})])]),l("div",kF,[l("div",wF,[l("div",CF,[l("p",$F,[S(d(e.$t("Lesson %1$s of %2$s",o.currentLessonIndex+1,o.lessonsCount))+" ",1),e.isAdmin()?(i(),c("a",{key:0,target:"_blank",rel:"noopener",style:{"margin-left":"8px"},class:"el-button el-button--small",href:e.$getRouteLink("admin/manage-courses/edit/:course_id/lessons?lesson_id=:lesson_id",{course_id:o.course.id,lesson_id:o.currentLesson.id})},d(n.isQuizContent?e.$t("Edit Quiz"):e.$t("Edit Lesson")),9,SF)):_("",!0)]),l("h1",{innerHTML:o.currentLesson.title},null,8,VF)]),l("div",LF,[a(b,{onClick:t[2]||(t[2]=W=>e.$emit("setPrevLesson")),disabled:o.currentLessonIndex===0,size:"small"},{default:r(()=>[a(h,{class:"fcom_arrow_icon"},{default:r(()=>[a(p)]),_:1})]),_:1},8,["disabled"]),a(b,{onClick:t[3]||(t[3]=W=>e.$emit("setNextLesson")),disabled:o.currentLessonIndex+1===o.lessonsCount,size:"small"},{default:r(()=>[a(h,{class:"fcom_arrow_icon"},{default:r(()=>[a(w)]),_:1})]),_:1},8,["disabled"])])]),o.currentLesson.can_view?(i(),c(V,{key:1},[n.showMediaPreview?(i(),v(M,{key:0,media_item:o.currentLesson.meta.media},null,8,["media_item"])):_("",!0),l("div",PF,[o.currentLesson.content_loading?(i(),c("div",FF,[a(m,{rows:5,animated:!0})])):(i(),c(V,{key:1},[l("div",{ref:"lessonContent",class:"fcom_lesson_content feed_md_content",innerHTML:o.currentLesson.content},null,8,TF),(ae=o.currentLesson.meta)!=null&&ae.quiz_questions?(i(),c("div",IF,[a(P,{lesson:o.currentLesson,isEnrolled:o.track.isEnrolled,questions:o.currentLesson.meta.quiz_questions},null,8,["lesson","isEnrolled","questions"])])):_("",!0)],64))]),n.hasDocuments&&!o.currentLesson.content_loading?(i(),c("div",UF,[l("div",BF,[l("h3",null,d(e.$t("Documents & Files")),1)]),e.has_pro?(i(),c("div",EF,[a(T,{class:"fcom_boxed_documents",document_lists:o.currentLesson.meta.document_lists},null,8,["document_lists"])])):_("",!0)],512)):_("",!0)],64)):(i(),c("div",{key:0,class:"fcom_locked_container",innerHTML:o.currentLesson.access_message},null,8,MF))]),n.commentsEnabled&&!o.currentLesson.content_loading?(i(),c("div",AF,[l("div",DF,[a(I,{show_comment_form:o.track.isEnrolled,feed:o.currentLesson,showAll:!0,checkPermission:!0},pe({before_comment_box:r(()=>[l("h3",null,d(e.$t("Lesson Discussions")),1)]),_:2},[o.track.isEnrolled?void 0:{name:"after_comment_box",fn:r(()=>[l("div",RF,[l("p",HF,d(e.$t("Please enroll the course to join the conversation.")),1),e.auth.user_id?!o.track.isEnrolled&&o.course.id?N((i(),v(b,{key:1,disabled:s.enrolling,onClick:n.enroll,class:"fcom_primary_button"},{default:r(()=>[S(d(e.$t("Enroll in this course")),1)]),_:1},8,["disabled","onClick"])),[[J,s.enrolling]]):_("",!0):(i(),c("a",{key:0,href:e.getCurrentAuthUrl(),class:"fcom_btn el-button el-button--primary fcom_primary_button"},d(e.$t("Login to enroll this course")),9,xF))])]),key:"0"}]),1032,["show_comment_form","feed"])])],512)):_("",!0)]}),_:1},512))]),_:1},8,["style"]),a(H,{class:"fcom_lesson_sidebar fcom_resp_side",width:"320px"},{default:r(()=>[a(U,{ref:"lesson_index_sidebar",height:n.containerHeight},{default:r(()=>[l("div",jF,[l("h3",null,d(e.$t("Lessons")),1)]),l("div",OF,[(i(!0),c(V,null,D(o.sections,ae=>(i(),c("div",{key:ae.id,class:"fcom_section_primary"},[l("div",NF,[l("div",zF,[a(h,{class:"clickable",onClick:W=>ae.is_closed=!ae.is_closed},{default:r(()=>[ae.is_closed?(i(),v(w,{key:0,class:"fcom_arrow_icon"})):(i(),v(A,{key:1}))]),_:2},1032,["onClick"]),l("h4",null,d(ae.title),1)])]),ae.is_closed?_("",!0):(i(!0),c(V,{key:0},D(ae.lessons,W=>(i(),c("div",{class:R([{fcom_current_lesson:W.id==o.currentLesson.id},"fcom_section_item"]),key:W.id},[l("div",{id:"fcom_lesson_title_"+W.id,onClick:te=>n.gotoLesson(W),class:"fcom_section_item_title"},[l("p",GF,[o.track.completed_lessons.includes(W.id.toString())?(i(),v(h,{key:0,style:{color:"#008a2e"}},{default:r(()=>[a(L)]),_:1})):W.can_view?(i(),v(h,{key:2},{default:r(()=>[a(G)]),_:1})):(i(),v(h,{key:1},{default:r(()=>[a(E)]),_:1})),l("span",{innerHTML:W.title},null,8,YF)])],8,qF)],2))),128))]))),128))]),o.track.progress?(i(),c("div",ZF,[l("div",WF,[l("p",null,d(e.$t("Course progress")),1),a(se,{class:"fcom_progress","stroke-width":8,percentage:parseInt(o.track.progress)},null,8,["percentage"])])])):_("",!0)]),_:1},8,["height"])]),_:1}),s.lightboxImages.length?(i(),v(X,{key:0,"url-list":s.lightboxImages,"hide-on-click-modal":!0,onClose:t[4]||(t[4]=ae=>s.lightboxImages=[])},null,8,["url-list"])):_("",!0)]),_:1})]),_:1})):_("",!0)]),_:1},8,["class"])}const QF=F(_F,[["render",JF]]),KF={name:"LeaderLists",props:["leaders"],computed:{isAll(){return this.leaders.key==="all_time"}}},XF={class:"fcom_box_list"},eT={class:"fcom_box_list_header"},tT={class:"fcom_box_list_body"},sT={class:"fcom_person_lists"},oT={class:"fcom_leader"},iT={key:0,class:"fcom_serial_suffix"},nT=l("svg",{width:"11",height:"11",viewBox:"0 0 11 11",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[l("path",{d:"M0 0L11 0V10.0442L5.73392 6.32786L0 10.0442L0 0Z",fill:"currentColor"})],-1),lT=[nT],aT={key:0,class:"fcom_leader_stat"};function rT(e,t,o,u,s,n){const m=g("UserAvatar"),p=g("UserRouteLink");return i(),c("div",XF,[l("div",eT,d(o.leaders.title),1),l("div",tT,[l("ul",sT,[(i(!0),c(V,null,D(o.leaders.items,(h,y)=>(i(),c("li",{key:h.user_id},[l("div",oT,[l("div",{class:R(["fcom_serial_"+(y+1),"fcom_serial"])},[l("span",null,d(y+1),1),y<3?(i(),c("div",iT,lT)):_("",!0)],2),a(m,{with_level:!1,xprofile:h.xprofile},null,8,["xprofile"]),a(p,{show_badge:!0,xprofile:h.xprofile,show_follow:!0},null,8,["xprofile"])]),parseInt(h.total_points)?(i(),c("div",aT,[N(l("span",null,"+",512),[[cs,!n.isAll]]),S(" "+d(h.total_points),1)])):_("",!0)]))),128))])])])}const cT=F(KF,[["render",rT]]),dT={name:"LeaderTooltip",components:{InfoFilled:jt},props:{levelChunks:{type:Array,required:!0}}},uT={class:"fcoml_tooltip_content"},_T={class:"fcoml_tooltip_title"},mT={class:"fcoml_tooltip_subtitle"},hT=["innerHTML"],fT={class:"fcoml_tooltip_subtitle"},pT={class:"fcoml_tooltip_desc"},gT={class:"fcoml_tooltip_levels"},yT={class:"levels_list"},vT={class:"level_title"},bT={class:"level_points"};function kT(e,t,o,u,s,n){const m=g("InfoFilled"),p=O,h=j,y=de;return i(),v(y,{persistent:!1,"popper-class":"fcoml_tooltip_popover",width:550,effect:"dark",trigger:"click"},{reference:r(()=>[a(h,{text:""},{default:r(()=>[a(p,null,{default:r(()=>[a(m)]),_:1})]),_:1})]),default:r(()=>[l("div",uT,[l("h5",_T,d(e.$t("Leaderboard Points")),1),l("p",mT,d(e.$t("1 Like = 1 Point")),1),l("p",{class:"fcoml_tooltip_desc",innerHTML:e.$t("__LEADERBOARD_DESC_INS")},null,8,hT),l("p",fT,d(e.$t("Levels")),1),l("p",pT,d(e.$t("As you gain points, you level up. Your level is shown at the bottom right of your avatar.")),1),l("div",gT,[(i(!0),c(V,null,D(o.levelChunks,(k,b)=>(i(),c("div",{key:b},[l("ul",yT,[(i(!0),c(V,null,D(k,$=>(i(),c("li",{key:$.level,class:"level_item"},[l("div",vT,d($.title),1),l("div",bT,d(e.$_n("%d point","%d points",$.min_points)),1)]))),128))])]))),128))])])]),_:1})}const wT=F(dT,[["render",kT]]),CT={name:"LeaderBoard",components:{InfoFilled:jt,LeaderLists:cT,AppLayout:we,Layout:ve,LeaderTooltip:wT},data(){return{leaderboard:[],loading:!1}},computed:{userLevel(){return this.appVars.auth.user_id?Fe(this.appVars.auth.total_points):null},requiredPoints(){return parseInt(this.userLevel.max_points)-parseInt(this.appVars.auth.total_points)+1},levelChunks(){let e=Object.values(this.appVars.leaderboard_levels);const t=Math.ceil(e.length/3);return e.reduce((o,u,s)=>{const n=Math.floor(s/t);return o[n]||(o[n]=[]),o[n].push(u),o},[])}},methods:{fetchLeaders(){this.loading=!0,this.$get("leaderboard").then(e=>{this.leaderboard=e.leaderboard,e.current_user_follows&&this.setFollowIds(e.current_user_follows)}).catch(e=>{this.$handleError(e)}).finally(()=>{this.loading=!1})}},mounted(){this.appVars.view_leaderboard_members&&this.fetchLeaders(),this.changeTitle(this.$t("Leaderboard"))}},$T={key:0,class:"fcom_leaderboard_profile"},ST={class:"fcom_leaderboard_profile_inner"},VT={class:"fcom_profile_header"},LT={class:"fcom_profile_info"},MT={class:"info_avatar"},PT={class:"info_user"},FT={class:"fcom_level_name"},TT={class:"fcoml_level_sub"},IT={class:"fcoml_level_sub_icon"},UT={class:"fcoml_level_sub_text"},BT={class:"fcom_leaderboard_profile_avatar"},ET={class:"fcom_leaderboard_levels"},AT=["title"],DT={key:1},RT={class:"fcoml_level_detail"},HT={class:"fcoml_level_title"},xT={class:"fcoml_level_sub"},jT={class:"fcom_leaderboard_items"},OT={key:1,class:"white_loaded"};function NT(e,t,o,u,s,n){const m=g("UserAvatar"),p=g("UserRouteLink"),h=g("LeaderTooltip"),y=g("Lock"),k=O,b=et,$=tt,f=g("leader-lists"),w=q,C=g("layout"),M=g("app-layout");return i(),v(M,{wrapper_class:"fcom_single_layout fcom_max_layout"},{default:r(()=>[a(C,{wrapper_class:"no_bg_layout",title:e.$t("Leaderboards")},{default:r(()=>[n.userLevel?(i(),c("div",$T,[l("div",ST,[l("div",VT,[l("div",LT,[l("div",MT,[a(m,{with_level:!0,with_completion:!0,xprofile:e.appVars.auth},null,8,["xprofile"])]),l("div",PT,[a(p,{show_badge:!0,show_pop:!1,xprofile:e.appVars.auth},null,8,["xprofile"]),l("div",FT,d(n.userLevel.title),1)])]),l("div",TT,[l("div",IT,[l("span",null,"üèÜ "+d(e.auth.total_points),1),S(" | "),l("span",null,d(e.$t("Level %d",n.userLevel.level)),1)]),l("div",UT,[S(d(e.$t("%d points to level up!",n.requiredPoints))+" ",1),a(h,{levelChunks:n.levelChunks},null,8,["levelChunks"])])])]),l("div",BT,[a($,{gutter:20},{default:r(()=>[(i(!0),c(V,null,D(n.levelChunks,P=>(i(),v(b,{sm:24,md:8},{default:r(()=>[l("ul",ET,[(i(!0),c(V,null,D(P,T=>(i(),c("li",null,[l("div",{title:`${T.min_points} points`,class:R(["fcom_level_icon",{fcom_is_in_level:n.userLevel.max_points>=T.max_points}])},[n.userLevel.max_points<T.max_points?(i(),v(k,{key:0},{default:r(()=>[a(y)]),_:1})):(i(),c("span",DT,d(T.level),1))],10,AT),l("div",RT,[l("div",HT,d(T.title),1),l("div",xT,d(T.tagline),1)])]))),256))])]),_:2},1024))),256))]),_:1})])])])):_("",!0),l("div",jT,[a($,{gutter:20},{default:r(()=>[(i(!0),c(V,null,D(s.leaderboard,P=>(i(),v(b,{key:P.key,md:8,sm:24},{default:r(()=>[a(f,{leaders:P},null,8,["leaders"])]),_:2},1024))),128))]),_:1})]),s.loading?(i(),c("div",OT,[a(w,{rows:16,animated:!0})])):_("",!0)]),_:1},8,["title"])]),_:1})}const zT=F(CT,[["render",NT]]),qT=[{name:"dashboard",path:"/dashboard",component:P2,meta:{active_menu:"dashboard",title:"Dashboard"}},{path:"/",component:Y0,meta:{active_menu:"dashboard"},children:[{name:"all_feeds",path:"",component:sb},{name:"single_feed",path:"post/:feed_slug",component:ns,props:!0}]},{path:"/space/:space/",component:c4,props:!0,meta:{in_space:!0,lazy_styles:["wp-block-library-css","fcom-block-content-styling-css"]},children:[{name:"space_home",path:"",component:f4,props:!0,meta:{show_sidebar:!0}},{name:"space_feeds",path:"home",component:h4,props:!0,meta:{in_space:!0,show_sidebar:!0}},{name:"space_about",path:"about",component:Ks,props:!0,meta:{in_space:!0,show_sidebar:!0}},{name:"space_feed",path:"post/:feed_slug",component:ns,props:!0,meta:{in_space:!0,show_sidebar:!0}},{name:"space_members",path:"members",component:m5,props:!0,meta:{in_space:!0,show_sidebar:!1}},{name:"space_invitations",path:"invitations",component:V6,props:!0,meta:{in_space:!0,show_sidebar:!1}},{name:"space_documents",path:"documents",component:e6,props:!0,meta:{in_space:!0,show_sidebar:!1}}]},{path:"/discover/spaces",name:"spaces",component:hC,meta:{active_menu:"spaces"}},{name:"all_members",path:"/members",component:YV,props:!0,meta:{active_menu:"all_members"}},{path:"/u/:username/",component:V$,props:!0,meta:{active_menu:"all_members"},children:[{name:"user_profile",path:"",component:u9,meta:{active_menu:"all_members"}},{name:"user_spaces",path:"spaces",component:F7,meta:{active_menu:"all_members",disable_sidebar:!0}},{name:"update_profile",path:"update",component:Q7,meta:{active_menu:"all_members",disable_sidebar:!0}},{name:"user_profile_about",path:"about",component:no,meta:{active_menu:"all_members"}},{name:"user_profile_feeds",path:"posts",component:R$,meta:{active_menu:"all_members"}},{name:"user_scheduled_posts",path:"scheduled-posts",component:d7,meta:{active_menu:"all_members"}},{name:"user_comments",path:"comments",component:$9,meta:{active_menu:"all_members"}},{name:"user_notification_settings",path:"notification-settings",component:SS,meta:{active_menu:"all_members",disable_sidebar:!0}},{name:"user_follows",path:"follow",component:pV,meta:{active_menu:"all_members"},children:[{name:"user_followers",path:"followers",component:NS,props:!0,meta:{active_menu:"all_members"}},{name:"user_followings",path:"followings",props:!0,component:aV,meta:{active_menu:"all_members"}}]}]},{path:"/notifications",name:"notifications",component:oL,meta:{}},{name:"bookmarks",path:"/bookmarks",component:cL,meta:{active_menu:"bookmarks"}},{name:"courses",path:"/courses",component:xL,meta:{active_menu:"courses",lazy_styles:["wp-block-library-css","fcom-block-content-styling-css"]}},{path:"/course/:course_slug",component:YL,props:!0,meta:{active_menu:"courses",in_course:!0,lazy_styles:["wp-block-library-css","fcom-block-content-styling-css"]},children:[{props:!0,path:"lessons",component:kP,name:"view_course",meta:{in_course:!0,lazy_styles:["wp-block-library-css","fcom-block-content-styling-css"]}},{props:!0,path:"lessons/:lesson_slug/view",component:QF,name:"view_lesson",meta:{in_course:!0,lazy_styles:["wp-block-library-css","fcom-block-content-styling-css"]}}]},{name:"leaderboards",path:"/leaderboards",component:zT,meta:{active_menu:"leaderboards"}}],GT={name:"NotFound",data(){return{message:this.$t("Please wait while we redirect you to the appropriate page.."),is404:!1,require_auth:!1}},methods:{lookForPost(e){this.$get("feeds/"+e+"/by-slug").then(t=>{this.$router.push({name:"single_feed",params:{feed_slug:e}})}).catch(t=>{this.$router.push({name:"all_feeds"}),this.is404=!0})}},mounted(){let e=this.$route.path;if(!e){this.message="The requested page could not be found";return}e=e.replace(/^\/+/,"");let o=e.split("/")[0];if(o=="community"){e=e.replace(/^community\//,"/space/"),this.$router.push(e);return}else if(o=="fcom_route"){if(this.$route.query.route=="user_notification_settings")if(this.auth.username){this.$router.push({name:"user_notification_settings",params:{username:this.auth.username}});return}else{window.location.href=this.getCurrentAuthUrl();return}}else if(o=="u")if(this.auth.username){this.$router.push({name:"user_profile",params:{username:this.auth.username}});return}else{window.location.href=this.appVars.auth_url;return}this.lookForPost(o)}};function YT(e,t,o,u,s,n){return i(),c("h1",null,d(s.message),1)}const ZT=F(GT,[["render",YT]]),WT={name:"VerifiedSign"},JT=l("span",{class:"fcom_verified"},[l("svg",{viewBox:"0 0 22 22","aria-label":"Verified account",role:"img","data-testid":"icon-verified"},[l("g",null,[l("path",{d:"M20.396 11c-.018-.646-.215-1.275-.57-1.816-.354-.54-.852-.972-1.438-1.246.223-.607.27-1.264.14-1.897-.131-.634-.437-1.218-.882-1.687-.47-.445-1.053-.75-1.687-.882-.633-.13-1.29-.083-1.897.14-.273-.587-.704-1.086-1.245-1.44S11.647 1.62 11 1.604c-.646.017-1.273.213-1.813.568s-.969.854-1.24 1.44c-.608-.223-1.267-.272-1.902-.14-.635.13-1.22.436-1.69.882-.445.47-.749 1.055-.878 1.688-.13.633-.08 1.29.144 1.896-.587.274-1.087.705-1.443 1.245-.356.54-.555 1.17-.574 1.817.02.647.218 1.276.574 1.817.356.54.856.972 1.443 1.245-.224.606-.274 1.263-.144 1.896.13.634.433 1.218.877 1.688.47.443 1.054.747 1.687.878.633.132 1.29.084 1.897-.136.274.586.705 1.084 1.246 1.439.54.354 1.17.551 1.816.569.647-.016 1.276-.213 1.817-.567s.972-.854 1.245-1.44c.604.239 1.266.296 1.903.164.636-.132 1.22-.447 1.68-.907.46-.46.776-1.044.908-1.681s.075-1.299-.165-1.903c.586-.274 1.084-.705 1.439-1.246.354-.54.551-1.17.569-1.816zM9.662 14.85l-3.429-3.428 1.293-1.302 2.072 2.072 4.4-4.794 1.347 1.246z"})])])],-1);function QT(e,t,o,u,s,n){const m=ks;return i(),v(m,{content:e.$t("Verified"),placement:"top"},{default:r(()=>[JT]),_:1},8,["content"])}const KT=F(WT,[["render",QT]]),XT={name:"WelcomeBanner",components:{MediaPreview:Be},data(){return{config:this.appVars.welcome_banner}},computed:{showMedia(){return this.config&&this.config.mediaType=="video"&&this.config.bannerVideo},showCtaButtons(){var e;return this.config&&((e=this.config.ctaButtons)==null?void 0:e.length)&&this.config.ctaButtons.some(t=>t.link&&t.label)},isRemovable(){return this.config&&this.config.allowClose=="yes"},showBanner(){if(!this.isRemovable)return!0;let e=this.Storage.get(this.getCloseKey,!1);return e?new Date().getTime()>e:!0},getCloseKey(){return this.appVars.user_id?"fcom_welcome_banner_closed_auth":"fcom_welcome_banner_closed_guest"}},methods:{closeBanner(){this.config=null;let e=new Date().getTime()+7*24*60*60*1e3;this.Storage.set(this.getCloseKey,e)}}},eI={key:0,class:"fcom_welcome_box"},tI={key:2,class:"fcom_welcome_title"},sI=["innerHTML"],oI={key:4,class:"fcom_welcome_cta_buttons"},iI=["href","target"];function nI(e,t,o,u,s,n){const m=g("media-preview"),p=Pe,h=g("MoreFilled"),y=O,k=j,b=ot,$=it,f=nt;return s.config&&n.showBanner?(i(),c("div",eI,[n.showMedia?(i(),v(m,{key:0,media_item:s.config.bannerVideo},null,8,["media_item"])):s.config.bannerImage?(i(),v(p,{key:1,class:"feed_media",alt:e.$t("Image Preview"),src:s.config.bannerImage},null,8,["alt","src"])):_("",!0),s.config.title?(i(),c("h2",tI,d(s.config.title),1)):_("",!0),s.config.description_rendered?(i(),c("div",{key:3,class:"fcom_welcome_sub",innerHTML:s.config.description_rendered},null,8,sI)):_("",!0),n.showCtaButtons?(i(),c("div",oI,[(i(!0),c(V,null,D(s.config.ctaButtons,w=>(i(),c(V,null,[w.link&&w.label?(i(),c("a",{key:0,href:w.link,target:w.newTab=="yes"?"_blank":"",class:R({"el-button fcom_primary_button":w.type=="primary","el-button fcom_secondary_button":w.type=="secondary","el-button is-text":w.type=="text","el-link fcom_link_button":w.type=="link"})},d(w.label),11,iI)):_("",!0)],64))),256))])):_("",!0),n.isRemovable?(i(),v(f,{key:5,trigger:"click",class:"fcom_welcome_close"},{dropdown:r(()=>[a($,null,{default:r(()=>[a(b,{onClick:n.closeBanner},{default:r(()=>[S(d(e.$t("Hide Banner")),1)]),_:1},8,["onClick"])]),_:1})]),default:r(()=>[a(k,{"aria-label":e.$t("Hide Banner"),class:"fcom_dot_menu",size:"small",text:""},{default:r(()=>[a(y,null,{default:r(()=>[a(h)]),_:1})]),_:1},8,["aria-label"])]),_:1})):_("",!0)])):_("",!0)}const lI=F(XT,[["render",nI]]),aI=[Mo,Po,Fo,To,Io,Uo,Bo,Eo,Ao,Do,Ro,Ho,xo,jo,Oo,No,zo,qo,us,Go,Yo,Zo,Wo,_s,Jo,Qo,Ko,Xo,gt,ei,ti,si,oi,ii,ni,li,ai,ri,ci,di,ui,_i,mi,jt,Ve];function Ke(e){const t=[];if(typeof e=="object"&&e.join===void 0)for(const o in e)t.push(Ke(e[o]));else if(typeof e=="object"&&e.join!==void 0)for(const o in e)t.push(Ke(e[o]));else typeof e=="function"||typeof e=="string"&&t.push(e);return t.join("<br />")}function rI(e){let t;try{t=new URL(e)}catch{t=new URL(e,"https://fluentcommunity.co")}let o=t.pathname;return o=o.replace(/^\//,""),o.split("/")[0]||""}const le=_o(v2),ss=fo();ss.use(po);ss.use(({store:e})=>{e.$api={get:(t,o)=>window.FluentCommunityUtil.Rest.get(t,o),post:(t,o)=>window.FluentCommunityUtil.Rest.post(t,o),put:(t,o)=>window.FluentCommunityUtil.Rest.put(t,o),patch:(t,o)=>window.FluentCommunityUtil.Rest.patch(t,o),delete:t=>window.FluentCommunityUtil.Rest.delete(t)}});le.use(ss);le.use(ki);var as,rs;le.use(Lo,{loading:(((as=window.fluentComAdmin)==null?void 0:as.assets_url)||"")+"images/image-loader.svg",error:(((rs=window.fluentComAdmin)==null?void 0:rs.assets_url)||"")+"images/image-placeholder.png",lifecycle:{loading:e=>{e.classList.add("fcom-img-loading")},loaded:e=>{e.classList.remove("fcom-img-loading"),e.classList.add("fcom-img-loaded")},error:e=>{e.classList.remove("fcom-img-loading"),e.classList.add("fcom-img-error")}}});le.config.globalProperties.appVars=window.fluentComAdmin;le.config.globalProperties.auth=window.fluentComAdmin.auth;le.config.globalProperties.has_pro=!!window.fluentComAdmin.pro;let Rt="40%",Ht="60%",ao="500px";window.innerWidth<600?(Ht="95%",Rt="90%",ao="90%"):window.innerWidth<800&&(Ht="80%",Rt="80%");aI.forEach(e=>{le.component(e.name,e)});le.component("VerifiedSign",KT);le.component("UserAvatar",Jt);le.component("UserRouteLink",Le);le.component("WelcomeBanner",lI);le.component("UserBadge",io);function ls(){var h,y,k,b,$;le.use(window.FluentCommunityUtil.eventBus);const e=window.FluentCommunityUtil.Rest;le.mixin({data(){return{Storage:window.FluentCommunityUtil.Storage,is_rtl:!1,drawerWidth:Rt,dialogWidth:Ht,modalWidth:ao,feedMonitorCache:{},mounted:!1,isMobile:window.innerWidth<=768,has_leaderboard:this.appVars.features.leaderboard}},methods:{$get:e.get,$post:e.post,$uploadFile:e.uploadFile,$put:e.put,$del:e.delete,$patch:e.patch,$ajax:e.ajax,changeTitle(f){document.title=f+" - "+this.appVars.site_title},$handleError(f){let w="";typeof f=="string"?w=f:f&&f.message?w=f.message:w=Ke(f),w||(w="Something is wrong!"),typeof w!="string"&&(w=Ke(w)),this.$notify({type:"error",title:this.$t("Error"),message:w,dangerouslyUseHTMLString:!0})},convertToText:Ke,$t(f){f=window.fluentComAdmin.i18n[f]||f;const w=Array.prototype.slice.call(arguments,1);if(w.length===0)return f;const C=/%(\d*)\$?s|%d/g;let M=0;return f=f.replace(C,(P,T)=>{if(T){const I=parseInt(T,10)-1;return I<w.length?w[I]:P}else return M<w.length?w[M++]:P}),f},$_n(f,w,C){return parseInt(C.toString().replace(/,/g,""),10)>1?this.$t(w,C):this.$t(f,C)},$labelize(f){return f?(f=f.charAt(0).toUpperCase()+f.slice(1),window.fluentComAdmin.i18n[f]?window.fluentComAdmin.i18n[f]:f.replace(/_/g," ").replace(/\b\w/g,w=>w.toUpperCase())):""},$toClipboard(f,w="Copied to clipboard"){navigator.clipboard.writeText(f).then(()=>{this.$notify.success(this.$t(w))}).catch(C=>{this.$notify.error(this.$t("Failed to copy"))})},dayjs,relativeTimeFromUtc(f){return dayjs.utc(f).local().fromNow()},$storeLocalData(f,w){this.Storage.set(f,w)},$getLocalData(f,w=""){return this.Storage.get(f,w)},ucFirst(f){return f?f.charAt(0).toUpperCase()+f.slice(1):""},ucWords(f){return f?f.replace(/\b[a-z]/g,function(w){return w.toUpperCase()}):""},smartDate(f,w=!1,C=!1){if(!f)return"";let M="D MMM, YYYY";dayjs(f).isSame(new Date,"year")?(M="D MMM",w&&(Math.abs(dayjs(f).diff(new Date,"days"))<=5||C)&&(M="D MMM, HH:mm")):w&&C&&(M="D MMM, YYYY, HH:mm");const P=dayjs(f);return P.isValid()?P.format(M):null},hasPermission(f){return this.appVars.permissions[f]},isAdmin(){return!!this.appVars.permissions.community_admin},hasCourseAdminAccess(){return!!this.appVars.permissions.course_admin},hasCourseCreatorAccess(){return!!this.appVars.permissions.course_creator},hasSpaceAdminAccess(f=null){return this.hasPermissionOrInCurrentSpace("community_admin")||f&&this.isSpaceAdmin(f)},hasSpaceModeratorAccess(f=null){return this.hasPermissionOrInCurrentSpace("community_moderator")||f&&this.isSpaceModerator(f)},canDeleteFeed(f){return this.auth.user_id&&(f.user_id==this.auth.user_id||this.hasPermissionOrInCurrentSpace("delete_any_feed"))},canEditFeed(f){return this.auth.user_id&&(f.user_id==this.auth.user_id||this.hasPermissionOrInCurrentSpace("edit_any_feed"))},canDeleteComment(f){return this.auth.user_id&&(f.user_id==this.auth.user_id||this.hasPermissionOrInCurrentSpace("delete_any_comment"))},canEditComment(f){return this.auth.user_id&&(f.user_id==this.auth.user_id||this.hasPermissionOrInCurrentSpace("edit_any_comment"))},hasSpaceAccess(f){return f?this.appVars.user_membership_slugs.indexOf(f)!==-1:!0},hasInPermission(f,w){return!w||typeof w!="object"?!1:w[f]},hasCurrentSpacePermission(f){return window.fcom_current_community?this.hasInPermission(f,window.fcom_current_community.permissions):!1},hasPermissionOrInCurrentSpace(f){return this.hasPermission(f)?!0:this.hasCurrentSpacePermission(f)},humanDateDiff(f){if(!f)return"";const w=dayjs.utc(f,"YYYY-MM-DD HH:mm:ss");if(!w.isValid())return"";const C=w.add(this.appVars.date_offset,"s");return dayjs(C.format("YYYY-MM-DD HH:mm:ss")).from(dayjs(dayjs.utc().format("YYYY-MM-DD HH:mm:ss")))},isToday(f){return dayjs(f).isSame(dayjs(),"day")},isPastDate(f){if(!f)return!0;const w=dayjs.utc(f,"YYYY-MM-DD HH:mm:ss");return w.isValid()?w.add(this.appVars.date_offset,"s").isBefore(dayjs(dayjs.utc().format("YYYY-MM-DD HH:mm:ss"))):!0},formattedDate(f){return dayjs(f).format(this.appVars.date_formatter)},formattedTime(f){return dayjs(f).format(this.appVars.time_formatter)},formattedDateTime(f){return dayjs(f).format(this.appVars.date_time_formatter)},hasCommentPermission(f){var w;return this.auth.user_id?!f.space_id&&!f.course_id?this.auth.user_id&&(f.user_id==this.auth.user_id||f.privacy=="public"):this.hasSpaceAccess((w=f.space)==null?void 0:w.slug):!1},getExcerpt(f,w=250){if(!f)return"";let C=f.replace(/(<([^>]+)>)/ig,"");return C=C.replace(/(\*\*|__)(.*?)\1/g,"$2"),C=C.replace(/(#+)(.*)/g,"$2"),C=C.replace(/\[(.*?)\]\((.*?)\)/g,"$1"),C.length>w&&(C=C.substring(0,w)+"..."),C},mdToHtml(f){return f?(f=f.replace("&#x20;","",f),f=f.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),f=f.replace(/\*(.*?)\*/g,"<em>$1</em>"),f=f.replace(/\~\~(.*?)\~\~/g,"<del>$1</del>"),f=f.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2">$1</a>'),f=f.replace(/<(https?:\/\/[^\s>]+)>/g,'<a href="$1">$1</a>'),f=f.replace(/^##\s+(.*?)$/gm,"<h2>$1</h2>"),f=f.replace(/^###\s+(.*?)$/gm,"<h3>$1</h3>"),f=f.replace(/^####\s+(.*?)$/gm,"<h4>$1</h4>"),f=f.replace(/^>\s+(.*?)$/gm,"<blockquote>$1</blockquote>"),f=f.replace(/`{3}([\s\S]*?)`{3}/g,"<pre><code>$1</code></pre>"),f=f.replace(/`([^`]+)`/g,"<code>$1</code>"),f=f.replace(/^([\*\-])\s+(.*)$/gm,"<li>$2</li>"),f=f.replace(/(<li>.*?<\/li>(?:\n<li>.*?<\/li>)*)/g,function(w){return"<ul>"+w.replace(/\n/g,"")+"</ul>"}),f=f.replace(/\n/g,"<br>"),f):""},$convertToBoolean(f){return f==="true"||f===!0||f===1||f==="1"||f==="yes"||f==="on"},each:Ee,hasFeature(f){return this.appVars.features[f]},isCommunityModerator(){return window.fluentComAdmin.auth.community_roles.some(f=>f==="admin"||f==="moderator")},isSpaceModerator(f){var C,M;return["admin","moderator"].includes((M=(C=f==null?void 0:f.membership)==null?void 0:C.pivot)==null?void 0:M.role)},isSpaceAdmin(f){var w,C;return((C=(w=f==null?void 0:f.membership)==null?void 0:w.pivot)==null?void 0:C.role)=="admin"},isModerator(f){if(this.isCommunityModerator())return!0;if(!f)return!1;const w=this.auth.spaces[f];return this.isSpaceModerator(w)},getCurrentAuthUrl(){let f=window.location.href,w=this.appVars.auth_url;return w=w.replace(/(\?|&)redirect_to=[^&]+/,""),w.indexOf("?")===-1?w+="?":w+="&",w+"redirect_to="+encodeURIComponent(f)},$formatNumber(f){return f&&f.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},$getRouteLink(f,w={}){return Ee(w,(C,M)=>{f=f.replace(":"+M,C)}),this.appVars.portal_url+f},isOnline(f){if(!f)return!1;const C=dayjs.utc(f,"YYYY-MM-DD HH:mm:ss").add(this.appVars.date_offset,"seconds").diff(dayjs.utc(),"minutes");return C<=5&&C>=0},setFollowIds(f){Te().setFollows(f)},doNothing(){console.log("OK")}},mounted(){if(window.fcom_mounted)return;this.isMobile&&document.body.classList.add("fcom-is-mobile"),window.fcom_mounted=!0,document.addEventListener("click",w=>{if(w.metaKey||w.ctrlKey)return;let C=w.target.getAttribute("href");if(!C){const M=w.target.closest("a");M&&(C=M.getAttribute("href"))}if(C){if(window.fluentComAdmin.is_absolute_url){let M=rI(C);if(M){if(window.fluentComAdmin.portal_paths.indexOf(M)===-1){document.dispatchEvent(new CustomEvent("fcomExternalLinkClicked",{detail:{href:C}}));return}}else{let P=window.location.origin,T=new URL(C).origin;if(P==T&&new URL(C).search){document.dispatchEvent(new CustomEvent("fcomExternalLinkClicked",{detail:{href:C}}));return}}}if(C.startsWith(window.fluentComAdmin.urls.portal_base)){if(C.indexOf("fcom_action")!==-1||C.startsWith(window.fluentComAdmin.urls.portal_base+"admin"))return;w.preventDefault(),C=C.replace(window.fluentComAdmin.urls.portal_base,"/"),this.$router.push(C)}else document.dispatchEvent(new CustomEvent("fcomExternalLinkClicked",{detail:{href:C}}))}});let f=window.fluentComAdmin.dateTime18n;dayjs.updateLocale("en",{weekdays:f.weekdays.split("_"),months:f.months.split("_"),weekdaysShort:f.weekdaysShort.split("_"),monthsShort:f.monthsShort.split("_"),weekdaysMin:f.weekdaysMin.split("_"),formats:{LT:"h:mm A",LTS:"h:mm:ss A",L:"YYYY-MM-DD",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},relativeTime:this.isMobile?f.relativeTimeMobile:f.relativeTime}),document.addEventListener("fcom_renew_rest_nonce",w=>{this.$ajax("GET","fluent_community_renew_nonce",{ajax_nonce:window.fluentComAdmin.ajax_nonce}).then(C=>{C.rest_nonce&&(window.fluentComAdmin.rest.nonce=C.rest_nonce,window.fluentComAdmin.ajax_nonce=C.ajax_nonce)}).catch(C=>{window.fluentFrameworkApp.$messageBox.alert(this.$t("Your session has expired due to inactivity. Please refresh the page to continue."),this.$t("Session Expired"),{confirmButtonText:this.$t("Refresh"),callback:M=>{location.reload()}})})})}}),le.config.globalProperties.$notify=wi,le.config.globalProperties.$confirm=At.confirm,le.config.globalProperties.$promt=At.prompt,le.config.globalProperties.$messageBox=At,le.config.globalProperties.$gloablStorage={},le.config.globalProperties.currentTimeZoneName=window.dayjs.tz.guess();const t=window.FluentCommunityUtil.hooks.applyFilters("fluent_com_portal_routes",qT);t.push({path:"/:catchAll(.*)",name:"not-found",component:ZT});let o=null;const u=(f,w,C)=>{const M=xe();if(C)return C;if(w&&w.path&&f.path){const P=M.restoreScrollPosition(f.path);if(P>0)return{top:P,behavior:"auto"}}return{top:0}};window.fluentComAdmin.routing_system=="hash"?o=os({routes:t,history:mo(),scrollBehavior:u}):o=os({routes:t,history:ho(window.fluentComAdmin.portal_slug),scrollBehavior:u});const s=window.FluentCommunityUtil.hooks.applyFilters("fluent_com_portal_app",le);window.fluentFrameworkApp=s.use(o).mount("#fluent_com_portal");const n=xe();n.initialize();const m=Te();m.initializeCurrentUser();const p=Gt();(y=(h=window.fluentComAdmin)==null?void 0:h.auth)!=null&&y.user_id&&((b=(k=window.fluentComAdmin)==null?void 0:k.features)!=null&&b.notifications_polling)&&p.startPolling(6e4),($=window.fluentComAdmin)!=null&&$.debug_mode&&(window.fcomDevTools={stores:{feed:Se(),space:je(),cache:oe(),ui:n,user:m,notification:p},memory:{getStats:()=>{const f=Se(),w=oe(),C=je(),M={feeds:f.getMemoryStats,cache:w.getCacheStats,spaces:{total:Object.keys(C.spacesBySlug).length,mySpaces:C.mySpaces.length}};if("memory"in performance){const P=performance.memory;M.browser={usedMB:(P.usedJSHeapSize/1048576).toFixed(2),totalMB:(P.totalJSHeapSize/1048576).toFixed(2),limitMB:(P.jsHeapSizeLimit/1048576).toFixed(2),percentage:(P.usedJSHeapSize/P.jsHeapSizeLimit*100).toFixed(2)+"%"}}return console.table(M),M},cleanup:()=>{const f=Se(),w=oe();console.log("üßπ Running memory cleanup..."),f.pruneOldFeeds(),w.pruneLRU(),console.log("‚úÖ Cleanup complete"),window.fcomDevTools.memory.getStats()}},help:()=>{console.log(`
üõ†Ô∏è FluentCommunity DevTools

Available commands:
  fcomDevTools.memory.getStats()  - Show memory statistics
  fcomDevTools.memory.cleanup()   - Run memory cleanup
  fcomDevTools.stores.feed        - Access Feed Store
  fcomDevTools.stores.space       - Access Space Store
  fcomDevTools.stores.cache       - Access Cache Store
  fcomDevTools.stores.ui          - Access UI Store
                `)}},console.log("üõ†Ô∏è FluentCommunity DevTools loaded. Type fcomDevTools.help() for available commands.")),document.dispatchEvent(new Event("fluentComPortalAppReady")),window.fluentFrameworkAppRouter=o}window.FluentCommunityUtil?ls():document.addEventListener("fluentCommunityUtilReady",function(){ls()});
